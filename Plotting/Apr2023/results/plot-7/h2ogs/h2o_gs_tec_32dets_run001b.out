Rank =    0  Free Memory = 49060 MB
Rank =    1  Free Memory = 49054 MB
Rank =    2  Free Memory = 49054 MB
Rank =    3  Free Memory = 49054 MB
Rank =    4  Free Memory = 49053 MB
Rank =    5  Free Memory = 49053 MB
Rank =    6  Free Memory = 49053 MB
Rank =    7  Free Memory = 49052 MB
Rank =    8  Free Memory = 49052 MB
Rank =    9  Free Memory = 49052 MB
Rank =   10  Free Memory = 49052 MB
Rank =   11  Free Memory = 49052 MB
Rank =   12  Free Memory = 49052 MB
Rank =   13  Free Memory = 49052 MB
Rank =   14  Free Memory = 49052 MB
Rank =   15  Free Memory = 49039 MB
Rank =   16  Free Memory = 49036 MB
Rank =   17  Free Memory = 49035 MB
Rank =   18  Free Memory = 49035 MB
Rank =   19  Free Memory = 49035 MB
Rank =   20  Free Memory = 49035 MB
Rank =   21  Free Memory = 49035 MB
Rank =   22  Free Memory = 49035 MB
Rank =   23  Free Memory = 49035 MB
Rank =   24  Free Memory = 53596 MB
Rank =   25  Free Memory = 53596 MB
Rank =   26  Free Memory = 53596 MB
Rank =   27  Free Memory = 53596 MB
Rank =   28  Free Memory = 53596 MB
Rank =   29  Free Memory = 53596 MB
Rank =   30  Free Memory = 53596 MB
Rank =   31  Free Memory = 53596 MB
Rank =   32  Free Memory = 53596 MB
Rank =   33  Free Memory = 53596 MB
Rank =   34  Free Memory = 53596 MB
Rank =   35  Free Memory = 53596 MB
Rank =   36  Free Memory = 53596 MB
Rank =   37  Free Memory = 53596 MB
Rank =   38  Free Memory = 53596 MB
Rank =   39  Free Memory = 53596 MB
Rank =   40  Free Memory = 53596 MB
Rank =   41  Free Memory = 53596 MB
Rank =   42  Free Memory = 53596 MB
Rank =   43  Free Memory = 53596 MB
Rank =   44  Free Memory = 53596 MB
Rank =   45  Free Memory = 53596 MB
Rank =   46  Free Memory = 53596 MB
Rank =   47  Free Memory = 53596 MB
Rank =   48  Free Memory = 51827 MB
Rank =   49  Free Memory = 51827 MB
Rank =   50  Free Memory = 51827 MB
Rank =   51  Free Memory = 51827 MB
Rank =   52  Free Memory = 51827 MB
Rank =   53  Free Memory = 51827 MB
Rank =   54  Free Memory = 51827 MB
Rank =   55  Free Memory = 51827 MB
Rank =   56  Free Memory = 51827 MB
Rank =   57  Free Memory = 51827 MB
Rank =   58  Free Memory = 51827 MB
Rank =   59  Free Memory = 51827 MB
Rank =   60  Free Memory = 51827 MB
Rank =   61  Free Memory = 51827 MB
Rank =   62  Free Memory = 51827 MB
Rank =   63  Free Memory = 51827 MB
Rank =   64  Free Memory = 51827 MB
Rank =   65  Free Memory = 51827 MB
Rank =   66  Free Memory = 51827 MB
Rank =   67  Free Memory = 51827 MB
Rank =   68  Free Memory = 51827 MB
Rank =   69  Free Memory = 51827 MB
Rank =   70  Free Memory = 51827 MB
Rank =   71  Free Memory = 51827 MB
Rank =   72  Free Memory = 55690 MB
Rank =   73  Free Memory = 55690 MB
Rank =   74  Free Memory = 55690 MB
Rank =   75  Free Memory = 55689 MB
Rank =   76  Free Memory = 55689 MB
Rank =   77  Free Memory = 55689 MB
Rank =   78  Free Memory = 55689 MB
Rank =   79  Free Memory = 55689 MB
Rank =   80  Free Memory = 55689 MB
Rank =   81  Free Memory = 55689 MB
Rank =   82  Free Memory = 55689 MB
Rank =   83  Free Memory = 55689 MB
Rank =   84  Free Memory = 55689 MB
Rank =   85  Free Memory = 55689 MB
Rank =   86  Free Memory = 55689 MB
Rank =   87  Free Memory = 55689 MB
Rank =   88  Free Memory = 55689 MB
Rank =   89  Free Memory = 55689 MB
Rank =   90  Free Memory = 55689 MB
Rank =   91  Free Memory = 55683 MB
Rank =   92  Free Memory = 55681 MB
Rank =   93  Free Memory = 55681 MB
Rank =   94  Free Memory = 55681 MB
Rank =   95  Free Memory = 55681 MB
  Input file(s): opt_h2o_gs_tec_32dets_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 96
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 96
  MPI ranks per node        = 24
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tec_32dets_run001b.xml

  Project = H2O
  date    = 2023-05-03 09:42:13 PDT
  host    = n0122.savio2

 Random Number
 -------------
  Offset for the random number seeds based on time: 741

  Range of prime numbers to use as seeds over processors and threads = 5651-6469


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.042503e-01    1         1  ON     0
     uu_1                 4.970997e-02    1         1  ON     1
     uu_2                -3.730244e-02    1         1  ON     2
     uu_3                -8.941357e-02    1         1  ON     3
     uu_4                -1.215887e-01    1         1  ON     4
     uu_5                -1.310034e-01    1         1  ON     5
     uu_6                -1.133170e-01    1         1  ON     6
     uu_7                -5.280652e-02    1         1  ON     7
     uu_8                 6.880165e-02    1         1  ON     8
     uu_9                 1.226549e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.013084e-01    1         1  ON     0
     ud_1                 7.551326e-02    1         1  ON     1
     ud_2                -2.236407e-02    1         1  ON     2
     ud_3                -7.391503e-02    1         1  ON     3
     ud_4                -1.108951e-01    1         1  ON     4
     ud_5                -1.325533e-01    1         1  ON     5
     ud_6                -1.291436e-01    1         1  ON     6
     ud_7                -8.919757e-02    1         1  ON     7
     ud_8                -5.478420e-03    1         1  ON     8
     ud_9                 8.710354e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.916466e-01    1         1  ON     0
     eO_1                -4.146418e-01    1         1  ON     1
     eO_2                -4.641024e-02    1         1  ON     2
     eO_3                 1.764940e-01    1         1  ON     3
     eO_4                 2.547935e-01    1         1  ON     4
     eO_5                 2.842077e-01    1         1  ON     5
     eO_6                 2.505912e-01    1         1  ON     6
     eO_7                 1.282767e-01    1         1  ON     7
     eO_8                 2.875441e-02    1         1  ON     8
     eO_9                 1.874536e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.992810e-01    1         1  ON     0
     eH1_1                -9.617737e-02    1         1  ON     1
     eH1_2                -4.657029e-02    1         1  ON     2
     eH1_3                -1.599069e-02    1         1  ON     3
     eH1_4                 1.718654e-02    1         1  ON     4
     eH1_5                 2.207622e-02    1         1  ON     5
     eH1_6                 7.167131e-02    1         1  ON     6
     eH1_7                 1.075488e-01    1         1  ON     7
     eH1_8                 9.848127e-02    1         1  ON     8
     eH1_9                 2.567439e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.992354e-01    1         1  ON     0
     eH2_1                -9.556751e-02    1         1  ON     1
     eH2_2                -4.621353e-02    1         1  ON     2
     eH2_3                -1.576902e-02    1         1  ON     3
     eH2_4                 1.687180e-02    1         1  ON     4
     eH2_5                 2.010247e-02    1         1  ON     5
     eH2_6                 7.067334e-02    1         1  ON     6
     eH2_7                 1.078649e-01    1         1  ON     7
     eH2_8                 1.010350e-01    1         1  ON     8
     eH2_9                 2.791954e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.697671e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.4869e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 119
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1659
    reference variance = 0.44566
====================================================
  Execution time = 2.8456e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0406e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8190e-01
  Total weights = 1.957567631e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7073e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268126320316
                                         uncertainty =       0.001856078900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268126320316
                                         uncertainty =       0.001856078900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366109820
  error estimate for blocks of size 2^( 2) =       0.000379926996
  error estimate for blocks of size 2^( 3) =       0.000392788655
  error estimate for blocks of size 2^( 4) =       0.000402044035
  error estimate for blocks of size 2^( 5) =       0.000409011196
  error estimate for blocks of size 2^( 6) =       0.000412159034
  error estimate for blocks of size 2^( 7) =       0.000413859782

      target function =      -0.941353078748
              le_mean =     -17.212702946058
             les_mean =     296.559047576993
             stat err =       0.000409268512
             autocorr =       1.249665866561
   target nu stat err =       0.000409268512
   target dn stat err =       0.003206646301
      target stat err =       0.005545579285
              std dev =       0.517765757471
             le_variance =       0.268081379610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721270294606e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941384851928       residual = 9.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941505774200       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941531840673       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941539413858       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941542657209       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941543284402       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941544156513       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941545110953       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941545191059       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941546105832       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941547087945       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941547960253       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941549573304       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941550501361       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941551289249       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941552001620       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941552345813       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941551636203       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941551591771       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941551863067       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941552081274       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941552127249       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941552242663       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941552722197       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941552643416       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941552903742       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941552943381       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941552936271       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941553112474       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941553063738       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941553164044       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941553072771       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941553117398       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941553108752       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941553000642       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941553056394       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.941553099402       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941553173562       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.941553228859       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941553347832       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941553335091       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.941553346126       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.941553373949       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.941553390745       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.941553415279       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.941553448077       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.941553479051       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.941553520670       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.941553506144       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.941553489091       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.941553497094       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.941553462035       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.941553445418       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         52 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e-01 is 1.949101e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941384851928       residual = 9.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941421736032       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941429472808       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941431628229       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941432564902       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941432711275       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941432936929       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941433221990       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941433224912       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941433549927       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941433817378       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941434104554       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941434529794       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941434785129       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941434954514       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941435146784       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941435224379       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941435020326       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941434981274       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941435067853       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941435136751       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941435112920       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941435201711       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941435268960       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941435246612       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941435308661       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941435322375       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941435319088       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941435344295       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941435322905       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941435349600       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941435339083       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941435343768       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941435328346       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941435310757       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941435332545       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.941435339966       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941435355217       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.941435370080       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941435393431       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941435390559       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.941435389713       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.941435396923       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.941435400806       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.941435406523       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.941435413837       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.941435416850       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.941435422858       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.941435420296       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+00 is 4.972779e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941384851928       residual = 9.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941394609794       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941396638530       residual = 6.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941397196395       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941397440315       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941397475118       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941397532506       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941397605966       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941397606507       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941397695618       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941397767589       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941397849635       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941397950960       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941398013974       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941398053362       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941398102590       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941398120478       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941398067747       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941398055849       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941398079078       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941398096830       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941398087764       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941398121898       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941398120026       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941398129849       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941398138119       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941398141487       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941398140274       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941398145167       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941398139145       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941398146215       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941398144433       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941398145013       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941398140417       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941398136858       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941398142691       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.941398144239       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941398147923       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.941398151742       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941398157049       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941398156385       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.941398156041       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.941398157777       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.941398158617       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.941398160029       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.941398161844       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.941398162213       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.941398163517       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+00 is 1.250207e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.396572 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7571e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0   2.042773e-01                 1 1 ON  0
uu_1   4.978322e-02                 1 1 ON  1
uu_2   -3.719662e-02                1 1 ON  2
uu_3   -8.928996e-02                1 1 ON  3
uu_4   -1.214829e-01                1 1 ON  4
uu_5   -1.309787e-01                1 1 ON  5
uu_6   -1.133784e-01                1 1 ON  6
uu_7   -5.300257e-02                1 1 ON  7
uu_8   6.830437e-02                 1 1 ON  8
uu_9   1.227559e-01                 1 1 ON  9
ud_0   3.010872e-01                 1 1 ON  10
ud_1   7.536714e-02                 1 1 ON  11
ud_2   -2.247582e-02                1 1 ON  12
ud_3   -7.401166e-02                1 1 ON  13
ud_4   -1.109246e-01                1 1 ON  14
ud_5   -1.324774e-01                1 1 ON  15
ud_6   -1.289992e-01                1 1 ON  16
ud_7   -8.903125e-02                1 1 ON  17
ud_8   -5.390718e-03                1 1 ON  18
ud_9   8.709697e-02                 1 1 ON  19
eO_0   -6.913888e-01                1 1 ON  20
eO_1   -4.145506e-01                1 1 ON  21
eO_2   -4.647492e-02                1 1 ON  22
eO_3   1.763500e-01                 1 1 ON  23
eO_4   2.544933e-01                 1 1 ON  24
eO_5   2.839617e-01                 1 1 ON  25
eO_6   2.506609e-01                 1 1 ON  26
eO_7   1.285250e-01                 1 1 ON  27
eO_8   2.879857e-02                 1 1 ON  28
eO_9   1.877260e-02                 1 1 ON  29
eH1_0  -1.993090e-01                1 1 ON  30
eH1_1  -9.617435e-02                1 1 ON  31
eH1_2  -4.647519e-02                1 1 ON  32
eH1_3  -1.587200e-02                1 1 ON  33
eH1_4  1.721623e-02                 1 1 ON  34
eH1_5  2.195396e-02                 1 1 ON  35
eH1_6  7.145411e-02                 1 1 ON  36
eH1_7  1.074935e-01                 1 1 ON  37
eH1_8  9.862617e-02                 1 1 ON  38
eH1_9  2.569972e-02                 1 1 ON  39
eH2_0  -1.993125e-01                1 1 ON  40
eH2_1  -9.552820e-02                1 1 ON  41
eH2_2  -4.607902e-02                1 1 ON  42
eH2_3  -1.564774e-02                1 1 ON  43
eH2_4  1.683051e-02                 1 1 ON  44
eH2_5  2.008143e-02                 1 1 ON  45
eH2_6  7.048762e-02                 1 1 ON  46
eH2_7  1.077172e-01                 1 1 ON  47
eH2_8  1.011232e-01                 1 1 ON  48
eH2_9  2.799609e-02                 1 1 ON  49
ci_001 -4.175074e-02                3 1 ON  50
ci_002 -3.108787e-02                3 1 ON  51
ci_003 -2.591076e-02                3 1 ON  52
ci_004 2.326789e-02                 3 1 ON  53
ci_005 2.356637e-02                 3 1 ON  54
ci_006 -2.034456e-02                3 1 ON  55
ci_007 -2.039227e-02                3 1 ON  56
ci_008 -8.630585e-03                3 1 ON  57
ci_009 -1.523816e-02                3 1 ON  58
ci_010 -1.000747e-02                3 1 ON  59
ci_011 -1.067505e-02                3 1 ON  60
ci_012 -1.050550e-02                3 1 ON  61
ci_013 -1.963891e-02                3 1 ON  62
ci_014 1.280090e-02                 3 1 ON  63
ci_015 1.243536e-02                 3 1 ON  64
ci_016 1.659064e-02                 3 1 ON  65
ci_017 1.680672e-02                 3 1 ON  66
ci_018 1.025194e-02                 3 1 ON  67
ci_019 1.021193e-02                 3 1 ON  68
ci_020 1.662300e-02                 3 1 ON  69
ci_021 1.627166e-02                 3 1 ON  70
ci_022 9.145138e-03                 3 1 ON  71
ci_023 8.996180e-03                 3 1 ON  72
ci_024 9.497941e-03                 3 1 ON  73
ci_025 9.456102e-03                 3 1 ON  74
ci_026 1.093812e-02                 3 1 ON  75
ci_027 1.084894e-02                 3 1 ON  76
ci_028 -1.497583e-02                3 1 ON  77
ci_029 -1.551694e-02                3 1 ON  78
ci_030 -8.998562e-03                3 1 ON  79
ci_031 -9.039894e-03                3 1 ON  80
ci_032 -1.506133e-02                3 1 ON  81
ci_033 6.539195e-03                 3 1 ON  82
ci_034 6.354786e-03                 3 1 ON  83
ci_035 -4.825624e-03                3 1 ON  84
ci_036 -1.206217e-02                3 1 ON  85
ci_037 -1.271144e-02                3 1 ON  86
ci_038 1.634494e-03                 3 1 ON  87
ci_039 1.704992e-03                 3 1 ON  88
ci_040 -2.849338e-03                3 1 ON  89
ci_041 8.442635e-03                 3 1 ON  90
ci_042 8.487236e-03                 3 1 ON  91
ci_043 -3.849631e-03                3 1 ON  92
ci_044 -4.448254e-03                3 1 ON  93
ci_045 -2.905027e-03                3 1 ON  94
ci_046 5.830436e-03                 3 1 ON  95
ci_047 5.914410e-03                 3 1 ON  96
ci_048 -1.334452e-02                3 1 ON  97
ci_049 -1.353191e-02                3 1 ON  98
ci_050 3.354159e-03                 3 1 ON  99
ci_051 3.313854e-03                 3 1 ON  100
ci_052 -2.578120e-03                3 1 ON  101
ci_053 -2.568102e-03                3 1 ON  102
ci_054 -2.562283e-03                3 1 ON  103
ci_055 -2.605965e-03                3 1 ON  104
ci_056 5.112407e-03                 3 1 ON  105
ci_057 5.098080e-03                 3 1 ON  106
ci_058 -1.747450e-03                3 1 ON  107
ci_059 -2.093249e-03                3 1 ON  108
ci_060 5.607016e-03                 3 1 ON  109
ci_061 5.407961e-03                 3 1 ON  110
ci_062 -4.009691e-03                3 1 ON  111
ci_063 -4.110880e-03                3 1 ON  112
ci_064 -3.344542e-03                3 1 ON  113
ci_065 -4.235237e-03                3 1 ON  114
ci_066 4.489720e-03                 3 1 ON  115
ci_067 4.372110e-03                 3 1 ON  116
ci_068 -5.044040e-03                3 1 ON  117
ci_069 -4.798721e-03                3 1 ON  118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2164
    reference variance = 0.188644
====================================================
  Execution time = 2.8653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8292e-01
  Total weights = 1.9576e+06
  Execution time = 2.5468e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000717385
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269568677297
                                         uncertainty =       0.001678767117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269568677297
                                         uncertainty =       0.001678767117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367132243
  error estimate for blocks of size 2^( 2) =       0.000380758262
  error estimate for blocks of size 2^( 3) =       0.000392791994
  error estimate for blocks of size 2^( 4) =       0.000402321805
  error estimate for blocks of size 2^( 5) =       0.000408108111
  error estimate for blocks of size 2^( 6) =       0.000411332457
  error estimate for blocks of size 2^( 7) =       0.000414522886

      target function =      -0.939573005528
              le_mean =     -17.212352115732
             les_mean =     296.548027843696
             stat err =       0.000409071315
             autocorr =       1.241517936360
   target nu stat err =       0.000409071315
   target dn stat err =       0.002612171073
      target stat err =       0.004518022217
              std dev =       0.519211704318
             le_variance =       0.269580793901

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000111295
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269495386115
                                         uncertainty =       0.001672103986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269495386115
                                         uncertainty =       0.001672103986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367082489
  error estimate for blocks of size 2^( 2) =       0.000380779561
  error estimate for blocks of size 2^( 3) =       0.000392888184
  error estimate for blocks of size 2^( 4) =       0.000402481662
  error estimate for blocks of size 2^( 5) =       0.000408301367
  error estimate for blocks of size 2^( 6) =       0.000411536844
  error estimate for blocks of size 2^( 7) =       0.000414735312

      target function =      -0.939301990848
              le_mean =     -17.212358562846
             les_mean =     296.548408706101
             stat err =       0.000409263796
             autocorr =       1.243023448718
   target nu stat err =       0.000409263796
   target dn stat err =       0.002590916287
      target stat err =       0.004479819582
              std dev =       0.519141340622
             le_variance =       0.269507731543

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000720746
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269517839849
                                         uncertainty =       0.001674614938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269517839849
                                         uncertainty =       0.001674614938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367097723
  error estimate for blocks of size 2^( 2) =       0.000380765889
  error estimate for blocks of size 2^( 3) =       0.000392843857
  error estimate for blocks of size 2^( 4) =       0.000402411292
  error estimate for blocks of size 2^( 5) =       0.000408217245
  error estimate for blocks of size 2^( 6) =       0.000411448340
  error estimate for blocks of size 2^( 7) =       0.000414642903

      target function =      -0.939665793449
              le_mean =     -17.212354795545
             les_mean =     296.548065816317
             stat err =       0.000409179945
             autocorr =       1.242411028475
   target nu stat err =       0.000409179945
   target dn stat err =       0.002592963319
      target stat err =       0.004486629900
              std dev =       0.519162885258
             le_variance =       0.269530101430

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00188792
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269560715101
                                         uncertainty =       0.001678197961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269560715101
                                         uncertainty =       0.001678197961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367126835
  error estimate for blocks of size 2^( 2) =       0.000380758357
  error estimate for blocks of size 2^( 3) =       0.000392797872
  error estimate for blocks of size 2^( 4) =       0.000402332618
  error estimate for blocks of size 2^( 5) =       0.000408121515
  error estimate for blocks of size 2^( 6) =       0.000411346745
  error estimate for blocks of size 2^( 7) =       0.000414537642

      target function =      -0.939585095991
              le_mean =     -17.212352263001
             les_mean =     296.548025852228
             stat err =       0.000409084630
             autocorr =       1.241635340451
   target nu stat err =       0.000409084630
   target dn stat err =       0.002609006599
      target stat err =       0.004512816541
              std dev =       0.519204055913
             le_variance =       0.269572851676


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939573005528        initial
     2.5000e-01     2.5000e+00             1.9491e-03        -0.939301990848
     1.0000e+00     1.0000e+01             4.9728e-04        -0.939665793449  <--
     4.0000e+00     4.0000e+01             1.2502e-04        -0.939585095991

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.1448e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
  uu_0                 2.042773e-01 1 1  ON 0
  uu_1                 4.978322e-02 1 1  ON 1
  uu_2                -3.719662e-02 1 1  ON 2
  uu_3                -8.928996e-02 1 1  ON 3
  uu_4                -1.214829e-01 1 1  ON 4
  uu_5                -1.309787e-01 1 1  ON 5
  uu_6                -1.133784e-01 1 1  ON 6
  uu_7                -5.300257e-02 1 1  ON 7
  uu_8                 6.830437e-02 1 1  ON 8
  uu_9                 1.227559e-01 1 1  ON 9
  ud_0                 3.010872e-01 1 1  ON 10
  ud_1                 7.536714e-02 1 1  ON 11
  ud_2                -2.247582e-02 1 1  ON 12
  ud_3                -7.401166e-02 1 1  ON 13
  ud_4                -1.109246e-01 1 1  ON 14
  ud_5                -1.324774e-01 1 1  ON 15
  ud_6                -1.289992e-01 1 1  ON 16
  ud_7                -8.903125e-02 1 1  ON 17
  ud_8                -5.390718e-03 1 1  ON 18
  ud_9                 8.709697e-02 1 1  ON 19
  eO_0                -6.913888e-01 1 1  ON 20
  eO_1                -4.145506e-01 1 1  ON 21
  eO_2                -4.647492e-02 1 1  ON 22
  eO_3                 1.763500e-01 1 1  ON 23
  eO_4                 2.544933e-01 1 1  ON 24
  eO_5                 2.839617e-01 1 1  ON 25
  eO_6                 2.506609e-01 1 1  ON 26
  eO_7                 1.285250e-01 1 1  ON 27
  eO_8                 2.879857e-02 1 1  ON 28
  eO_9                 1.877260e-02 1 1  ON 29
 eH1_0                -1.993090e-01 1 1  ON 30
 eH1_1                -9.617435e-02 1 1  ON 31
 eH1_2                -4.647519e-02 1 1  ON 32
 eH1_3                -1.587200e-02 1 1  ON 33
 eH1_4                 1.721623e-02 1 1  ON 34
 eH1_5                 2.195396e-02 1 1  ON 35
 eH1_6                 7.145411e-02 1 1  ON 36
 eH1_7                 1.074935e-01 1 1  ON 37
 eH1_8                 9.862617e-02 1 1  ON 38
 eH1_9                 2.569972e-02 1 1  ON 39
 eH2_0                -1.993125e-01 1 1  ON 40
 eH2_1                -9.552820e-02 1 1  ON 41
 eH2_2                -4.607902e-02 1 1  ON 42
 eH2_3                -1.564774e-02 1 1  ON 43
 eH2_4                 1.683051e-02 1 1  ON 44
 eH2_5                 2.008143e-02 1 1  ON 45
 eH2_6                 7.048762e-02 1 1  ON 46
 eH2_7                 1.077172e-01 1 1  ON 47
 eH2_8                 1.011232e-01 1 1  ON 48
 eH2_9                 2.799609e-02 1 1  ON 49
ci_001                -4.175074e-02 3 1  ON 50
ci_002                -3.108787e-02 3 1  ON 51
ci_003                -2.591076e-02 3 1  ON 52
ci_004                 2.326789e-02 3 1  ON 53
ci_005                 2.356637e-02 3 1  ON 54
ci_006                -2.034456e-02 3 1  ON 55
ci_007                -2.039227e-02 3 1  ON 56
ci_008                -8.630585e-03 3 1  ON 57
ci_009                -1.523816e-02 3 1  ON 58
ci_010                -1.000747e-02 3 1  ON 59
ci_011                -1.067505e-02 3 1  ON 60
ci_012                -1.050550e-02 3 1  ON 61
ci_013                -1.963891e-02 3 1  ON 62
ci_014                 1.280090e-02 3 1  ON 63
ci_015                 1.243536e-02 3 1  ON 64
ci_016                 1.659064e-02 3 1  ON 65
ci_017                 1.680672e-02 3 1  ON 66
ci_018                 1.025194e-02 3 1  ON 67
ci_019                 1.021193e-02 3 1  ON 68
ci_020                 1.662300e-02 3 1  ON 69
ci_021                 1.627166e-02 3 1  ON 70
ci_022                 9.145138e-03 3 1  ON 71
ci_023                 8.996180e-03 3 1  ON 72
ci_024                 9.497941e-03 3 1  ON 73
ci_025                 9.456102e-03 3 1  ON 74
ci_026                 1.093812e-02 3 1  ON 75
ci_027                 1.084894e-02 3 1  ON 76
ci_028                -1.497583e-02 3 1  ON 77
ci_029                -1.551694e-02 3 1  ON 78
ci_030                -8.998562e-03 3 1  ON 79
ci_031                -9.039894e-03 3 1  ON 80
ci_032                -1.506133e-02 3 1  ON 81
ci_033                 6.539195e-03 3 1  ON 82
ci_034                 6.354786e-03 3 1  ON 83
ci_035                -4.825624e-03 3 1  ON 84
ci_036                -1.206217e-02 3 1  ON 85
ci_037                -1.271144e-02 3 1  ON 86
ci_038                 1.634494e-03 3 1  ON 87
ci_039                 1.704992e-03 3 1  ON 88
ci_040                -2.849338e-03 3 1  ON 89
ci_041                 8.442635e-03 3 1  ON 90
ci_042                 8.487236e-03 3 1  ON 91
ci_043                -3.849631e-03 3 1  ON 92
ci_044                -4.448254e-03 3 1  ON 93
ci_045                -2.905027e-03 3 1  ON 94
ci_046                 5.830436e-03 3 1  ON 95
ci_047                 5.914410e-03 3 1  ON 96
ci_048                -1.334452e-02 3 1  ON 97
ci_049                -1.353191e-02 3 1  ON 98
ci_050                 3.354159e-03 3 1  ON 99
ci_051                 3.313854e-03 3 1  ON 100
ci_052                -2.578120e-03 3 1  ON 101
ci_053                -2.568102e-03 3 1  ON 102
ci_054                -2.562283e-03 3 1  ON 103
ci_055                -2.605965e-03 3 1  ON 104
ci_056                 5.112407e-03 3 1  ON 105
ci_057                 5.098080e-03 3 1  ON 106
ci_058                -1.747450e-03 3 1  ON 107
ci_059                -2.093249e-03 3 1  ON 108
ci_060                 5.607016e-03 3 1  ON 109
ci_061                 5.407961e-03 3 1  ON 110
ci_062                -4.009691e-03 3 1  ON 111
ci_063                -4.110880e-03 3 1  ON 112
ci_064                -3.344542e-03 3 1  ON 113
ci_065                -4.235237e-03 3 1  ON 114
ci_066                 4.489720e-03 3 1  ON 115
ci_067                 4.372110e-03 3 1  ON 116
ci_068                -5.044040e-03 3 1  ON 117
ci_069                -4.798721e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9032e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.0817
    reference variance = 0.353639
====================================================
  Execution time = 2.8472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0386e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8724e-01
  Total weights = 1.957136352e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7949e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271985954991
                                         uncertainty =       0.002194487812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271985954991
                                         uncertainty =       0.002194487812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368735656
  error estimate for blocks of size 2^( 2) =       0.000382314175
  error estimate for blocks of size 2^( 3) =       0.000395082036
  error estimate for blocks of size 2^( 4) =       0.000404194852
  error estimate for blocks of size 2^( 5) =       0.000409517378
  error estimate for blocks of size 2^( 6) =       0.000411430489
  error estimate for blocks of size 2^( 7) =       0.000413663619

      target function =      -0.932302341633
              le_mean =     -17.212359601505
             les_mean =     296.552564594848
             stat err =       0.000409701584
             autocorr =       1.234539574721
   target nu stat err =       0.000409701584
   target dn stat err =       0.003926200974
      target stat err =       0.006636568518
              std dev =       0.521479309457
             le_variance =       0.271940670192


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721235960150e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932348894593       residual = 3.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932719653008       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932757848043       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932776821216       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932784324933       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932787766642       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932791912046       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932794044007       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932796117265       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932797187075       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932797627340       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932797923653       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932799053664       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932799576603       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932800718721       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932800598358       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932800526586       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932800759064       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932800753993       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932800876676       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932800990401       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932801084140       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932801231957       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932801284416       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932801534809       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932801703439       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932801645416       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932801489201       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932801776254       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932801942099       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932802076673       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932802171307       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932802148221       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932802238860       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932802409513       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932802455218       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932802464600       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932802430593       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.932802487850       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.932802575754       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932802601469       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.932802618170       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.932802560825       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.932802496861       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.932802473215       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.932802477809       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.932802480234       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.932802490742       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.932802492794       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.932802482397       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         49 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e-01 is 1.559600e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932348894593       residual = 3.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932462301001       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932473614882       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932479069366       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932481221611       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932482199494       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932483398406       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932483996836       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932484586022       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932484895626       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932485037969       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932485116665       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932485461741       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932485559230       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932485842572       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932485763420       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932485770271       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932485788863       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932485830085       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932485846082       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932485902080       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932485920069       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932485943683       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932485964774       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932485997067       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932486068884       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932486032403       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932486007003       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932486086279       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932486124655       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932486153657       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932486164776       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932486155938       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932486182386       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932486223363       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932486229869       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932486222431       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932486214149       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.932486225410       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.932486248705       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932486251765       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.932486249221       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.932486234868       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.932486223182       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.932486222953       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.932486222980       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.932486222087       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.932486225016       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+00 is 4.259806e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932348894593       residual = 3.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932378923458       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932381888258       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932383304323       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932383863232       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932384116725       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932384428523       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932384582877       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932384735297       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932384815587       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932384854013       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932384873888       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932384964864       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932384985947       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932385055230       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932385033126       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932385035146       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932385037534       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932385047263       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932385056149       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932385069780       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932385074832       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932385079032       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932385084913       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932385089696       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932385109349       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932385100790       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932385095167       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932385115766       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932385124624       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932385131459       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932385133213       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932385130947       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932385138045       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932385148025       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932385149217       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932385146636       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932385144632       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.932385147586       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.932385153239       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932385153655       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.932385152637       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.932385149183       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.932385146731       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.932385146881       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.932385146600       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.932385146395       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         46 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+00 is 1.090441e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.535420 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7422e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.043718e-01 1 1  ON 0
  uu_1                 4.984381e-02 1 1  ON 1
  uu_2                -3.716187e-02 1 1  ON 2
  uu_3                -8.930094e-02 1 1  ON 3
  uu_4                -1.215228e-01 1 1  ON 4
  uu_5                -1.310988e-01 1 1  ON 5
  uu_6                -1.134566e-01 1 1  ON 6
  uu_7                -5.289667e-02 1 1  ON 7
  uu_8                 6.801558e-02 1 1  ON 8
  uu_9                 1.227847e-01 1 1  ON 9
  ud_0                 3.008440e-01 1 1  ON 10
  ud_1                 7.519459e-02 1 1  ON 11
  ud_2                -2.260901e-02 1 1  ON 12
  ud_3                -7.407435e-02 1 1  ON 13
  ud_4                -1.109264e-01 1 1  ON 14
  ud_5                -1.323334e-01 1 1  ON 15
  ud_6                -1.288759e-01 1 1  ON 16
  ud_7                -8.869673e-02 1 1  ON 17
  ud_8                -5.416971e-03 1 1  ON 18
  ud_9                 8.694671e-02 1 1  ON 19
  eO_0                -6.915245e-01 1 1  ON 20
  eO_1                -4.146933e-01 1 1  ON 21
  eO_2                -4.662109e-02 1 1  ON 22
  eO_3                 1.763136e-01 1 1  ON 23
  eO_4                 2.546040e-01 1 1  ON 24
  eO_5                 2.839044e-01 1 1  ON 25
  eO_6                 2.507737e-01 1 1  ON 26
  eO_7                 1.287467e-01 1 1  ON 27
  eO_8                 2.883386e-02 1 1  ON 28
  eO_9                 1.880406e-02 1 1  ON 29
 eH1_0                -1.993704e-01 1 1  ON 30
 eH1_1                -9.593730e-02 1 1  ON 31
 eH1_2                -4.628945e-02 1 1  ON 32
 eH1_3                -1.584475e-02 1 1  ON 33
 eH1_4                 1.711561e-02 1 1  ON 34
 eH1_5                 2.152798e-02 1 1  ON 35
 eH1_6                 7.141368e-02 1 1  ON 36
 eH1_7                 1.074958e-01 1 1  ON 37
 eH1_8                 9.876823e-02 1 1  ON 38
 eH1_9                 2.573258e-02 1 1  ON 39
 eH2_0                -1.993095e-01 1 1  ON 40
 eH2_1                -9.545345e-02 1 1  ON 41
 eH2_2                -4.599096e-02 1 1  ON 42
 eH2_3                -1.564795e-02 1 1  ON 43
 eH2_4                 1.663833e-02 1 1  ON 44
 eH2_5                 1.990847e-02 1 1  ON 45
 eH2_6                 7.050828e-02 1 1  ON 46
 eH2_7                 1.077293e-01 1 1  ON 47
 eH2_8                 1.012311e-01 1 1  ON 48
 eH2_9                 2.803018e-02 1 1  ON 49
ci_001                -4.164442e-02 3 1  ON 50
ci_002                -3.102547e-02 3 1  ON 51
ci_003                -2.600767e-02 3 1  ON 52
ci_004                 2.314523e-02 3 1  ON 53
ci_005                 2.354728e-02 3 1  ON 54
ci_006                -2.037691e-02 3 1  ON 55
ci_007                -2.024903e-02 3 1  ON 56
ci_008                -8.590938e-03 3 1  ON 57
ci_009                -1.519633e-02 3 1  ON 58
ci_010                -1.008546e-02 3 1  ON 59
ci_011                -1.062163e-02 3 1  ON 60
ci_012                -1.043602e-02 3 1  ON 61
ci_013                -1.957723e-02 3 1  ON 62
ci_014                 1.282729e-02 3 1  ON 63
ci_015                 1.246330e-02 3 1  ON 64
ci_016                 1.656588e-02 3 1  ON 65
ci_017                 1.676038e-02 3 1  ON 66
ci_018                 1.012822e-02 3 1  ON 67
ci_019                 1.013028e-02 3 1  ON 68
ci_020                 1.655571e-02 3 1  ON 69
ci_021                 1.631414e-02 3 1  ON 70
ci_022                 9.053397e-03 3 1  ON 71
ci_023                 8.971706e-03 3 1  ON 72
ci_024                 9.633243e-03 3 1  ON 73
ci_025                 9.508786e-03 3 1  ON 74
ci_026                 1.103660e-02 3 1  ON 75
ci_027                 1.079161e-02 3 1  ON 76
ci_028                -1.496027e-02 3 1  ON 77
ci_029                -1.551926e-02 3 1  ON 78
ci_030                -8.989838e-03 3 1  ON 79
ci_031                -8.936056e-03 3 1  ON 80
ci_032                -1.504984e-02 3 1  ON 81
ci_033                 6.476672e-03 3 1  ON 82
ci_034                 6.185315e-03 3 1  ON 83
ci_035                -4.812292e-03 3 1  ON 84
ci_036                -1.206786e-02 3 1  ON 85
ci_037                -1.251829e-02 3 1  ON 86
ci_038                 1.601213e-03 3 1  ON 87
ci_039                 1.684713e-03 3 1  ON 88
ci_040                -2.786168e-03 3 1  ON 89
ci_041                 8.457587e-03 3 1  ON 90
ci_042                 8.548278e-03 3 1  ON 91
ci_043                -3.853908e-03 3 1  ON 92
ci_044                -4.306128e-03 3 1  ON 93
ci_045                -2.887417e-03 3 1  ON 94
ci_046                 5.867874e-03 3 1  ON 95
ci_047                 5.930170e-03 3 1  ON 96
ci_048                -1.328171e-02 3 1  ON 97
ci_049                -1.360755e-02 3 1  ON 98
ci_050                 3.329293e-03 3 1  ON 99
ci_051                 3.292619e-03 3 1  ON 100
ci_052                -2.550688e-03 3 1  ON 101
ci_053                -2.536527e-03 3 1  ON 102
ci_054                -2.568033e-03 3 1  ON 103
ci_055                -2.588182e-03 3 1  ON 104
ci_056                 5.093203e-03 3 1  ON 105
ci_057                 5.103449e-03 3 1  ON 106
ci_058                -1.738983e-03 3 1  ON 107
ci_059                -2.012658e-03 3 1  ON 108
ci_060                 5.560147e-03 3 1  ON 109
ci_061                 5.403520e-03 3 1  ON 110
ci_062                -3.893200e-03 3 1  ON 111
ci_063                -4.115837e-03 3 1  ON 112
ci_064                -3.326648e-03 3 1  ON 113
ci_065                -4.227508e-03 3 1  ON 114
ci_066                 4.462553e-03 3 1  ON 115
ci_067                 4.268895e-03 3 1  ON 116
ci_068                -5.016510e-03 3 1  ON 117
ci_069                -4.834631e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.3242
    reference variance = 0.201594
====================================================
  Execution time = 3.0129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7654e-01
  Total weights = 1.9572e+06
  Execution time = 2.5864e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265496724331
                                         uncertainty =       0.001388937827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265496724331
                                         uncertainty =       0.001388937827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364370201
  error estimate for blocks of size 2^( 2) =       0.000377919803
  error estimate for blocks of size 2^( 3) =       0.000390576729
  error estimate for blocks of size 2^( 4) =       0.000399628256
  error estimate for blocks of size 2^( 5) =       0.000404462880
  error estimate for blocks of size 2^( 6) =       0.000406672803
  error estimate for blocks of size 2^( 7) =       0.000406872928

      target function =      -0.949147249039
              le_mean =     -17.211876042895
             les_mean =     296.526095999335
             stat err =       0.000404409217
             autocorr =       1.231845905181
   target nu stat err =       0.000404409217
   target dn stat err =       0.002225104260
      target stat err =       0.003940676912
              std dev =       0.515305525181
             le_variance =       0.265539784282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265549672314
                                         uncertainty =       0.001385733720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265549672314
                                         uncertainty =       0.001385733720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364406872
  error estimate for blocks of size 2^( 2) =       0.000378057937
  error estimate for blocks of size 2^( 3) =       0.000390824802
  error estimate for blocks of size 2^( 4) =       0.000399962078
  error estimate for blocks of size 2^( 5) =       0.000404837995
  error estimate for blocks of size 2^( 6) =       0.000407065058
  error estimate for blocks of size 2^( 7) =       0.000407244079

      target function =      -0.949802087835
              le_mean =     -17.211878980010
             les_mean =     296.525821236892
             stat err =       0.000404777303
             autocorr =       1.233840972750
   target nu stat err =       0.000404777303
   target dn stat err =       0.002173984168
      target stat err =       0.003858750736
              std dev =       0.515357385634
             le_variance =       0.265593234928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265512223064
                                         uncertainty =       0.001386785378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265512223064
                                         uncertainty =       0.001386785378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364381048
  error estimate for blocks of size 2^( 2) =       0.000377990864
  error estimate for blocks of size 2^( 3) =       0.000390712786
  error estimate for blocks of size 2^( 4) =       0.000399815306
  error estimate for blocks of size 2^( 5) =       0.000404674587
  error estimate for blocks of size 2^( 6) =       0.000406895141
  error estimate for blocks of size 2^( 7) =       0.000407082108

      target function =      -0.949178115354
              le_mean =     -17.211874871207
             les_mean =     296.526037220185
             stat err =       0.000404616785
             autocorr =       1.233037343288
   target nu stat err =       0.000404616785
   target dn stat err =       0.002311703046
      target stat err =       0.004089044253
              std dev =       0.515320864906
             le_variance =       0.265555593807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265495740217
                                         uncertainty =       0.001388616783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265495740217
                                         uncertainty =       0.001388616783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364369556
  error estimate for blocks of size 2^( 2) =       0.000377926953
  error estimate for blocks of size 2^( 3) =       0.000390592622
  error estimate for blocks of size 2^( 4) =       0.000399650736
  error estimate for blocks of size 2^( 5) =       0.000404488256
  error estimate for blocks of size 2^( 6) =       0.000406699961
  error estimate for blocks of size 2^( 7) =       0.000406898689

      target function =      -0.950265358509
              le_mean =     -17.211875401561
             les_mean =     296.525432470471
             stat err =       0.000404434410
             autocorr =       1.232003758044
   target nu stat err =       0.000404434410
   target dn stat err =       0.002148258326
      target stat err =       0.003818289476
              std dev =       0.515304612061
             le_variance =       0.265538843211


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949147249039        initial
     2.5000e-01     2.5000e+00             1.5596e-03        -0.949802087835
     1.0000e+00     1.0000e+01             4.2598e-04        -0.949178115354
     4.0000e+00     4.0000e+01             1.0904e-04        -0.950265358509  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.3005e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.043021e-01 1 1  ON 0
  uu_1                 4.979907e-02 1 1  ON 1
  uu_2                -3.718752e-02 1 1  ON 2
  uu_3                -8.929285e-02 1 1  ON 3
  uu_4                -1.214933e-01 1 1  ON 4
  uu_5                -1.310102e-01 1 1  ON 5
  uu_6                -1.133988e-01 1 1  ON 6
  uu_7                -5.297490e-02 1 1  ON 7
  uu_8                 6.823153e-02 1 1  ON 8
  uu_9                 1.227631e-01 1 1  ON 9
  ud_0                 3.010240e-01 1 1  ON 10
  ud_1                 7.532270e-02 1 1  ON 11
  ud_2                -2.251001e-02 1 1  ON 12
  ud_3                -7.402746e-02 1 1  ON 13
  ud_4                -1.109247e-01 1 1  ON 14
  ud_5                -1.324395e-01 1 1  ON 15
  ud_6                -1.289676e-01 1 1  ON 16
  ud_7                -8.894536e-02 1 1  ON 17
  ud_8                -5.397880e-03 1 1  ON 18
  ud_9                 8.705933e-02 1 1  ON 19
  eO_0                -6.914225e-01 1 1  ON 20
  eO_1                -4.145863e-01 1 1  ON 21
  eO_2                -4.651172e-02 1 1  ON 22
  eO_3                 1.763412e-01 1 1  ON 23
  eO_4                 2.545217e-01 1 1  ON 24
  eO_5                 2.839465e-01 1 1  ON 25
  eO_6                 2.506891e-01 1 1  ON 26
  eO_7                 1.285804e-01 1 1  ON 27
  eO_8                 2.880736e-02 1 1  ON 28
  eO_9                 1.878047e-02 1 1  ON 29
 eH1_0                -1.993261e-01 1 1  ON 30
 eH1_1                -9.611268e-02 1 1  ON 31
 eH1_2                -4.642705e-02 1 1  ON 32
 eH1_3                -1.586528e-02 1 1  ON 33
 eH1_4                 1.719052e-02 1 1  ON 34
 eH1_5                 2.184492e-02 1 1  ON 35
 eH1_6                 7.144497e-02 1 1  ON 36
 eH1_7                 1.074939e-01 1 1  ON 37
 eH1_8                 9.866167e-02 1 1  ON 38
 eH1_9                 2.570792e-02 1 1  ON 39
 eH2_0                -1.993119e-01 1 1  ON 40
 eH2_1                -9.550873e-02 1 1  ON 41
 eH2_2                -4.605601e-02 1 1  ON 42
 eH2_3                -1.564770e-02 1 1  ON 43
 eH2_4                 1.678089e-02 1 1  ON 44
 eH2_5                 2.003776e-02 1 1  ON 45
 eH2_6                 7.049324e-02 1 1  ON 46
 eH2_7                 1.077200e-01 1 1  ON 47
 eH2_8                 1.011502e-01 1 1  ON 48
 eH2_9                 2.800460e-02 1 1  ON 49
ci_001                -4.172309e-02 3 1  ON 50
ci_002                -3.107155e-02 3 1  ON 51
ci_003                -2.593648e-02 3 1  ON 52
ci_004                 2.323567e-02 3 1  ON 53
ci_005                 2.356147e-02 3 1  ON 54
ci_006                -2.035297e-02 3 1  ON 55
ci_007                -2.035485e-02 3 1  ON 56
ci_008                -8.620096e-03 3 1  ON 57
ci_009                -1.522714e-02 3 1  ON 58
ci_010                -1.002802e-02 3 1  ON 59
ci_011                -1.066102e-02 3 1  ON 60
ci_012                -1.048715e-02 3 1  ON 61
ci_013                -1.962284e-02 3 1  ON 62
ci_014                 1.280772e-02 3 1  ON 63
ci_015                 1.244265e-02 3 1  ON 64
ci_016                 1.658408e-02 3 1  ON 65
ci_017                 1.679452e-02 3 1  ON 66
ci_018                 1.021921e-02 3 1  ON 67
ci_019                 1.019045e-02 3 1  ON 68
ci_020                 1.660552e-02 3 1  ON 69
ci_021                 1.628295e-02 3 1  ON 70
ci_022                 9.121062e-03 3 1  ON 71
ci_023                 8.989746e-03 3 1  ON 72
ci_024                 9.533610e-03 3 1  ON 73
ci_025                 9.469888e-03 3 1  ON 74
ci_026                 1.096429e-02 3 1  ON 75
ci_027                 1.083383e-02 3 1  ON 76
ci_028                -1.497168e-02 3 1  ON 77
ci_029                -1.551739e-02 3 1  ON 78
ci_030                -8.996319e-03 3 1  ON 79
ci_031                -9.012308e-03 3 1  ON 80
ci_032                -1.505829e-02 3 1  ON 81
ci_033                 6.522811e-03 3 1  ON 82
ci_034                 6.310206e-03 3 1  ON 83
ci_035                -4.822098e-03 3 1  ON 84
ci_036                -1.206365e-02 3 1  ON 85
ci_037                -1.266025e-02 3 1  ON 86
ci_038                 1.625702e-03 3 1  ON 87
ci_039                 1.699647e-03 3 1  ON 88
ci_040                -2.832608e-03 3 1  ON 89
ci_041                 8.446546e-03 3 1  ON 90
ci_042                 8.503336e-03 3 1  ON 91
ci_043                -3.850753e-03 3 1  ON 92
ci_044                -4.410836e-03 3 1  ON 93
ci_045                -2.900369e-03 3 1  ON 94
ci_046                 5.840286e-03 3 1  ON 95
ci_047                 5.918560e-03 3 1  ON 96
ci_048                -1.332801e-02 3 1  ON 97
ci_049                -1.355176e-02 3 1  ON 98
ci_050                 3.347545e-03 3 1  ON 99
ci_051                 3.308234e-03 3 1  ON 100
ci_052                -2.570845e-03 3 1  ON 101
ci_053                -2.559661e-03 3 1  ON 102
ci_054                -2.563894e-03 3 1  ON 103
ci_055                -2.601240e-03 3 1  ON 104
ci_056                 5.107351e-03 3 1  ON 105
ci_057                 5.099504e-03 3 1  ON 106
ci_058                -1.745259e-03 3 1  ON 107
ci_059                -2.072043e-03 3 1  ON 108
ci_060                 5.594739e-03 3 1  ON 109
ci_061                 5.406758e-03 3 1  ON 110
ci_062                -3.978915e-03 3 1  ON 111
ci_063                -4.112147e-03 3 1  ON 112
ci_064                -3.339806e-03 3 1  ON 113
ci_065                -4.233198e-03 3 1  ON 114
ci_066                 4.482523e-03 3 1  ON 115
ci_067                 4.344835e-03 3 1  ON 116
ci_068                -5.036763e-03 3 1  ON 117
ci_069                -4.808099e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0445e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.218
    reference variance = 0.147683
====================================================
  Execution time = 2.8618e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0391e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8330e-01
  Total weights = 1.957087024e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9273e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272005284433
                                         uncertainty =       0.002191280824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272005284433
                                         uncertainty =       0.002191280824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368836698
  error estimate for blocks of size 2^( 2) =       0.000382514561
  error estimate for blocks of size 2^( 3) =       0.000394872681
  error estimate for blocks of size 2^( 4) =       0.000404642637
  error estimate for blocks of size 2^( 5) =       0.000409176194
  error estimate for blocks of size 2^( 6) =       0.000412028496
  error estimate for blocks of size 2^( 7) =       0.000414673863

      target function =      -0.938986994136
              le_mean =     -17.212612608418
             les_mean =     296.557330751532
             stat err =       0.000410130298
             autocorr =       1.236446859378
   target nu stat err =       0.000410130298
   target dn stat err =       0.002626745763
      target stat err =       0.004539565164
              std dev =       0.521622206439
             le_variance =       0.272089726250


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721261260842e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939008187653       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939105073422       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939112741422       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939116054804       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939116824814       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939117790356       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939118412455       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939118820154       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939120046921       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939120399695       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939120698930       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939120993135       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939121118765       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939121098522       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939121450316       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939121589355       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939121621978       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939121597558       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939121658811       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939121742198       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939121817289       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939122028360       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939122068797       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939122067053       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939122066414       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939122107676       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939122095332       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939122044338       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939122083006       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939122138952       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939122130343       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939122146730       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939122131079       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939122136588       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939122129140       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939122144336       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939122160552       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939122176514       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939122166103       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939122169254       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939122178804       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939122162789       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939122144679       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939122146533       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.939122145586       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+00 is 3.722927e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939008187653       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939033857468       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939035860994       residual = 6.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939036725222       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939036926507       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939037177794       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939037338895       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939037449161       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939037765070       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939037861127       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939037935979       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939038014129       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939038046501       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939038040697       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939038131335       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939038164413       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939038171290       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939038164238       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939038180720       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939038203013       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939038222844       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939038274701       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939038283604       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939038282303       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939038283086       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939038292900       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939038288048       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939038276097       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939038286344       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939038299614       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939038296973       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939038300159       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939038296531       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939038297881       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939038296184       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939038300393       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939038303769       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939038307074       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939038304180       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939038305591       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939038307401       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939038304098       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939038299009       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939038300341       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.939038299564       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+00 is 9.378975e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939008187653       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939014702488       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939015209068       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939015427486       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939015478411       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939015541879       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939015582520       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939015610657       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939015690210       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939015714765       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939015733473       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939015753323       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939015761462       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939015759981       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939015782815       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939015790937       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939015792580       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939015790748       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939015794965       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939015800627       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939015805655       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939015818533       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939015820686       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939015820311       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939015820571       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939015822985       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939015821653       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939015818729       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939015821321       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939015824591       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939015823898       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939015824640       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939015823751       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939015824089       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939015823677       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939015824749       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939015825549       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939015826334       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939015825599       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939015825987       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939015826403       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939015825623       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939015824327       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939015824674       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.939015824495       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.6000e+01 is 2.349316e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.636225 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7653e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.043397e-01 1 1  ON 0
  uu_1                 4.984192e-02 1 1  ON 1
  uu_2                -3.716559e-02 1 1  ON 2
  uu_3                -8.928119e-02 1 1  ON 3
  uu_4                -1.214978e-01 1 1  ON 4
  uu_5                -1.310245e-01 1 1  ON 5
  uu_6                -1.134283e-01 1 1  ON 6
  uu_7                -5.299942e-02 1 1  ON 7
  uu_8                 6.813774e-02 1 1  ON 8
  uu_9                 1.227732e-01 1 1  ON 9
  ud_0                 3.009777e-01 1 1  ON 10
  ud_1                 7.528308e-02 1 1  ON 11
  ud_2                -2.254560e-02 1 1  ON 12
  ud_3                -7.405280e-02 1 1  ON 13
  ud_4                -1.109300e-01 1 1  ON 14
  ud_5                -1.324041e-01 1 1  ON 15
  ud_6                -1.288931e-01 1 1  ON 16
  ud_7                -8.889338e-02 1 1  ON 17
  ud_8                -5.434954e-03 1 1  ON 18
  ud_9                 8.703927e-02 1 1  ON 19
  eO_0                -6.914154e-01 1 1  ON 20
  eO_1                -4.145851e-01 1 1  ON 21
  eO_2                -4.650402e-02 1 1  ON 22
  eO_3                 1.763359e-01 1 1  ON 23
  eO_4                 2.544766e-01 1 1  ON 24
  eO_5                 2.838867e-01 1 1  ON 25
  eO_6                 2.507081e-01 1 1  ON 26
  eO_7                 1.286464e-01 1 1  ON 27
  eO_8                 2.881025e-02 1 1  ON 28
  eO_9                 1.878336e-02 1 1  ON 29
 eH1_0                -1.994023e-01 1 1  ON 30
 eH1_1                -9.612429e-02 1 1  ON 31
 eH1_2                -4.640637e-02 1 1  ON 32
 eH1_3                -1.585710e-02 1 1  ON 33
 eH1_4                 1.719643e-02 1 1  ON 34
 eH1_5                 2.184899e-02 1 1  ON 35
 eH1_6                 7.143349e-02 1 1  ON 36
 eH1_7                 1.074882e-01 1 1  ON 37
 eH1_8                 9.870968e-02 1 1  ON 38
 eH1_9                 2.572283e-02 1 1  ON 39
 eH2_0                -1.993482e-01 1 1  ON 40
 eH2_1                -9.550946e-02 1 1  ON 41
 eH2_2                -4.601490e-02 1 1  ON 42
 eH2_3                -1.562357e-02 1 1  ON 43
 eH2_4                 1.675830e-02 1 1  ON 44
 eH2_5                 2.000654e-02 1 1  ON 45
 eH2_6                 7.048921e-02 1 1  ON 46
 eH2_7                 1.077164e-01 1 1  ON 47
 eH2_8                 1.011801e-01 1 1  ON 48
 eH2_9                 2.800366e-02 1 1  ON 49
ci_001                -4.170235e-02 3 1  ON 50
ci_002                -3.106502e-02 3 1  ON 51
ci_003                -2.592222e-02 3 1  ON 52
ci_004                 2.323219e-02 3 1  ON 53
ci_005                 2.355320e-02 3 1  ON 54
ci_006                -2.035161e-02 3 1  ON 55
ci_007                -2.035513e-02 3 1  ON 56
ci_008                -8.623389e-03 3 1  ON 57
ci_009                -1.518674e-02 3 1  ON 58
ci_010                -1.002173e-02 3 1  ON 59
ci_011                -1.064197e-02 3 1  ON 60
ci_012                -1.046442e-02 3 1  ON 61
ci_013                -1.963899e-02 3 1  ON 62
ci_014                 1.280266e-02 3 1  ON 63
ci_015                 1.243202e-02 3 1  ON 64
ci_016                 1.657838e-02 3 1  ON 65
ci_017                 1.678920e-02 3 1  ON 66
ci_018                 1.022845e-02 3 1  ON 67
ci_019                 1.021664e-02 3 1  ON 68
ci_020                 1.657941e-02 3 1  ON 69
ci_021                 1.629927e-02 3 1  ON 70
ci_022                 9.125868e-03 3 1  ON 71
ci_023                 8.982129e-03 3 1  ON 72
ci_024                 9.529419e-03 3 1  ON 73
ci_025                 9.494080e-03 3 1  ON 74
ci_026                 1.095720e-02 3 1  ON 75
ci_027                 1.083772e-02 3 1  ON 76
ci_028                -1.494895e-02 3 1  ON 77
ci_029                -1.550599e-02 3 1  ON 78
ci_030                -9.017444e-03 3 1  ON 79
ci_031                -9.035577e-03 3 1  ON 80
ci_032                -1.506040e-02 3 1  ON 81
ci_033                 6.512347e-03 3 1  ON 82
ci_034                 6.293898e-03 3 1  ON 83
ci_035                -4.803750e-03 3 1  ON 84
ci_036                -1.207865e-02 3 1  ON 85
ci_037                -1.263062e-02 3 1  ON 86
ci_038                 1.615705e-03 3 1  ON 87
ci_039                 1.677546e-03 3 1  ON 88
ci_040                -2.840396e-03 3 1  ON 89
ci_041                 8.474239e-03 3 1  ON 90
ci_042                 8.514543e-03 3 1  ON 91
ci_043                -3.842965e-03 3 1  ON 92
ci_044                -4.412167e-03 3 1  ON 93
ci_045                -2.897509e-03 3 1  ON 94
ci_046                 5.853198e-03 3 1  ON 95
ci_047                 5.910592e-03 3 1  ON 96
ci_048                -1.330884e-02 3 1  ON 97
ci_049                -1.356506e-02 3 1  ON 98
ci_050                 3.345636e-03 3 1  ON 99
ci_051                 3.291496e-03 3 1  ON 100
ci_052                -2.536123e-03 3 1  ON 101
ci_053                -2.564352e-03 3 1  ON 102
ci_054                -2.554308e-03 3 1  ON 103
ci_055                -2.590343e-03 3 1  ON 104
ci_056                 5.114901e-03 3 1  ON 105
ci_057                 5.118203e-03 3 1  ON 106
ci_058                -1.732296e-03 3 1  ON 107
ci_059                -2.053591e-03 3 1  ON 108
ci_060                 5.602644e-03 3 1  ON 109
ci_061                 5.384134e-03 3 1  ON 110
ci_062                -3.974950e-03 3 1  ON 111
ci_063                -4.105006e-03 3 1  ON 112
ci_064                -3.332050e-03 3 1  ON 113
ci_065                -4.231804e-03 3 1  ON 114
ci_066                 4.474418e-03 3 1  ON 115
ci_067                 4.339773e-03 3 1  ON 116
ci_068                -5.016268e-03 3 1  ON 117
ci_069                -4.796052e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2259
    reference variance = 0.509257
====================================================
  Execution time = 2.8084e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7929e-01
  Total weights = 1.9578e+06
  Execution time = 2.5677e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266756274292
                                         uncertainty =       0.001787531897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266756274292
                                         uncertainty =       0.001787531897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365197926
  error estimate for blocks of size 2^( 2) =       0.000378696581
  error estimate for blocks of size 2^( 3) =       0.000391161681
  error estimate for blocks of size 2^( 4) =       0.000400268855
  error estimate for blocks of size 2^( 5) =       0.000405427005
  error estimate for blocks of size 2^( 6) =       0.000407433936
  error estimate for blocks of size 2^( 7) =       0.000408810570

      target function =      -0.945723534408
              le_mean =     -17.212229042332
             les_mean =     296.540206470490
             stat err =       0.000405485091
             autocorr =       1.232801563269
   target nu stat err =       0.000405485091
   target dn stat err =       0.003144010182
      target stat err =       0.005483406987
              std dev =       0.516476123758
             le_variance =       0.266747586412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266773663534
                                         uncertainty =       0.001785845276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266773663534
                                         uncertainty =       0.001785845276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365209947
  error estimate for blocks of size 2^( 2) =       0.000378731909
  error estimate for blocks of size 2^( 3) =       0.000391223156
  error estimate for blocks of size 2^( 4) =       0.000400348051
  error estimate for blocks of size 2^( 5) =       0.000405515725
  error estimate for blocks of size 2^( 6) =       0.000407531842
  error estimate for blocks of size 2^( 7) =       0.000408909539

      target function =      -0.945685489422
              le_mean =     -17.212230269916
             les_mean =     296.540270972794
             stat err =       0.000405576289
             autocorr =       1.233274971226
   target nu stat err =       0.000405576289
   target dn stat err =       0.003122118121
      target stat err =       0.005445523947
              std dev =       0.516493124435
             le_variance =       0.266765147588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266764093314
                                         uncertainty =       0.001786581442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266764093314
                                         uncertainty =       0.001786581442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365203342
  error estimate for blocks of size 2^( 2) =       0.000378714205
  error estimate for blocks of size 2^( 3) =       0.000391192977
  error estimate for blocks of size 2^( 4) =       0.000400309378
  error estimate for blocks of size 2^( 5) =       0.000405472445
  error estimate for blocks of size 2^( 6) =       0.000407484288
  error estimate for blocks of size 2^( 7) =       0.000408861432

      target function =      -0.945956050005
              le_mean =     -17.212229497867
             les_mean =     296.540087883521
             stat err =       0.000405531886
             autocorr =       1.233049551390
   target nu stat err =       0.000405531886
   target dn stat err =       0.003120717422
      target stat err =       0.005446193046
              std dev =       0.516483782171
             le_variance =       0.266755497246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266757101406
                                         uncertainty =       0.001787406882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266757101406
                                         uncertainty =       0.001787406882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365198501
  error estimate for blocks of size 2^( 2) =       0.000378698698
  error estimate for blocks of size 2^( 3) =       0.000391165526
  error estimate for blocks of size 2^( 4) =       0.000400273864
  error estimate for blocks of size 2^( 5) =       0.000405432635
  error estimate for blocks of size 2^( 6) =       0.000407440193
  error estimate for blocks of size 2^( 7) =       0.000408816890

      target function =      -0.945771356330
              le_mean =     -17.212229078093
             les_mean =     296.540180081635
             stat err =       0.000405490895
             autocorr =       1.232832977285
   target nu stat err =       0.000405490895
   target dn stat err =       0.003139273096
      target stat err =       0.005475846044
              std dev =       0.516476935849
             le_variance =       0.266748425264


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945723534408        initial
     1.0000e+00     1.0000e+01             3.7229e-04        -0.945685489422
     4.0000e+00     4.0000e+01             9.3790e-05        -0.945956050005  <--
     1.6000e+01     1.6000e+02             2.3493e-05        -0.945771356330

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.0869e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.043397e-01 1 1  ON 0
  uu_1                 4.984192e-02 1 1  ON 1
  uu_2                -3.716559e-02 1 1  ON 2
  uu_3                -8.928119e-02 1 1  ON 3
  uu_4                -1.214978e-01 1 1  ON 4
  uu_5                -1.310245e-01 1 1  ON 5
  uu_6                -1.134283e-01 1 1  ON 6
  uu_7                -5.299942e-02 1 1  ON 7
  uu_8                 6.813774e-02 1 1  ON 8
  uu_9                 1.227732e-01 1 1  ON 9
  ud_0                 3.009777e-01 1 1  ON 10
  ud_1                 7.528308e-02 1 1  ON 11
  ud_2                -2.254560e-02 1 1  ON 12
  ud_3                -7.405280e-02 1 1  ON 13
  ud_4                -1.109300e-01 1 1  ON 14
  ud_5                -1.324041e-01 1 1  ON 15
  ud_6                -1.288931e-01 1 1  ON 16
  ud_7                -8.889338e-02 1 1  ON 17
  ud_8                -5.434954e-03 1 1  ON 18
  ud_9                 8.703927e-02 1 1  ON 19
  eO_0                -6.914154e-01 1 1  ON 20
  eO_1                -4.145851e-01 1 1  ON 21
  eO_2                -4.650402e-02 1 1  ON 22
  eO_3                 1.763359e-01 1 1  ON 23
  eO_4                 2.544766e-01 1 1  ON 24
  eO_5                 2.838867e-01 1 1  ON 25
  eO_6                 2.507081e-01 1 1  ON 26
  eO_7                 1.286464e-01 1 1  ON 27
  eO_8                 2.881025e-02 1 1  ON 28
  eO_9                 1.878336e-02 1 1  ON 29
 eH1_0                -1.994023e-01 1 1  ON 30
 eH1_1                -9.612429e-02 1 1  ON 31
 eH1_2                -4.640637e-02 1 1  ON 32
 eH1_3                -1.585710e-02 1 1  ON 33
 eH1_4                 1.719643e-02 1 1  ON 34
 eH1_5                 2.184899e-02 1 1  ON 35
 eH1_6                 7.143349e-02 1 1  ON 36
 eH1_7                 1.074882e-01 1 1  ON 37
 eH1_8                 9.870968e-02 1 1  ON 38
 eH1_9                 2.572283e-02 1 1  ON 39
 eH2_0                -1.993482e-01 1 1  ON 40
 eH2_1                -9.550946e-02 1 1  ON 41
 eH2_2                -4.601490e-02 1 1  ON 42
 eH2_3                -1.562357e-02 1 1  ON 43
 eH2_4                 1.675830e-02 1 1  ON 44
 eH2_5                 2.000654e-02 1 1  ON 45
 eH2_6                 7.048921e-02 1 1  ON 46
 eH2_7                 1.077164e-01 1 1  ON 47
 eH2_8                 1.011801e-01 1 1  ON 48
 eH2_9                 2.800366e-02 1 1  ON 49
ci_001                -4.170235e-02 3 1  ON 50
ci_002                -3.106502e-02 3 1  ON 51
ci_003                -2.592222e-02 3 1  ON 52
ci_004                 2.323219e-02 3 1  ON 53
ci_005                 2.355320e-02 3 1  ON 54
ci_006                -2.035161e-02 3 1  ON 55
ci_007                -2.035513e-02 3 1  ON 56
ci_008                -8.623389e-03 3 1  ON 57
ci_009                -1.518674e-02 3 1  ON 58
ci_010                -1.002173e-02 3 1  ON 59
ci_011                -1.064197e-02 3 1  ON 60
ci_012                -1.046442e-02 3 1  ON 61
ci_013                -1.963899e-02 3 1  ON 62
ci_014                 1.280266e-02 3 1  ON 63
ci_015                 1.243202e-02 3 1  ON 64
ci_016                 1.657838e-02 3 1  ON 65
ci_017                 1.678920e-02 3 1  ON 66
ci_018                 1.022845e-02 3 1  ON 67
ci_019                 1.021664e-02 3 1  ON 68
ci_020                 1.657941e-02 3 1  ON 69
ci_021                 1.629927e-02 3 1  ON 70
ci_022                 9.125868e-03 3 1  ON 71
ci_023                 8.982129e-03 3 1  ON 72
ci_024                 9.529419e-03 3 1  ON 73
ci_025                 9.494080e-03 3 1  ON 74
ci_026                 1.095720e-02 3 1  ON 75
ci_027                 1.083772e-02 3 1  ON 76
ci_028                -1.494895e-02 3 1  ON 77
ci_029                -1.550599e-02 3 1  ON 78
ci_030                -9.017444e-03 3 1  ON 79
ci_031                -9.035577e-03 3 1  ON 80
ci_032                -1.506040e-02 3 1  ON 81
ci_033                 6.512347e-03 3 1  ON 82
ci_034                 6.293898e-03 3 1  ON 83
ci_035                -4.803750e-03 3 1  ON 84
ci_036                -1.207865e-02 3 1  ON 85
ci_037                -1.263062e-02 3 1  ON 86
ci_038                 1.615705e-03 3 1  ON 87
ci_039                 1.677546e-03 3 1  ON 88
ci_040                -2.840396e-03 3 1  ON 89
ci_041                 8.474239e-03 3 1  ON 90
ci_042                 8.514543e-03 3 1  ON 91
ci_043                -3.842965e-03 3 1  ON 92
ci_044                -4.412167e-03 3 1  ON 93
ci_045                -2.897509e-03 3 1  ON 94
ci_046                 5.853198e-03 3 1  ON 95
ci_047                 5.910592e-03 3 1  ON 96
ci_048                -1.330884e-02 3 1  ON 97
ci_049                -1.356506e-02 3 1  ON 98
ci_050                 3.345636e-03 3 1  ON 99
ci_051                 3.291496e-03 3 1  ON 100
ci_052                -2.536123e-03 3 1  ON 101
ci_053                -2.564352e-03 3 1  ON 102
ci_054                -2.554308e-03 3 1  ON 103
ci_055                -2.590343e-03 3 1  ON 104
ci_056                 5.114901e-03 3 1  ON 105
ci_057                 5.118203e-03 3 1  ON 106
ci_058                -1.732296e-03 3 1  ON 107
ci_059                -2.053591e-03 3 1  ON 108
ci_060                 5.602644e-03 3 1  ON 109
ci_061                 5.384134e-03 3 1  ON 110
ci_062                -3.974950e-03 3 1  ON 111
ci_063                -4.105006e-03 3 1  ON 112
ci_064                -3.332050e-03 3 1  ON 113
ci_065                -4.231804e-03 3 1  ON 114
ci_066                 4.474418e-03 3 1  ON 115
ci_067                 4.339773e-03 3 1  ON 116
ci_068                -5.016268e-03 3 1  ON 117
ci_069                -4.796052e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.3503
    reference variance = 0.560326
====================================================
  Execution time = 2.8660e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0371e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8035e-01
  Total weights = 1.957548347e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9363e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268862175772
                                         uncertainty =       0.002002955440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268862175772
                                         uncertainty =       0.002002955440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366796094
  error estimate for blocks of size 2^( 2) =       0.000380791862
  error estimate for blocks of size 2^( 3) =       0.000393710990
  error estimate for blocks of size 2^( 4) =       0.000403223617
  error estimate for blocks of size 2^( 5) =       0.000409183807
  error estimate for blocks of size 2^( 6) =       0.000411729757
  error estimate for blocks of size 2^( 7) =       0.000414816603

      target function =      -0.944068964764
              le_mean =     -17.212097506579
             les_mean =     296.536648050755
             stat err =       0.000409738446
             autocorr =       1.247854727349
   target nu stat err =       0.000409738446
   target dn stat err =       0.002414546626
      target stat err =       0.004223463649
              std dev =       0.518736309734
             le_variance =       0.269087359037


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721209750658e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944086943607       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944136135691       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944144250087       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944145614481       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944146020268       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944146164818       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944146493453       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944146862037       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944147132344       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944147797593       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944148057549       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944148273149       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944148356535       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944148394602       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944148479887       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944148470886       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944148577879       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944148548461       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944148640702       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944148533547       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944148757500       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944148895363       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944148965103       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944148998716       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944148980394       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944148989441       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944149063358       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944149119816       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944149117671       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944149099848       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944149099408       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944149105299       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.944149124602       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944149126188       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944149166443       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944149132237       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944149144295       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944149130200       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944149137819       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.944149146974       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944149144730       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944149140549       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.944149132420       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.944149134637       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.944149132258       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.944149124457       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.944149125657       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.944149132291       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+00 is 3.897422e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944086943607       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944099966302       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944102087730       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944102445185       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944102549080       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944102584360       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944102670339       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944102767845       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944102839994       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944103013971       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944103081394       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944103136992       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944103157695       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944103165100       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944103188752       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944103183461       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944103212205       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944103203759       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944103227540       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944103202376       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944103258398       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944103293657       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944103307847       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944103315391       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944103310792       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944103314822       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944103332230       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944103344919       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944103343378       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944103339161       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944103339087       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944103340739       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.944103346009       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944103345929       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944103355610       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944103346775       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944103349596       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944103346651       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944103348200       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.944103350864       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944103349685       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944103348438       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.944103346821       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.944103347202       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.944103346676       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.944103345010       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.944103345657       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.944103346929       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+00 is 9.828064e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944086943607       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944090247956       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944090784429       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944090874895       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944090901018       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944090909776       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944090931528       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944090956261       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944090974604       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944091018604       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944091035625       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944091049626       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944091054789       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944091056488       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944091062567       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944091061034       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944091068350       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944091066181       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944091072163       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944091065995       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944091079993       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944091088836       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944091092168       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944091094007       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944091092868       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944091093991       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944091098252       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944091101333       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944091100890       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944091099855       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944091099840       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944091100268       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.944091101612       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944091101556       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944091103948       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944091101728       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944091102424       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944091101723       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944091102086       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.944091102776       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944091102439       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944091102118       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.944091101739       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.944091101824       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.6000e+01 is 2.442953e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.746960 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7714e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.043608e-01 1 1  ON 0
  uu_1                 4.986969e-02 1 1  ON 1
  uu_2                -3.714698e-02 1 1  ON 2
  uu_3                -8.927300e-02 1 1  ON 3
  uu_4                -1.215102e-01 1 1  ON 4
  uu_5                -1.310252e-01 1 1  ON 5
  uu_6                -1.134314e-01 1 1  ON 6
  uu_7                -5.300015e-02 1 1  ON 7
  uu_8                 6.803946e-02 1 1  ON 8
  uu_9                 1.227868e-01 1 1  ON 9
  ud_0                 3.009387e-01 1 1  ON 10
  ud_1                 7.525198e-02 1 1  ON 11
  ud_2                -2.259002e-02 1 1  ON 12
  ud_3                -7.408982e-02 1 1  ON 13
  ud_4                -1.109411e-01 1 1  ON 14
  ud_5                -1.323726e-01 1 1  ON 15
  ud_6                -1.288379e-01 1 1  ON 16
  ud_7                -8.885840e-02 1 1  ON 17
  ud_8                -5.416573e-03 1 1  ON 18
  ud_9                 8.704930e-02 1 1  ON 19
  eO_0                -6.914138e-01 1 1  ON 20
  eO_1                -4.145868e-01 1 1  ON 21
  eO_2                -4.647197e-02 1 1  ON 22
  eO_3                 1.763404e-01 1 1  ON 23
  eO_4                 2.544224e-01 1 1  ON 24
  eO_5                 2.838327e-01 1 1  ON 25
  eO_6                 2.507056e-01 1 1  ON 26
  eO_7                 1.287114e-01 1 1  ON 27
  eO_8                 2.881940e-02 1 1  ON 28
  eO_9                 1.878371e-02 1 1  ON 29
 eH1_0                -1.994225e-01 1 1  ON 30
 eH1_1                -9.610587e-02 1 1  ON 31
 eH1_2                -4.636264e-02 1 1  ON 32
 eH1_3                -1.583608e-02 1 1  ON 33
 eH1_4                 1.720836e-02 1 1  ON 34
 eH1_5                 2.179302e-02 1 1  ON 35
 eH1_6                 7.140407e-02 1 1  ON 36
 eH1_7                 1.074642e-01 1 1  ON 37
 eH1_8                 9.874202e-02 1 1  ON 38
 eH1_9                 2.572457e-02 1 1  ON 39
 eH2_0                -1.993423e-01 1 1  ON 40
 eH2_1                -9.549498e-02 1 1  ON 41
 eH2_2                -4.598117e-02 1 1  ON 42
 eH2_3                -1.559240e-02 1 1  ON 43
 eH2_4                 1.678195e-02 1 1  ON 44
 eH2_5                 1.997827e-02 1 1  ON 45
 eH2_6                 7.042011e-02 1 1  ON 46
 eH2_7                 1.076825e-01 1 1  ON 47
 eH2_8                 1.011906e-01 1 1  ON 48
 eH2_9                 2.801314e-02 1 1  ON 49
ci_001                -4.168328e-02 3 1  ON 50
ci_002                -3.106066e-02 3 1  ON 51
ci_003                -2.591884e-02 3 1  ON 52
ci_004                 2.322832e-02 3 1  ON 53
ci_005                 2.353548e-02 3 1  ON 54
ci_006                -2.034541e-02 3 1  ON 55
ci_007                -2.034294e-02 3 1  ON 56
ci_008                -8.617867e-03 3 1  ON 57
ci_009                -1.517599e-02 3 1  ON 58
ci_010                -1.002334e-02 3 1  ON 59
ci_011                -1.062090e-02 3 1  ON 60
ci_012                -1.044054e-02 3 1  ON 61
ci_013                -1.963686e-02 3 1  ON 62
ci_014                 1.278694e-02 3 1  ON 63
ci_015                 1.242187e-02 3 1  ON 64
ci_016                 1.659490e-02 3 1  ON 65
ci_017                 1.678902e-02 3 1  ON 66
ci_018                 1.021945e-02 3 1  ON 67
ci_019                 1.019951e-02 3 1  ON 68
ci_020                 1.657796e-02 3 1  ON 69
ci_021                 1.630051e-02 3 1  ON 70
ci_022                 9.122735e-03 3 1  ON 71
ci_023                 8.990351e-03 3 1  ON 72
ci_024                 9.535522e-03 3 1  ON 73
ci_025                 9.512850e-03 3 1  ON 74
ci_026                 1.096116e-02 3 1  ON 75
ci_027                 1.081902e-02 3 1  ON 76
ci_028                -1.493934e-02 3 1  ON 77
ci_029                -1.552051e-02 3 1  ON 78
ci_030                -9.017869e-03 3 1  ON 79
ci_031                -9.040569e-03 3 1  ON 80
ci_032                -1.504234e-02 3 1  ON 81
ci_033                 6.463782e-03 3 1  ON 82
ci_034                 6.297361e-03 3 1  ON 83
ci_035                -4.798890e-03 3 1  ON 84
ci_036                -1.205901e-02 3 1  ON 85
ci_037                -1.264324e-02 3 1  ON 86
ci_038                 1.611023e-03 3 1  ON 87
ci_039                 1.675213e-03 3 1  ON 88
ci_040                -2.835232e-03 3 1  ON 89
ci_041                 8.477947e-03 3 1  ON 90
ci_042                 8.511061e-03 3 1  ON 91
ci_043                -3.837383e-03 3 1  ON 92
ci_044                -4.408513e-03 3 1  ON 93
ci_045                -2.905726e-03 3 1  ON 94
ci_046                 5.845832e-03 3 1  ON 95
ci_047                 5.916436e-03 3 1  ON 96
ci_048                -1.329921e-02 3 1  ON 97
ci_049                -1.358072e-02 3 1  ON 98
ci_050                 3.331001e-03 3 1  ON 99
ci_051                 3.306988e-03 3 1  ON 100
ci_052                -2.524335e-03 3 1  ON 101
ci_053                -2.570583e-03 3 1  ON 102
ci_054                -2.553120e-03 3 1  ON 103
ci_055                -2.591901e-03 3 1  ON 104
ci_056                 5.091013e-03 3 1  ON 105
ci_057                 5.118563e-03 3 1  ON 106
ci_058                -1.707576e-03 3 1  ON 107
ci_059                -2.039101e-03 3 1  ON 108
ci_060                 5.601934e-03 3 1  ON 109
ci_061                 5.382608e-03 3 1  ON 110
ci_062                -3.952946e-03 3 1  ON 111
ci_063                -4.094571e-03 3 1  ON 112
ci_064                -3.332001e-03 3 1  ON 113
ci_065                -4.237251e-03 3 1  ON 114
ci_066                 4.467367e-03 3 1  ON 115
ci_067                 4.341127e-03 3 1  ON 116
ci_068                -5.030324e-03 3 1  ON 117
ci_069                -4.806957e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2204
    reference variance = 0.259607
====================================================
  Execution time = 2.8409e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7518e-01
  Total weights = 1.9575e+06
  Execution time = 2.5378e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265287671650
                                         uncertainty =       0.001545090391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265287671650
                                         uncertainty =       0.001545090391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364169237
  error estimate for blocks of size 2^( 2) =       0.000377825669
  error estimate for blocks of size 2^( 3) =       0.000390551062
  error estimate for blocks of size 2^( 4) =       0.000400195688
  error estimate for blocks of size 2^( 5) =       0.000405600126
  error estimate for blocks of size 2^( 6) =       0.000408884697
  error estimate for blocks of size 2^( 7) =       0.000411518310

      target function =      -0.953075936142
              le_mean =     -17.211857851115
             les_mean =     296.523222728281
             stat err =       0.000406549705
             autocorr =       1.246294814606
   target nu stat err =       0.000406549705
   target dn stat err =       0.001945676485
      target stat err =       0.003493305550
              std dev =       0.515021314250
             le_variance =       0.265246954131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265299209985
                                         uncertainty =       0.001543291395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265299209985
                                         uncertainty =       0.001543291395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364177301
  error estimate for blocks of size 2^( 2) =       0.000377849411
  error estimate for blocks of size 2^( 3) =       0.000390592938
  error estimate for blocks of size 2^( 4) =       0.000400252653
  error estimate for blocks of size 2^( 5) =       0.000405667183
  error estimate for blocks of size 2^( 6) =       0.000408960915
  error estimate for blocks of size 2^( 7) =       0.000411602065

      target function =      -0.952278598739
              le_mean =     -17.211859630487
             les_mean =     296.523738756445
             stat err =       0.000406620704
             autocorr =       1.246674937702
   target nu stat err =       0.000406620704
   target dn stat err =       0.001979291664
      target stat err =       0.003545147570
              std dev =       0.515032719184
             le_variance =       0.265258701830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265293045740
                                         uncertainty =       0.001544128589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265293045740
                                         uncertainty =       0.001544128589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364173003
  error estimate for blocks of size 2^( 2) =       0.000377837643
  error estimate for blocks of size 2^( 3) =       0.000390572629
  error estimate for blocks of size 2^( 4) =       0.000400225216
  error estimate for blocks of size 2^( 5) =       0.000405634956
  error estimate for blocks of size 2^( 6) =       0.000408924324
  error estimate for blocks of size 2^( 7) =       0.000411561998

      target function =      -0.953032796865
              le_mean =     -17.211858630888
             les_mean =     296.523274147099
             stat err =       0.000406586623
             autocorr =       1.246495396515
   target nu stat err =       0.000406586623
   target dn stat err =       0.001947504332
      target stat err =       0.003496147476
              std dev =       0.515026639545
             le_variance =       0.265252439441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265288266766
                                         uncertainty =       0.001544967027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265288266766
                                         uncertainty =       0.001544967027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364169655
  error estimate for blocks of size 2^( 2) =       0.000377827125
  error estimate for blocks of size 2^( 3) =       0.000390553730
  error estimate for blocks of size 2^( 4) =       0.000400199377
  error estimate for blocks of size 2^( 5) =       0.000405604534
  error estimate for blocks of size 2^( 6) =       0.000408889742
  error estimate for blocks of size 2^( 7) =       0.000411523885

      target function =      -0.951197843688
              le_mean =     -17.211857922930
             les_mean =     296.524296161307
             stat err =       0.000406554385
             autocorr =       1.246320642125
   target nu stat err =       0.000406554385
   target dn stat err =       0.002217082490
      target stat err =       0.003944263448
              std dev =       0.515021905731
             le_variance =       0.265247563382


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.953075936142        initial  <--
     1.0000e+00     1.0000e+01             3.8974e-04        -0.952278598739
     4.0000e+00     4.0000e+01             9.8281e-05        -0.953032796865
     1.6000e+01     1.6000e+02             2.4430e-05        -0.951197843688

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.1741
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.043397e-01 1 1  ON 0
  uu_1                 4.984192e-02 1 1  ON 1
  uu_2                -3.716559e-02 1 1  ON 2
  uu_3                -8.928119e-02 1 1  ON 3
  uu_4                -1.214978e-01 1 1  ON 4
  uu_5                -1.310245e-01 1 1  ON 5
  uu_6                -1.134283e-01 1 1  ON 6
  uu_7                -5.299942e-02 1 1  ON 7
  uu_8                 6.813774e-02 1 1  ON 8
  uu_9                 1.227732e-01 1 1  ON 9
  ud_0                 3.009777e-01 1 1  ON 10
  ud_1                 7.528308e-02 1 1  ON 11
  ud_2                -2.254560e-02 1 1  ON 12
  ud_3                -7.405280e-02 1 1  ON 13
  ud_4                -1.109300e-01 1 1  ON 14
  ud_5                -1.324041e-01 1 1  ON 15
  ud_6                -1.288931e-01 1 1  ON 16
  ud_7                -8.889338e-02 1 1  ON 17
  ud_8                -5.434954e-03 1 1  ON 18
  ud_9                 8.703927e-02 1 1  ON 19
  eO_0                -6.914154e-01 1 1  ON 20
  eO_1                -4.145851e-01 1 1  ON 21
  eO_2                -4.650402e-02 1 1  ON 22
  eO_3                 1.763359e-01 1 1  ON 23
  eO_4                 2.544766e-01 1 1  ON 24
  eO_5                 2.838867e-01 1 1  ON 25
  eO_6                 2.507081e-01 1 1  ON 26
  eO_7                 1.286464e-01 1 1  ON 27
  eO_8                 2.881025e-02 1 1  ON 28
  eO_9                 1.878336e-02 1 1  ON 29
 eH1_0                -1.994023e-01 1 1  ON 30
 eH1_1                -9.612429e-02 1 1  ON 31
 eH1_2                -4.640637e-02 1 1  ON 32
 eH1_3                -1.585710e-02 1 1  ON 33
 eH1_4                 1.719643e-02 1 1  ON 34
 eH1_5                 2.184899e-02 1 1  ON 35
 eH1_6                 7.143349e-02 1 1  ON 36
 eH1_7                 1.074882e-01 1 1  ON 37
 eH1_8                 9.870968e-02 1 1  ON 38
 eH1_9                 2.572283e-02 1 1  ON 39
 eH2_0                -1.993482e-01 1 1  ON 40
 eH2_1                -9.550946e-02 1 1  ON 41
 eH2_2                -4.601490e-02 1 1  ON 42
 eH2_3                -1.562357e-02 1 1  ON 43
 eH2_4                 1.675830e-02 1 1  ON 44
 eH2_5                 2.000654e-02 1 1  ON 45
 eH2_6                 7.048921e-02 1 1  ON 46
 eH2_7                 1.077164e-01 1 1  ON 47
 eH2_8                 1.011801e-01 1 1  ON 48
 eH2_9                 2.800366e-02 1 1  ON 49
ci_001                -4.170235e-02 3 1  ON 50
ci_002                -3.106502e-02 3 1  ON 51
ci_003                -2.592222e-02 3 1  ON 52
ci_004                 2.323219e-02 3 1  ON 53
ci_005                 2.355320e-02 3 1  ON 54
ci_006                -2.035161e-02 3 1  ON 55
ci_007                -2.035513e-02 3 1  ON 56
ci_008                -8.623389e-03 3 1  ON 57
ci_009                -1.518674e-02 3 1  ON 58
ci_010                -1.002173e-02 3 1  ON 59
ci_011                -1.064197e-02 3 1  ON 60
ci_012                -1.046442e-02 3 1  ON 61
ci_013                -1.963899e-02 3 1  ON 62
ci_014                 1.280266e-02 3 1  ON 63
ci_015                 1.243202e-02 3 1  ON 64
ci_016                 1.657838e-02 3 1  ON 65
ci_017                 1.678920e-02 3 1  ON 66
ci_018                 1.022845e-02 3 1  ON 67
ci_019                 1.021664e-02 3 1  ON 68
ci_020                 1.657941e-02 3 1  ON 69
ci_021                 1.629927e-02 3 1  ON 70
ci_022                 9.125868e-03 3 1  ON 71
ci_023                 8.982129e-03 3 1  ON 72
ci_024                 9.529419e-03 3 1  ON 73
ci_025                 9.494080e-03 3 1  ON 74
ci_026                 1.095720e-02 3 1  ON 75
ci_027                 1.083772e-02 3 1  ON 76
ci_028                -1.494895e-02 3 1  ON 77
ci_029                -1.550599e-02 3 1  ON 78
ci_030                -9.017444e-03 3 1  ON 79
ci_031                -9.035577e-03 3 1  ON 80
ci_032                -1.506040e-02 3 1  ON 81
ci_033                 6.512347e-03 3 1  ON 82
ci_034                 6.293898e-03 3 1  ON 83
ci_035                -4.803750e-03 3 1  ON 84
ci_036                -1.207865e-02 3 1  ON 85
ci_037                -1.263062e-02 3 1  ON 86
ci_038                 1.615705e-03 3 1  ON 87
ci_039                 1.677546e-03 3 1  ON 88
ci_040                -2.840396e-03 3 1  ON 89
ci_041                 8.474239e-03 3 1  ON 90
ci_042                 8.514543e-03 3 1  ON 91
ci_043                -3.842965e-03 3 1  ON 92
ci_044                -4.412167e-03 3 1  ON 93
ci_045                -2.897509e-03 3 1  ON 94
ci_046                 5.853198e-03 3 1  ON 95
ci_047                 5.910592e-03 3 1  ON 96
ci_048                -1.330884e-02 3 1  ON 97
ci_049                -1.356506e-02 3 1  ON 98
ci_050                 3.345636e-03 3 1  ON 99
ci_051                 3.291496e-03 3 1  ON 100
ci_052                -2.536123e-03 3 1  ON 101
ci_053                -2.564352e-03 3 1  ON 102
ci_054                -2.554308e-03 3 1  ON 103
ci_055                -2.590343e-03 3 1  ON 104
ci_056                 5.114901e-03 3 1  ON 105
ci_057                 5.118203e-03 3 1  ON 106
ci_058                -1.732296e-03 3 1  ON 107
ci_059                -2.053591e-03 3 1  ON 108
ci_060                 5.602644e-03 3 1  ON 109
ci_061                 5.384134e-03 3 1  ON 110
ci_062                -3.974950e-03 3 1  ON 111
ci_063                -4.105006e-03 3 1  ON 112
ci_064                -3.332050e-03 3 1  ON 113
ci_065                -4.231804e-03 3 1  ON 114
ci_066                 4.474418e-03 3 1  ON 115
ci_067                 4.339773e-03 3 1  ON 116
ci_068                -5.016268e-03 3 1  ON 117
ci_069                -4.796052e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8895e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1911
    reference variance = 0.190609
====================================================
  Execution time = 2.8340e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0382e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8058e-01
  Total weights = 1.957473345e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8522e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269282070786
                                         uncertainty =       0.001867115520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269282070786
                                         uncertainty =       0.001867115520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366908122
  error estimate for blocks of size 2^( 2) =       0.000380775922
  error estimate for blocks of size 2^( 3) =       0.000393307003
  error estimate for blocks of size 2^( 4) =       0.000402357384
  error estimate for blocks of size 2^( 5) =       0.000407505987
  error estimate for blocks of size 2^( 6) =       0.000410715335
  error estimate for blocks of size 2^( 7) =       0.000411742649

      target function =      -0.943666036766
              le_mean =     -17.212054993724
             les_mean =     296.535420922401
             stat err =       0.000408080339
             autocorr =       1.237019913586
   target nu stat err =       0.000408080339
   target dn stat err =       0.002301996488
      target stat err =       0.004028620157
              std dev =       0.518894744290
             le_variance =       0.269251755652


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721205499372e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943682001412       residual = 6.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943684909971       residual = 9.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943685467360       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943685728695       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943685789083       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943685835737       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943685912459       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943685959185       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943686012803       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943686017554       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943686044027       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943686045479       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943686057703       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943686075898       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943686115558       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943686119745       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943686126046       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943686126949       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943686139670       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943686149752       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943686153861       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943686158221       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943686154249       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943686151430       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943686150226       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.943686148733       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.943686154374       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.943686155315       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.943686149700       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.943686154025       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943686154510       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.943686153490       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943686156506       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.943686160815       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943686163924       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.943686165590       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943686165139       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.943686163995       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.943686165270       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943686162205       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.943686163184       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.943686163195       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.943686164135       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.943686164102       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.943686164205       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.943686164668       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.943686164520       residual = 9.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         46 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+01 is 3.863735e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943682001412       residual = 6.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943682732946       residual = 9.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943682872958       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943682938544       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943682953698       residual = 9.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943682965470       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943682984752       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943682996493       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943683009891       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943683011065       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943683017698       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943683018058       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943683021124       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943683025680       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943683035593       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943683036631       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943683038216       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943683038443       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943683041629       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943683044149       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943683045167       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943683046242       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943683045237       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943683044520       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943683044228       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.943683043876       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.943683045284       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.943683045505       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.943683044094       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.943683045189       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943683045300       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.943683045063       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943683045810       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.943683046887       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943683047650       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.943683048068       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943683047940       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.943683047665       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.943683047976       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943683047215       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.943683047464       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.943683047464       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.943683047698       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.943683047689       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.943683047715       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.943683047830       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.943683047789       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         46 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+01 is 9.678184e-06

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943682001412       residual = 6.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943682184572       residual = 9.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943682219617       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943682236029       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943682239821       residual = 9.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943682242771       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943682247598       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943682250537       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943682253886       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943682254179       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943682255838       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943682255928       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943682256694       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943682257834       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943682260312       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943682260571       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943682260968       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943682261025       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943682261822       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943682262452       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943682262706       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943682262974       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943682262722       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943682262542       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943682262469       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.943682262383       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.943682262734       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.943682262789       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.943682262435       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.943682262710       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943682262737       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.943682262679       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943682262864       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.943682263136       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943682263324       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.943682263430       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943682263395       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.943682263328       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.943682263406       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943682263216       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.943682263278       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.943682263278       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.943682263337       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.943682263334       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.943682263341       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.943682263369       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.943682263359       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         46 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.6000e+02 is 2.420727e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.857632 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7310e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.043412e-01 1 1  ON 0
  uu_1                 4.984189e-02 1 1  ON 1
  uu_2                -3.716518e-02 1 1  ON 2
  uu_3                -8.928082e-02 1 1  ON 3
  uu_4                -1.214973e-01 1 1  ON 4
  uu_5                -1.310240e-01 1 1  ON 5
  uu_6                -1.134276e-01 1 1  ON 6
  uu_7                -5.300252e-02 1 1  ON 7
  uu_8                 6.813196e-02 1 1  ON 8
  uu_9                 1.227738e-01 1 1  ON 9
  ud_0                 3.009736e-01 1 1  ON 10
  ud_1                 7.528003e-02 1 1  ON 11
  ud_2                -2.254844e-02 1 1  ON 12
  ud_3                -7.405470e-02 1 1  ON 13
  ud_4                -1.109305e-01 1 1  ON 14
  ud_5                -1.324031e-01 1 1  ON 15
  ud_6                -1.288871e-01 1 1  ON 16
  ud_7                -8.888758e-02 1 1  ON 17
  ud_8                -5.435216e-03 1 1  ON 18
  ud_9                 8.703666e-02 1 1  ON 19
  eO_0                -6.914089e-01 1 1  ON 20
  eO_1                -4.145808e-01 1 1  ON 21
  eO_2                -4.650315e-02 1 1  ON 22
  eO_3                 1.763310e-01 1 1  ON 23
  eO_4                 2.544669e-01 1 1  ON 24
  eO_5                 2.838811e-01 1 1  ON 25
  eO_6                 2.507078e-01 1 1  ON 26
  eO_7                 1.286540e-01 1 1  ON 27
  eO_8                 2.881127e-02 1 1  ON 28
  eO_9                 1.878358e-02 1 1  ON 29
 eH1_0                -1.994092e-01 1 1  ON 30
 eH1_1                -9.612308e-02 1 1  ON 31
 eH1_2                -4.640434e-02 1 1  ON 32
 eH1_3                -1.585471e-02 1 1  ON 33
 eH1_4                 1.719933e-02 1 1  ON 34
 eH1_5                 2.184657e-02 1 1  ON 35
 eH1_6                 7.143109e-02 1 1  ON 36
 eH1_7                 1.074866e-01 1 1  ON 37
 eH1_8                 9.871380e-02 1 1  ON 38
 eH1_9                 2.572339e-02 1 1  ON 39
 eH2_0                -1.993541e-01 1 1  ON 40
 eH2_1                -9.551317e-02 1 1  ON 41
 eH2_2                -4.601587e-02 1 1  ON 42
 eH2_3                -1.562324e-02 1 1  ON 43
 eH2_4                 1.675763e-02 1 1  ON 44
 eH2_5                 2.000974e-02 1 1  ON 45
 eH2_6                 7.049198e-02 1 1  ON 46
 eH2_7                 1.077173e-01 1 1  ON 47
 eH2_8                 1.011834e-01 1 1  ON 48
 eH2_9                 2.800421e-02 1 1  ON 49
ci_001                -4.170025e-02 3 1  ON 50
ci_002                -3.106569e-02 3 1  ON 51
ci_003                -2.592065e-02 3 1  ON 52
ci_004                 2.323249e-02 3 1  ON 53
ci_005                 2.355227e-02 3 1  ON 54
ci_006                -2.035185e-02 3 1  ON 55
ci_007                -2.035482e-02 3 1  ON 56
ci_008                -8.622647e-03 3 1  ON 57
ci_009                -1.518432e-02 3 1  ON 58
ci_010                -1.002180e-02 3 1  ON 59
ci_011                -1.064084e-02 3 1  ON 60
ci_012                -1.046411e-02 3 1  ON 61
ci_013                -1.964145e-02 3 1  ON 62
ci_014                 1.280238e-02 3 1  ON 63
ci_015                 1.243205e-02 3 1  ON 64
ci_016                 1.657858e-02 3 1  ON 65
ci_017                 1.678926e-02 3 1  ON 66
ci_018                 1.022813e-02 3 1  ON 67
ci_019                 1.021720e-02 3 1  ON 68
ci_020                 1.657693e-02 3 1  ON 69
ci_021                 1.629984e-02 3 1  ON 70
ci_022                 9.124533e-03 3 1  ON 71
ci_023                 8.982451e-03 3 1  ON 72
ci_024                 9.527799e-03 3 1  ON 73
ci_025                 9.494291e-03 3 1  ON 74
ci_026                 1.095539e-02 3 1  ON 75
ci_027                 1.083755e-02 3 1  ON 76
ci_028                -1.494866e-02 3 1  ON 77
ci_029                -1.550624e-02 3 1  ON 78
ci_030                -9.015904e-03 3 1  ON 79
ci_031                -9.035101e-03 3 1  ON 80
ci_032                -1.506024e-02 3 1  ON 81
ci_033                 6.511025e-03 3 1  ON 82
ci_034                 6.293193e-03 3 1  ON 83
ci_035                -4.803153e-03 3 1  ON 84
ci_036                -1.208086e-02 3 1  ON 85
ci_037                -1.262946e-02 3 1  ON 86
ci_038                 1.614907e-03 3 1  ON 87
ci_039                 1.677476e-03 3 1  ON 88
ci_040                -2.839296e-03 3 1  ON 89
ci_041                 8.474544e-03 3 1  ON 90
ci_042                 8.515587e-03 3 1  ON 91
ci_043                -3.842371e-03 3 1  ON 92
ci_044                -4.413473e-03 3 1  ON 93
ci_045                -2.897296e-03 3 1  ON 94
ci_046                 5.853203e-03 3 1  ON 95
ci_047                 5.910305e-03 3 1  ON 96
ci_048                -1.330817e-02 3 1  ON 97
ci_049                -1.356472e-02 3 1  ON 98
ci_050                 3.345657e-03 3 1  ON 99
ci_051                 3.292103e-03 3 1  ON 100
ci_052                -2.535100e-03 3 1  ON 101
ci_053                -2.563854e-03 3 1  ON 102
ci_054                -2.554026e-03 3 1  ON 103
ci_055                -2.591273e-03 3 1  ON 104
ci_056                 5.114729e-03 3 1  ON 105
ci_057                 5.117795e-03 3 1  ON 106
ci_058                -1.731771e-03 3 1  ON 107
ci_059                -2.053015e-03 3 1  ON 108
ci_060                 5.602083e-03 3 1  ON 109
ci_061                 5.384831e-03 3 1  ON 110
ci_062                -3.974860e-03 3 1  ON 111
ci_063                -4.104447e-03 3 1  ON 112
ci_064                -3.331941e-03 3 1  ON 113
ci_065                -4.232397e-03 3 1  ON 114
ci_066                 4.473760e-03 3 1  ON 115
ci_067                 4.340867e-03 3 1  ON 116
ci_068                -5.016757e-03 3 1  ON 117
ci_069                -4.796848e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1741
    reference variance = 0.259536
====================================================
  Execution time = 2.8354e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7760e-01
  Total weights = 1.9573e+06
  Execution time = 2.5495e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266519257896
                                         uncertainty =       0.001426241092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266519257896
                                         uncertainty =       0.001426241092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365016572
  error estimate for blocks of size 2^( 2) =       0.000378508844
  error estimate for blocks of size 2^( 3) =       0.000391416874
  error estimate for blocks of size 2^( 4) =       0.000400748878
  error estimate for blocks of size 2^( 5) =       0.000405458052
  error estimate for blocks of size 2^( 6) =       0.000407387047
  error estimate for blocks of size 2^( 7) =       0.000409002852

      target function =      -0.948780657259
              le_mean =     -17.212549497644
             les_mean =     296.549478222654
             stat err =       0.000405649207
             autocorr =       1.235025995460
   target nu stat err =       0.000405649207
   target dn stat err =       0.002126506912
      target stat err =       0.003774867425
              std dev =       0.516219645793
             le_variance =       0.266482722703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266517109547
                                         uncertainty =       0.001426002068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266517109547
                                         uncertainty =       0.001426002068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365015091
  error estimate for blocks of size 2^( 2) =       0.000378509276
  error estimate for blocks of size 2^( 3) =       0.000391419402
  error estimate for blocks of size 2^( 4) =       0.000400753008
  error estimate for blocks of size 2^( 5) =       0.000405462850
  error estimate for blocks of size 2^( 6) =       0.000407392501
  error estimate for blocks of size 2^( 7) =       0.000409009125

      target function =      -0.948877892395
              le_mean =     -17.212549444306
             les_mean =     296.549420536273
             stat err =       0.000405654371
             autocorr =       1.235067459815
   target nu stat err =       0.000405654371
   target dn stat err =       0.002124449739
      target stat err =       0.003772116965
              std dev =       0.516217551260
             le_variance =       0.266480560229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266518173689
                                         uncertainty =       0.001426120863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266518173689
                                         uncertainty =       0.001426120863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365015824
  error estimate for blocks of size 2^( 2) =       0.000378509058
  error estimate for blocks of size 2^( 3) =       0.000391418141
  error estimate for blocks of size 2^( 4) =       0.000400750949
  error estimate for blocks of size 2^( 5) =       0.000405460459
  error estimate for blocks of size 2^( 6) =       0.000407389783
  error estimate for blocks of size 2^( 7) =       0.000409006001

      target function =      -0.948842438007
              le_mean =     -17.212549469908
             les_mean =     296.549441780836
             stat err =       0.000405651798
             autocorr =       1.235046829368
   target nu stat err =       0.000405651798
   target dn stat err =       0.002125164478
      target stat err =       0.003773059457
              std dev =       0.516218588771
             le_variance =       0.266481631393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266519121620
                                         uncertainty =       0.001426226033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266519121620
                                         uncertainty =       0.001426226033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365016478
  error estimate for blocks of size 2^( 2) =       0.000378508870
  error estimate for blocks of size 2^( 3) =       0.000391417032
  error estimate for blocks of size 2^( 4) =       0.000400749137
  error estimate for blocks of size 2^( 5) =       0.000405458352
  error estimate for blocks of size 2^( 6) =       0.000407387389
  error estimate for blocks of size 2^( 7) =       0.000409003246

      target function =      -0.948790694681
              le_mean =     -17.212549494063
             les_mean =     296.549472333648
             stat err =       0.000405649531
             autocorr =       1.235028603193
   target nu stat err =       0.000405649531
   target dn stat err =       0.002126271044
      target stat err =       0.003774543383
              std dev =       0.516219512938
             le_variance =       0.266482585538


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948780657259        initial
     1.0000e+01     1.0000e+02             3.8637e-05        -0.948877892395  <--
     4.0000e+01     4.0000e+02             9.6782e-06        -0.948842438007
     1.6000e+02     1.6000e+03             2.4207e-06        -0.948790694681

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.1135e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.043455e-01 1 1  ON 0
  uu_1                 4.984181e-02 1 1  ON 1
  uu_2                -3.716397e-02 1 1  ON 2
  uu_3                -8.927974e-02 1 1  ON 3
  uu_4                -1.214956e-01 1 1  ON 4
  uu_5                -1.310225e-01 1 1  ON 5
  uu_6                -1.134254e-01 1 1  ON 6
  uu_7                -5.301180e-02 1 1  ON 7
  uu_8                 6.811462e-02 1 1  ON 8
  uu_9                 1.227757e-01 1 1  ON 9
  ud_0                 3.009613e-01 1 1  ON 10
  ud_1                 7.527089e-02 1 1  ON 11
  ud_2                -2.255693e-02 1 1  ON 12
  ud_3                -7.406039e-02 1 1  ON 13
  ud_4                -1.109320e-01 1 1  ON 14
  ud_5                -1.324004e-01 1 1  ON 15
  ud_6                -1.288690e-01 1 1  ON 16
  ud_7                -8.887022e-02 1 1  ON 17
  ud_8                -5.435982e-03 1 1  ON 18
  ud_9                 8.702883e-02 1 1  ON 19
  eO_0                -6.913898e-01 1 1  ON 20
  eO_1                -4.145680e-01 1 1  ON 21
  eO_2                -4.650055e-02 1 1  ON 22
  eO_3                 1.763165e-01 1 1  ON 23
  eO_4                 2.544380e-01 1 1  ON 24
  eO_5                 2.838644e-01 1 1  ON 25
  eO_6                 2.507066e-01 1 1  ON 26
  eO_7                 1.286768e-01 1 1  ON 27
  eO_8                 2.881433e-02 1 1  ON 28
  eO_9                 1.878427e-02 1 1  ON 29
 eH1_0                -1.994297e-01 1 1  ON 30
 eH1_1                -9.611947e-02 1 1  ON 31
 eH1_2                -4.639830e-02 1 1  ON 32
 eH1_3                -1.584759e-02 1 1  ON 33
 eH1_4                 1.720796e-02 1 1  ON 34
 eH1_5                 2.183935e-02 1 1  ON 35
 eH1_6                 7.142390e-02 1 1  ON 36
 eH1_7                 1.074817e-01 1 1  ON 37
 eH1_8                 9.872618e-02 1 1  ON 38
 eH1_9                 2.572510e-02 1 1  ON 39
 eH2_0                -1.993718e-01 1 1  ON 40
 eH2_1                -9.552425e-02 1 1  ON 41
 eH2_2                -4.601879e-02 1 1  ON 42
 eH2_3                -1.562228e-02 1 1  ON 43
 eH2_4                 1.675564e-02 1 1  ON 44
 eH2_5                 2.001933e-02 1 1  ON 45
 eH2_6                 7.050031e-02 1 1  ON 46
 eH2_7                 1.077201e-01 1 1  ON 47
 eH2_8                 1.011933e-01 1 1  ON 48
 eH2_9                 2.800587e-02 1 1  ON 49
ci_001                -4.169399e-02 3 1  ON 50
ci_002                -3.106767e-02 3 1  ON 51
ci_003                -2.591596e-02 3 1  ON 52
ci_004                 2.323336e-02 3 1  ON 53
ci_005                 2.354949e-02 3 1  ON 54
ci_006                -2.035256e-02 3 1  ON 55
ci_007                -2.035387e-02 3 1  ON 56
ci_008                -8.620439e-03 3 1  ON 57
ci_009                -1.517713e-02 3 1  ON 58
ci_010                -1.002200e-02 3 1  ON 59
ci_011                -1.063748e-02 3 1  ON 60
ci_012                -1.046320e-02 3 1  ON 61
ci_013                -1.964880e-02 3 1  ON 62
ci_014                 1.280155e-02 3 1  ON 63
ci_015                 1.243211e-02 3 1  ON 64
ci_016                 1.657919e-02 3 1  ON 65
ci_017                 1.678947e-02 3 1  ON 66
ci_018                 1.022715e-02 3 1  ON 67
ci_019                 1.021886e-02 3 1  ON 68
ci_020                 1.656955e-02 3 1  ON 69
ci_021                 1.630151e-02 3 1  ON 70
ci_022                 9.120555e-03 3 1  ON 71
ci_023                 8.983412e-03 3 1  ON 72
ci_024                 9.522972e-03 3 1  ON 73
ci_025                 9.494918e-03 3 1  ON 74
ci_026                 1.095000e-02 3 1  ON 75
ci_027                 1.083703e-02 3 1  ON 76
ci_028                -1.494782e-02 3 1  ON 77
ci_029                -1.550699e-02 3 1  ON 78
ci_030                -9.011323e-03 3 1  ON 79
ci_031                -9.033682e-03 3 1  ON 80
ci_032                -1.505974e-02 3 1  ON 81
ci_033                 6.507089e-03 3 1  ON 82
ci_034                 6.291092e-03 3 1  ON 83
ci_035                -4.801378e-03 3 1  ON 84
ci_036                -1.208746e-02 3 1  ON 85
ci_037                -1.262602e-02 3 1  ON 86
ci_038                 1.612535e-03 3 1  ON 87
ci_039                 1.677266e-03 3 1  ON 88
ci_040                -2.836022e-03 3 1  ON 89
ci_041                 8.475449e-03 3 1  ON 90
ci_042                 8.518696e-03 3 1  ON 91
ci_043                -3.840604e-03 3 1  ON 92
ci_044                -4.417364e-03 3 1  ON 93
ci_045                -2.896665e-03 3 1  ON 94
ci_046                 5.853216e-03 3 1  ON 95
ci_047                 5.909453e-03 3 1  ON 96
ci_048                -1.330616e-02 3 1  ON 97
ci_049                -1.356368e-02 3 1  ON 98
ci_050                 3.345720e-03 3 1  ON 99
ci_051                 3.293911e-03 3 1  ON 100
ci_052                -2.532054e-03 3 1  ON 101
ci_053                -2.562374e-03 3 1  ON 102
ci_054                -2.553187e-03 3 1  ON 103
ci_055                -2.594041e-03 3 1  ON 104
ci_056                 5.114216e-03 3 1  ON 105
ci_057                 5.116581e-03 3 1  ON 106
ci_058                -1.730210e-03 3 1  ON 107
ci_059                -2.051303e-03 3 1  ON 108
ci_060                 5.600411e-03 3 1  ON 109
ci_061                 5.386906e-03 3 1  ON 110
ci_062                -3.974591e-03 3 1  ON 111
ci_063                -4.102780e-03 3 1  ON 112
ci_064                -3.331617e-03 3 1  ON 113
ci_065                -4.234162e-03 3 1  ON 114
ci_066                 4.471799e-03 3 1  ON 115
ci_067                 4.344125e-03 3 1  ON 116
ci_068                -5.018213e-03 3 1  ON 117
ci_069                -4.799219e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8452e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2926
    reference variance = 0.222792
====================================================
  Execution time = 2.8426e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0387e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7598e-01
  Total weights = 1.957589783e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8874e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265230481221
                                         uncertainty =       0.001383559255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265230481221
                                         uncertainty =       0.001383559255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364136013
  error estimate for blocks of size 2^( 2) =       0.000378140359
  error estimate for blocks of size 2^( 3) =       0.000391638809
  error estimate for blocks of size 2^( 4) =       0.000401094405
  error estimate for blocks of size 2^( 5) =       0.000406336079
  error estimate for blocks of size 2^( 6) =       0.000409127630
  error estimate for blocks of size 2^( 7) =       0.000411092809

      target function =      -0.951644859623
              le_mean =     -17.212426594735
             les_mean =     296.543610859442
             stat err =       0.000406912731
             autocorr =       1.248749390658
   target nu stat err =       0.000406912731
   target dn stat err =       0.001785014719
      target stat err =       0.003212923871
              std dev =       0.514974327657
             le_variance =       0.265198558146


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721242659473e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951654623372       residual = 7.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951667196415       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951668996782       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951669808183       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951670335522       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951670466358       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951670738573       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951670739073       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951670891723       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951670914262       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951670970788       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951671047974       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951671045935       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951671054735       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951671049048       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951671153047       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951671174452       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951671234296       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951671240153       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951671260234       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951671269085       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951671275589       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951671241477       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951671243092       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.951671255993       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951671275393       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.951671270084       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951671291483       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.951671324098       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.951671328222       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951671325266       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.951671336189       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951671337484       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.951671344327       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.951671355439       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.951671362900       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.951671357517       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951671355235       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.951671357498       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.951671358196       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.951671353730       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.951671352550       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.951671355638       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.951671355867       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.951671360633       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.951671359395       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.951671359040       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         46 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+00 is 1.798647e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951654623372       residual = 7.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951657842996       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951658302116       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951658508049       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951658642512       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951658675522       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951658745236       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951658745306       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951658783853       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951658789953       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951658803882       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951658823784       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951658822785       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951658825023       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951658823564       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951658850149       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951658855409       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951658870369       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951658871772       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951658876653       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951658878919       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951658880421       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951658871811       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951658872400       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.951658875618       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951658880354       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.951658878968       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951658884651       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.951658892596       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.951658893325       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951658892787       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.951658894914       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951658896276       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.951658896509       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.951658899715       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.951658901766       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.951658900549       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951658899928       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.951658900546       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.951658900600       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.951658899524       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.951658899250       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.951658899993       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.951658900081       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.951658901245       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.951658900893       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.951658900870       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         46 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+01 is 4.509683e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951654623372       residual = 7.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951655433197       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951655548555       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951655600234       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951655634018       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951655642289       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951655659825       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951655659839       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951655669499       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951655671055       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951655674524       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951655679538       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951655679256       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951655679818       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951655679452       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951655686135       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951655687444       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951655691183       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951655691530       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951655692742       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951655693312       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951655693679       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951655691521       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951655691680       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.951655692484       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951655693661       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.951655693311       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951655694754       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.951655696725       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.951655696889       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951655696767       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.951655697252       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951655697636       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.951655697680       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.951655698469       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.951655698991       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.951655698684       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951655698532       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.951655698687       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.951655698694       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.951655698428       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.951655698360       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.951655698544       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.951655698568       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.951655698857       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.951655698767       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.951655698765       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         46 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+01 is 1.128242e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.968384 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7431e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.043605e-01 1 1  ON 0
  uu_1                 4.985163e-02 1 1  ON 1
  uu_2                -3.715829e-02 1 1  ON 2
  uu_3                -8.927515e-02 1 1  ON 3
  uu_4                -1.214902e-01 1 1  ON 4
  uu_5                -1.310224e-01 1 1  ON 5
  uu_6                -1.134222e-01 1 1  ON 6
  uu_7                -5.302089e-02 1 1  ON 7
  uu_8                 6.806952e-02 1 1  ON 8
  uu_9                 1.227769e-01 1 1  ON 9
  ud_0                 3.009390e-01 1 1  ON 10
  ud_1                 7.525540e-02 1 1  ON 11
  ud_2                -2.256712e-02 1 1  ON 12
  ud_3                -7.406427e-02 1 1  ON 13
  ud_4                -1.109264e-01 1 1  ON 14
  ud_5                -1.323843e-01 1 1  ON 15
  ud_6                -1.288552e-01 1 1  ON 16
  ud_7                -8.884432e-02 1 1  ON 17
  ud_8                -5.439885e-03 1 1  ON 18
  ud_9                 8.701444e-02 1 1  ON 19
  eO_0                -6.913874e-01 1 1  ON 20
  eO_1                -4.145624e-01 1 1  ON 21
  eO_2                -4.649796e-02 1 1  ON 22
  eO_3                 1.762947e-01 1 1  ON 23
  eO_4                 2.544194e-01 1 1  ON 24
  eO_5                 2.838668e-01 1 1  ON 25
  eO_6                 2.507067e-01 1 1  ON 26
  eO_7                 1.287037e-01 1 1  ON 27
  eO_8                 2.881364e-02 1 1  ON 28
  eO_9                 1.878540e-02 1 1  ON 29
 eH1_0                -1.994302e-01 1 1  ON 30
 eH1_1                -9.611023e-02 1 1  ON 31
 eH1_2                -4.638423e-02 1 1  ON 32
 eH1_3                -1.584327e-02 1 1  ON 33
 eH1_4                 1.720180e-02 1 1  ON 34
 eH1_5                 2.182794e-02 1 1  ON 35
 eH1_6                 7.141030e-02 1 1  ON 36
 eH1_7                 1.074714e-01 1 1  ON 37
 eH1_8                 9.873820e-02 1 1  ON 38
 eH1_9                 2.572784e-02 1 1  ON 39
 eH2_0                -1.993838e-01 1 1  ON 40
 eH2_1                -9.551701e-02 1 1  ON 41
 eH2_2                -4.600974e-02 1 1  ON 42
 eH2_3                -1.561399e-02 1 1  ON 43
 eH2_4                 1.674979e-02 1 1  ON 44
 eH2_5                 1.998702e-02 1 1  ON 45
 eH2_6                 7.050327e-02 1 1  ON 46
 eH2_7                 1.077219e-01 1 1  ON 47
 eH2_8                 1.012125e-01 1 1  ON 48
 eH2_9                 2.800737e-02 1 1  ON 49
ci_001                -4.169034e-02 3 1  ON 50
ci_002                -3.106838e-02 3 1  ON 51
ci_003                -2.591370e-02 3 1  ON 52
ci_004                 2.323273e-02 3 1  ON 53
ci_005                 2.355559e-02 3 1  ON 54
ci_006                -2.035731e-02 3 1  ON 55
ci_007                -2.035080e-02 3 1  ON 56
ci_008                -8.622390e-03 3 1  ON 57
ci_009                -1.517111e-02 3 1  ON 58
ci_010                -1.001506e-02 3 1  ON 59
ci_011                -1.063438e-02 3 1  ON 60
ci_012                -1.046784e-02 3 1  ON 61
ci_013                -1.964977e-02 3 1  ON 62
ci_014                 1.280117e-02 3 1  ON 63
ci_015                 1.244226e-02 3 1  ON 64
ci_016                 1.657553e-02 3 1  ON 65
ci_017                 1.679318e-02 3 1  ON 66
ci_018                 1.021885e-02 3 1  ON 67
ci_019                 1.022132e-02 3 1  ON 68
ci_020                 1.656987e-02 3 1  ON 69
ci_021                 1.630151e-02 3 1  ON 70
ci_022                 9.119407e-03 3 1  ON 71
ci_023                 8.980112e-03 3 1  ON 72
ci_024                 9.522867e-03 3 1  ON 73
ci_025                 9.498101e-03 3 1  ON 74
ci_026                 1.094690e-02 3 1  ON 75
ci_027                 1.083792e-02 3 1  ON 76
ci_028                -1.494165e-02 3 1  ON 77
ci_029                -1.550460e-02 3 1  ON 78
ci_030                -9.012042e-03 3 1  ON 79
ci_031                -9.028014e-03 3 1  ON 80
ci_032                -1.505842e-02 3 1  ON 81
ci_033                 6.503605e-03 3 1  ON 82
ci_034                 6.291564e-03 3 1  ON 83
ci_035                -4.801548e-03 3 1  ON 84
ci_036                -1.208957e-02 3 1  ON 85
ci_037                -1.262530e-02 3 1  ON 86
ci_038                 1.608656e-03 3 1  ON 87
ci_039                 1.674234e-03 3 1  ON 88
ci_040                -2.835762e-03 3 1  ON 89
ci_041                 8.473634e-03 3 1  ON 90
ci_042                 8.513797e-03 3 1  ON 91
ci_043                -3.838052e-03 3 1  ON 92
ci_044                -4.415815e-03 3 1  ON 93
ci_045                -2.901998e-03 3 1  ON 94
ci_046                 5.852203e-03 3 1  ON 95
ci_047                 5.910483e-03 3 1  ON 96
ci_048                -1.329827e-02 3 1  ON 97
ci_049                -1.356366e-02 3 1  ON 98
ci_050                 3.351426e-03 3 1  ON 99
ci_051                 3.293315e-03 3 1  ON 100
ci_052                -2.527182e-03 3 1  ON 101
ci_053                -2.564697e-03 3 1  ON 102
ci_054                -2.552502e-03 3 1  ON 103
ci_055                -2.593502e-03 3 1  ON 104
ci_056                 5.113990e-03 3 1  ON 105
ci_057                 5.112836e-03 3 1  ON 106
ci_058                -1.738872e-03 3 1  ON 107
ci_059                -2.045047e-03 3 1  ON 108
ci_060                 5.601149e-03 3 1  ON 109
ci_061                 5.387672e-03 3 1  ON 110
ci_062                -3.971674e-03 3 1  ON 111
ci_063                -4.103543e-03 3 1  ON 112
ci_064                -3.329983e-03 3 1  ON 113
ci_065                -4.233078e-03 3 1  ON 114
ci_066                 4.474956e-03 3 1  ON 115
ci_067                 4.346474e-03 3 1  ON 116
ci_068                -5.020827e-03 3 1  ON 117
ci_069                -4.807907e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2244
    reference variance = 0.180642
====================================================
  Execution time = 3.0425e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8501e-01
  Total weights = 1.9573e+06
  Execution time = 2.5358e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270834219567
                                         uncertainty =       0.003007679419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270834219567
                                         uncertainty =       0.003007679419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367982693
  error estimate for blocks of size 2^( 2) =       0.000381773705
  error estimate for blocks of size 2^( 3) =       0.000394382098
  error estimate for blocks of size 2^( 4) =       0.000404050678
  error estimate for blocks of size 2^( 5) =       0.000409647368
  error estimate for blocks of size 2^( 6) =       0.000412501511
  error estimate for blocks of size 2^( 7) =       0.000415926425

      target function =      -0.935948198453
              le_mean =     -17.212715012140
             les_mean =     296.562616414107
             stat err =       0.000410531496
             autocorr =       1.244624015324
   target nu stat err =       0.000410531496
   target dn stat err =       0.004526845907
      target stat err =       0.007705276616
              std dev =       0.520414441382
             le_variance =       0.270831190799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270817593787
                                         uncertainty =       0.002999441506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270817593787
                                         uncertainty =       0.002999441506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367971410
  error estimate for blocks of size 2^( 2) =       0.000381767733
  error estimate for blocks of size 2^( 3) =       0.000394382238
  error estimate for blocks of size 2^( 4) =       0.000404056276
  error estimate for blocks of size 2^( 5) =       0.000409655649
  error estimate for blocks of size 2^( 6) =       0.000412511427
  error estimate for blocks of size 2^( 7) =       0.000415936973

      target function =      -0.936181459289
              le_mean =     -17.212714975501
             les_mean =     296.562477806707
             stat err =       0.000410540081
             autocorr =       1.244752404482
   target nu stat err =       0.000410540081
   target dn stat err =       0.004507389357
      target stat err =       0.007676271393
              std dev =       0.520398484632
             le_variance =       0.270814582807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270825623730
                                         uncertainty =       0.003003455184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270825623730
                                         uncertainty =       0.003003455184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367976859
  error estimate for blocks of size 2^( 2) =       0.000381770578
  error estimate for blocks of size 2^( 3) =       0.000394382080
  error estimate for blocks of size 2^( 4) =       0.000404053438
  error estimate for blocks of size 2^( 5) =       0.000409651493
  error estimate for blocks of size 2^( 6) =       0.000412506477
  error estimate for blocks of size 2^( 7) =       0.000415931705

      target function =      -0.936087430022
              le_mean =     -17.212714985172
             les_mean =     296.562533473814
             stat err =       0.000410535779
             autocorr =       1.244689447229
   target nu stat err =       0.000410535779
   target dn stat err =       0.004516643828
      target stat err =       0.007690348067
              std dev =       0.520406191476
             le_variance =       0.270822604127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270833127799
                                         uncertainty =       0.003007147461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270833127799
                                         uncertainty =       0.003007147461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367981952
  error estimate for blocks of size 2^( 2) =       0.000381773304
  error estimate for blocks of size 2^( 3) =       0.000394382087
  error estimate for blocks of size 2^( 4) =       0.000404051016
  error estimate for blocks of size 2^( 5) =       0.000409647878
  error estimate for blocks of size 2^( 6) =       0.000412502126
  error estimate for blocks of size 2^( 7) =       0.000415927080

      target function =      -0.935968583371
              le_mean =     -17.212715007663
             les_mean =     296.562604248359
             stat err =       0.000410532025
             autocorr =       1.244632236266
   target nu stat err =       0.000410532025
   target dn stat err =       0.004525520573
      target stat err =       0.007703375443
              std dev =       0.520413393553
             le_variance =       0.270830100190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935948198453        initial
     2.5000e+00     2.5000e+01             1.7986e-04        -0.936181459289  <--
     1.0000e+01     1.0000e+02             4.5097e-05        -0.936087430022
     4.0000e+01     4.0000e+02             1.1282e-05        -0.935968583371

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.3146e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.044048e-01 1 1  ON 0
  uu_1                 4.988074e-02 1 1  ON 1
  uu_2                -3.714122e-02 1 1  ON 2
  uu_3                -8.926125e-02 1 1  ON 3
  uu_4                -1.214736e-01 1 1  ON 4
  uu_5                -1.310216e-01 1 1  ON 5
  uu_6                -1.134128e-01 1 1  ON 6
  uu_7                -5.304799e-02 1 1  ON 7
  uu_8                 6.793475e-02 1 1  ON 8
  uu_9                 1.227803e-01 1 1  ON 9
  ud_0                 3.008737e-01 1 1  ON 10
  ud_1                 7.520976e-02 1 1  ON 11
  ud_2                -2.259728e-02 1 1  ON 12
  ud_3                -7.407593e-02 1 1  ON 13
  ud_4                -1.109100e-01 1 1  ON 14
  ud_5                -1.323373e-01 1 1  ON 15
  ud_6                -1.288142e-01 1 1  ON 16
  ud_7                -8.876755e-02 1 1  ON 17
  ud_8                -5.451244e-03 1 1  ON 18
  ud_9                 8.697139e-02 1 1  ON 19
  eO_0                -6.913808e-01 1 1  ON 20
  eO_1                -4.145463e-01 1 1  ON 21
  eO_2                -4.649084e-02 1 1  ON 22
  eO_3                 1.762307e-01 1 1  ON 23
  eO_4                 2.543645e-01 1 1  ON 24
  eO_5                 2.838739e-01 1 1  ON 25
  eO_6                 2.507071e-01 1 1  ON 26
  eO_7                 1.287844e-01 1 1  ON 27
  eO_8                 2.881159e-02 1 1  ON 28
  eO_9                 1.878879e-02 1 1  ON 29
 eH1_0                -1.994313e-01 1 1  ON 30
 eH1_1                -9.608290e-02 1 1  ON 31
 eH1_2                -4.634288e-02 1 1  ON 32
 eH1_3                -1.583041e-02 1 1  ON 33
 eH1_4                 1.718377e-02 1 1  ON 34
 eH1_5                 2.179418e-02 1 1  ON 35
 eH1_6                 7.136955e-02 1 1  ON 36
 eH1_7                 1.074406e-01 1 1  ON 37
 eH1_8                 9.877421e-02 1 1  ON 38
 eH1_9                 2.573605e-02 1 1  ON 39
 eH2_0                -1.994188e-01 1 1  ON 40
 eH2_1                -9.549587e-02 1 1  ON 41
 eH2_2                -4.598328e-02 1 1  ON 42
 eH2_3                -1.558987e-02 1 1  ON 43
 eH2_4                 1.673243e-02 1 1  ON 44
 eH2_5                 1.989163e-02 1 1  ON 45
 eH2_6                 7.051148e-02 1 1  ON 46
 eH2_7                 1.077272e-01 1 1  ON 47
 eH2_8                 1.012700e-01 1 1  ON 48
 eH2_9                 2.801188e-02 1 1  ON 49
ci_001                -4.167965e-02 3 1  ON 50
ci_002                -3.107045e-02 3 1  ON 51
ci_003                -2.590715e-02 3 1  ON 52
ci_004                 2.323084e-02 3 1  ON 53
ci_005                 2.357344e-02 3 1  ON 54
ci_006                -2.037122e-02 3 1  ON 55
ci_007                -2.034181e-02 3 1  ON 56
ci_008                -8.628050e-03 3 1  ON 57
ci_009                -1.515359e-02 3 1  ON 58
ci_010                -9.994846e-03 3 1  ON 59
ci_011                -1.062536e-02 3 1  ON 60
ci_012                -1.048138e-02 3 1  ON 61
ci_013                -1.965261e-02 3 1  ON 62
ci_014                 1.280011e-02 3 1  ON 63
ci_015                 1.247184e-02 3 1  ON 64
ci_016                 1.656482e-02 3 1  ON 65
ci_017                 1.680408e-02 3 1  ON 66
ci_018                 1.019469e-02 3 1  ON 67
ci_019                 1.022848e-02 3 1  ON 68
ci_020                 1.657083e-02 3 1  ON 69
ci_021                 1.630143e-02 3 1  ON 70
ci_022                 9.116030e-03 3 1  ON 71
ci_023                 8.970508e-03 3 1  ON 72
ci_024                 9.522523e-03 3 1  ON 73
ci_025                 9.507379e-03 3 1  ON 74
ci_026                 1.093790e-02 3 1  ON 75
ci_027                 1.084057e-02 3 1  ON 76
ci_028                -1.492362e-02 3 1  ON 77
ci_029                -1.549761e-02 3 1  ON 78
ci_030                -9.014078e-03 3 1  ON 79
ci_031                -9.011533e-03 3 1  ON 80
ci_032                -1.505460e-02 3 1  ON 81
ci_033                 6.493404e-03 3 1  ON 82
ci_034                 6.292931e-03 3 1  ON 83
ci_035                -4.802045e-03 3 1  ON 84
ci_036                -1.209570e-02 3 1  ON 85
ci_037                -1.262320e-02 3 1  ON 86
ci_038                 1.597382e-03 3 1  ON 87
ci_039                 1.665423e-03 3 1  ON 88
ci_040                -2.835016e-03 3 1  ON 89
ci_041                 8.468312e-03 3 1  ON 90
ci_042                 8.499544e-03 3 1  ON 91
ci_043                -3.830631e-03 3 1  ON 92
ci_044                -4.411313e-03 3 1  ON 93
ci_045                -2.917498e-03 3 1  ON 94
ci_046                 5.849253e-03 3 1  ON 95
ci_047                 5.913492e-03 3 1  ON 96
ci_048                -1.327522e-02 3 1  ON 97
ci_049                -1.356353e-02 3 1  ON 98
ci_050                 3.367973e-03 3 1  ON 99
ci_051                 3.291586e-03 3 1  ON 100
ci_052                -2.513048e-03 3 1  ON 101
ci_053                -2.571456e-03 3 1  ON 102
ci_054                -2.550496e-03 3 1  ON 103
ci_055                -2.591957e-03 3 1  ON 104
ci_056                 5.113318e-03 3 1  ON 105
ci_057                 5.101931e-03 3 1  ON 106
ci_058                -1.763984e-03 3 1  ON 107
ci_059                -2.026866e-03 3 1  ON 108
ci_060                 5.603303e-03 3 1  ON 109
ci_061                 5.389906e-03 3 1  ON 110
ci_062                -3.963175e-03 3 1  ON 111
ci_063                -4.105781e-03 3 1  ON 112
ci_064                -3.325237e-03 3 1  ON 113
ci_065                -4.229930e-03 3 1  ON 114
ci_066                 4.484148e-03 3 1  ON 115
ci_067                 4.353302e-03 3 1  ON 116
ci_068                -5.028456e-03 3 1  ON 117
ci_069                -4.833266e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0584e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2959
    reference variance = 0.193675
====================================================
  Execution time = 2.8208e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0383e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7601e-01
  Total weights = 1.957373201e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0220e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264481726701
                                         uncertainty =       0.001407744918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264481726701
                                         uncertainty =       0.001407744918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363764319
  error estimate for blocks of size 2^( 2) =       0.000377975202
  error estimate for blocks of size 2^( 3) =       0.000391343374
  error estimate for blocks of size 2^( 4) =       0.000401114789
  error estimate for blocks of size 2^( 5) =       0.000405826800
  error estimate for blocks of size 2^( 6) =       0.000409263160
  error estimate for blocks of size 2^( 7) =       0.000410705016

      target function =      -0.951599355137
              le_mean =     -17.212261087563
             les_mean =     296.537940430700
             stat err =       0.000406727441
             autocorr =       1.250163322830
   target nu stat err =       0.000406727441
   target dn stat err =       0.002004536205
      target stat err =       0.003586180515
              std dev =       0.514448664442
             le_variance =       0.264657428346


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721226108756e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951611792937       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951645598881       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951652251374       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951654655684       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951655017319       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951655697262       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951656871452       residual = 9.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951657756766       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951658034095       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951658251513       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951658736146       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951658927774       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951659024410       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951659294888       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951659433538       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951659198898       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951659292697       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951659300256       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951659262594       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951659565763       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951659830692       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951659867858       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951659762549       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951659842466       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.951659798036       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951659722830       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.951659721554       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951659858887       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.951659963223       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.951660110488       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951660067561       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.951660080235       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951660126659       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.951660144129       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.951660125620       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.951660176516       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.951660166066       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951660185761       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.951660183867       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.951660199406       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.951660204234       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.951660174756       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.951660167751       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.951660163675       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.951660162900       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.951660164377       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         45 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e-01 is 7.661350e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951611792937       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951621044012       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951622840194       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951623480422       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951623575651       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951623756857       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951624070488       residual = 9.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951624307672       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951624379564       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951624435787       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951624571500       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951624624881       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951624649080       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951624709252       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951624741944       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951624681966       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951624701759       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951624711380       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951624699020       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951624779026       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951624844579       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951624849885       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951624822428       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951624842150       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.951624830438       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951624811098       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.951624813136       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951624850085       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.951624874447       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.951624905574       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951624895277       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.951624898564       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951624908147       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.951624912664       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.951624909379       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.951624920937       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.951624917826       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951624921942       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.951624922407       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.951624925114       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.951624926033       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.951624918834       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.951624917769       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.951624916891       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.951624916745       residual = 8.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+00 is 1.937724e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951611792937       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951614161731       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951614619919       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951614782631       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951614806769       residual = 9.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951614852841       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951614932629       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951614992991       residual = 8.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951615011112       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951615025304       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951615060268       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951615073974       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951615079972       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951615094433       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951615102455       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951615087439       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951615092146       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951615095098       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951615091839       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951615112096       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951615128443       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951615129353       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951615122489       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951615127401       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.951615124443       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951615119601       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.951615120272       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951615129644       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.951615135582       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.951615143005       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951615140475       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.951615141313       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951615143585       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.951615144722       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.951615143975       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.951615146787       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.951615145977       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951615146959       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.951615147137       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.951615147728       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.951615147941       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.951615146151       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.951615145930       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.951615145732       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.951615145696       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+01 is 4.859325e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.071292 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7340e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.044164e-01 1 1  ON 0
  uu_1                 4.988112e-02 1 1  ON 1
  uu_2                -3.713764e-02 1 1  ON 2
  uu_3                -8.923567e-02 1 1  ON 3
  uu_4                -1.214486e-01 1 1  ON 4
  uu_5                -1.310213e-01 1 1  ON 5
  uu_6                -1.133566e-01 1 1  ON 6
  uu_7                -5.306880e-02 1 1  ON 7
  uu_8                 6.774098e-02 1 1  ON 8
  uu_9                 1.227840e-01 1 1  ON 9
  ud_0                 3.007788e-01 1 1  ON 10
  ud_1                 7.513406e-02 1 1  ON 11
  ud_2                -2.264774e-02 1 1  ON 12
  ud_3                -7.409830e-02 1 1  ON 13
  ud_4                -1.108924e-01 1 1  ON 14
  ud_5                -1.322796e-01 1 1  ON 15
  ud_6                -1.287442e-01 1 1  ON 16
  ud_7                -8.869555e-02 1 1  ON 17
  ud_8                -5.465424e-03 1 1  ON 18
  ud_9                 8.693575e-02 1 1  ON 19
  eO_0                -6.913416e-01 1 1  ON 20
  eO_1                -4.145066e-01 1 1  ON 21
  eO_2                -4.653226e-02 1 1  ON 22
  eO_3                 1.761102e-01 1 1  ON 23
  eO_4                 2.542584e-01 1 1  ON 24
  eO_5                 2.839095e-01 1 1  ON 25
  eO_6                 2.507380e-01 1 1  ON 26
  eO_7                 1.288835e-01 1 1  ON 27
  eO_8                 2.882746e-02 1 1  ON 28
  eO_9                 1.879354e-02 1 1  ON 29
 eH1_0                -1.994539e-01 1 1  ON 30
 eH1_1                -9.603816e-02 1 1  ON 31
 eH1_2                -4.630794e-02 1 1  ON 32
 eH1_3                -1.581514e-02 1 1  ON 33
 eH1_4                 1.715768e-02 1 1  ON 34
 eH1_5                 2.171711e-02 1 1  ON 35
 eH1_6                 7.131031e-02 1 1  ON 36
 eH1_7                 1.074533e-01 1 1  ON 37
 eH1_8                 9.883744e-02 1 1  ON 38
 eH1_9                 2.574448e-02 1 1  ON 39
 eH2_0                -1.994314e-01 1 1  ON 40
 eH2_1                -9.545754e-02 1 1  ON 41
 eH2_2                -4.591588e-02 1 1  ON 42
 eH2_3                -1.556112e-02 1 1  ON 43
 eH2_4                 1.672006e-02 1 1  ON 44
 eH2_5                 1.982337e-02 1 1  ON 45
 eH2_6                 7.044365e-02 1 1  ON 46
 eH2_7                 1.076951e-01 1 1  ON 47
 eH2_8                 1.013233e-01 1 1  ON 48
 eH2_9                 2.801948e-02 1 1  ON 49
ci_001                -4.166130e-02 3 1  ON 50
ci_002                -3.107211e-02 3 1  ON 51
ci_003                -2.588837e-02 3 1  ON 52
ci_004                 2.323808e-02 3 1  ON 53
ci_005                 2.354483e-02 3 1  ON 54
ci_006                -2.036792e-02 3 1  ON 55
ci_007                -2.034523e-02 3 1  ON 56
ci_008                -8.634027e-03 3 1  ON 57
ci_009                -1.515140e-02 3 1  ON 58
ci_010                -1.000332e-02 3 1  ON 59
ci_011                -1.062237e-02 3 1  ON 60
ci_012                -1.046088e-02 3 1  ON 61
ci_013                -1.965559e-02 3 1  ON 62
ci_014                 1.281594e-02 3 1  ON 63
ci_015                 1.247947e-02 3 1  ON 64
ci_016                 1.656944e-02 3 1  ON 65
ci_017                 1.679116e-02 3 1  ON 66
ci_018                 1.017806e-02 3 1  ON 67
ci_019                 1.019828e-02 3 1  ON 68
ci_020                 1.659073e-02 3 1  ON 69
ci_021                 1.631020e-02 3 1  ON 70
ci_022                 9.107396e-03 3 1  ON 71
ci_023                 8.958081e-03 3 1  ON 72
ci_024                 9.519814e-03 3 1  ON 73
ci_025                 9.473112e-03 3 1  ON 74
ci_026                 1.093745e-02 3 1  ON 75
ci_027                 1.086192e-02 3 1  ON 76
ci_028                -1.494510e-02 3 1  ON 77
ci_029                -1.550859e-02 3 1  ON 78
ci_030                -8.993132e-03 3 1  ON 79
ci_031                -9.016103e-03 3 1  ON 80
ci_032                -1.504986e-02 3 1  ON 81
ci_033                 6.459910e-03 3 1  ON 82
ci_034                 6.292074e-03 3 1  ON 83
ci_035                -4.799656e-03 3 1  ON 84
ci_036                -1.210695e-02 3 1  ON 85
ci_037                -1.259553e-02 3 1  ON 86
ci_038                 1.579681e-03 3 1  ON 87
ci_039                 1.671922e-03 3 1  ON 88
ci_040                -2.837577e-03 3 1  ON 89
ci_041                 8.454038e-03 3 1  ON 90
ci_042                 8.489652e-03 3 1  ON 91
ci_043                -3.825856e-03 3 1  ON 92
ci_044                -4.402246e-03 3 1  ON 93
ci_045                -2.925003e-03 3 1  ON 94
ci_046                 5.860472e-03 3 1  ON 95
ci_047                 5.909665e-03 3 1  ON 96
ci_048                -1.325314e-02 3 1  ON 97
ci_049                -1.356612e-02 3 1  ON 98
ci_050                 3.364100e-03 3 1  ON 99
ci_051                 3.308704e-03 3 1  ON 100
ci_052                -2.520153e-03 3 1  ON 101
ci_053                -2.576359e-03 3 1  ON 102
ci_054                -2.543528e-03 3 1  ON 103
ci_055                -2.592290e-03 3 1  ON 104
ci_056                 5.108396e-03 3 1  ON 105
ci_057                 5.095793e-03 3 1  ON 106
ci_058                -1.767064e-03 3 1  ON 107
ci_059                -2.035881e-03 3 1  ON 108
ci_060                 5.581961e-03 3 1  ON 109
ci_061                 5.387936e-03 3 1  ON 110
ci_062                -3.950429e-03 3 1  ON 111
ci_063                -4.104434e-03 3 1  ON 112
ci_064                -3.322312e-03 3 1  ON 113
ci_065                -4.220991e-03 3 1  ON 114
ci_066                 4.463116e-03 3 1  ON 115
ci_067                 4.350792e-03 3 1  ON 116
ci_068                -5.048289e-03 3 1  ON 117
ci_069                -4.860770e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2136
    reference variance = 0.189293
====================================================
  Execution time = 2.8169e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8091e-01
  Total weights = 1.9574e+06
  Execution time = 2.5437e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269303808677
                                         uncertainty =       0.001370538823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269303808677
                                         uncertainty =       0.001370538823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366939744
  error estimate for blocks of size 2^( 2) =       0.000380685358
  error estimate for blocks of size 2^( 3) =       0.000393528331
  error estimate for blocks of size 2^( 4) =       0.000403356991
  error estimate for blocks of size 2^( 5) =       0.000408400982
  error estimate for blocks of size 2^( 6) =       0.000411841226
  error estimate for blocks of size 2^( 7) =       0.000412593425

      target function =      -0.943158224519
              le_mean =     -17.212591885544
             les_mean =     296.554186993178
             stat err =       0.000409048156
             autocorr =       1.242680175328
   target nu stat err =       0.000409048156
   target dn stat err =       0.002039906416
      target stat err =       0.003586845527
              std dev =       0.518939466045
             le_variance =       0.269298169419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269252903877
                                         uncertainty =       0.001369708418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269252903877
                                         uncertainty =       0.001369708418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366905155
  error estimate for blocks of size 2^( 2) =       0.000380678095
  error estimate for blocks of size 2^( 3) =       0.000393551836
  error estimate for blocks of size 2^( 4) =       0.000403404053
  error estimate for blocks of size 2^( 5) =       0.000408468149
  error estimate for blocks of size 2^( 6) =       0.000411923628
  error estimate for blocks of size 2^( 7) =       0.000412676287

      target function =      -0.942605951423
              le_mean =     -17.212593668387
             les_mean =     296.554569162189
             stat err =       0.000409118029
             autocorr =       1.243339150590
   target nu stat err =       0.000409118029
   target dn stat err =       0.002101189722
      target stat err =       0.003685816841
              std dev =       0.518890548991
             le_variance =       0.269247401833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269275379840
                                         uncertainty =       0.001370074259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269275379840
                                         uncertainty =       0.001370074259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366920426
  error estimate for blocks of size 2^( 2) =       0.000380680662
  error estimate for blocks of size 2^( 3) =       0.000393540041
  error estimate for blocks of size 2^( 4) =       0.000403381278
  error estimate for blocks of size 2^( 5) =       0.000408435922
  error estimate for blocks of size 2^( 6) =       0.000411884623
  error estimate for blocks of size 2^( 7) =       0.000412637209

      target function =      -0.942155306499
              le_mean =     -17.212592615571
             les_mean =     296.554795479771
             stat err =       0.000409084758
             autocorr =       1.243033456366
   target nu stat err =       0.000409084758
   target dn stat err =       0.002091189899
      target stat err =       0.003665539807
              std dev =       0.518912145250
             le_variance =       0.269269814488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269300043455
                                         uncertainty =       0.001370477088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269300043455
                                         uncertainty =       0.001370477088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366937186
  error estimate for blocks of size 2^( 2) =       0.000380684662
  error estimate for blocks of size 2^( 3) =       0.000393529731
  error estimate for blocks of size 2^( 4) =       0.000403359983
  error estimate for blocks of size 2^( 5) =       0.000408405332
  error estimate for blocks of size 2^( 6) =       0.000411846623
  error estimate for blocks of size 2^( 7) =       0.000412598882

      target function =      -0.943142473100
              le_mean =     -17.212591965651
             les_mean =     296.554198894352
             stat err =       0.000409052705
             autocorr =       1.242725146907
   target nu stat err =       0.000409052705
   target dn stat err =       0.002041682310
      target stat err =       0.003589718208
              std dev =       0.518935847355
             le_variance =       0.269294413670


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943158224519        initial  <--
     6.2500e-01     6.2500e+00             7.6614e-04        -0.942605951423
     2.5000e+00     2.5000e+01             1.9377e-04        -0.942155306499
     1.0000e+01     1.0000e+02             4.8593e-05        -0.943142473100

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.9071
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.044048e-01 1 1  ON 0
  uu_1                 4.988074e-02 1 1  ON 1
  uu_2                -3.714122e-02 1 1  ON 2
  uu_3                -8.926125e-02 1 1  ON 3
  uu_4                -1.214736e-01 1 1  ON 4
  uu_5                -1.310216e-01 1 1  ON 5
  uu_6                -1.134128e-01 1 1  ON 6
  uu_7                -5.304799e-02 1 1  ON 7
  uu_8                 6.793475e-02 1 1  ON 8
  uu_9                 1.227803e-01 1 1  ON 9
  ud_0                 3.008737e-01 1 1  ON 10
  ud_1                 7.520976e-02 1 1  ON 11
  ud_2                -2.259728e-02 1 1  ON 12
  ud_3                -7.407593e-02 1 1  ON 13
  ud_4                -1.109100e-01 1 1  ON 14
  ud_5                -1.323373e-01 1 1  ON 15
  ud_6                -1.288142e-01 1 1  ON 16
  ud_7                -8.876755e-02 1 1  ON 17
  ud_8                -5.451244e-03 1 1  ON 18
  ud_9                 8.697139e-02 1 1  ON 19
  eO_0                -6.913808e-01 1 1  ON 20
  eO_1                -4.145463e-01 1 1  ON 21
  eO_2                -4.649084e-02 1 1  ON 22
  eO_3                 1.762307e-01 1 1  ON 23
  eO_4                 2.543645e-01 1 1  ON 24
  eO_5                 2.838739e-01 1 1  ON 25
  eO_6                 2.507071e-01 1 1  ON 26
  eO_7                 1.287844e-01 1 1  ON 27
  eO_8                 2.881159e-02 1 1  ON 28
  eO_9                 1.878879e-02 1 1  ON 29
 eH1_0                -1.994313e-01 1 1  ON 30
 eH1_1                -9.608290e-02 1 1  ON 31
 eH1_2                -4.634288e-02 1 1  ON 32
 eH1_3                -1.583041e-02 1 1  ON 33
 eH1_4                 1.718377e-02 1 1  ON 34
 eH1_5                 2.179418e-02 1 1  ON 35
 eH1_6                 7.136955e-02 1 1  ON 36
 eH1_7                 1.074406e-01 1 1  ON 37
 eH1_8                 9.877421e-02 1 1  ON 38
 eH1_9                 2.573605e-02 1 1  ON 39
 eH2_0                -1.994188e-01 1 1  ON 40
 eH2_1                -9.549587e-02 1 1  ON 41
 eH2_2                -4.598328e-02 1 1  ON 42
 eH2_3                -1.558987e-02 1 1  ON 43
 eH2_4                 1.673243e-02 1 1  ON 44
 eH2_5                 1.989163e-02 1 1  ON 45
 eH2_6                 7.051148e-02 1 1  ON 46
 eH2_7                 1.077272e-01 1 1  ON 47
 eH2_8                 1.012700e-01 1 1  ON 48
 eH2_9                 2.801188e-02 1 1  ON 49
ci_001                -4.167965e-02 3 1  ON 50
ci_002                -3.107045e-02 3 1  ON 51
ci_003                -2.590715e-02 3 1  ON 52
ci_004                 2.323084e-02 3 1  ON 53
ci_005                 2.357344e-02 3 1  ON 54
ci_006                -2.037122e-02 3 1  ON 55
ci_007                -2.034181e-02 3 1  ON 56
ci_008                -8.628050e-03 3 1  ON 57
ci_009                -1.515359e-02 3 1  ON 58
ci_010                -9.994846e-03 3 1  ON 59
ci_011                -1.062536e-02 3 1  ON 60
ci_012                -1.048138e-02 3 1  ON 61
ci_013                -1.965261e-02 3 1  ON 62
ci_014                 1.280011e-02 3 1  ON 63
ci_015                 1.247184e-02 3 1  ON 64
ci_016                 1.656482e-02 3 1  ON 65
ci_017                 1.680408e-02 3 1  ON 66
ci_018                 1.019469e-02 3 1  ON 67
ci_019                 1.022848e-02 3 1  ON 68
ci_020                 1.657083e-02 3 1  ON 69
ci_021                 1.630143e-02 3 1  ON 70
ci_022                 9.116030e-03 3 1  ON 71
ci_023                 8.970508e-03 3 1  ON 72
ci_024                 9.522523e-03 3 1  ON 73
ci_025                 9.507379e-03 3 1  ON 74
ci_026                 1.093790e-02 3 1  ON 75
ci_027                 1.084057e-02 3 1  ON 76
ci_028                -1.492362e-02 3 1  ON 77
ci_029                -1.549761e-02 3 1  ON 78
ci_030                -9.014078e-03 3 1  ON 79
ci_031                -9.011533e-03 3 1  ON 80
ci_032                -1.505460e-02 3 1  ON 81
ci_033                 6.493404e-03 3 1  ON 82
ci_034                 6.292931e-03 3 1  ON 83
ci_035                -4.802045e-03 3 1  ON 84
ci_036                -1.209570e-02 3 1  ON 85
ci_037                -1.262320e-02 3 1  ON 86
ci_038                 1.597382e-03 3 1  ON 87
ci_039                 1.665423e-03 3 1  ON 88
ci_040                -2.835016e-03 3 1  ON 89
ci_041                 8.468312e-03 3 1  ON 90
ci_042                 8.499544e-03 3 1  ON 91
ci_043                -3.830631e-03 3 1  ON 92
ci_044                -4.411313e-03 3 1  ON 93
ci_045                -2.917498e-03 3 1  ON 94
ci_046                 5.849253e-03 3 1  ON 95
ci_047                 5.913492e-03 3 1  ON 96
ci_048                -1.327522e-02 3 1  ON 97
ci_049                -1.356353e-02 3 1  ON 98
ci_050                 3.367973e-03 3 1  ON 99
ci_051                 3.291586e-03 3 1  ON 100
ci_052                -2.513048e-03 3 1  ON 101
ci_053                -2.571456e-03 3 1  ON 102
ci_054                -2.550496e-03 3 1  ON 103
ci_055                -2.591957e-03 3 1  ON 104
ci_056                 5.113318e-03 3 1  ON 105
ci_057                 5.101931e-03 3 1  ON 106
ci_058                -1.763984e-03 3 1  ON 107
ci_059                -2.026866e-03 3 1  ON 108
ci_060                 5.603303e-03 3 1  ON 109
ci_061                 5.389906e-03 3 1  ON 110
ci_062                -3.963175e-03 3 1  ON 111
ci_063                -4.105781e-03 3 1  ON 112
ci_064                -3.325237e-03 3 1  ON 113
ci_065                -4.229930e-03 3 1  ON 114
ci_066                 4.484148e-03 3 1  ON 115
ci_067                 4.353302e-03 3 1  ON 116
ci_068                -5.028456e-03 3 1  ON 117
ci_069                -4.833266e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8256e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1632
    reference variance = 0.231452
====================================================
  Execution time = 2.8397e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0379e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7937e-01
  Total weights = 1.957264598e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7115e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267536440804
                                         uncertainty =       0.001636816827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267536440804
                                         uncertainty =       0.001636816827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365730487
  error estimate for blocks of size 2^( 2) =       0.000379580239
  error estimate for blocks of size 2^( 3) =       0.000392631795
  error estimate for blocks of size 2^( 4) =       0.000403011152
  error estimate for blocks of size 2^( 5) =       0.000409435286
  error estimate for blocks of size 2^( 6) =       0.000411750984
  error estimate for blocks of size 2^( 7) =       0.000413826766

      target function =      -0.945722217281
              le_mean =     -17.213061995737
             les_mean =     296.568870460124
             stat err =       0.000409506047
             autocorr =       1.253713521893
   target nu stat err =       0.000409506047
   target dn stat err =       0.002368061003
      target stat err =       0.004166697108
              std dev =       0.517229290085
             le_variance =       0.267526138522


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721306199574e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945739452011       residual = 8.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945744585208       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945745421664       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945745844451       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945746046599       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945746181011       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945746328478       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945746402129       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945746517686       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945746609054       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945746667091       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945746650095       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945746691253       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945746714578       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945746764570       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945746821116       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945746843820       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945746877751       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945746854195       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945746862659       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945746884825       residual = 9.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945746915437       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945746900356       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945746884641       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945746873897       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.945746880398       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.945746881631       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.945746893921       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.945746888417       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.945746901709       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.945746904601       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.945746894672       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.945746896345       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.945746896599       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.945746902389       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.945746898729       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.945746902700       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.945746903541       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.945746903535       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.945746904609       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.945746904105       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.945746903765       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.945746904745       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.945746904183       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.945746903867       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.945746904614       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.945746904750       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.945746905001       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+00 is 7.187783e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945739452011       residual = 8.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945740747680       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945740958273       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945741064587       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945741115426       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945741149440       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945741186346       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945741205566       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945741235174       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945741257155       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945741271707       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945741267199       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945741277513       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945741283489       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945741295902       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945741310172       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945741315735       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945741324187       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945741318282       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945741320463       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945741326085       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945741333666       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945741329781       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945741325803       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945741323181       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.945741324844       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.945741325138       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.945741328242       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.945741326862       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.945741330162       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.945741330797       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.945741328343       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.945741328776       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.945741328859       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.945741330288       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.945741329371       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.945741330375       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.945741330566       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.945741330574       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.945741330833       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.945741330703       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.945741330627       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.945741330864       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.945741330722       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.945741330646       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.945741330833       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.945741330868       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.945741330927       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+01 is 1.799561e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945739452011       residual = 8.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945739776710       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945739829452       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945739856069       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945739868798       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945739877327       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945739886555       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945739891414       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945739898862       residual = 7.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945739904307       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945739907943       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945739906797       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945739909378       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945739910881       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945739913978       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945739917555       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945739918939       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945739921049       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945739919572       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945739920121       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945739921532       residual = 9.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945739923423       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945739922444       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945739921446       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945739920796       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.945739921214       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.945739921286       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.945739922064       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.945739921719       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.945739922542       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.945739922695       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.945739922084       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.945739922193       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.945739922215       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.945739922571       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.945739922342       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.945739922593       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.945739922640       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.945739922642       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.945739922707       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.945739922674       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.945739922655       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.945739922714       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.945739922678       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.945739922660       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.945739922707       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.945739922715       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.945739922730       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+02 is 4.500543e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.189239 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7233e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.044040e-01 1 1  ON 0
  uu_1                 4.988242e-02 1 1  ON 1
  uu_2                -3.713966e-02 1 1  ON 2
  uu_3                -8.925788e-02 1 1  ON 3
  uu_4                -1.214685e-01 1 1  ON 4
  uu_5                -1.310206e-01 1 1  ON 5
  uu_6                -1.134090e-01 1 1  ON 6
  uu_7                -5.305002e-02 1 1  ON 7
  uu_8                 6.791676e-02 1 1  ON 8
  uu_9                 1.227805e-01 1 1  ON 9
  ud_0                 3.008634e-01 1 1  ON 10
  ud_1                 7.520133e-02 1 1  ON 11
  ud_2                -2.260453e-02 1 1  ON 12
  ud_3                -7.408123e-02 1 1  ON 13
  ud_4                -1.109098e-01 1 1  ON 14
  ud_5                -1.323282e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.875446e-02 1 1  ON 17
  ud_8                -5.455600e-03 1 1  ON 18
  ud_9                 8.696748e-02 1 1  ON 19
  eO_0                -6.913698e-01 1 1  ON 20
  eO_1                -4.145360e-01 1 1  ON 21
  eO_2                -4.648761e-02 1 1  ON 22
  eO_3                 1.762204e-01 1 1  ON 23
  eO_4                 2.543490e-01 1 1  ON 24
  eO_5                 2.838596e-01 1 1  ON 25
  eO_6                 2.507100e-01 1 1  ON 26
  eO_7                 1.287968e-01 1 1  ON 27
  eO_8                 2.881193e-02 1 1  ON 28
  eO_9                 1.878892e-02 1 1  ON 29
 eH1_0                -1.994336e-01 1 1  ON 30
 eH1_1                -9.607692e-02 1 1  ON 31
 eH1_2                -4.633756e-02 1 1  ON 32
 eH1_3                -1.582897e-02 1 1  ON 33
 eH1_4                 1.717824e-02 1 1  ON 34
 eH1_5                 2.178643e-02 1 1  ON 35
 eH1_6                 7.136640e-02 1 1  ON 36
 eH1_7                 1.074404e-01 1 1  ON 37
 eH1_8                 9.878002e-02 1 1  ON 38
 eH1_9                 2.573643e-02 1 1  ON 39
 eH2_0                -1.994284e-01 1 1  ON 40
 eH2_1                -9.549919e-02 1 1  ON 41
 eH2_2                -4.598169e-02 1 1  ON 42
 eH2_3                -1.559173e-02 1 1  ON 43
 eH2_4                 1.672896e-02 1 1  ON 44
 eH2_5                 1.988868e-02 1 1  ON 45
 eH2_6                 7.052414e-02 1 1  ON 46
 eH2_7                 1.077291e-01 1 1  ON 47
 eH2_8                 1.012745e-01 1 1  ON 48
 eH2_9                 2.801275e-02 1 1  ON 49
ci_001                -4.167888e-02 3 1  ON 50
ci_002                -3.106930e-02 3 1  ON 51
ci_003                -2.590550e-02 3 1  ON 52
ci_004                 2.323212e-02 3 1  ON 53
ci_005                 2.357396e-02 3 1  ON 54
ci_006                -2.037066e-02 3 1  ON 55
ci_007                -2.033953e-02 3 1  ON 56
ci_008                -8.626645e-03 3 1  ON 57
ci_009                -1.514936e-02 3 1  ON 58
ci_010                -9.995570e-03 3 1  ON 59
ci_011                -1.062646e-02 3 1  ON 60
ci_012                -1.048172e-02 3 1  ON 61
ci_013                -1.965098e-02 3 1  ON 62
ci_014                 1.279795e-02 3 1  ON 63
ci_015                 1.247208e-02 3 1  ON 64
ci_016                 1.656465e-02 3 1  ON 65
ci_017                 1.680320e-02 3 1  ON 66
ci_018                 1.019454e-02 3 1  ON 67
ci_019                 1.022719e-02 3 1  ON 68
ci_020                 1.657095e-02 3 1  ON 69
ci_021                 1.630124e-02 3 1  ON 70
ci_022                 9.114081e-03 3 1  ON 71
ci_023                 8.971502e-03 3 1  ON 72
ci_024                 9.521586e-03 3 1  ON 73
ci_025                 9.508161e-03 3 1  ON 74
ci_026                 1.093496e-02 3 1  ON 75
ci_027                 1.084075e-02 3 1  ON 76
ci_028                -1.492491e-02 3 1  ON 77
ci_029                -1.549686e-02 3 1  ON 78
ci_030                -9.014570e-03 3 1  ON 79
ci_031                -9.008298e-03 3 1  ON 80
ci_032                -1.505377e-02 3 1  ON 81
ci_033                 6.492523e-03 3 1  ON 82
ci_034                 6.293367e-03 3 1  ON 83
ci_035                -4.802433e-03 3 1  ON 84
ci_036                -1.209513e-02 3 1  ON 85
ci_037                -1.262173e-02 3 1  ON 86
ci_038                 1.597636e-03 3 1  ON 87
ci_039                 1.664906e-03 3 1  ON 88
ci_040                -2.833844e-03 3 1  ON 89
ci_041                 8.471431e-03 3 1  ON 90
ci_042                 8.502495e-03 3 1  ON 91
ci_043                -3.829908e-03 3 1  ON 92
ci_044                -4.409505e-03 3 1  ON 93
ci_045                -2.916174e-03 3 1  ON 94
ci_046                 5.848319e-03 3 1  ON 95
ci_047                 5.915704e-03 3 1  ON 96
ci_048                -1.326932e-02 3 1  ON 97
ci_049                -1.356215e-02 3 1  ON 98
ci_050                 3.368728e-03 3 1  ON 99
ci_051                 3.294319e-03 3 1  ON 100
ci_052                -2.511315e-03 3 1  ON 101
ci_053                -2.572359e-03 3 1  ON 102
ci_054                -2.548912e-03 3 1  ON 103
ci_055                -2.591307e-03 3 1  ON 104
ci_056                 5.112590e-03 3 1  ON 105
ci_057                 5.101521e-03 3 1  ON 106
ci_058                -1.762613e-03 3 1  ON 107
ci_059                -2.026925e-03 3 1  ON 108
ci_060                 5.604528e-03 3 1  ON 109
ci_061                 5.392113e-03 3 1  ON 110
ci_062                -3.961217e-03 3 1  ON 111
ci_063                -4.103994e-03 3 1  ON 112
ci_064                -3.325840e-03 3 1  ON 113
ci_065                -4.229865e-03 3 1  ON 114
ci_066                 4.482423e-03 3 1  ON 115
ci_067                 4.354077e-03 3 1  ON 116
ci_068                -5.027663e-03 3 1  ON 117
ci_069                -4.834401e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2248
    reference variance = 0.20351
====================================================
  Execution time = 2.7993e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7717e-01
  Total weights = 1.9575e+06
  Execution time = 2.5447e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267024832292
                                         uncertainty =       0.001644027739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267024832292
                                         uncertainty =       0.001644027739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365371584
  error estimate for blocks of size 2^( 2) =       0.000379468168
  error estimate for blocks of size 2^( 3) =       0.000392397953
  error estimate for blocks of size 2^( 4) =       0.000402103228
  error estimate for blocks of size 2^( 5) =       0.000408132651
  error estimate for blocks of size 2^( 6) =       0.000411646599
  error estimate for blocks of size 2^( 7) =       0.000413780953

      target function =      -0.949571599050
              le_mean =     -17.212535883726
             les_mean =     296.548557482506
             stat err =       0.000408915858
             autocorr =       1.252559514085
   target nu stat err =       0.000408915858
   target dn stat err =       0.001881476441
      target stat err =       0.003364550444
              std dev =       0.516721716564
             le_variance =       0.267001332369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267020849108
                                         uncertainty =       0.001643888159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267020849108
                                         uncertainty =       0.001643888159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365368877
  error estimate for blocks of size 2^( 2) =       0.000379468493
  error estimate for blocks of size 2^( 3) =       0.000392401734
  error estimate for blocks of size 2^( 4) =       0.000402110043
  error estimate for blocks of size 2^( 5) =       0.000408141359
  error estimate for blocks of size 2^( 6) =       0.000411655965
  error estimate for blocks of size 2^( 7) =       0.000413791241

      target function =      -0.948733672544
              le_mean =     -17.212536118069
             les_mean =     296.549046212210
             stat err =       0.000408924652
             autocorr =       1.252631950326
   target nu stat err =       0.000408924652
   target dn stat err =       0.001946005181
      target stat err =       0.003468312569
              std dev =       0.516717888431
             le_variance =       0.266997376225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267022808848
                                         uncertainty =       0.001643957133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267022808848
                                         uncertainty =       0.001643957133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365370209
  error estimate for blocks of size 2^( 2) =       0.000379468319
  error estimate for blocks of size 2^( 3) =       0.000392399844
  error estimate for blocks of size 2^( 4) =       0.000402106648
  error estimate for blocks of size 2^( 5) =       0.000408137026
  error estimate for blocks of size 2^( 6) =       0.000411651306
  error estimate for blocks of size 2^( 7) =       0.000413786125

      target function =      -0.949540577096
              le_mean =     -17.212536001105
             les_mean =     296.548579313550
             stat err =       0.000408920276
             autocorr =       1.252596011613
   target nu stat err =       0.000408920276
   target dn stat err =       0.001882127962
      target stat err =       0.003365445706
              std dev =       0.516719771800
             le_variance =       0.266999322569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267024577121
                                         uncertainty =       0.001644018872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267024577121
                                         uncertainty =       0.001644018872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365371410
  error estimate for blocks of size 2^( 2) =       0.000379468185
  error estimate for blocks of size 2^( 3) =       0.000392398188
  error estimate for blocks of size 2^( 4) =       0.000402103655
  error estimate for blocks of size 2^( 5) =       0.000408133198
  error estimate for blocks of size 2^( 6) =       0.000411647187
  error estimate for blocks of size 2^( 7) =       0.000413781599

      target function =      -0.949572348301
              le_mean =     -17.212535898126
             les_mean =     296.548557547787
             stat err =       0.000408916410
             autocorr =       1.252564083437
   target nu stat err =       0.000408916410
   target dn stat err =       0.001881527177
      target stat err =       0.003364642156
              std dev =       0.516721471306
             le_variance =       0.267001078908


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949571599050        initial
     6.2500e+00     6.2500e+01             7.1878e-05        -0.948733672544
     2.5000e+01     2.5000e+02             1.7996e-05        -0.949540577096
     1.0000e+02     1.0000e+03             4.5005e-06        -0.949572348301  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+02     and shift_s =   1.0000e+03
*****************************************************************************

  Execution time = 4.0776e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.044046e-01 1 1  ON 0
  uu_1                 4.988116e-02 1 1  ON 1
  uu_2                -3.714083e-02 1 1  ON 2
  uu_3                -8.926041e-02 1 1  ON 3
  uu_4                -1.214723e-01 1 1  ON 4
  uu_5                -1.310214e-01 1 1  ON 5
  uu_6                -1.134119e-01 1 1  ON 6
  uu_7                -5.304850e-02 1 1  ON 7
  uu_8                 6.793025e-02 1 1  ON 8
  uu_9                 1.227804e-01 1 1  ON 9
  ud_0                 3.008711e-01 1 1  ON 10
  ud_1                 7.520765e-02 1 1  ON 11
  ud_2                -2.259910e-02 1 1  ON 12
  ud_3                -7.407726e-02 1 1  ON 13
  ud_4                -1.109100e-01 1 1  ON 14
  ud_5                -1.323350e-01 1 1  ON 15
  ud_6                -1.288110e-01 1 1  ON 16
  ud_7                -8.876427e-02 1 1  ON 17
  ud_8                -5.452335e-03 1 1  ON 18
  ud_9                 8.697041e-02 1 1  ON 19
  eO_0                -6.913780e-01 1 1  ON 20
  eO_1                -4.145437e-01 1 1  ON 21
  eO_2                -4.649003e-02 1 1  ON 22
  eO_3                 1.762281e-01 1 1  ON 23
  eO_4                 2.543606e-01 1 1  ON 24
  eO_5                 2.838703e-01 1 1  ON 25
  eO_6                 2.507078e-01 1 1  ON 26
  eO_7                 1.287875e-01 1 1  ON 27
  eO_8                 2.881167e-02 1 1  ON 28
  eO_9                 1.878882e-02 1 1  ON 29
 eH1_0                -1.994319e-01 1 1  ON 30
 eH1_1                -9.608140e-02 1 1  ON 31
 eH1_2                -4.634155e-02 1 1  ON 32
 eH1_3                -1.583005e-02 1 1  ON 33
 eH1_4                 1.718239e-02 1 1  ON 34
 eH1_5                 2.179224e-02 1 1  ON 35
 eH1_6                 7.136876e-02 1 1  ON 36
 eH1_7                 1.074406e-01 1 1  ON 37
 eH1_8                 9.877566e-02 1 1  ON 38
 eH1_9                 2.573614e-02 1 1  ON 39
 eH2_0                -1.994212e-01 1 1  ON 40
 eH2_1                -9.549670e-02 1 1  ON 41
 eH2_2                -4.598288e-02 1 1  ON 42
 eH2_3                -1.559034e-02 1 1  ON 43
 eH2_4                 1.673156e-02 1 1  ON 44
 eH2_5                 1.989089e-02 1 1  ON 45
 eH2_6                 7.051465e-02 1 1  ON 46
 eH2_7                 1.077277e-01 1 1  ON 47
 eH2_8                 1.012711e-01 1 1  ON 48
 eH2_9                 2.801210e-02 1 1  ON 49
ci_001                -4.167946e-02 3 1  ON 50
ci_002                -3.107016e-02 3 1  ON 51
ci_003                -2.590674e-02 3 1  ON 52
ci_004                 2.323116e-02 3 1  ON 53
ci_005                 2.357357e-02 3 1  ON 54
ci_006                -2.037108e-02 3 1  ON 55
ci_007                -2.034124e-02 3 1  ON 56
ci_008                -8.627698e-03 3 1  ON 57
ci_009                -1.515253e-02 3 1  ON 58
ci_010                -9.995028e-03 3 1  ON 59
ci_011                -1.062563e-02 3 1  ON 60
ci_012                -1.048146e-02 3 1  ON 61
ci_013                -1.965220e-02 3 1  ON 62
ci_014                 1.279957e-02 3 1  ON 63
ci_015                 1.247190e-02 3 1  ON 64
ci_016                 1.656478e-02 3 1  ON 65
ci_017                 1.680386e-02 3 1  ON 66
ci_018                 1.019465e-02 3 1  ON 67
ci_019                 1.022816e-02 3 1  ON 68
ci_020                 1.657086e-02 3 1  ON 69
ci_021                 1.630138e-02 3 1  ON 70
ci_022                 9.115542e-03 3 1  ON 71
ci_023                 8.970757e-03 3 1  ON 72
ci_024                 9.522288e-03 3 1  ON 73
ci_025                 9.507575e-03 3 1  ON 74
ci_026                 1.093716e-02 3 1  ON 75
ci_027                 1.084061e-02 3 1  ON 76
ci_028                -1.492394e-02 3 1  ON 77
ci_029                -1.549742e-02 3 1  ON 78
ci_030                -9.014202e-03 3 1  ON 79
ci_031                -9.010723e-03 3 1  ON 80
ci_032                -1.505439e-02 3 1  ON 81
ci_033                 6.493183e-03 3 1  ON 82
ci_034                 6.293040e-03 3 1  ON 83
ci_035                -4.802142e-03 3 1  ON 84
ci_036                -1.209556e-02 3 1  ON 85
ci_037                -1.262283e-02 3 1  ON 86
ci_038                 1.597445e-03 3 1  ON 87
ci_039                 1.665294e-03 3 1  ON 88
ci_040                -2.834722e-03 3 1  ON 89
ci_041                 8.469093e-03 3 1  ON 90
ci_042                 8.500283e-03 3 1  ON 91
ci_043                -3.830450e-03 3 1  ON 92
ci_044                -4.410860e-03 3 1  ON 93
ci_045                -2.917166e-03 3 1  ON 94
ci_046                 5.849019e-03 3 1  ON 95
ci_047                 5.914046e-03 3 1  ON 96
ci_048                -1.327374e-02 3 1  ON 97
ci_049                -1.356318e-02 3 1  ON 98
ci_050                 3.368162e-03 3 1  ON 99
ci_051                 3.292271e-03 3 1  ON 100
ci_052                -2.512614e-03 3 1  ON 101
ci_053                -2.571682e-03 3 1  ON 102
ci_054                -2.550099e-03 3 1  ON 103
ci_055                -2.591794e-03 3 1  ON 104
ci_056                 5.113136e-03 3 1  ON 105
ci_057                 5.101828e-03 3 1  ON 106
ci_058                -1.763640e-03 3 1  ON 107
ci_059                -2.026881e-03 3 1  ON 108
ci_060                 5.603610e-03 3 1  ON 109
ci_061                 5.390459e-03 3 1  ON 110
ci_062                -3.962684e-03 3 1  ON 111
ci_063                -4.105333e-03 3 1  ON 112
ci_064                -3.325388e-03 3 1  ON 113
ci_065                -4.229914e-03 3 1  ON 114
ci_066                 4.483716e-03 3 1  ON 115
ci_067                 4.353496e-03 3 1  ON 116
ci_068                -5.028257e-03 3 1  ON 117
ci_069                -4.833550e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2152
    reference variance = 0.212503
====================================================
  Execution time = 2.8551e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0398e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8218e-01
  Total weights = 1.957459662e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7895e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270170684488
                                         uncertainty =       0.001872660466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270170684488
                                         uncertainty =       0.001872660466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367544582
  error estimate for blocks of size 2^( 2) =       0.000381400959
  error estimate for blocks of size 2^( 3) =       0.000394553757
  error estimate for blocks of size 2^( 4) =       0.000403778251
  error estimate for blocks of size 2^( 5) =       0.000409569024
  error estimate for blocks of size 2^( 6) =       0.000411314929
  error estimate for blocks of size 2^( 7) =       0.000413224876

      target function =      -0.940927928800
              le_mean =     -17.212212637120
             les_mean =     296.542439165888
             stat err =       0.000409471770
             autocorr =       1.241160318236
   target nu stat err =       0.000409471770
   target dn stat err =       0.002385771858
      target stat err =       0.004148259426
              std dev =       0.519794848835
             le_variance =       0.270186684875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721221263712e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940945174827       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940947283742       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940947665767       residual = 6.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940947836177       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940947879623       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940947892757       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940947909271       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940947924736       residual = 9.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940947973885       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940947980718       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940948001187       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940948011179       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940948011726       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940948026471       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940948030226       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940948039787       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940948030944       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940948033308       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940948032698       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940948037713       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940948036762       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940948035479       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940948038579       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940948037316       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940948034656       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.940948037109       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.940948039868       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.940948041988       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.940948042608       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.940948041629       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.940948043631       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.940948041777       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.940948043816       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.940948043373       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.940948042676       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.940948044698       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.940948044555       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.940948044469       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.940948044869       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.940948044758       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.940948044605       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.940948044102       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.940948044758       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.940948044971       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.940948045306       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.940948045354       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.940948045474       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.940948045593       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+01 is 2.059403e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940945174827       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940945703312       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940945799017       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940945841691       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940945852566       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940945855848       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940945859988       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940945863854       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940945876164       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940945877876       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940945882999       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940945885500       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940945885633       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940945889325       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940945890257       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940945892649       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940945890433       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940945891026       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940945890869       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940945892136       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940945891869       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940945891581       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940945892342       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940945892020       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940945891357       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.940945891978       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.940945892663       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.940945893195       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.940945893347       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.940945893102       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.940945893605       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.940945893140       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.940945893648       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.940945893537       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.940945893364       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.940945893868       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.940945893834       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.940945893811       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.940945893910       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.940945893883       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.940945893845       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.940945893719       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.940945893883       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.940945893937       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.940945894020       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.940945894032       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.940945894062       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.940945894091       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+02 is 5.150049e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940945174827       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940945307027       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940945330966       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940945341639       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940945344358       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940945345179       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940945346214       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940945347181       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940945350259       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940945350688       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940945351968       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940945352596       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940945352628       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940945353551       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940945353784       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940945354381       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940945353828       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940945353975       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940945353935       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940945354254       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940945354186       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940945354115       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940945354305       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940945354224       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940945354058       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.940945354214       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.940945354385       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.940945354518       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.940945354555       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.940945354494       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.940945354617       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.940945354505       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.940945354630       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.940945354602       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.940945354563       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.940945354685       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.940945354676       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.940945354668       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.940945354697       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.940945354689       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.940945354680       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.940945354649       residual = 9.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.940945354690       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.940945354703       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.940945354723       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.940945354727       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.940945354733       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.940945354741       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+02 is 1.287609e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.307697 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7466e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.044047e-01 1 1  ON 0
  uu_1                 4.988130e-02 1 1  ON 1
  uu_2                -3.714051e-02 1 1  ON 2
  uu_3                -8.925957e-02 1 1  ON 3
  uu_4                -1.214712e-01 1 1  ON 4
  uu_5                -1.310201e-01 1 1  ON 5
  uu_6                -1.134120e-01 1 1  ON 6
  uu_7                -5.304991e-02 1 1  ON 7
  uu_8                 6.792510e-02 1 1  ON 8
  uu_9                 1.227812e-01 1 1  ON 9
  ud_0                 3.008682e-01 1 1  ON 10
  ud_1                 7.520549e-02 1 1  ON 11
  ud_2                -2.260078e-02 1 1  ON 12
  ud_3                -7.407871e-02 1 1  ON 13
  ud_4                -1.109108e-01 1 1  ON 14
  ud_5                -1.323348e-01 1 1  ON 15
  ud_6                -1.288085e-01 1 1  ON 16
  ud_7                -8.875942e-02 1 1  ON 17
  ud_8                -5.451598e-03 1 1  ON 18
  ud_9                 8.696963e-02 1 1  ON 19
  eO_0                -6.913754e-01 1 1  ON 20
  eO_1                -4.145414e-01 1 1  ON 21
  eO_2                -4.648979e-02 1 1  ON 22
  eO_3                 1.762244e-01 1 1  ON 23
  eO_4                 2.543563e-01 1 1  ON 24
  eO_5                 2.838684e-01 1 1  ON 25
  eO_6                 2.507092e-01 1 1  ON 26
  eO_7                 1.287905e-01 1 1  ON 27
  eO_8                 2.881205e-02 1 1  ON 28
  eO_9                 1.878883e-02 1 1  ON 29
 eH1_0                -1.994324e-01 1 1  ON 30
 eH1_1                -9.608082e-02 1 1  ON 31
 eH1_2                -4.634076e-02 1 1  ON 32
 eH1_3                -1.582975e-02 1 1  ON 33
 eH1_4                 1.718248e-02 1 1  ON 34
 eH1_5                 2.179026e-02 1 1  ON 35
 eH1_6                 7.136860e-02 1 1  ON 36
 eH1_7                 1.074402e-01 1 1  ON 37
 eH1_8                 9.877661e-02 1 1  ON 38
 eH1_9                 2.573646e-02 1 1  ON 39
 eH2_0                -1.994231e-01 1 1  ON 40
 eH2_1                -9.549648e-02 1 1  ON 41
 eH2_2                -4.598159e-02 1 1  ON 42
 eH2_3                -1.559025e-02 1 1  ON 43
 eH2_4                 1.673074e-02 1 1  ON 44
 eH2_5                 1.989097e-02 1 1  ON 45
 eH2_6                 7.051445e-02 1 1  ON 46
 eH2_7                 1.077271e-01 1 1  ON 47
 eH2_8                 1.012723e-01 1 1  ON 48
 eH2_9                 2.801258e-02 1 1  ON 49
ci_001                -4.167878e-02 3 1  ON 50
ci_002                -3.106972e-02 3 1  ON 51
ci_003                -2.590640e-02 3 1  ON 52
ci_004                 2.323160e-02 3 1  ON 53
ci_005                 2.357393e-02 3 1  ON 54
ci_006                -2.037158e-02 3 1  ON 55
ci_007                -2.034075e-02 3 1  ON 56
ci_008                -8.627296e-03 3 1  ON 57
ci_009                -1.515233e-02 3 1  ON 58
ci_010                -9.994293e-03 3 1  ON 59
ci_011                -1.062505e-02 3 1  ON 60
ci_012                -1.048167e-02 3 1  ON 61
ci_013                -1.965254e-02 3 1  ON 62
ci_014                 1.279903e-02 3 1  ON 63
ci_015                 1.247225e-02 3 1  ON 64
ci_016                 1.656489e-02 3 1  ON 65
ci_017                 1.680308e-02 3 1  ON 66
ci_018                 1.019400e-02 3 1  ON 67
ci_019                 1.022770e-02 3 1  ON 68
ci_020                 1.657093e-02 3 1  ON 69
ci_021                 1.630118e-02 3 1  ON 70
ci_022                 9.116160e-03 3 1  ON 71
ci_023                 8.970571e-03 3 1  ON 72
ci_024                 9.523103e-03 3 1  ON 73
ci_025                 9.507645e-03 3 1  ON 74
ci_026                 1.093692e-02 3 1  ON 75
ci_027                 1.084024e-02 3 1  ON 76
ci_028                -1.492354e-02 3 1  ON 77
ci_029                -1.549673e-02 3 1  ON 78
ci_030                -9.014560e-03 3 1  ON 79
ci_031                -9.011419e-03 3 1  ON 80
ci_032                -1.505432e-02 3 1  ON 81
ci_033                 6.493297e-03 3 1  ON 82
ci_034                 6.291755e-03 3 1  ON 83
ci_035                -4.802272e-03 3 1  ON 84
ci_036                -1.209626e-02 3 1  ON 85
ci_037                -1.262187e-02 3 1  ON 86
ci_038                 1.596575e-03 3 1  ON 87
ci_039                 1.665525e-03 3 1  ON 88
ci_040                -2.834147e-03 3 1  ON 89
ci_041                 8.469686e-03 3 1  ON 90
ci_042                 8.500743e-03 3 1  ON 91
ci_043                -3.830175e-03 3 1  ON 92
ci_044                -4.410990e-03 3 1  ON 93
ci_045                -2.917285e-03 3 1  ON 94
ci_046                 5.849269e-03 3 1  ON 95
ci_047                 5.914016e-03 3 1  ON 96
ci_048                -1.327384e-02 3 1  ON 97
ci_049                -1.356271e-02 3 1  ON 98
ci_050                 3.367916e-03 3 1  ON 99
ci_051                 3.292236e-03 3 1  ON 100
ci_052                -2.512367e-03 3 1  ON 101
ci_053                -2.570535e-03 3 1  ON 102
ci_054                -2.550543e-03 3 1  ON 103
ci_055                -2.591642e-03 3 1  ON 104
ci_056                 5.112572e-03 3 1  ON 105
ci_057                 5.101427e-03 3 1  ON 106
ci_058                -1.763599e-03 3 1  ON 107
ci_059                -2.025997e-03 3 1  ON 108
ci_060                 5.602315e-03 3 1  ON 109
ci_061                 5.390434e-03 3 1  ON 110
ci_062                -3.962418e-03 3 1  ON 111
ci_063                -4.105065e-03 3 1  ON 112
ci_064                -3.325275e-03 3 1  ON 113
ci_065                -4.230210e-03 3 1  ON 114
ci_066                 4.484412e-03 3 1  ON 115
ci_067                 4.353173e-03 3 1  ON 116
ci_068                -5.028408e-03 3 1  ON 117
ci_069                -4.833116e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2678
    reference variance = 0.338632
====================================================
  Execution time = 2.7916e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7980e-01
  Total weights = 1.9573e+06
  Execution time = 2.5506e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268763976024
                                         uncertainty =       0.001702933438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268763976024
                                         uncertainty =       0.001702933438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366603372
  error estimate for blocks of size 2^( 2) =       0.000380379910
  error estimate for blocks of size 2^( 3) =       0.000392358040
  error estimate for blocks of size 2^( 4) =       0.000401339270
  error estimate for blocks of size 2^( 5) =       0.000406596893
  error estimate for blocks of size 2^( 6) =       0.000409113495
  error estimate for blocks of size 2^( 7) =       0.000411707229

      target function =      -0.945010491102
              le_mean =     -17.212242157683
             les_mean =     296.541077767161
             stat err =       0.000407189222
             autocorr =       1.233671801336
   target nu stat err =       0.000407189222
   target dn stat err =       0.002434904114
      target stat err =       0.004266708808
              std dev =       0.518463755309
             le_variance =       0.268804665569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268762812396
                                         uncertainty =       0.001702838379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268762812396
                                         uncertainty =       0.001702838379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366602576
  error estimate for blocks of size 2^( 2) =       0.000380380266
  error estimate for blocks of size 2^( 3) =       0.000392359497
  error estimate for blocks of size 2^( 4) =       0.000401341581
  error estimate for blocks of size 2^( 5) =       0.000406599547
  error estimate for blocks of size 2^( 6) =       0.000409116526
  error estimate for blocks of size 2^( 7) =       0.000411710528

      target function =      -0.945021153896
              le_mean =     -17.212242246440
             les_mean =     296.541074644217
             stat err =       0.000407192045
             autocorr =       1.233694268164
   target nu stat err =       0.000407192045
   target dn stat err =       0.002434526133
      target stat err =       0.004266162995
              std dev =       0.518462629650
             le_variance =       0.268803498344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268763390378
                                         uncertainty =       0.001702885772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268763390378
                                         uncertainty =       0.001702885772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366602971
  error estimate for blocks of size 2^( 2) =       0.000380380087
  error estimate for blocks of size 2^( 3) =       0.000392358768
  error estimate for blocks of size 2^( 4) =       0.000401340426
  error estimate for blocks of size 2^( 5) =       0.000406598220
  error estimate for blocks of size 2^( 6) =       0.000409115011
  error estimate for blocks of size 2^( 7) =       0.000411708879

      target function =      -0.945015955016
              le_mean =     -17.212242201985
             les_mean =     296.541076126260
             stat err =       0.000407190634
             autocorr =       1.233683056257
   target nu stat err =       0.000407190634
   target dn stat err =       0.002434711631
      target stat err =       0.004266431147
              std dev =       0.518463188782
             le_variance =       0.268804078122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268763902495
                                         uncertainty =       0.001702927471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268763902495
                                         uncertainty =       0.001702927471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366603321
  error estimate for blocks of size 2^( 2) =       0.000380379932
  error estimate for blocks of size 2^( 3) =       0.000392358131
  error estimate for blocks of size 2^( 4) =       0.000401339415
  error estimate for blocks of size 2^( 5) =       0.000406597059
  error estimate for blocks of size 2^( 6) =       0.000409113684
  error estimate for blocks of size 2^( 7) =       0.000411707435

      target function =      -0.945011190145
              le_mean =     -17.212242163205
             les_mean =     296.541077552208
             stat err =       0.000407189398
             autocorr =       1.233673208842
   target nu stat err =       0.000407189398
   target dn stat err =       0.002434879696
      target stat err =       0.004266673636
              std dev =       0.518463684183
             le_variance =       0.268804591816


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945010491102        initial
     2.5000e+01     2.5000e+02             2.0594e-05        -0.945021153896  <--
     1.0000e+02     1.0000e+03             5.1500e-06        -0.945015955016
     4.0000e+02     4.0000e+03             1.2876e-06        -0.945011190145

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 4.0713e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8189e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1195
    reference variance = 0.320574
====================================================
  Execution time = 2.8481e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0412e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8114e-01
  Total weights = 1.957162937e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2800e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267792604279
                                         uncertainty =       0.001440231405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267792604279
                                         uncertainty =       0.001440231405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365867357
  error estimate for blocks of size 2^( 2) =       0.000379543192
  error estimate for blocks of size 2^( 3) =       0.000392299805
  error estimate for blocks of size 2^( 4) =       0.000402035469
  error estimate for blocks of size 2^( 5) =       0.000407945420
  error estimate for blocks of size 2^( 6) =       0.000411861073
  error estimate for blocks of size 2^( 7) =       0.000413838644

      target function =      -0.942705230273
              le_mean =     -17.211801682113
             les_mean =     296.527259579160
             stat err =       0.000408920151
             autocorr =       1.249193454055
   target nu stat err =       0.000408920151
   target dn stat err =       0.003008610165
      target stat err =       0.005215097856
              std dev =       0.517422856708
             le_variance =       0.267726412644


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721180168211e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942733015914       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942741231985       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942742468867       residual = 6.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942743030840       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942743172098       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942743278259       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942743343764       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942743449683       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942743644613       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942743706033       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942743765232       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942743771982       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942743833253       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942743841332       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942743830867       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942743832259       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942743852833       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942743892907       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942743907742       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942743904386       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942743933245       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942743955936       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942743969708       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942743969680       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.942743977926       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.942743961468       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.942743954797       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.942743968053       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.942743970093       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942743971598       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.942743974645       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.942743978376       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.942743982712       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.942743982348       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942743984938       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.942743985166       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.942743984228       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.942743983967       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.942743983263       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.942743982558       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.942743982385       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.942743983074       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.942743983833       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.942743983826       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.942743984478       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.942743984273       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.942743983304       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         46 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+00 is 6.187735e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942733015914       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942735089230       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942735400953       residual = 6.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942735542400       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942735577941       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942735604761       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942735621244       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942735648022       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942735697080       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942735712466       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942735727352       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942735729063       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942735744388       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942735746325       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942735743703       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942735744061       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942735749256       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942735759214       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942735763045       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942735762084       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942735769372       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942735775127       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942735778488       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942735778430       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.942735780444       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.942735776314       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.942735774726       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.942735778034       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.942735778521       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942735778868       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.942735779622       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.942735780554       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.942735781609       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.942735781505       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942735782164       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.942735782238       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.942735782002       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.942735781937       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.942735781759       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.942735781581       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.942735781526       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.942735781676       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.942735781868       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.942735781875       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.942735782045       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.942735782000       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         45 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+01 is 1.556694e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942733015914       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942733535463       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942733613552       residual = 6.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942733648974       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942733657874       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942733664596       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942733668724       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942733675437       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942733687722       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942733691570       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942733695298       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942733695727       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942733699559       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942733700038       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942733699382       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942733699472       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942733700774       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942733703259       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942733704225       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942733703977       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942733705804       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942733707247       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942733708082       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942733708065       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.942733708565       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.942733707532       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.942733707140       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.942733707966       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.942733708086       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942733708172       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.942733708360       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.942733708593       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.942733708855       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.942733708828       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942733708993       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.942733709013       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.942733708953       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.942733708937       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.942733708893       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.942733708848       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.942733708833       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.942733708870       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.942733708918       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.942733708920       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.942733708963       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.942733708952       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         45 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+02 is 3.897821e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.414093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7874e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.044129e-01 1 1  ON 0
  uu_1                 4.988809e-02 1 1  ON 1
  uu_2                -3.713516e-02 1 1  ON 2
  uu_3                -8.925509e-02 1 1  ON 3
  uu_4                -1.214684e-01 1 1  ON 4
  uu_5                -1.310188e-01 1 1  ON 5
  uu_6                -1.134172e-01 1 1  ON 6
  uu_7                -5.306341e-02 1 1  ON 7
  uu_8                 6.789665e-02 1 1  ON 8
  uu_9                 1.227870e-01 1 1  ON 9
  ud_0                 3.008515e-01 1 1  ON 10
  ud_1                 7.519151e-02 1 1  ON 11
  ud_2                -2.261233e-02 1 1  ON 12
  ud_3                -7.408706e-02 1 1  ON 13
  ud_4                -1.109115e-01 1 1  ON 14
  ud_5                -1.323277e-01 1 1  ON 15
  ud_6                -1.287857e-01 1 1  ON 16
  ud_7                -8.874025e-02 1 1  ON 17
  ud_8                -5.452763e-03 1 1  ON 18
  ud_9                 8.696309e-02 1 1  ON 19
  eO_0                -6.913618e-01 1 1  ON 20
  eO_1                -4.145284e-01 1 1  ON 21
  eO_2                -4.648719e-02 1 1  ON 22
  eO_3                 1.762066e-01 1 1  ON 23
  eO_4                 2.543333e-01 1 1  ON 24
  eO_5                 2.838492e-01 1 1  ON 25
  eO_6                 2.507147e-01 1 1  ON 26
  eO_7                 1.288130e-01 1 1  ON 27
  eO_8                 2.881378e-02 1 1  ON 28
  eO_9                 1.878894e-02 1 1  ON 29
 eH1_0                -1.994340e-01 1 1  ON 30
 eH1_1                -9.607724e-02 1 1  ON 31
 eH1_2                -4.633361e-02 1 1  ON 32
 eH1_3                -1.582646e-02 1 1  ON 33
 eH1_4                 1.718128e-02 1 1  ON 34
 eH1_5                 2.177467e-02 1 1  ON 35
 eH1_6                 7.136481e-02 1 1  ON 36
 eH1_7                 1.074378e-01 1 1  ON 37
 eH1_8                 9.878504e-02 1 1  ON 38
 eH1_9                 2.573806e-02 1 1  ON 39
 eH2_0                -1.994363e-01 1 1  ON 40
 eH2_1                -9.549570e-02 1 1  ON 41
 eH2_2                -4.597423e-02 1 1  ON 42
 eH2_3                -1.558690e-02 1 1  ON 43
 eH2_4                 1.672978e-02 1 1  ON 44
 eH2_5                 1.988821e-02 1 1  ON 45
 eH2_6                 7.050973e-02 1 1  ON 46
 eH2_7                 1.077264e-01 1 1  ON 47
 eH2_8                 1.012810e-01 1 1  ON 48
 eH2_9                 2.801421e-02 1 1  ON 49
ci_001                -4.167847e-02 3 1  ON 50
ci_002                -3.106721e-02 3 1  ON 51
ci_003                -2.590447e-02 3 1  ON 52
ci_004                 2.323173e-02 3 1  ON 53
ci_005                 2.357380e-02 3 1  ON 54
ci_006                -2.037243e-02 3 1  ON 55
ci_007                -2.033491e-02 3 1  ON 56
ci_008                -8.624585e-03 3 1  ON 57
ci_009                -1.514879e-02 3 1  ON 58
ci_010                -9.991094e-03 3 1  ON 59
ci_011                -1.062184e-02 3 1  ON 60
ci_012                -1.047878e-02 3 1  ON 61
ci_013                -1.965424e-02 3 1  ON 62
ci_014                 1.279577e-02 3 1  ON 63
ci_015                 1.247009e-02 3 1  ON 64
ci_016                 1.656731e-02 3 1  ON 65
ci_017                 1.680116e-02 3 1  ON 66
ci_018                 1.019198e-02 3 1  ON 67
ci_019                 1.022560e-02 3 1  ON 68
ci_020                 1.657046e-02 3 1  ON 69
ci_021                 1.630243e-02 3 1  ON 70
ci_022                 9.120512e-03 3 1  ON 71
ci_023                 8.967179e-03 3 1  ON 72
ci_024                 9.526633e-03 3 1  ON 73
ci_025                 9.512646e-03 3 1  ON 74
ci_026                 1.093324e-02 3 1  ON 75
ci_027                 1.083991e-02 3 1  ON 76
ci_028                -1.492366e-02 3 1  ON 77
ci_029                -1.549524e-02 3 1  ON 78
ci_030                -9.016858e-03 3 1  ON 79
ci_031                -9.015690e-03 3 1  ON 80
ci_032                -1.505174e-02 3 1  ON 81
ci_033                 6.492096e-03 3 1  ON 82
ci_034                 6.288705e-03 3 1  ON 83
ci_035                -4.801724e-03 3 1  ON 84
ci_036                -1.209970e-02 3 1  ON 85
ci_037                -1.261673e-02 3 1  ON 86
ci_038                 1.594277e-03 3 1  ON 87
ci_039                 1.665645e-03 3 1  ON 88
ci_040                -2.833157e-03 3 1  ON 89
ci_041                 8.475225e-03 3 1  ON 90
ci_042                 8.507140e-03 3 1  ON 91
ci_043                -3.828939e-03 3 1  ON 92
ci_044                -4.406767e-03 3 1  ON 93
ci_045                -2.917701e-03 3 1  ON 94
ci_046                 5.851289e-03 3 1  ON 95
ci_047                 5.913822e-03 3 1  ON 96
ci_048                -1.327722e-02 3 1  ON 97
ci_049                -1.355872e-02 3 1  ON 98
ci_050                 3.366469e-03 3 1  ON 99
ci_051                 3.292296e-03 3 1  ON 100
ci_052                -2.511151e-03 3 1  ON 101
ci_053                -2.564629e-03 3 1  ON 102
ci_054                -2.550913e-03 3 1  ON 103
ci_055                -2.591752e-03 3 1  ON 104
ci_056                 5.109779e-03 3 1  ON 105
ci_057                 5.100755e-03 3 1  ON 106
ci_058                -1.762537e-03 3 1  ON 107
ci_059                -2.018169e-03 3 1  ON 108
ci_060                 5.597204e-03 3 1  ON 109
ci_061                 5.391708e-03 3 1  ON 110
ci_062                -3.961126e-03 3 1  ON 111
ci_063                -4.101390e-03 3 1  ON 112
ci_064                -3.324686e-03 3 1  ON 113
ci_065                -4.230770e-03 3 1  ON 114
ci_066                 4.484464e-03 3 1  ON 115
ci_067                 4.353928e-03 3 1  ON 116
ci_068                -5.028874e-03 3 1  ON 117
ci_069                -4.835962e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2433
    reference variance = 0.149356
====================================================
  Execution time = 2.8376e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7519e-01
  Total weights = 1.9574e+06
  Execution time = 2.4852e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266086277145
                                         uncertainty =       0.001592898717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266086277145
                                         uncertainty =       0.001592898717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364697415
  error estimate for blocks of size 2^( 2) =       0.000378539705
  error estimate for blocks of size 2^( 3) =       0.000390802613
  error estimate for blocks of size 2^( 4) =       0.000400638826
  error estimate for blocks of size 2^( 5) =       0.000406436942
  error estimate for blocks of size 2^( 6) =       0.000408726127
  error estimate for blocks of size 2^( 7) =       0.000408014932

      target function =      -0.953057769097
              le_mean =     -17.211969469031
             les_mean =     296.527074704552
             stat err =       0.000405954207
             autocorr =       1.239049688057
   target nu stat err =       0.000405954207
   target dn stat err =       0.001827448939
      target stat err =       0.003291405188
              std dev =       0.515768282506
             le_variance =       0.266016921239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266089804054
                                         uncertainty =       0.001592485117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266089804054
                                         uncertainty =       0.001592485117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364699853
  error estimate for blocks of size 2^( 2) =       0.000378545164
  error estimate for blocks of size 2^( 3) =       0.000390811364
  error estimate for blocks of size 2^( 4) =       0.000400650795
  error estimate for blocks of size 2^( 5) =       0.000406450221
  error estimate for blocks of size 2^( 6) =       0.000408740210
  error estimate for blocks of size 2^( 7) =       0.000408029369

      target function =      -0.952897917743
              le_mean =     -17.211969294801
             les_mean =     296.527159836151
             stat err =       0.000405967649
             autocorr =       1.239115176933
   target nu stat err =       0.000405967649
   target dn stat err =       0.001830654313
      target stat err =       0.003295808296
              std dev =       0.515771730174
             le_variance =       0.266020477647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266088038119
                                         uncertainty =       0.001592690202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266088038119
                                         uncertainty =       0.001592690202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364698632
  error estimate for blocks of size 2^( 2) =       0.000378542445
  error estimate for blocks of size 2^( 3) =       0.000390807010
  error estimate for blocks of size 2^( 4) =       0.000400644844
  error estimate for blocks of size 2^( 5) =       0.000406443620
  error estimate for blocks of size 2^( 6) =       0.000408733209
  error estimate for blocks of size 2^( 7) =       0.000408022197

      target function =      -0.953005540238
              le_mean =     -17.211969377238
             les_mean =     296.527101319112
             stat err =       0.000405960967
             autocorr =       1.239082685570
   target nu stat err =       0.000405960967
   target dn stat err =       0.001828148094
      target stat err =       0.003292250244
              std dev =       0.515770004093
             le_variance =       0.266018697122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266086495316
                                         uncertainty =       0.001592872573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266086495316
                                         uncertainty =       0.001592872573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364697566
  error estimate for blocks of size 2^( 2) =       0.000378540047
  error estimate for blocks of size 2^( 3) =       0.000390803162
  error estimate for blocks of size 2^( 4) =       0.000400639578
  error estimate for blocks of size 2^( 5) =       0.000406437777
  error estimate for blocks of size 2^( 6) =       0.000408727012
  error estimate for blocks of size 2^( 7) =       0.000408015841

      target function =      -0.953053383276
              le_mean =     -17.211969457173
             les_mean =     296.527076796583
             stat err =       0.000405955052
             autocorr =       1.239053822288
   target nu stat err =       0.000405955052
   target dn stat err =       0.001827500158
      target stat err =       0.003291463450
              std dev =       0.515768495818
             le_variance =       0.266017141279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.953057769097        initial  <--
     6.2500e+00     6.2500e+01             6.1877e-05        -0.952897917743
     2.5000e+01     2.5000e+02             1.5567e-05        -0.953005540238
     1.0000e+02     1.0000e+03             3.8978e-06        -0.953053383276

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.9101
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8793e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2289
    reference variance = 0.145644
====================================================
  Execution time = 2.8453e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0400e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.0280e-01
  Total weights = 1.957325393e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0270e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268477901738
                                         uncertainty =       0.002383704824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268477901738
                                         uncertainty =       0.002383704824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366402566
  error estimate for blocks of size 2^( 2) =       0.000380094045
  error estimate for blocks of size 2^( 3) =       0.000392853695
  error estimate for blocks of size 2^( 4) =       0.000401762842
  error estimate for blocks of size 2^( 5) =       0.000408147184
  error estimate for blocks of size 2^( 6) =       0.000411199612
  error estimate for blocks of size 2^( 7) =       0.000412850318

      target function =      -0.905299883221
              le_mean =     -17.211855162768
             les_mean =     296.550760768793
             stat err =       0.000408489989
             autocorr =       1.242927572505
   target nu stat err =       0.000408489989
   target dn stat err =       0.024555149182
      target stat err =       0.038932517888
              std dev =       0.518179768392
             le_variance =       0.268510272371


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721185516277e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906974279718       residual = 2.31e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906990642726       residual = 3.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906993337658       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906994393945       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906994332846       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906994172447       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906994246225       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906994591930       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906994786366       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906994887897       residual = 9.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906994949686       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906995014216       residual = 6.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906995109804       residual = 5.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906995223955       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906995245261       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906995266346       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906995291043       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906995317277       residual = 9.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906995339265       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906995367493       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906995365191       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906995363635       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906995370613       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906995379990       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906995389033       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906995411329       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906995426174       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906995419937       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.906995410007       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.906995406564       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.906995419065       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.906995422621       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.906995427122       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906995424101       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906995419588       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.906995419129       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.906995424266       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.906995426113       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.906995430620       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.906995429560       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.906995427055       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.906995427614       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.906995430448       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.906995430860       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.906995429977       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.906995430830       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.906995429250       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.906995429690       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.906995429551       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.906995429814       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.906995430186       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.906995430478       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.906995430060       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.906995429788       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.906995429453       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.906995430068       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.906995429977       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.906995429783       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         57 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+01 is 4.603609e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906974279718       residual = 2.31e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906978373952       residual = 3.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906979047998       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906979312160       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906979296777       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906979256606       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906979275071       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906979361618       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906979410278       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906979435661       residual = 9.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906979451098       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906979467246       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906979491150       residual = 5.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906979519694       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906979525008       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906979530264       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906979536462       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906979543028       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906979548524       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906979555564       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906979554980       residual = 8.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906979554590       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906979556349       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906979558696       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906979560954       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906979566532       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906979570225       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906979568653       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.906979566173       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.906979565324       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.906979568454       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.906979569340       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.906979570458       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906979569699       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906979568572       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.906979568463       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.906979569748       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.906979570210       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.906979571333       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.906979571064       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.906979570441       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.906979570581       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.906979571290       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.906979571392       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.906979571170       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.906979571382       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.906979570988       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.906979571098       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.906979571064       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.906979571130       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.906979571223       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.906979571295       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.906979571191       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.906979571124       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.906979571040       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.906979571193       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.906979571171       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.906979571122       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         57 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+02 is 1.151240e-05

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906974279718       residual = 2.31e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906975303494       residual = 3.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906975472025       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906975538070       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906975534216       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906975524171       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906975528789       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906975550433       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906975562602       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906975568947       residual = 9.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906975572805       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906975576843       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906975582822       residual = 5.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906975589958       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906975591282       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906975592597       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906975594148       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906975595789       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906975597163       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906975598923       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906975598777       residual = 8.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906975598678       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906975599116       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906975599704       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906975600270       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906975601666       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906975602588       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906975602197       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.906975601572       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.906975601361       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.906975602146       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.906975602370       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.906975602644       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906975602457       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906975602172       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.906975602151       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.906975602472       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.906975602587       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.906975602861       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.906975602804       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.906975602641       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.906975602677       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.906975602857       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.906975602876       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.906975602824       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.906975602877       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.906975602782       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.906975602803       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.906975602798       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.906975602814       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.906975602838       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.906975602854       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.906975602825       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.906975602815       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.906975602794       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.906975602832       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.906975602819       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.906975602809       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         57 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+03 is 2.878312e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.618151 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7692e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.044062e-01 1 1  ON 0
  uu_1                 4.988243e-02 1 1  ON 1
  uu_2                -3.713907e-02 1 1  ON 2
  uu_3                -8.925622e-02 1 1  ON 3
  uu_4                -1.214661e-01 1 1  ON 4
  uu_5                -1.310144e-01 1 1  ON 5
  uu_6                -1.134146e-01 1 1  ON 6
  uu_7                -5.305653e-02 1 1  ON 7
  uu_8                 6.790704e-02 1 1  ON 8
  uu_9                 1.227840e-01 1 1  ON 9
  ud_0                 3.008562e-01 1 1  ON 10
  ud_1                 7.519683e-02 1 1  ON 11
  ud_2                -2.260786e-02 1 1  ON 12
  ud_3                -7.408464e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323304e-01 1 1  ON 15
  ud_6                -1.287979e-01 1 1  ON 16
  ud_7                -8.874328e-02 1 1  ON 17
  ud_8                -5.449313e-03 1 1  ON 18
  ud_9                 8.696697e-02 1 1  ON 19
  eO_0                -6.913685e-01 1 1  ON 20
  eO_1                -4.145359e-01 1 1  ON 21
  eO_2                -4.649171e-02 1 1  ON 22
  eO_3                 1.762076e-01 1 1  ON 23
  eO_4                 2.543385e-01 1 1  ON 24
  eO_5                 2.838741e-01 1 1  ON 25
  eO_6                 2.507161e-01 1 1  ON 26
  eO_7                 1.288006e-01 1 1  ON 27
  eO_8                 2.881326e-02 1 1  ON 28
  eO_9                 1.878886e-02 1 1  ON 29
 eH1_0                -1.994317e-01 1 1  ON 30
 eH1_1                -9.607593e-02 1 1  ON 31
 eH1_2                -4.633617e-02 1 1  ON 32
 eH1_3                -1.582655e-02 1 1  ON 33
 eH1_4                 1.718325e-02 1 1  ON 34
 eH1_5                 2.178047e-02 1 1  ON 35
 eH1_6                 7.136218e-02 1 1  ON 36
 eH1_7                 1.074374e-01 1 1  ON 37
 eH1_8                 9.878025e-02 1 1  ON 38
 eH1_9                 2.573755e-02 1 1  ON 39
 eH2_0                -1.994298e-01 1 1  ON 40
 eH2_1                -9.549565e-02 1 1  ON 41
 eH2_2                -4.597730e-02 1 1  ON 42
 eH2_3                -1.559144e-02 1 1  ON 43
 eH2_4                 1.672496e-02 1 1  ON 44
 eH2_5                 1.989304e-02 1 1  ON 45
 eH2_6                 7.051720e-02 1 1  ON 46
 eH2_7                 1.077246e-01 1 1  ON 47
 eH2_8                 1.012766e-01 1 1  ON 48
 eH2_9                 2.801425e-02 1 1  ON 49
ci_001                -4.167479e-02 3 1  ON 50
ci_002                -3.106863e-02 3 1  ON 51
ci_003                -2.590411e-02 3 1  ON 52
ci_004                 2.323449e-02 3 1  ON 53
ci_005                 2.357680e-02 3 1  ON 54
ci_006                -2.037283e-02 3 1  ON 55
ci_007                -2.033982e-02 3 1  ON 56
ci_008                -8.625858e-03 3 1  ON 57
ci_009                -1.515156e-02 3 1  ON 58
ci_010                -9.993505e-03 3 1  ON 59
ci_011                -1.062316e-02 3 1  ON 60
ci_012                -1.048174e-02 3 1  ON 61
ci_013                -1.965432e-02 3 1  ON 62
ci_014                 1.279720e-02 3 1  ON 63
ci_015                 1.247402e-02 3 1  ON 64
ci_016                 1.656510e-02 3 1  ON 65
ci_017                 1.679877e-02 3 1  ON 66
ci_018                 1.019279e-02 3 1  ON 67
ci_019                 1.022622e-02 3 1  ON 68
ci_020                 1.657063e-02 3 1  ON 69
ci_021                 1.630057e-02 3 1  ON 70
ci_022                 9.117926e-03 3 1  ON 71
ci_023                 8.970038e-03 3 1  ON 72
ci_024                 9.525691e-03 3 1  ON 73
ci_025                 9.506656e-03 3 1  ON 74
ci_026                 1.093666e-02 3 1  ON 75
ci_027                 1.083997e-02 3 1  ON 76
ci_028                -1.492216e-02 3 1  ON 77
ci_029                -1.549578e-02 3 1  ON 78
ci_030                -9.014479e-03 3 1  ON 79
ci_031                -9.013068e-03 3 1  ON 80
ci_032                -1.505416e-02 3 1  ON 81
ci_033                 6.491568e-03 3 1  ON 82
ci_034                 6.287925e-03 3 1  ON 83
ci_035                -4.801403e-03 3 1  ON 84
ci_036                -1.209770e-02 3 1  ON 85
ci_037                -1.261835e-02 3 1  ON 86
ci_038                 1.594376e-03 3 1  ON 87
ci_039                 1.665800e-03 3 1  ON 88
ci_040                -2.832607e-03 3 1  ON 89
ci_041                 8.472125e-03 3 1  ON 90
ci_042                 8.502310e-03 3 1  ON 91
ci_043                -3.829355e-03 3 1  ON 92
ci_044                -4.410964e-03 3 1  ON 93
ci_045                -2.917568e-03 3 1  ON 94
ci_046                 5.850116e-03 3 1  ON 95
ci_047                 5.913969e-03 3 1  ON 96
ci_048                -1.327393e-02 3 1  ON 97
ci_049                -1.356034e-02 3 1  ON 98
ci_050                 3.367040e-03 3 1  ON 99
ci_051                 3.291893e-03 3 1  ON 100
ci_052                -2.511814e-03 3 1  ON 101
ci_053                -2.566792e-03 3 1  ON 102
ci_054                -2.551402e-03 3 1  ON 103
ci_055                -2.591674e-03 3 1  ON 104
ci_056                 5.110813e-03 3 1  ON 105
ci_057                 5.099758e-03 3 1  ON 106
ci_058                -1.762862e-03 3 1  ON 107
ci_059                -2.022973e-03 3 1  ON 108
ci_060                 5.596076e-03 3 1  ON 109
ci_061                 5.389738e-03 3 1  ON 110
ci_062                -3.961381e-03 3 1  ON 111
ci_063                -4.104066e-03 3 1  ON 112
ci_064                -3.324914e-03 3 1  ON 113
ci_065                -4.230843e-03 3 1  ON 114
ci_066                 4.486464e-03 3 1  ON 115
ci_067                 4.352368e-03 3 1  ON 116
ci_068                -5.028957e-03 3 1  ON 117
ci_069                -4.831579e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2563
    reference variance = 0.19517
====================================================
  Execution time = 2.8352e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7582e-01
  Total weights = 1.9575e+06
  Execution time = 2.4835e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264536623062
                                         uncertainty =       0.001560098687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264536623062
                                         uncertainty =       0.001560098687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363727473
  error estimate for blocks of size 2^( 2) =       0.000377767527
  error estimate for blocks of size 2^( 3) =       0.000390870550
  error estimate for blocks of size 2^( 4) =       0.000400167719
  error estimate for blocks of size 2^( 5) =       0.000407267353
  error estimate for blocks of size 2^( 6) =       0.000410127780
  error estimate for blocks of size 2^( 7) =       0.000411962182

      target function =      -0.951956457136
              le_mean =     -17.211827336515
             les_mean =     296.522811447844
             stat err =       0.000407381258
             autocorr =       1.254439959763
   target nu stat err =       0.000407381258
   target dn stat err =       0.002000470449
      target stat err =       0.003579103020
              std dev =       0.514396555546
             le_variance =       0.264603816357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264535827729
                                         uncertainty =       0.001559988041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264535827729
                                         uncertainty =       0.001559988041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363726944
  error estimate for blocks of size 2^( 2) =       0.000377767903
  error estimate for blocks of size 2^( 3) =       0.000390871737
  error estimate for blocks of size 2^( 4) =       0.000400169767
  error estimate for blocks of size 2^( 5) =       0.000407269883
  error estimate for blocks of size 2^( 6) =       0.000410130407
  error estimate for blocks of size 2^( 7) =       0.000411964652

      target function =      -0.951920624760
              le_mean =     -17.211827231218
             les_mean =     296.522828302539
             stat err =       0.000407383677
             autocorr =       1.254458508498
   target nu stat err =       0.000407383677
   target dn stat err =       0.002001080149
      target stat err =       0.003579882733
              std dev =       0.514395806670
             le_variance =       0.264603045920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264536221794
                                         uncertainty =       0.001560043331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264536221794
                                         uncertainty =       0.001560043331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363727206
  error estimate for blocks of size 2^( 2) =       0.000377767713
  error estimate for blocks of size 2^( 3) =       0.000390871141
  error estimate for blocks of size 2^( 4) =       0.000400168742
  error estimate for blocks of size 2^( 5) =       0.000407268617
  error estimate for blocks of size 2^( 6) =       0.000410129092
  error estimate for blocks of size 2^( 7) =       0.000411963416

      target function =      -0.951939596701
              le_mean =     -17.211827283324
             les_mean =     296.522819253032
             stat err =       0.000407382466
             autocorr =       1.254449243177
   target nu stat err =       0.000407382466
   target dn stat err =       0.002000747067
      target stat err =       0.003579452356
              std dev =       0.514396177618
             le_variance =       0.264603427548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264536572521
                                         uncertainty =       0.001560091766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264536572521
                                         uncertainty =       0.001560091766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363727439
  error estimate for blocks of size 2^( 2) =       0.000377767550
  error estimate for blocks of size 2^( 3) =       0.000390870623
  error estimate for blocks of size 2^( 4) =       0.000400167847
  error estimate for blocks of size 2^( 5) =       0.000407267511
  error estimate for blocks of size 2^( 6) =       0.000410127944
  error estimate for blocks of size 2^( 7) =       0.000411962336

      target function =      -0.951954694307
              le_mean =     -17.211827329793
             les_mean =     296.522812223930
             stat err =       0.000407381409
             autocorr =       1.254441121073
   target nu stat err =       0.000407381409
   target dn stat err =       0.002000502454
      target stat err =       0.003579144823
              std dev =       0.514396507934
             le_variance =       0.264603767374


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951956457136        initial  <--
     6.2500e+01     6.2500e+02             4.6036e-05        -0.951920624760
     2.5000e+02     2.5000e+03             1.1512e-05        -0.951939596701
     1.0000e+03     1.0000e+04             2.8783e-06        -0.951954694307

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8835
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8583e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1267
    reference variance = 0.232565
====================================================
  Execution time = 2.8554e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0396e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7778e-01
  Total weights = 1.957769297e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9444e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265308478429
                                         uncertainty =       0.001240182352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265308478429
                                         uncertainty =       0.001240182352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364278248
  error estimate for blocks of size 2^( 2) =       0.000378431123
  error estimate for blocks of size 2^( 3) =       0.000391398348
  error estimate for blocks of size 2^( 4) =       0.000400665337
  error estimate for blocks of size 2^( 5) =       0.000405382765
  error estimate for blocks of size 2^( 6) =       0.000408692373
  error estimate for blocks of size 2^( 7) =       0.000410065713

      target function =      -0.948525085898
              le_mean =     -17.212014419005
             les_mean =     296.531215643266
             stat err =       0.000406201547
             autocorr =       1.243416617447
   target nu stat err =       0.000406201547
   target dn stat err =       0.002113804638
      target stat err =       0.003747539241
              std dev =       0.515175481659
             le_variance =       0.265405776902


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721201441900e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948538849102       residual = 8.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948538911921       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948538925242       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948538929478       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948538930394       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948538930720       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948538931514       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948538931674       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948538931717       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948538932134       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948538932225       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948538932633       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948538932280       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948538932617       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948538932688       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948538932748       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948538932948       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948538932942       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948538932875       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948538932805       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948538933068       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948538933004       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948538932936       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948538933071       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948538933197       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.948538933292       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.948538933373       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.948538933419       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.948538933338       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.948538933420       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.948538933425       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.948538933429       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.948538933449       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.948538933505       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.948538933487       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.948538933441       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.948538933454       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948538933474       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.948538933460       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.948538933470       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.948538933463       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.948538933455       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.948538933452       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.948538933444       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+02 is 6.094590e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948538849102       residual = 8.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948538864809       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948538868139       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948538869198       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948538869428       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948538869502       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948538869709       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948538869749       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948538869753       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948538869860       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948538869879       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948538869983       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948538869903       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948538869983       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948538869999       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948538870015       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948538870060       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948538870062       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948538870044       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948538870030       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948538870096       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948538870082       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948538870063       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948538870116       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948538870117       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.948538870151       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.948538870170       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.948538870184       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.948538870163       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.948538870188       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.948538870183       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.948538870184       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.948538870193       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.948538870199       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.948538870194       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.948538870189       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.948538870189       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948538870204       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.948538870197       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.948538870200       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.948538870180       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.948538870202       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.948538870193       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.948538870196       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+03 is 1.523663e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948538849102       residual = 8.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948538853029       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948538853862       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948538854126       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948538854189       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948538854221       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948538854257       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948538854265       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948538854256       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948538854313       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948538854294       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948538854323       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948538854271       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948538854319       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948538854340       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948538854322       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948538854374       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948538854357       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948538854348       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948538854333       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948538854339       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948538854333       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948538854346       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948538854397       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948538854387       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.948538854391       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.948538854377       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.948538854372       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.948538854367       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.948538854413       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.948538854388       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.948538854413       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.948538854394       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.948538854401       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.948538854382       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.948538854384       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.948538854370       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948538854351       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.948538854352       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.948538854336       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.948538854369       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.948538854359       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.948538854384       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.948538854354       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+04 is 3.809166e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.710079 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7598e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.044050e-01 1 1  ON 0
  uu_1                 4.988175e-02 1 1  ON 1
  uu_2                -3.713954e-02 1 1  ON 2
  uu_3                -8.925705e-02 1 1  ON 3
  uu_4                -1.214675e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305416e-02 1 1  ON 7
  uu_8                 6.790950e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008593e-01 1 1  ON 10
  ud_1                 7.519897e-02 1 1  ON 11
  ud_2                -2.260587e-02 1 1  ON 12
  ud_3                -7.408312e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323340e-01 1 1  ON 15
  ud_6                -1.288012e-01 1 1  ON 16
  ud_7                -8.874480e-02 1 1  ON 17
  ud_8                -5.449393e-03 1 1  ON 18
  ud_9                 8.696729e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648907e-02 1 1  ON 22
  eO_3                 1.762132e-01 1 1  ON 23
  eO_4                 2.543432e-01 1 1  ON 24
  eO_5                 2.838625e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287994e-01 1 1  ON 27
  eO_8                 2.881320e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607908e-02 1 1  ON 31
 eH1_2                -4.633836e-02 1 1  ON 32
 eH1_3                -1.582881e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178433e-02 1 1  ON 35
 eH1_6                 7.136804e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877948e-02 1 1  ON 38
 eH1_9                 2.573742e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549586e-02 1 1  ON 41
 eH2_2                -4.597775e-02 1 1  ON 42
 eH2_3                -1.559000e-02 1 1  ON 43
 eH2_4                 1.672827e-02 1 1  ON 44
 eH2_5                 1.989115e-02 1 1  ON 45
 eH2_6                 7.051386e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012760e-01 1 1  ON 48
 eH2_9                 2.801406e-02 1 1  ON 49
ci_001                -4.167674e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590534e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357500e-02 3 1  ON 54
ci_006                -2.037304e-02 3 1  ON 55
ci_007                -2.033926e-02 3 1  ON 56
ci_008                -8.626070e-03 3 1  ON 57
ci_009                -1.515171e-02 3 1  ON 58
ci_010                -9.992059e-03 3 1  ON 59
ci_011                -1.062329e-02 3 1  ON 60
ci_012                -1.048231e-02 3 1  ON 61
ci_013                -1.965357e-02 3 1  ON 62
ci_014                 1.279741e-02 3 1  ON 63
ci_015                 1.247329e-02 3 1  ON 64
ci_016                 1.656525e-02 3 1  ON 65
ci_017                 1.680071e-02 3 1  ON 66
ci_018                 1.019201e-02 3 1  ON 67
ci_019                 1.022630e-02 3 1  ON 68
ci_020                 1.657115e-02 3 1  ON 69
ci_021                 1.630061e-02 3 1  ON 70
ci_022                 9.118019e-03 3 1  ON 71
ci_023                 8.970020e-03 3 1  ON 72
ci_024                 9.525512e-03 3 1  ON 73
ci_025                 9.507832e-03 3 1  ON 74
ci_026                 1.093618e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492234e-02 3 1  ON 77
ci_029                -1.549463e-02 3 1  ON 78
ci_030                -9.015615e-03 3 1  ON 79
ci_031                -9.013483e-03 3 1  ON 80
ci_032                -1.505409e-02 3 1  ON 81
ci_033                 6.493622e-03 3 1  ON 82
ci_034                 6.287890e-03 3 1  ON 83
ci_035                -4.802665e-03 3 1  ON 84
ci_036                -1.209837e-02 3 1  ON 85
ci_037                -1.261897e-02 3 1  ON 86
ci_038                 1.593960e-03 3 1  ON 87
ci_039                 1.666205e-03 3 1  ON 88
ci_040                -2.832433e-03 3 1  ON 89
ci_041                 8.471447e-03 3 1  ON 90
ci_042                 8.502124e-03 3 1  ON 91
ci_043                -3.829348e-03 3 1  ON 92
ci_044                -4.411309e-03 3 1  ON 93
ci_045                -2.917629e-03 3 1  ON 94
ci_046                 5.850005e-03 3 1  ON 95
ci_047                 5.913921e-03 3 1  ON 96
ci_048                -1.327415e-02 3 1  ON 97
ci_049                -1.356129e-02 3 1  ON 98
ci_050                 3.367175e-03 3 1  ON 99
ci_051                 3.292128e-03 3 1  ON 100
ci_052                -2.511605e-03 3 1  ON 101
ci_053                -2.567108e-03 3 1  ON 102
ci_054                -2.551886e-03 3 1  ON 103
ci_055                -2.591192e-03 3 1  ON 104
ci_056                 5.110865e-03 3 1  ON 105
ci_057                 5.100221e-03 3 1  ON 106
ci_058                -1.763471e-03 3 1  ON 107
ci_059                -2.023352e-03 3 1  ON 108
ci_060                 5.598422e-03 3 1  ON 109
ci_061                 5.390360e-03 3 1  ON 110
ci_062                -3.961602e-03 3 1  ON 111
ci_063                -4.104255e-03 3 1  ON 112
ci_064                -3.324936e-03 3 1  ON 113
ci_065                -4.231094e-03 3 1  ON 114
ci_066                 4.486506e-03 3 1  ON 115
ci_067                 4.352196e-03 3 1  ON 116
ci_068                -5.028839e-03 3 1  ON 117
ci_069                -4.831805e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1355
    reference variance = 0.322669
====================================================
  Execution time = 2.8245e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8338e-01
  Total weights = 1.9576e+06
  Execution time = 2.4807e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268338982842
                                         uncertainty =       0.001780984839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268338982842
                                         uncertainty =       0.001780984839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366269992
  error estimate for blocks of size 2^( 2) =       0.000379769207
  error estimate for blocks of size 2^( 3) =       0.000392426417
  error estimate for blocks of size 2^( 4) =       0.000401952523
  error estimate for blocks of size 2^( 5) =       0.000407592593
  error estimate for blocks of size 2^( 6) =       0.000409658649
  error estimate for blocks of size 2^( 7) =       0.000411919340

      target function =      -0.938852032928
              le_mean =     -17.211751171128
             les_mean =     296.527760618915
             stat err =       0.000407780776
             autocorr =       1.239512235578
   target nu stat err =       0.000407780776
   target dn stat err =       0.004301960788
      target stat err =       0.007357174251
              std dev =       0.517992278369
             le_variance =       0.268316000450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268338967578
                                         uncertainty =       0.001780970651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268338967578
                                         uncertainty =       0.001780970651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366269982
  error estimate for blocks of size 2^( 2) =       0.000379769235
  error estimate for blocks of size 2^( 3) =       0.000392426486
  error estimate for blocks of size 2^( 4) =       0.000401952624
  error estimate for blocks of size 2^( 5) =       0.000407592718
  error estimate for blocks of size 2^( 6) =       0.000409658781
  error estimate for blocks of size 2^( 7) =       0.000411919469

      target function =      -0.938851043547
              le_mean =     -17.211751169955
             les_mean =     296.527761160197
             stat err =       0.000407780898
             autocorr =       1.239513043331
   target nu stat err =       0.000407780898
   target dn stat err =       0.004301954600
      target stat err =       0.007357148350
              std dev =       0.517992263710
             le_variance =       0.268315985263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268338975208
                                         uncertainty =       0.001780977744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268338975208
                                         uncertainty =       0.001780977744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366269987
  error estimate for blocks of size 2^( 2) =       0.000379769221
  error estimate for blocks of size 2^( 3) =       0.000392426451
  error estimate for blocks of size 2^( 4) =       0.000401952574
  error estimate for blocks of size 2^( 5) =       0.000407592656
  error estimate for blocks of size 2^( 6) =       0.000409658715
  error estimate for blocks of size 2^( 7) =       0.000411919404

      target function =      -0.938851542403
              le_mean =     -17.211751170541
             les_mean =     296.527760887095
             stat err =       0.000407780837
             autocorr =       1.239512639482
   target nu stat err =       0.000407780837
   target dn stat err =       0.004301957672
      target stat err =       0.007357161329
              std dev =       0.517992271037
             le_variance =       0.268315992854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268338981888
                                         uncertainty =       0.001780983952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268338981888
                                         uncertainty =       0.001780983952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366269992
  error estimate for blocks of size 2^( 2) =       0.000379769208
  error estimate for blocks of size 2^( 3) =       0.000392426421
  error estimate for blocks of size 2^( 4) =       0.000401952530
  error estimate for blocks of size 2^( 5) =       0.000407592601
  error estimate for blocks of size 2^( 6) =       0.000409658657
  error estimate for blocks of size 2^( 7) =       0.000411919348

      target function =      -0.938851972065
              le_mean =     -17.211751171055
             les_mean =     296.527760652170
             stat err =       0.000407780784
             autocorr =       1.239512286074
   target nu stat err =       0.000407780784
   target dn stat err =       0.004301960396
      target stat err =       0.007357172639
              std dev =       0.517992277452
             le_variance =       0.268315999500


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938852032928        initial  <--
     6.2500e+02     6.2500e+03             6.0946e-07        -0.938851043547
     2.5000e+03     2.5000e+04             1.5237e-07        -0.938851542403
     1.0000e+04     1.0000e+05             3.8092e-08        -0.938851972065

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7895
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8394e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2308
    reference variance = 0.353581
====================================================
  Execution time = 2.8506e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0384e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8913e-01
  Total weights = 1.957349806e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9129e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270133112525
                                         uncertainty =       0.002216272064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270133112525
                                         uncertainty =       0.002216272064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367487636
  error estimate for blocks of size 2^( 2) =       0.000381006350
  error estimate for blocks of size 2^( 3) =       0.000393656421
  error estimate for blocks of size 2^( 4) =       0.000402765487
  error estimate for blocks of size 2^( 5) =       0.000408093314
  error estimate for blocks of size 2^( 6) =       0.000411187280
  error estimate for blocks of size 2^( 7) =       0.000413880632

      target function =      -0.929071920116
              le_mean =     -17.211741466884
             les_mean =     296.533174655313
             stat err =       0.000408981678
             autocorr =       1.238574803455
   target nu stat err =       0.000408981678
   target dn stat err =       0.007267811553
      target stat err =       0.012133456956
              std dev =       0.519714314572
             le_variance =       0.270102968771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721174146688e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929228555497       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929228568672       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929228571211       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929228572478       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929228573209       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929228573645       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929228573928       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929228574069       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929228574287       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929228574451       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929228574463       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929228574474       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929228574483       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929228574531       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929228574518       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929228574617       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929228574576       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929228574583       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929228574617       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929228574637       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929228574639       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929228574673       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929228574643       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929228574660       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929228574659       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929228574668       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929228574666       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929228574710       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929228574698       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929228574680       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929228574694       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929228574698       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929228574676       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929228574691       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929228574694       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929228574717       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929228574695       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929228574691       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929228574695       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929228574701       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929228574714       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929228574716       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929228574687       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929228574685       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929228574694       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.929228574684       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         45 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+03 is 7.322775e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929228555497       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929228558790       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929228559425       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929228559737       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929228559964       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929228560070       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929228560137       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929228560119       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929228560179       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929228560250       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929228560280       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929228560241       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929228560210       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929228560127       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929228560257       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929228560288       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929228560253       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929228560297       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929228560278       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929228560306       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929228560288       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929228560283       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929228560296       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929228560252       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929228560321       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929228560369       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929228560290       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929228560262       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929228560281       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929228560161       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929228560240       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929228560372       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929228560279       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929228560290       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929228560357       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929228560138       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929228560328       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929228560291       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929228560126       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929228560374       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929228560443       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929228560257       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929228560320       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929228560307       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929228560347       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.929228560283       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         45 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+04 is 1.830708e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929228555497       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929228556320       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929228556479       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929228556558       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929228556615       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929228556617       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929228556649       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929228556658       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929228556725       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929228556774       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929228557029       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929228556653       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929228556683       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929228556819       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929228556571       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929228556695       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929228556653       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929228557071       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929228556618       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929228556649       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929228556757       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929228556898       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929228556922       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929228556850       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929228556770       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929228556510       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929228556573       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929228556960       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929228556587       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929228556620       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929228556796       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929228556721       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929228556529       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929228556503       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929228556826       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929228556286       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929228556583       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929228556963       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929228556878       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929228556227       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929228556749       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929228557120       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929228555570       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929228556518       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929228556563       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.929228556857       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         45 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+05 is 4.576777e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.813991 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7530e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.044050e-01 1 1  ON 0
  uu_1                 4.988173e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925707e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305415e-02 1 1  ON 7
  uu_8                 6.790964e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008593e-01 1 1  ON 10
  ud_1                 7.519902e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323340e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874486e-02 1 1  ON 17
  ud_8                -5.449383e-03 1 1  ON 18
  ud_9                 8.696730e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838625e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633838e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718276e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136810e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590537e-02 3 1  ON 52
ci_004                 2.323289e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992097e-03 3 1  ON 59
ci_011                -1.062330e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118010e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507854e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015631e-03 3 1  ON 79
ci_031                -9.013497e-03 3 1  ON 80
ci_032                -1.505409e-02 3 1  ON 81
ci_033                 6.493639e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802658e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593975e-03 3 1  ON 87
ci_039                 1.666217e-03 3 1  ON 88
ci_040                -2.832429e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502114e-03 3 1  ON 91
ci_043                -3.829356e-03 3 1  ON 92
ci_044                -4.411382e-03 3 1  ON 93
ci_045                -2.917642e-03 3 1  ON 94
ci_046                 5.850017e-03 3 1  ON 95
ci_047                 5.913924e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367174e-03 3 1  ON 99
ci_051                 3.292134e-03 3 1  ON 100
ci_052                -2.511626e-03 3 1  ON 101
ci_053                -2.567108e-03 3 1  ON 102
ci_054                -2.551871e-03 3 1  ON 103
ci_055                -2.591187e-03 3 1  ON 104
ci_056                 5.110880e-03 3 1  ON 105
ci_057                 5.100231e-03 3 1  ON 106
ci_058                -1.763477e-03 3 1  ON 107
ci_059                -2.023353e-03 3 1  ON 108
ci_060                 5.598438e-03 3 1  ON 109
ci_061                 5.390357e-03 3 1  ON 110
ci_062                -3.961622e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324936e-03 3 1  ON 113
ci_065                -4.231093e-03 3 1  ON 114
ci_066                 4.486493e-03 3 1  ON 115
ci_067                 4.352207e-03 3 1  ON 116
ci_068                -5.028856e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.243
    reference variance = 0.15206
====================================================
  Execution time = 2.8021e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7926e-01
  Total weights = 1.9575e+06
  Execution time = 2.4805e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268250739589
                                         uncertainty =       0.001684220233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268250739589
                                         uncertainty =       0.001684220233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366262716
  error estimate for blocks of size 2^( 2) =       0.000379878924
  error estimate for blocks of size 2^( 3) =       0.000392477833
  error estimate for blocks of size 2^( 4) =       0.000401674940
  error estimate for blocks of size 2^( 5) =       0.000407683541
  error estimate for blocks of size 2^( 6) =       0.000409951229
  error estimate for blocks of size 2^( 7) =       0.000412912599

      target function =      -0.945963765939
              le_mean =     -17.211756560910
             les_mean =     296.523822360279
             stat err =       0.000408055577
             autocorr =       1.241232715867
   target nu stat err =       0.000408055577
   target dn stat err =       0.002170520021
      target stat err =       0.003822587976
              std dev =       0.517981987295
             le_variance =       0.268305339162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268250746722
                                         uncertainty =       0.001684220008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268250746722
                                         uncertainty =       0.001684220008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366262720
  error estimate for blocks of size 2^( 2) =       0.000379878932
  error estimate for blocks of size 2^( 3) =       0.000392477845
  error estimate for blocks of size 2^( 4) =       0.000401674954
  error estimate for blocks of size 2^( 5) =       0.000407683557
  error estimate for blocks of size 2^( 6) =       0.000409951246
  error estimate for blocks of size 2^( 7) =       0.000412912618

      target function =      -0.945963742893
              le_mean =     -17.211756560535
             les_mean =     296.523822360749
             stat err =       0.000408055594
             autocorr =       1.241232783515
   target nu stat err =       0.000408055594
   target dn stat err =       0.002170517810
      target stat err =       0.003822584050
              std dev =       0.517981994150
             le_variance =       0.268305346263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268250743155
                                         uncertainty =       0.001684220120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268250743155
                                         uncertainty =       0.001684220120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366262718
  error estimate for blocks of size 2^( 2) =       0.000379878928
  error estimate for blocks of size 2^( 3) =       0.000392477839
  error estimate for blocks of size 2^( 4) =       0.000401674947
  error estimate for blocks of size 2^( 5) =       0.000407683549
  error estimate for blocks of size 2^( 6) =       0.000409951237
  error estimate for blocks of size 2^( 7) =       0.000412912608

      target function =      -0.945963754420
              le_mean =     -17.211756560722
             les_mean =     296.523822360511
             stat err =       0.000408055585
             autocorr =       1.241232749702
   target nu stat err =       0.000408055585
   target dn stat err =       0.002170518915
      target stat err =       0.003822586013
              std dev =       0.517981990722
             le_variance =       0.268305342712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268250740035
                                         uncertainty =       0.001684220219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268250740035
                                         uncertainty =       0.001684220219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366262716
  error estimate for blocks of size 2^( 2) =       0.000379878924
  error estimate for blocks of size 2^( 3) =       0.000392477834
  error estimate for blocks of size 2^( 4) =       0.000401674941
  error estimate for blocks of size 2^( 5) =       0.000407683542
  error estimate for blocks of size 2^( 6) =       0.000409951230
  error estimate for blocks of size 2^( 7) =       0.000412912600

      target function =      -0.945963764500
              le_mean =     -17.211756560886
             les_mean =     296.523822360308
             stat err =       0.000408055578
             autocorr =       1.241232720112
   target nu stat err =       0.000408055578
   target dn stat err =       0.002170519883
      target stat err =       0.003822587731
              std dev =       0.517981987723
             le_variance =       0.268305339606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945963765939        initial  <--
     6.2500e+03     6.2500e+04             7.3228e-08        -0.945963742893
     2.5000e+04     2.5000e+05             1.8307e-08        -0.945963754420
     1.0000e+05     1.0000e+06             4.5768e-09        -0.945963764500

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.5579
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8096e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2104
    reference variance = 0.193878
====================================================
  Execution time = 3.0470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0406e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7855e-01
  Total weights = 1.957758279e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6671e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267346388718
                                         uncertainty =       0.001460654700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267346388718
                                         uncertainty =       0.001460654700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365606927
  error estimate for blocks of size 2^( 2) =       0.000379195945
  error estimate for blocks of size 2^( 3) =       0.000392010366
  error estimate for blocks of size 2^( 4) =       0.000401664207
  error estimate for blocks of size 2^( 5) =       0.000407480319
  error estimate for blocks of size 2^( 6) =       0.000410291144
  error estimate for blocks of size 2^( 7) =       0.000412245983

      target function =      -0.947168388118
              le_mean =     -17.212256801738
             les_mean =     296.540334989498
             stat err =       0.000407920413
             autocorr =       1.244864398757
   target nu stat err =       0.000407920413
   target dn stat err =       0.002295528395
      target stat err =       0.004048578223
              std dev =       0.517054547222
             le_variance =       0.267345404803


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721225680174e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947184673463       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947184674438       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947184674608       residual = 8.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947184674638       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947184674650       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947184674672       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947184674709       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947184674796       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947184674661       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947184674707       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947184674583       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947184674619       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947184674620       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947184674632       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947184674645       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947184674680       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947184674883       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947184674689       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947184674686       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947184674777       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947184674410       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947184674833       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947184674837       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947184674657       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947184674869       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947184674576       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947184674710       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947184674726       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947184674694       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947184674890       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947184674678       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947184674751       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947184674541       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947184674904       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947184674526       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947184674452       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947184674712       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947184674737       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947184674625       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947184674535       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947184674640       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947184674923       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947184674585       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947184674555       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+04 is 6.490673e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947184673463       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947184673707       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947184673749       residual = 8.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947184673762       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947184673513       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947184674090       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947184673529       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947184673462       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947184673734       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947184673795       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947184673683       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947184673821       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947184674404       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947184674040       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947184673988       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947184674047       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947184673375       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947184674106       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947184674350       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947184673914       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947184673859       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947184674196       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947184673614       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947184673830       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947184673720       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947184673659       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947184673567       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947184673171       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947184673139       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947184673380       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947184673795       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947184674356       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947184673397       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947184673014       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947184674120       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947184674071       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947184674188       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947184673601       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947184674076       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947184674260       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947184673567       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947184673000       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947184674505       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947184674288       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+05 is 1.622669e-09

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947184673463       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947184673524       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947184673534       residual = 8.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947184673534       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947184673538       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947184673725       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947184673987       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947184674533       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947184670531       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947184673027       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947184674315       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947184672040       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947184673900       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947184673348       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947184673380       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947184675172       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947184675290       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947184671559       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947184672175       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947184671820       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947184672171       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947184674365       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947184677042       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947184672304       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947184671440       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947184675502       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947184671658       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947184676766       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947184674155       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947184676929       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947184672460       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947184672510       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947184673598       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947184674213       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947184675911       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947184673617       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947184674009       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947184674000       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947184670231       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947184671364       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947184670430       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947184672324       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947184670485       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947184677355       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+06 is 4.056674e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.906471 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9237e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449382e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582885e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992094e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525538e-03 3 1  ON 73
ci_025                 9.507855e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802662e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471459e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591185e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352207e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2757
    reference variance = 0.166285
====================================================
  Execution time = 2.8100e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7813e-01
  Total weights = 1.9575e+06
  Execution time = 2.5074e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266296838435
                                         uncertainty =       0.001449975081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266296838435
                                         uncertainty =       0.001449975081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364969981
  error estimate for blocks of size 2^( 2) =       0.000378707405
  error estimate for blocks of size 2^( 3) =       0.000391473326
  error estimate for blocks of size 2^( 4) =       0.000400145048
  error estimate for blocks of size 2^( 5) =       0.000405936284
  error estimate for blocks of size 2^( 6) =       0.000406886458
  error estimate for blocks of size 2^( 7) =       0.000409106902

      target function =      -0.947914285682
              le_mean =     -17.211574880933
             les_mean =     296.516440564339
             stat err =       0.000405518673
             autocorr =       1.234546417538
   target nu stat err =       0.000405518673
   target dn stat err =       0.002662505689
      target stat err =       0.004675712702
              std dev =       0.516153755595
             le_variance =       0.266414699415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266296838048
                                         uncertainty =       0.001449975135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266296838048
                                         uncertainty =       0.001449975135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364969981
  error estimate for blocks of size 2^( 2) =       0.000378707405
  error estimate for blocks of size 2^( 3) =       0.000391473326
  error estimate for blocks of size 2^( 4) =       0.000400145048
  error estimate for blocks of size 2^( 5) =       0.000405936284
  error estimate for blocks of size 2^( 6) =       0.000406886459
  error estimate for blocks of size 2^( 7) =       0.000409106902

      target function =      -0.947914285412
              le_mean =     -17.211574880937
             les_mean =     296.516440564645
             stat err =       0.000405518673
             autocorr =       1.234546422142
   target nu stat err =       0.000405518673
   target dn stat err =       0.002662505859
      target stat err =       0.004675712990
              std dev =       0.516153755207
             le_variance =       0.266414699015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266296838241
                                         uncertainty =       0.001449975108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266296838241
                                         uncertainty =       0.001449975108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364969981
  error estimate for blocks of size 2^( 2) =       0.000378707405
  error estimate for blocks of size 2^( 3) =       0.000391473326
  error estimate for blocks of size 2^( 4) =       0.000400145048
  error estimate for blocks of size 2^( 5) =       0.000405936284
  error estimate for blocks of size 2^( 6) =       0.000406886459
  error estimate for blocks of size 2^( 7) =       0.000409106902

      target function =      -0.947914285548
              le_mean =     -17.211574880935
             les_mean =     296.516440564491
             stat err =       0.000405518673
             autocorr =       1.234546419833
   target nu stat err =       0.000405518673
   target dn stat err =       0.002662505774
      target stat err =       0.004675712846
              std dev =       0.516153755401
             le_variance =       0.266414699215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266296838411
                                         uncertainty =       0.001449975084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266296838411
                                         uncertainty =       0.001449975084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364969981
  error estimate for blocks of size 2^( 2) =       0.000378707405
  error estimate for blocks of size 2^( 3) =       0.000391473326
  error estimate for blocks of size 2^( 4) =       0.000400145048
  error estimate for blocks of size 2^( 5) =       0.000405936284
  error estimate for blocks of size 2^( 6) =       0.000406886458
  error estimate for blocks of size 2^( 7) =       0.000409106902

      target function =      -0.947914285666
              le_mean =     -17.211574880933
             les_mean =     296.516440564358
             stat err =       0.000405518673
             autocorr =       1.234546417817
   target nu stat err =       0.000405518673
   target dn stat err =       0.002662505700
      target stat err =       0.004675712720
              std dev =       0.516153755571
             le_variance =       0.266414699390


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947914285682        initial  <--
     6.2500e+04     6.2500e+05             6.4907e-09        -0.947914285412
     2.5000e+05     2.5000e+06             1.6227e-09        -0.947914285548
     1.0000e+06     1.0000e+07             4.0567e-10        -0.947914285666

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.6976
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9941e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1926
    reference variance = 0.133863
====================================================
  Execution time = 2.8483e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0380e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7915e-01
  Total weights = 1.957208520e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5635e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268204364116
                                         uncertainty =       0.001568647241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268204364116
                                         uncertainty =       0.001568647241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366171689
  error estimate for blocks of size 2^( 2) =       0.000379911290
  error estimate for blocks of size 2^( 3) =       0.000392307543
  error estimate for blocks of size 2^( 4) =       0.000402070781
  error estimate for blocks of size 2^( 5) =       0.000408181154
  error estimate for blocks of size 2^( 6) =       0.000410435559
  error estimate for blocks of size 2^( 7) =       0.000413831071

      target function =      -0.946156015992
              le_mean =     -17.211827789265
             les_mean =     296.526162877140
             stat err =       0.000408629641
             autocorr =       1.245346504148
   target nu stat err =       0.000408629641
   target dn stat err =       0.001995159159
      target stat err =       0.003528081471
              std dev =       0.517853254312
             le_variance =       0.268171993001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721182778927e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946168074009       residual = 8.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946168074066       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946168074074       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946168074077       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946168074245       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946168073771       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946168073075       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946168074361       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946168073287       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946168073347       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946168074080       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946168074664       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946168073372       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946168073877       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946168074115       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946168074998       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946168074795       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946168074185       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946168074753       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946168072906       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946168074119       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946168074413       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946168076132       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946168074159       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946168073725       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.946168074082       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.946168071836       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.946168074535       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.946168074454       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.946168073239       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.946168071680       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.946168075384       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.946168075517       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.946168072605       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.946168072383       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.946168073790       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.946168074293       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.946168074558       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.946168073303       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.946168072020       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.946168073221       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.946168073328       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.946168074166       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.946168073144       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.946168072987       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.946168073562       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.946168074576       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.946168073758       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+05 is 6.120026e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946168074009       residual = 8.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946168074023       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946168074025       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946168074026       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946168074652       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946168074026       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946168074026       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946168075045       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946168070447       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946168074027       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946168074027       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946168076754       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946168073819       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946168083001       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946168076336       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946168074027       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946168067541       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946168072825       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946168067420       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946168078401       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946168073936       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946168077054       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946168069900       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946168079467       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946168073875       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.946168077586       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.946168071302       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.946168078637       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.946168067471       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.946168070968       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.946168070292       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.946168078212       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.946168061398       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.946168071764       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.946168064145       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.946168071522       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.946168088599       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.946168078875       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.946168072676       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.946168068589       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.946168074237       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.946168087239       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.946168079255       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.946168075603       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.946168075188       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.946168063688       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.946168082942       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.946168073349       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+06 is 1.530007e-10

solving harmonic davidson linear method for identity shift 1.0000e+07, overlap shift 1.0000e+08 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946168074009       residual = 8.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946168074013       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946168074013       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946168074013       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946168074013       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946168074013       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946168074013       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946168074013       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946168074013       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946168074013       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946168088286       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946168074014       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946168060172       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946168074014       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946168068018       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946168095715       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946168098622       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946168086656       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946168076596       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946168089917       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946168065825       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946168082627       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946168084290       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946168094320       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946168089258       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.946168086467       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.946168085937       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.946168061824       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.946168087061       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.946168090296       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.946168067643       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.946168087242       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.946168068347       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.946168061650       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.946168109670       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.946168073665       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.946168041224       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.946167987645       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.946168031304       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.946168036695       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.946168060186       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.946168047671       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.946168028066       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.946168094807       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.946168035150       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.946168093063       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.946168032892       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.946168081233       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+07 is 3.824989e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.023340 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7170e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502117e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1166
    reference variance = 0.253454
====================================================
  Execution time = 2.8244e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8153e-01
  Total weights = 1.9574e+06
  Execution time = 2.5089e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268614133033
                                         uncertainty =       0.002008212254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268614133033
                                         uncertainty =       0.002008212254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366447473
  error estimate for blocks of size 2^( 2) =       0.000380258503
  error estimate for blocks of size 2^( 3) =       0.000392990814
  error estimate for blocks of size 2^( 4) =       0.000401847211
  error estimate for blocks of size 2^( 5) =       0.000406396107
  error estimate for blocks of size 2^( 6) =       0.000408925822
  error estimate for blocks of size 2^( 7) =       0.000411016816

      target function =      -0.942035457176
              le_mean =     -17.211932797115
             les_mean =     296.532156933007
             stat err =       0.000407046489
             autocorr =       1.233856245337
   target nu stat err =       0.000407046489
   target dn stat err =       0.003305279247
      target stat err =       0.005712314114
              std dev =       0.518243278138
             le_variance =       0.268576095335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268614132990
                                         uncertainty =       0.002008212247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268614132990
                                         uncertainty =       0.002008212247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366447473
  error estimate for blocks of size 2^( 2) =       0.000380258503
  error estimate for blocks of size 2^( 3) =       0.000392990814
  error estimate for blocks of size 2^( 4) =       0.000401847211
  error estimate for blocks of size 2^( 5) =       0.000406396107
  error estimate for blocks of size 2^( 6) =       0.000408925822
  error estimate for blocks of size 2^( 7) =       0.000411016816

      target function =      -0.942035456476
              le_mean =     -17.211932797115
             les_mean =     296.532156933417
             stat err =       0.000407046489
             autocorr =       1.233856245864
   target nu stat err =       0.000407046489
   target dn stat err =       0.003305279189
      target stat err =       0.005712314006
              std dev =       0.518243278096
             le_variance =       0.268576095292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268614133012
                                         uncertainty =       0.002008212251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268614133012
                                         uncertainty =       0.002008212251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366447473
  error estimate for blocks of size 2^( 2) =       0.000380258503
  error estimate for blocks of size 2^( 3) =       0.000392990814
  error estimate for blocks of size 2^( 4) =       0.000401847211
  error estimate for blocks of size 2^( 5) =       0.000406396107
  error estimate for blocks of size 2^( 6) =       0.000408925822
  error estimate for blocks of size 2^( 7) =       0.000411016816

      target function =      -0.942035456826
              le_mean =     -17.211932797115
             les_mean =     296.532156933212
             stat err =       0.000407046489
             autocorr =       1.233856245606
   target nu stat err =       0.000407046489
   target dn stat err =       0.003305279218
      target stat err =       0.005712314060
              std dev =       0.518243278117
             le_variance =       0.268576095314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268614133030
                                         uncertainty =       0.002008212253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268614133030
                                         uncertainty =       0.002008212253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366447473
  error estimate for blocks of size 2^( 2) =       0.000380258503
  error estimate for blocks of size 2^( 3) =       0.000392990814
  error estimate for blocks of size 2^( 4) =       0.000401847211
  error estimate for blocks of size 2^( 5) =       0.000406396107
  error estimate for blocks of size 2^( 6) =       0.000408925822
  error estimate for blocks of size 2^( 7) =       0.000411016816

      target function =      -0.942035457132
              le_mean =     -17.211932797115
             les_mean =     296.532156933033
             stat err =       0.000407046489
             autocorr =       1.233856245373
   target nu stat err =       0.000407046489
   target dn stat err =       0.003305279244
      target stat err =       0.005712314107
              std dev =       0.518243278135
             le_variance =       0.268576095333


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942035457176        initial  <--
     6.2500e+05     6.2500e+06             6.1200e-10        -0.942035456476
     2.5000e+06     2.5000e+07             1.5300e-10        -0.942035456826
     1.0000e+07     1.0000e+08             3.8250e-11        -0.942035457132

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8464
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8024e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2927
    reference variance = 0.349683
====================================================
  Execution time = 2.8317e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0411e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8122e-01
  Total weights = 1.957227030e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7394e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268248520363
                                         uncertainty =       0.002023937300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268248520363
                                         uncertainty =       0.002023937300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366201494
  error estimate for blocks of size 2^( 2) =       0.000379957210
  error estimate for blocks of size 2^( 3) =       0.000392377222
  error estimate for blocks of size 2^( 4) =       0.000402511607
  error estimate for blocks of size 2^( 5) =       0.000408223658
  error estimate for blocks of size 2^( 6) =       0.000412032624
  error estimate for blocks of size 2^( 7) =       0.000413480737

      target function =      -0.942556781002
              le_mean =     -17.211997326517
             les_mean =     296.534076298425
             stat err =       0.000409062157
             autocorr =       1.247781044219
   target nu stat err =       0.000409062157
   target dn stat err =       0.002992780580
      target stat err =       0.005188596398
              std dev =       0.517895405539
             le_variance =       0.268215651079


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721199732652e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942584107493       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942584107499       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942584107501       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942584107501       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942584107502       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942584107502       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942584107502       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942584107502       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942584107502       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942584107502       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942584100799       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942584107502       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942584107502       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942584107502       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942584107502       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942584107502       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942584107502       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942584107502       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942584101981       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942584105535       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942584112900       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942584099561       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942584126834       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942584110404       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.942584115677       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.942584096687       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.942584106973       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.942584115902       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.942584093868       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942584083368       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.942584113587       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.942584092084       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.942584097006       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.942584103476       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942584095926       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.942584098936       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.942584093828       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.942584092252       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.942584095273       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.942584104373       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.942584104342       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.942584118053       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.942584117875       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.942584115342       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.942584117395       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.942584098339       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.942584083299       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.942584112033       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+06 is 6.475478e-11

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942584107493       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942584107494       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942584107495       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942584107495       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942584108962       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942584107495       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942584107495       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942584137816       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942584152916       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942584131831       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942584107495       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942584107495       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942584109036       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942584107495       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942584173939       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942584094950       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942584071633       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942584084207       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942584046654       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942584108562       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942584138449       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942584112608       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942583789488       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942584100216       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.942584191758       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.942584015283       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.942584032461       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.942584097342       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.942584060607       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942584208900       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.942584072776       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.942584149220       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.942584130187       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.942584139339       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942584054168       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.942584161340       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.942584278395       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.942584151656       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.942584043779       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.942584141350       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.942583982753       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.942583959828       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.942584173984       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.942584096680       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.942584091126       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.942584158789       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.942584041491       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.942584079266       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+07 is 1.618900e-11

solving harmonic davidson linear method for identity shift 1.0000e+08, overlap shift 1.0000e+09 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942584107493       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942584107493       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942584107493       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942584090282       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942584121999       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942584107493       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942584107493       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942584107493       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942584107493       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942584233798       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942584507863       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942583978193       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942583995570       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942584135401       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942583946341       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942584121531       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942584451396       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942583944893       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942584248314       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942583931138       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942583840475       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942583954986       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942583967521       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942584158140       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.942583588537       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.942584182765       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.942584184757       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.942584157042       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.942584076933       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942584385854       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.942584160722       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.942584325282       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.942584467936       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.942583948829       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942584203576       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.942584199675       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.942583912169       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.942583898613       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.942584405715       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.942583813425       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.942584142214       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.942584053438       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.942584281432       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.942584101459       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.942583736448       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.942583784449       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.942583971709       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.942583780723       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+08 is 4.046705e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.140502 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7181e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2607
    reference variance = 0.17172
====================================================
  Execution time = 2.8105e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8041e-01
  Total weights = 1.9574e+06
  Execution time = 2.4999e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268319186996
                                         uncertainty =       0.002332450858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268319186996
                                         uncertainty =       0.002332450858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366309022
  error estimate for blocks of size 2^( 2) =       0.000380514981
  error estimate for blocks of size 2^( 3) =       0.000392765594
  error estimate for blocks of size 2^( 4) =       0.000402226819
  error estimate for blocks of size 2^( 5) =       0.000407910169
  error estimate for blocks of size 2^( 6) =       0.000410157555
  error estimate for blocks of size 2^( 7) =       0.000412015980

      target function =      -0.943929653452
              le_mean =     -17.212001657046
             les_mean =     296.533409746536
             stat err =       0.000408077630
             autocorr =       1.241053054963
   target nu stat err =       0.000408077630
   target dn stat err =       0.004226404794
      target stat err =       0.007310857051
              std dev =       0.518047474859
             le_variance =       0.268373186207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268319186994
                                         uncertainty =       0.002332450861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268319186994
                                         uncertainty =       0.002332450861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366309022
  error estimate for blocks of size 2^( 2) =       0.000380514981
  error estimate for blocks of size 2^( 3) =       0.000392765594
  error estimate for blocks of size 2^( 4) =       0.000402226819
  error estimate for blocks of size 2^( 5) =       0.000407910169
  error estimate for blocks of size 2^( 6) =       0.000410157555
  error estimate for blocks of size 2^( 7) =       0.000412015980

      target function =      -0.943929653480
              le_mean =     -17.212001657046
             les_mean =     296.533409746520
             stat err =       0.000408077630
             autocorr =       1.241053055046
   target nu stat err =       0.000408077630
   target dn stat err =       0.004226404801
      target stat err =       0.007310857064
              std dev =       0.518047474857
             le_variance =       0.268373186206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268319186995
                                         uncertainty =       0.002332450859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268319186995
                                         uncertainty =       0.002332450859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366309022
  error estimate for blocks of size 2^( 2) =       0.000380514981
  error estimate for blocks of size 2^( 3) =       0.000392765594
  error estimate for blocks of size 2^( 4) =       0.000402226819
  error estimate for blocks of size 2^( 5) =       0.000407910169
  error estimate for blocks of size 2^( 6) =       0.000410157555
  error estimate for blocks of size 2^( 7) =       0.000412015980

      target function =      -0.943929653466
              le_mean =     -17.212001657046
             les_mean =     296.533409746528
             stat err =       0.000408077630
             autocorr =       1.241053055013
   target nu stat err =       0.000408077630
   target dn stat err =       0.004226404798
      target stat err =       0.007310857057
              std dev =       0.518047474858
             le_variance =       0.268373186207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268319186996
                                         uncertainty =       0.002332450858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268319186996
                                         uncertainty =       0.002332450858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366309022
  error estimate for blocks of size 2^( 2) =       0.000380514981
  error estimate for blocks of size 2^( 3) =       0.000392765594
  error estimate for blocks of size 2^( 4) =       0.000402226819
  error estimate for blocks of size 2^( 5) =       0.000407910169
  error estimate for blocks of size 2^( 6) =       0.000410157555
  error estimate for blocks of size 2^( 7) =       0.000412015980

      target function =      -0.943929653454
              le_mean =     -17.212001657046
             les_mean =     296.533409746535
             stat err =       0.000408077630
             autocorr =       1.241053054974
   target nu stat err =       0.000408077630
   target dn stat err =       0.004226404794
      target stat err =       0.007310857051
              std dev =       0.518047474858
             le_variance =       0.268373186207


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943929653452        initial
     6.2500e+06     6.2500e+07             6.4755e-11        -0.943929653480  <--
     2.5000e+07     2.5000e+08             1.6189e-11        -0.943929653466
     1.0000e+08     1.0000e+09             4.0467e-12        -0.943929653454

*****************************************************************************
Applying the update for shift_i =   6.2500e+06     and shift_s =   6.2500e+07
*****************************************************************************

  Execution time = 4.0662e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7851e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2406
    reference variance = 0.559174
====================================================
  Execution time = 2.7848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0412e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8193e-01
  Total weights = 1.957525866e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6919e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268793622690
                                         uncertainty =       0.001923727807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268793622690
                                         uncertainty =       0.001923727807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366648517
  error estimate for blocks of size 2^( 2) =       0.000380225317
  error estimate for blocks of size 2^( 3) =       0.000392582985
  error estimate for blocks of size 2^( 4) =       0.000401705187
  error estimate for blocks of size 2^( 5) =       0.000406342219
  error estimate for blocks of size 2^( 6) =       0.000408106497
  error estimate for blocks of size 2^( 7) =       0.000410710168

      target function =      -0.941270563096
              le_mean =     -17.213467847808
             les_mean =     296.585408376908
             stat err =       0.000406716018
             autocorr =       1.230503028585
   target nu stat err =       0.000406716018
   target dn stat err =       0.003018597569
      target stat err =       0.005232569736
              std dev =       0.518527602038
             le_variance =       0.268870874075


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721346784781e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941298692441       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941298692483       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941298692494       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941298692496       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941298692568       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941298696647       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941298684856       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941298691302       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941298693861       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941298688851       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941298694202       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941298692847       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941298687182       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941298685967       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941298691480       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941298693970       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941298693276       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941298693890       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941298696728       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941298692611       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941298691242       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941298691820       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941298687011       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941298696655       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941298687564       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941298697603       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941298694037       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941298695165       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941298693776       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941298697262       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941298689849       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941298691730       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941298688877       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941298685531       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941298687808       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941298693460       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.941298690802       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941298691732       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.941298688158       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941298694169       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941298692180       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.941298693875       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.941298693221       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.941298694123       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.941298698961       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.941298688317       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.941298689449       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.941298693809       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+06 is 1.867677e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941298692441       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941298692451       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941298692454       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941298692455       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941298692453       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941298686437       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941298693135       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941298687391       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941298687324       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941298696164       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941298707925       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941298684779       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941298695654       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941298677157       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941298710197       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941298688611       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941298693555       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941298689135       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941298699173       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941298700821       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941298695287       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941298696751       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941298695858       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941298665021       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941298686855       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941298681322       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941298685667       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941298670821       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941298702313       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941298705239       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941298697665       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941298685123       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941298707111       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941298685803       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941298663194       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941298676407       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.941298682683       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941298672381       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.941298708705       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941298682863       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941298700847       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.941298673253       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.941298707201       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.941298699876       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.941298692431       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.941298701413       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.941298698614       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.941298702148       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+06 is 4.669174e-11

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941298692441       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941298692443       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941298692444       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941298692444       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941298697647       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941298694884       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941298634070       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941298643140       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941298690429       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941298672732       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941298782711       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941298688519       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941298681628       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941298671989       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941298667381       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941298651297       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941298636214       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941298693550       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941298776474       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941298714168       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941298624241       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941298704253       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941298662717       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941298720265       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941298692549       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941298709256       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941298608015       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941298680168       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941298674338       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941298785132       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941298737921       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941298661132       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941298608327       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941298667032       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941298711820       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941298694638       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.941298677451       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941298632971       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.941298729213       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941298675511       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941298680180       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.941298698437       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.941298677441       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.941298702008       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.941298718936       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.941298666754       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.941298557145       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.941298660024       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+07 is 1.167286e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.257497 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6664e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2434
    reference variance = 0.779275
====================================================
  Execution time = 2.7990e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8080e-01
  Total weights = 1.9575e+06
  Execution time = 2.5133e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269487570442
                                         uncertainty =       0.002106632613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269487570442
                                         uncertainty =       0.002106632613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367075675
  error estimate for blocks of size 2^( 2) =       0.000381076494
  error estimate for blocks of size 2^( 3) =       0.000393410745
  error estimate for blocks of size 2^( 4) =       0.000403239208
  error estimate for blocks of size 2^( 5) =       0.000409105671
  error estimate for blocks of size 2^( 6) =       0.000410431050
  error estimate for blocks of size 2^( 7) =       0.000413067371

      target function =      -0.943289651613
              le_mean =     -17.212275004366
             les_mean =     296.543207436588
             stat err =       0.000408960825
             autocorr =       1.241229830506
   target nu stat err =       0.000408960825
   target dn stat err =       0.002361724223
      target stat err =       0.004128435994
              std dev =       0.519131703803
             le_variance =       0.269497725893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269487570471
                                         uncertainty =       0.002106632613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269487570471
                                         uncertainty =       0.002106632613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367075675
  error estimate for blocks of size 2^( 2) =       0.000381076494
  error estimate for blocks of size 2^( 3) =       0.000393410745
  error estimate for blocks of size 2^( 4) =       0.000403239208
  error estimate for blocks of size 2^( 5) =       0.000409105671
  error estimate for blocks of size 2^( 6) =       0.000410431050
  error estimate for blocks of size 2^( 7) =       0.000413067371

      target function =      -0.943289626518
              le_mean =     -17.212275004365
             les_mean =     296.543207451176
             stat err =       0.000408960825
             autocorr =       1.241229830846
   target nu stat err =       0.000408960825
   target dn stat err =       0.002361724298
      target stat err =       0.004128435905
              std dev =       0.519131703830
             le_variance =       0.269497725922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269487570457
                                         uncertainty =       0.002106632613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269487570457
                                         uncertainty =       0.002106632613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367075675
  error estimate for blocks of size 2^( 2) =       0.000381076494
  error estimate for blocks of size 2^( 3) =       0.000393410745
  error estimate for blocks of size 2^( 4) =       0.000403239208
  error estimate for blocks of size 2^( 5) =       0.000409105671
  error estimate for blocks of size 2^( 6) =       0.000410431050
  error estimate for blocks of size 2^( 7) =       0.000413067371

      target function =      -0.943289639072
              le_mean =     -17.212275004366
             les_mean =     296.543207443878
             stat err =       0.000408960825
             autocorr =       1.241229830671
   target nu stat err =       0.000408960825
   target dn stat err =       0.002361724261
      target stat err =       0.004128435950
              std dev =       0.519131703816
             le_variance =       0.269497725907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269487570444
                                         uncertainty =       0.002106632613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269487570444
                                         uncertainty =       0.002106632613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367075675
  error estimate for blocks of size 2^( 2) =       0.000381076494
  error estimate for blocks of size 2^( 3) =       0.000393410745
  error estimate for blocks of size 2^( 4) =       0.000403239208
  error estimate for blocks of size 2^( 5) =       0.000409105671
  error estimate for blocks of size 2^( 6) =       0.000410431050
  error estimate for blocks of size 2^( 7) =       0.000413067371

      target function =      -0.943289650046
              le_mean =     -17.212275004366
             les_mean =     296.543207437499
             stat err =       0.000408960825
             autocorr =       1.241229830531
   target nu stat err =       0.000408960825
   target dn stat err =       0.002361724228
      target stat err =       0.004128435989
              std dev =       0.519131703804
             le_variance =       0.269497725895


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943289651613        initial  <--
     1.5625e+06     1.5625e+07             1.8677e-10        -0.943289626518
     6.2500e+06     6.2500e+07             4.6692e-11        -0.943289639072
     2.5000e+07     2.5000e+08             1.1673e-11        -0.943289650046

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.6099
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7284e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1859
    reference variance = 0.134019
====================================================
  Execution time = 3.0670e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0411e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7991e-01
  Total weights = 1.957534595e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8153e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266408767423
                                         uncertainty =       0.001843125029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266408767423
                                         uncertainty =       0.001843125029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364929701
  error estimate for blocks of size 2^( 2) =       0.000378645095
  error estimate for blocks of size 2^( 3) =       0.000391407661
  error estimate for blocks of size 2^( 4) =       0.000400808904
  error estimate for blocks of size 2^( 5) =       0.000407168624
  error estimate for blocks of size 2^( 6) =       0.000410422348
  error estimate for blocks of size 2^( 7) =       0.000412940337

      target function =      -0.944811193846
              le_mean =     -17.212264139149
             les_mean =     296.541948350775
             stat err =       0.000407835053
             autocorr =       1.248966176228
   target nu stat err =       0.000407835053
   target dn stat err =       0.002563892905
      target stat err =       0.004484571026
              std dev =       0.516096790361
             le_variance =       0.266355897021


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721226413915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944831378576       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944831378578       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944831378578       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944831375289       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944831378578       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944831387156       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944831350991       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944831333794       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944831413087       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944831376574       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944831361759       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944831409737       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944831344778       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944831388320       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944831363415       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944831355274       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944831370697       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944831390821       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944831380812       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944831364349       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944831365085       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944831391990       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944831344078       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944831392370       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944831337644       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944831368311       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944831403358       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944831328627       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944831327456       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944831412712       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944831359727       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944831337776       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.944831364791       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944831356129       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944831362408       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944831405212       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944831361036       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944831427344       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944831355638       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.944831333543       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944831359473       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944831391825       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.944831435986       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.944831434806       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+07 is 2.642853e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944831378576       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944831378576       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944831378576       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944831378576       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944831334570       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944831410851       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944831315009       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944831288842       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944831360105       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944831330217       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944831545464       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944831123251       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944831413784       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944831251089       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944831346759       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944831466096       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944831401890       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944831255479       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944831522505       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944831518522       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944831420415       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944831439536       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944831355908       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944831443433       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944831267700       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944831373604       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944831047976       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944831508602       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944831257670       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944831227795       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944831656224       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944831409904       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.944831323996       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944831355565       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944831532681       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944831384686       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944831326210       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944831559253       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944831577874       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.944831448994       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944831554266       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944831409797       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.944831318939       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.944831154435       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+07 is 6.606960e-12

solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944831378576       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944831378576       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944831378576       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944831378576       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944831378577       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944831188329       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944831784361       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944830792022       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944831246243       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944831243789       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944831453778       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944831937087       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944831322247       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944830967259       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944831756031       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944831286135       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944831347765       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944831147686       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944831428132       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944830960108       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944831493584       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944831698345       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944830395221       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944831743855       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944831811315       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944831403585       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944831501294       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944831686708       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944831395972       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944831848214       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944831950851       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944830747348       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.944831226094       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944832523787       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944831958699       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944831115948       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944830600083       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944830697550       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944831866072       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.944831718630       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944830967539       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944831415369       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.944831668384       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.944830380000       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+08 is 1.651947e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.349698 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9585e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1811
    reference variance = 0.205116
====================================================
  Execution time = 2.8150e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7491e-01
  Total weights = 1.9574e+06
  Execution time = 2.4851e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265814550897
                                         uncertainty =       0.001299635705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265814550897
                                         uncertainty =       0.001299635705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364527562
  error estimate for blocks of size 2^( 2) =       0.000378143043
  error estimate for blocks of size 2^( 3) =       0.000390580301
  error estimate for blocks of size 2^( 4) =       0.000400146106
  error estimate for blocks of size 2^( 5) =       0.000405542946
  error estimate for blocks of size 2^( 6) =       0.000406698338
  error estimate for blocks of size 2^( 7) =       0.000407230426

      target function =      -0.953536692050
              le_mean =     -17.212067040790
             les_mean =     296.530160453208
             stat err =       0.000404904454
             autocorr =       1.233798859691
   target nu stat err =       0.000404904454
   target dn stat err =       0.001654956821
      target stat err =       0.003000524461
              std dev =       0.515528070891
             le_variance =       0.265769191877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265814550896
                                         uncertainty =       0.001299635705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265814550896
                                         uncertainty =       0.001299635705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364527562
  error estimate for blocks of size 2^( 2) =       0.000378143043
  error estimate for blocks of size 2^( 3) =       0.000390580301
  error estimate for blocks of size 2^( 4) =       0.000400146106
  error estimate for blocks of size 2^( 5) =       0.000405542946
  error estimate for blocks of size 2^( 6) =       0.000406698338
  error estimate for blocks of size 2^( 7) =       0.000407230426

      target function =      -0.953536692037
              le_mean =     -17.212067040790
             les_mean =     296.530160453214
             stat err =       0.000404904454
             autocorr =       1.233798859707
   target nu stat err =       0.000404904454
   target dn stat err =       0.001654956821
      target stat err =       0.003000524461
              std dev =       0.515528070890
             le_variance =       0.265769191876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265814550896
                                         uncertainty =       0.001299635705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265814550896
                                         uncertainty =       0.001299635705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364527562
  error estimate for blocks of size 2^( 2) =       0.000378143043
  error estimate for blocks of size 2^( 3) =       0.000390580301
  error estimate for blocks of size 2^( 4) =       0.000400146106
  error estimate for blocks of size 2^( 5) =       0.000405542946
  error estimate for blocks of size 2^( 6) =       0.000406698338
  error estimate for blocks of size 2^( 7) =       0.000407230426

      target function =      -0.953536692043
              le_mean =     -17.212067040790
             les_mean =     296.530160453211
             stat err =       0.000404904454
             autocorr =       1.233798859700
   target nu stat err =       0.000404904454
   target dn stat err =       0.001654956821
      target stat err =       0.003000524461
              std dev =       0.515528070891
             le_variance =       0.265769191876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265814550897
                                         uncertainty =       0.001299635705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265814550897
                                         uncertainty =       0.001299635705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364527562
  error estimate for blocks of size 2^( 2) =       0.000378143043
  error estimate for blocks of size 2^( 3) =       0.000390580301
  error estimate for blocks of size 2^( 4) =       0.000400146106
  error estimate for blocks of size 2^( 5) =       0.000405542946
  error estimate for blocks of size 2^( 6) =       0.000406698338
  error estimate for blocks of size 2^( 7) =       0.000407230426

      target function =      -0.953536692049
              le_mean =     -17.212067040790
             les_mean =     296.530160453208
             stat err =       0.000404904454
             autocorr =       1.233798859687
   target nu stat err =       0.000404904454
   target dn stat err =       0.001654956821
      target stat err =       0.003000524461
              std dev =       0.515528070891
             le_variance =       0.265769191877


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.953536692050        initial  <--
     1.5625e+07     1.5625e+08             2.6429e-11        -0.953536692037
     6.2500e+07     6.2500e+08             6.6070e-12        -0.953536692043
     2.5000e+08     2.5000e+09             1.6519e-12        -0.953536692049

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.6967
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0289e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.0773
    reference variance = 0.739347
====================================================
  Execution time = 2.8572e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0388e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7866e-01
  Total weights = 1.957510552e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9290e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266781411112
                                         uncertainty =       0.001348732095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266781411112
                                         uncertainty =       0.001348732095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365228379
  error estimate for blocks of size 2^( 2) =       0.000379230072
  error estimate for blocks of size 2^( 3) =       0.000391444522
  error estimate for blocks of size 2^( 4) =       0.000400411495
  error estimate for blocks of size 2^( 5) =       0.000405566866
  error estimate for blocks of size 2^( 6) =       0.000408784953
  error estimate for blocks of size 2^( 7) =       0.000411540076

      target function =      -0.946988136249
              le_mean =     -17.212181892335
             les_mean =     296.537863258902
             stat err =       0.000406575847
             autocorr =       1.239236282134
   target nu stat err =       0.000406575847
   target dn stat err =       0.002123506761
      target stat err =       0.003753463041
              std dev =       0.516519191108
             le_variance =       0.266792074783


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721218189234e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947001954742       residual = 8.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947001954743       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947001954743       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947001954743       residual = 9.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947001954743       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947001954743       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947001954743       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947001954743       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947001954743       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947001954743       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947001954743       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947001954743       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947001954743       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947001954743       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947001954743       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947001753011       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947001863511       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947002106607       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947001954743       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947001574744       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947002454367       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947001614231       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947001926435       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947001300926       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947000696550       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947001948927       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947001860320       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947002028025       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947001440906       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947002004466       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947002637211       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947001825178       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947002007916       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947001804057       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947001652198       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947002219240       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947001358879       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947001608353       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947002014120       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947001854279       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947002559614       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947001478950       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947001932358       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947002061957       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.947001791896       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+08 is 3.240338e-12

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947001954742       residual = 8.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947001954742       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947001954742       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947001954742       residual = 9.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947001954742       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947001406113       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947002036213       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947001971191       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947001912467       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947000420625       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947003675060       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947001954742       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947001795039       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947000863557       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947002110358       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947001976095       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947001333986       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947003324038       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947001662986       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947000581288       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946998582635       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947002175791       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947002973123       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946997404362       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947000864935       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947002110619       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.946998913655       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947003233107       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947003484196       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947001328486       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947004022864       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947004714205       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947001106241       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947001109997       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947003673198       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947003133939       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947001250498       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947000419358       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947001698909       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947003883614       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947001002495       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947000407218       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.946999884187       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947002599150       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.947001713011       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+08 is 8.102673e-13

solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947001954742       residual = 8.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947001954742       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947001954742       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947001954742       residual = 9.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947001954742       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947001954742       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947001954742       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947001954742       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947001939182       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947001954742       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947001954742       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947009243361       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946994668160       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946999914887       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947001954742       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947001954742       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947001954742       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947002411781       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947012422738       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946994491499       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946995200037       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947003596092       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947002044878       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946969263136       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946999319518       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947020317064       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.946997042338       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.946991882969       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.946995076505       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947023074804       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947005738931       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947001248971       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.946989451086       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947020722229       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947012774835       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947004901931       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.946991516342       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947001157601       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.946993589722       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.946998932488       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.946994599681       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947004625933       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.946998573380       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.946995326200       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.947009161575       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.947004178894       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.947006146941       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.947001295396       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+09 is 2.031271e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.454167 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7613e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2476
    reference variance = 0.451808
====================================================
  Execution time = 2.8331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7961e-01
  Total weights = 1.9572e+06
  Execution time = 2.4795e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266750524061
                                         uncertainty =       0.001284821401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266750524061
                                         uncertainty =       0.001284821401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365175410
  error estimate for blocks of size 2^( 2) =       0.000379117040
  error estimate for blocks of size 2^( 3) =       0.000392138864
  error estimate for blocks of size 2^( 4) =       0.000401109684
  error estimate for blocks of size 2^( 5) =       0.000406153164
  error estimate for blocks of size 2^( 6) =       0.000409021396
  error estimate for blocks of size 2^( 7) =       0.000409262936

      target function =      -0.945344061183
              le_mean =     -17.211894244586
             les_mean =     296.528916356993
             stat err =       0.000406386795
             autocorr =       1.238443290728
   target nu stat err =       0.000406386795
   target dn stat err =       0.002361642646
      target stat err =       0.004142114052
              std dev =       0.516444280136
             le_variance =       0.266714694486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266750524061
                                         uncertainty =       0.001284821401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266750524061
                                         uncertainty =       0.001284821401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365175410
  error estimate for blocks of size 2^( 2) =       0.000379117040
  error estimate for blocks of size 2^( 3) =       0.000392138864
  error estimate for blocks of size 2^( 4) =       0.000401109684
  error estimate for blocks of size 2^( 5) =       0.000406153164
  error estimate for blocks of size 2^( 6) =       0.000409021396
  error estimate for blocks of size 2^( 7) =       0.000409262936

      target function =      -0.945344061184
              le_mean =     -17.211894244586
             les_mean =     296.528916356992
             stat err =       0.000406386795
             autocorr =       1.238443290721
   target nu stat err =       0.000406386795
   target dn stat err =       0.002361642646
      target stat err =       0.004142114052
              std dev =       0.516444280136
             le_variance =       0.266714694485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266750524061
                                         uncertainty =       0.001284821401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266750524061
                                         uncertainty =       0.001284821401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365175410
  error estimate for blocks of size 2^( 2) =       0.000379117040
  error estimate for blocks of size 2^( 3) =       0.000392138864
  error estimate for blocks of size 2^( 4) =       0.000401109684
  error estimate for blocks of size 2^( 5) =       0.000406153164
  error estimate for blocks of size 2^( 6) =       0.000409021396
  error estimate for blocks of size 2^( 7) =       0.000409262936

      target function =      -0.945344061183
              le_mean =     -17.211894244586
             les_mean =     296.528916356993
             stat err =       0.000406386795
             autocorr =       1.238443290725
   target nu stat err =       0.000406386795
   target dn stat err =       0.002361642646
      target stat err =       0.004142114052
              std dev =       0.516444280136
             le_variance =       0.266714694485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266750524061
                                         uncertainty =       0.001284821401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266750524061
                                         uncertainty =       0.001284821401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365175410
  error estimate for blocks of size 2^( 2) =       0.000379117040
  error estimate for blocks of size 2^( 3) =       0.000392138864
  error estimate for blocks of size 2^( 4) =       0.000401109684
  error estimate for blocks of size 2^( 5) =       0.000406153164
  error estimate for blocks of size 2^( 6) =       0.000409021396
  error estimate for blocks of size 2^( 7) =       0.000409262936

      target function =      -0.945344061183
              le_mean =     -17.211894244586
             les_mean =     296.528916356993
             stat err =       0.000406386795
             autocorr =       1.238443290729
   target nu stat err =       0.000406386795
   target dn stat err =       0.002361642646
      target stat err =       0.004142114052
              std dev =       0.516444280136
             le_variance =       0.266714694485


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945344061183        initial
     1.5625e+08     1.5625e+09             3.2403e-12        -0.945344061184  <--
     6.2500e+08     6.2500e+09             8.1027e-13        -0.945344061183
     2.5000e+09     2.5000e+10             2.0313e-13        -0.945344061183

*****************************************************************************
Applying the update for shift_i =   1.5625e+08     and shift_s =   1.5625e+09
*****************************************************************************

  Execution time = 4.0820e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8440e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2586
    reference variance = 0.283221
====================================================
  Execution time = 2.8376e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0370e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7855e-01
  Total weights = 1.957345379e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6906e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266134658646
                                         uncertainty =       0.001482586103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266134658646
                                         uncertainty =       0.001482586103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364768203
  error estimate for blocks of size 2^( 2) =       0.000378629766
  error estimate for blocks of size 2^( 3) =       0.000391642186
  error estimate for blocks of size 2^( 4) =       0.000401206325
  error estimate for blocks of size 2^( 5) =       0.000406495890
  error estimate for blocks of size 2^( 6) =       0.000408975110
  error estimate for blocks of size 2^( 7) =       0.000410752101

      target function =      -0.947173875315
              le_mean =     -17.211981398582
             les_mean =     296.530855628795
             stat err =       0.000406857356
             autocorr =       1.244085990432
   target nu stat err =       0.000406857356
   target dn stat err =       0.002441385184
      target stat err =       0.004294765031
              std dev =       0.515868392801
             le_variance =       0.266120198691


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721198139858e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947192347674       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947192347675       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947192347675       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947192347675       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947192347675       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947192401382       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947192347675       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947192460807       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947192347675       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947192347675       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947192347675       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947192370039       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947192347675       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947192347675       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947192329869       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947192376066       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947192394833       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947192282036       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947192252082       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947192546027       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947192429301       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947192333865       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947192368374       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947192404491       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947192160876       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947192410699       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947192325166       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947192381304       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947192375582       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947192262102       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947192274066       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947192476768       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947192316892       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947192308632       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947192439981       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947192367914       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947192227207       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947192325733       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947192332942       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947192330797       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947192351110       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947192195571       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947192442536       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947192335199       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+07 is 7.329211e-12

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947192347674       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947192347674       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947192347674       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947192347674       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947192347674       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947192347674       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947192347674       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947192857598       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947192808951       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947192218522       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947192347674       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947192347674       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947192357684       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947193239008       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947192347674       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947192510569       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947192437334       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947192305124       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947192163341       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947192229606       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947192143054       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947192091011       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947192529141       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947190933858       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947192008507       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947192225983       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947192444256       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947192558908       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947191528445       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947192158843       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947191909799       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947192578695       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947191412351       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947191952977       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947191887266       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947192371293       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947192783504       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947192085956       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947192329806       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947191586220       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947191831143       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947191997818       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947192446214       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947192151236       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+08 is 1.831907e-12

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947192347674       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947192347674       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947192347674       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947192349524       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947192347674       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947192347674       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947192347674       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947192347674       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947191454895       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947192347674       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947192276077       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947192652247       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947192177442       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947193640543       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947191903352       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947192924437       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947193179592       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947191093855       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947193198175       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947194100990       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947192877213       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947191556668       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947191261348       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947192594306       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947192980145       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947193961067       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947194701329       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947191358399       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947193898804       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947195370114       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947192683302       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947190448669       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947192230183       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947191555812       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947192992102       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947195417947       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947192841743       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947190449587       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947192497481       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947189070622       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947192174330       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947191949940       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947192039008       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947188643910       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+08 is 4.580759e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.546393 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7166e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.3099
    reference variance = 0.326677
====================================================
  Execution time = 2.8209e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8049e-01
  Total weights = 1.9575e+06
  Execution time = 2.4886e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270091030848
                                         uncertainty =       0.001562455933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270091030848
                                         uncertainty =       0.001562455933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367431254
  error estimate for blocks of size 2^( 2) =       0.000381240612
  error estimate for blocks of size 2^( 3) =       0.000394195889
  error estimate for blocks of size 2^( 4) =       0.000403499426
  error estimate for blocks of size 2^( 5) =       0.000410050756
  error estimate for blocks of size 2^( 6) =       0.000413379395
  error estimate for blocks of size 2^( 7) =       0.000416977595

      target function =      -0.943796565622
              le_mean =     -17.212949505415
             les_mean =     296.566116872311
             stat err =       0.000410976793
             autocorr =       1.251072295468
   target nu stat err =       0.000410976793
   target dn stat err =       0.002218995591
      target stat err =       0.003897203163
              std dev =       0.519634577007
             le_variance =       0.270020093621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270091030848
                                         uncertainty =       0.001562455933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270091030848
                                         uncertainty =       0.001562455933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367431254
  error estimate for blocks of size 2^( 2) =       0.000381240612
  error estimate for blocks of size 2^( 3) =       0.000394195889
  error estimate for blocks of size 2^( 4) =       0.000403499426
  error estimate for blocks of size 2^( 5) =       0.000410050756
  error estimate for blocks of size 2^( 6) =       0.000413379395
  error estimate for blocks of size 2^( 7) =       0.000416977595

      target function =      -0.943796565620
              le_mean =     -17.212949505415
             les_mean =     296.566116872312
             stat err =       0.000410976793
             autocorr =       1.251072295468
   target nu stat err =       0.000410976793
   target dn stat err =       0.002218995591
      target stat err =       0.003897203163
              std dev =       0.519634577007
             le_variance =       0.270020093621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270091030848
                                         uncertainty =       0.001562455933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270091030848
                                         uncertainty =       0.001562455933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367431254
  error estimate for blocks of size 2^( 2) =       0.000381240612
  error estimate for blocks of size 2^( 3) =       0.000394195889
  error estimate for blocks of size 2^( 4) =       0.000403499426
  error estimate for blocks of size 2^( 5) =       0.000410050756
  error estimate for blocks of size 2^( 6) =       0.000413379395
  error estimate for blocks of size 2^( 7) =       0.000416977595

      target function =      -0.943796565621
              le_mean =     -17.212949505415
             les_mean =     296.566116872311
             stat err =       0.000410976793
             autocorr =       1.251072295463
   target nu stat err =       0.000410976793
   target dn stat err =       0.002218995591
      target stat err =       0.003897203163
              std dev =       0.519634577007
             le_variance =       0.270020093621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270091030848
                                         uncertainty =       0.001562455933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270091030848
                                         uncertainty =       0.001562455933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367431254
  error estimate for blocks of size 2^( 2) =       0.000381240612
  error estimate for blocks of size 2^( 3) =       0.000394195889
  error estimate for blocks of size 2^( 4) =       0.000403499426
  error estimate for blocks of size 2^( 5) =       0.000410050756
  error estimate for blocks of size 2^( 6) =       0.000413379395
  error estimate for blocks of size 2^( 7) =       0.000416977595

      target function =      -0.943796565622
              le_mean =     -17.212949505415
             les_mean =     296.566116872311
             stat err =       0.000410976793
             autocorr =       1.251072295460
   target nu stat err =       0.000410976793
   target dn stat err =       0.002218995591
      target stat err =       0.003897203163
              std dev =       0.519634577007
             le_variance =       0.270020093621


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943796565622        initial  <--
     3.9062e+07     3.9062e+08             7.3292e-12        -0.943796565620
     1.5625e+08     1.5625e+09             1.8319e-12        -0.943796565621
     6.2500e+08     6.2500e+09             4.5808e-13        -0.943796565622

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7136
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7887e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2169
    reference variance = 0.188365
====================================================
  Execution time = 2.8393e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0355e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8051e-01
  Total weights = 1.957358841e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7661e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267854691197
                                         uncertainty =       0.001788905761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267854691197
                                         uncertainty =       0.001788905761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365913075
  error estimate for blocks of size 2^( 2) =       0.000379422920
  error estimate for blocks of size 2^( 3) =       0.000392395503
  error estimate for blocks of size 2^( 4) =       0.000400847051
  error estimate for blocks of size 2^( 5) =       0.000406151618
  error estimate for blocks of size 2^( 6) =       0.000408598469
  error estimate for blocks of size 2^( 7) =       0.000409816059

      target function =      -0.943778221030
              le_mean =     -17.212425713802
             les_mean =     296.548107934364
             stat err =       0.000406353299
             autocorr =       1.233251700779
   target nu stat err =       0.000406353299
   target dn stat err =       0.002349991818
      target stat err =       0.004113121759
              std dev =       0.517487513357
             le_variance =       0.267793326480


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721242571380e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943795160150       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943795160150       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943795160150       residual = 6.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943795160150       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943795167109       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943795366116       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943796067222       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943794515074       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943794196910       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943795021948       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943795751734       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943794922133       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943795294144       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943794870836       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943795272144       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943795243235       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943794850940       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943795382418       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943796102195       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943794796140       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943795393041       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943794982795       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943795649893       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943794139003       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943794286113       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.943795796076       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.943794746339       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.943794257102       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.943793748296       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.943795475878       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943796003268       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.943795278929       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943796011225       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.943794338380       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943796230924       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.943796008827       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943795288239       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.943794324362       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.943796257582       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943796765720       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.943794154722       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.943796538279       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.943793231802       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.943794583855       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.943794550081       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.943795297817       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.943794239895       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.943796362048       residual = 6.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+08 is 1.030207e-12

solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943795160150       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943795160150       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943795160150       residual = 6.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943795160150       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943794986249       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943795160150       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943791959142       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943794723070       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943794082452       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943794808634       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943795873212       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943790879730       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943796948672       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943791082555       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943791181864       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943797004161       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943798471716       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943793186437       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943796205795       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943793604520       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943798800449       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943797666676       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943796698471       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943796977726       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943797587234       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.943800905808       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.943791828177       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.943793716123       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.943794493624       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.943799487993       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943795031537       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.943795061251       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943795961660       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.943788168034       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943795432059       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.943797022703       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943797193819       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.943795460154       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.943796556509       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943790963974       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.943794725393       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.943794123352       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.943797372400       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.943784133959       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.943785604222       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.943797582794       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.943796400980       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.943793979667       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.943791945630       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+09 is 2.574037e-13

solving harmonic davidson linear method for identity shift 6.2500e+09, overlap shift 6.2500e+10 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943795160150       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943795160150       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943795160150       residual = 6.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943795160150       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943794693699       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943791649191       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943789717147       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943805022868       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943795996886       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943772449040       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943802111129       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943796176672       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943796025890       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943795929340       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943803997707       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943789426155       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943802483485       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943803582634       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943790091829       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943799426432       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943792529430       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943803654088       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943799475943       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943767486241       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943787865160       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.943799139042       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.943773919732       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.943803096682       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.943787127616       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.943802205010       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943798241871       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.943805493721       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943792746770       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.943786181952       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943793267519       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.943774082644       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943777462079       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.943790328719       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.943812770629       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943807286430       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.943770685902       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.943774119084       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.943782030364       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.943804668246       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.943802650324       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.943788221925       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.943784674133       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.943779626717       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.943795021293       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.943809377090       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.943795492430       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.943766358090       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.943777688626       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.943844842266       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.943719801872       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.943903113509       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.943851470436       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.943830443343       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.943693810903       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.943757244449       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.943681567999       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.943747532935       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.943801754272       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.943791514948       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.943831188940       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.943826519389       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.943786400348       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.943724658992       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.943800564649       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.943807599763       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.943793223140       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.943769588282       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.943781827597       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.943728624605       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.943823845085       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.943848943820       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.943929105663       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.943792049138       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.944253705307       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.943643039629       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.943949241511       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.943832971700       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.943734654887       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.943873637238       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.943793525807       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.943721068031       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.943326463333       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.943723054231       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.943813426195       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.943621899376       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.943717267775       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.944334257073       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.943835664281       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.944527973323       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.943903173703       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.945129227238       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.945864302031       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.944042520281       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.943460379205       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.943642490238       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.944604301100       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.943689239301       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.944076955978       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.944113859231       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.945901361418       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.942534522268       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.943561480723       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.943331955566       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration  108:   krylov dim = 109   tar_fn =      -0.946123046528       residual = 6.71e-04           smallest_sin_value = 9.99e-01
davidson iteration  109 stopping due to small subspace S singular value of 9.66e-01
davidson solver did not converge after        109 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+09 is 6.432734e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.152012 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7772e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.191
    reference variance = 0.142738
====================================================
  Execution time = 2.8289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8273e-01
  Total weights = 1.9574e+06
  Execution time = 2.5004e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269650086305
                                         uncertainty =       0.001750440381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269650086305
                                         uncertainty =       0.001750440381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367181087
  error estimate for blocks of size 2^( 2) =       0.000381064525
  error estimate for blocks of size 2^( 3) =       0.000394001122
  error estimate for blocks of size 2^( 4) =       0.000404031902
  error estimate for blocks of size 2^( 5) =       0.000409783510
  error estimate for blocks of size 2^( 6) =       0.000412019521
  error estimate for blocks of size 2^( 7) =       0.000414446349

      target function =      -0.939996884583
              le_mean =     -17.211670338734
             les_mean =     296.524329714327
             stat err =       0.000410070320
             autocorr =       1.247257337782
   target nu stat err =       0.000410070320
   target dn stat err =       0.002570179447
      target stat err =       0.004445771626
              std dev =       0.519280781861
             le_variance =       0.269652530411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269650086305
                                         uncertainty =       0.001750440381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269650086305
                                         uncertainty =       0.001750440381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367181087
  error estimate for blocks of size 2^( 2) =       0.000381064525
  error estimate for blocks of size 2^( 3) =       0.000394001122
  error estimate for blocks of size 2^( 4) =       0.000404031902
  error estimate for blocks of size 2^( 5) =       0.000409783510
  error estimate for blocks of size 2^( 6) =       0.000412019521
  error estimate for blocks of size 2^( 7) =       0.000414446349

      target function =      -0.939996884584
              le_mean =     -17.211670338734
             les_mean =     296.524329714326
             stat err =       0.000410070320
             autocorr =       1.247257337776
   target nu stat err =       0.000410070320
   target dn stat err =       0.002570179447
      target stat err =       0.004445771626
              std dev =       0.519280781861
             le_variance =       0.269652530410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269650086305
                                         uncertainty =       0.001750440381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269650086305
                                         uncertainty =       0.001750440381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367181087
  error estimate for blocks of size 2^( 2) =       0.000381064525
  error estimate for blocks of size 2^( 3) =       0.000394001122
  error estimate for blocks of size 2^( 4) =       0.000404031902
  error estimate for blocks of size 2^( 5) =       0.000409783510
  error estimate for blocks of size 2^( 6) =       0.000412019521
  error estimate for blocks of size 2^( 7) =       0.000414446349

      target function =      -0.939996884584
              le_mean =     -17.211670338734
             les_mean =     296.524329714326
             stat err =       0.000410070320
             autocorr =       1.247257337772
   target nu stat err =       0.000410070320
   target dn stat err =       0.002570179447
      target stat err =       0.004445771626
              std dev =       0.519280781861
             le_variance =       0.269652530410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269650086305
                                         uncertainty =       0.001750440381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269650086305
                                         uncertainty =       0.001750440381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367181087
  error estimate for blocks of size 2^( 2) =       0.000381064525
  error estimate for blocks of size 2^( 3) =       0.000394001122
  error estimate for blocks of size 2^( 4) =       0.000404031902
  error estimate for blocks of size 2^( 5) =       0.000409783510
  error estimate for blocks of size 2^( 6) =       0.000412019521
  error estimate for blocks of size 2^( 7) =       0.000414446349

      target function =      -0.939996884584
              le_mean =     -17.211670338734
             les_mean =     296.524329714327
             stat err =       0.000410070320
             autocorr =       1.247257337772
   target nu stat err =       0.000410070320
   target dn stat err =       0.002570179447
      target stat err =       0.004445771626
              std dev =       0.519280781861
             le_variance =       0.269652530411


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939996884583        initial
     3.9062e+08     3.9062e+09             1.0302e-12        -0.939996884584  <--
     1.5625e+09     1.5625e+10             2.5740e-13        -0.939996884584
     6.2500e+09     6.2500e+10             6.4327e-14        -0.939996884584

*****************************************************************************
Applying the update for shift_i =   3.9062e+08     and shift_s =   3.9062e+09
*****************************************************************************

  Execution time = 4.4253e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2035e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1809
    reference variance = 0.201071
====================================================
  Execution time = 2.8300e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0379e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7768e-01
  Total weights = 1.957442652e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7633e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265970902604
                                         uncertainty =       0.001495268824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265970902604
                                         uncertainty =       0.001495268824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364695042
  error estimate for blocks of size 2^( 2) =       0.000378285921
  error estimate for blocks of size 2^( 3) =       0.000391989741
  error estimate for blocks of size 2^( 4) =       0.000401353175
  error estimate for blocks of size 2^( 5) =       0.000407534597
  error estimate for blocks of size 2^( 6) =       0.000410617394
  error estimate for blocks of size 2^( 7) =       0.000412876122

      target function =      -0.948697491428
              le_mean =     -17.211611618738
             les_mean =     296.517258140314
             stat err =       0.000408095322
             autocorr =       1.252170634356
   target nu stat err =       0.000408095322
   target dn stat err =       0.002087095821
      target stat err =       0.003701202427
              std dev =       0.515764926474
             le_variance =       0.266013459380


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721161161874e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948710793887       residual = 7.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948710793887       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948710793887       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948710793887       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948710793889       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948710787270       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948710864871       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948710754571       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948710806505       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948710625489       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948710865784       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948710571193       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948710758866       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948711027414       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948710915286       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948710631840       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948710758257       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948710750745       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948710703746       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948710651885       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948710898883       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948710587321       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948710649594       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948710538076       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948710672845       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.948710563473       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.948710721322       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.948710790023       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.948710491284       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.948711205423       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.948710721005       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.948711112600       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.948710491517       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.948710721821       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.948710860733       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.948710919259       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.948710410640       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948710606319       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.948710458065       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.948710933798       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.948710887790       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.948711065110       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.948711163276       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.948711060759       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.948710559663       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.948710973558       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.948710792768       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.948710781200       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+07 is 4.413237e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948710793887       residual = 7.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948710793887       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948710793887       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948710793887       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948710793897       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948710812242       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948711075692       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948710251379       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948711464278       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948711037350       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948710509926       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948711995139       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948711417585       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948710851302       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948709906688       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948710666118       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948710475035       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948711867541       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948711098274       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948711643145       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948710838612       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948710265432       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948710462921       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948711598890       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948710483687       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.948710280804       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.948710730307       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.948711664739       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.948710904591       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.948709990102       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.948710741585       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.948710594883       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.948711550067       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.948711038420       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.948711456751       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.948709245816       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.948710587741       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948711310200       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.948709759038       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.948711000163       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.948709242647       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.948710474376       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.948711522293       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.948711975771       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.948709386632       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.948712004869       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.948710539259       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.948710230466       residual = 8.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+08 is 1.103610e-12

solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948710793887       residual = 7.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948710793887       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948710793887       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948710793887       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948710793889       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948710685189       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948712783943       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948709750631       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948711629604       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948712350224       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948712385725       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948710575102       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948707833010       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948710054046       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948710755157       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948709431108       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948711253434       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948706655386       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948708779088       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948707445366       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948712188145       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948709279932       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948705655478       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948705730883       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948709592245       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.948710347902       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.948709829355       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.948713893254       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.948707206232       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.948713596251       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.948709513937       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.948712435564       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.948707716199       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.948710850934       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.948708707736       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.948713043589       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.948703180998       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948708621412       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.948712129688       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.948708450862       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.948709454770       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.948710778275       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.948702335044       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.948712581164       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.948709950933       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.948709326728       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.948711206823       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.948711997625       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.948705929065       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+09 is 2.762036e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.272187 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7191e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2747
    reference variance = 0.286624
====================================================
  Execution time = 2.8484e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7656e-01
  Total weights = 1.9574e+06
  Execution time = 2.4914e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266631911419
                                         uncertainty =       0.001251512925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266631911419
                                         uncertainty =       0.001251512925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365148110
  error estimate for blocks of size 2^( 2) =       0.000379308762
  error estimate for blocks of size 2^( 3) =       0.000392208415
  error estimate for blocks of size 2^( 4) =       0.000401597081
  error estimate for blocks of size 2^( 5) =       0.000406998705
  error estimate for blocks of size 2^( 6) =       0.000410855863
  error estimate for blocks of size 2^( 7) =       0.000410187348

      target function =      -0.950664618039
              le_mean =     -17.211548201180
             les_mean =     296.513948696811
             stat err =       0.000407409749
             autocorr =       1.244872066168
   target nu stat err =       0.000407409749
   target dn stat err =       0.001666573392
      target stat err =       0.003000811284
              std dev =       0.516405671027
             le_variance =       0.266674817069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266631911419
                                         uncertainty =       0.001251512925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266631911419
                                         uncertainty =       0.001251512925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365148110
  error estimate for blocks of size 2^( 2) =       0.000379308762
  error estimate for blocks of size 2^( 3) =       0.000392208415
  error estimate for blocks of size 2^( 4) =       0.000401597081
  error estimate for blocks of size 2^( 5) =       0.000406998705
  error estimate for blocks of size 2^( 6) =       0.000410855863
  error estimate for blocks of size 2^( 7) =       0.000410187348

      target function =      -0.950664618034
              le_mean =     -17.211548201180
             les_mean =     296.513948696815
             stat err =       0.000407409749
             autocorr =       1.244872066168
   target nu stat err =       0.000407409749
   target dn stat err =       0.001666573392
      target stat err =       0.003000811284
              std dev =       0.516405671028
             le_variance =       0.266674817069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266631911419
                                         uncertainty =       0.001251512925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266631911419
                                         uncertainty =       0.001251512925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365148110
  error estimate for blocks of size 2^( 2) =       0.000379308762
  error estimate for blocks of size 2^( 3) =       0.000392208415
  error estimate for blocks of size 2^( 4) =       0.000401597081
  error estimate for blocks of size 2^( 5) =       0.000406998705
  error estimate for blocks of size 2^( 6) =       0.000410855863
  error estimate for blocks of size 2^( 7) =       0.000410187348

      target function =      -0.950664618037
              le_mean =     -17.211548201180
             les_mean =     296.513948696813
             stat err =       0.000407409749
             autocorr =       1.244872066174
   target nu stat err =       0.000407409749
   target dn stat err =       0.001666573392
      target stat err =       0.003000811284
              std dev =       0.516405671027
             le_variance =       0.266674817069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266631911419
                                         uncertainty =       0.001251512925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266631911419
                                         uncertainty =       0.001251512925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365148110
  error estimate for blocks of size 2^( 2) =       0.000379308762
  error estimate for blocks of size 2^( 3) =       0.000392208415
  error estimate for blocks of size 2^( 4) =       0.000401597081
  error estimate for blocks of size 2^( 5) =       0.000406998705
  error estimate for blocks of size 2^( 6) =       0.000410855863
  error estimate for blocks of size 2^( 7) =       0.000410187348

      target function =      -0.950664618039
              le_mean =     -17.211548201180
             les_mean =     296.513948696812
             stat err =       0.000407409749
             autocorr =       1.244872066176
   target nu stat err =       0.000407409749
   target dn stat err =       0.001666573392
      target stat err =       0.003000811284
              std dev =       0.516405671027
             le_variance =       0.266674817069


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950664618039        initial  <--
     9.7656e+07     9.7656e+08             4.4132e-12        -0.950664618034
     3.9062e+08     3.9062e+09             1.1036e-12        -0.950664618037
     1.5625e+09     1.5625e+10             2.7620e-13        -0.950664618039

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0244
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8222e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2111
    reference variance = 0.193231
====================================================
  Execution time = 2.8300e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0411e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8036e-01
  Total weights = 1.957338884e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8812e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266685292523
                                         uncertainty =       0.001564841153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266685292523
                                         uncertainty =       0.001564841153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365153110
  error estimate for blocks of size 2^( 2) =       0.000378881754
  error estimate for blocks of size 2^( 3) =       0.000391219467
  error estimate for blocks of size 2^( 4) =       0.000400601956
  error estimate for blocks of size 2^( 5) =       0.000406980095
  error estimate for blocks of size 2^( 6) =       0.000410046707
  error estimate for blocks of size 2^( 7) =       0.000411042923

      target function =      -0.944020125762
              le_mean =     -17.212685361521
             les_mean =     296.556894765356
             stat err =       0.000407167920
             autocorr =       1.243360594040
   target nu stat err =       0.000407167920
   target dn stat err =       0.002852006559
      target stat err =       0.004970965756
              std dev =       0.516412743222
             le_variance =       0.266682121362


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721268536152e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944045105431       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944045105431       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944045105431       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944044680016       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944045136225       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944044807158       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944044741683       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944043615836       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944046081940       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944046118045       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944045731346       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944046713534       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944044400341       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944046543786       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944045262717       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944046785043       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944044873194       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944045482423       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944043777270       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944043920573       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944047492120       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944043257715       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944044051612       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944043828032       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944039943047       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944046167223       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944048275743       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944035824770       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944039721705       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944044272628       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944045740561       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944048401716       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.944046448354       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944047148126       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944050629984       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944043991488       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944045043395       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944041924332       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944042515306       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.944042698666       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944045148003       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944044222246       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.944045238767       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.944045346018       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+08 is 4.089460e-13

solving harmonic davidson linear method for identity shift 3.9062e+09, overlap shift 3.9062e+10 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944045105431       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944045105431       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944045105431       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944044663278       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944045542826       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944046351709       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944049581717       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944048910285       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944041926132       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944043074947       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944037194595       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944036112163       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944048399616       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944035462320       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944043122978       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944045868632       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944064734861       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944046034346       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944040791233       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944039285167       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944056811457       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944035951954       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944057705785       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944037386457       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944045163629       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944053957475       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944041702227       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944051795377       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944040185453       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944034014251       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944043133799       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944062689517       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.944016511383       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944059416695       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944045535074       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944046719986       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944041748307       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944051301939       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944050029403       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.944049758322       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944056395723       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944054066036       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.944047705995       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.944031836456       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.944040219485       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.944039114023       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.944033607553       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.944026347408       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.944048816043       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.944050659125       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.944039557361       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.944047562007       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.944052281583       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.944050361733       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.944030171856       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.944034734795       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.944026983308       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.944027132788       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.944021700596       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.944030670647       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.944051291406       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.944039215488       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.944071728213       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.944040665602       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.944046925973       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.944038857412       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.944077376995       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.944024442741       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.944084897844       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.944046312216       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.944030231837       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.944037433031       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.944053383546       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.944056743381       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.944019962826       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.943957992486       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.944025275797       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.944026383031       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.943997486309       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.944003192409       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.943994701079       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.943952164238       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.944172211851       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.944054646429       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.943978100888       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.944398563370       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.944064313130       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.944059682777       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.943849180596       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.943819440461       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.944272913693       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.943690210608       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.944660322168       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.944183274903       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.944361457387       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.943944341220       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.944326553142       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.944084406059       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.944079206375       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.943800760048       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.944117612650       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.944201366161       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.943435085702       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.944143514736       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.943554501342       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.943687871506       residual = 9.22e-05           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.944167079497       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.944180635191       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration  108 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+09 is 1.023779e-13

solving harmonic davidson linear method for identity shift 1.5625e+10, overlap shift 1.5625e+11 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944045105431       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944045105431       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944045105431       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944045105431       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944048316496       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944047599943       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944060534506       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944027737396       residual = 9.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944044259753       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944050312429       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944047367784       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944037258719       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944003705143       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944038410452       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944125425826       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944067243924       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944078154316       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944029114142       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944051732708       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944042598161       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944057879708       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944026682695       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944049564235       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944032421392       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944026948280       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944018152066       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944094077681       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944027312386       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944003816093       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944033397094       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944064364417       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944045927266       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943995905331       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944040735365       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944061498094       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944076236478       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944052165449       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944042208489       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944018557418       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.944007944858       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.943990563559       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944002428204       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.944014922199       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.943978559752       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.943798662135       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.943974923290       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.944096378849       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.943867495658       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.944101743705       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.944053801285       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.943958886317       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.943770501725       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.944168049798       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.944295772045       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.944125150969       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.944028817571       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.944057545768       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.944174690268       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.944224481485       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.944150997820       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.943973873517       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.944038069498       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.944104441735       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.944011706643       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.944077568946       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.943878474429       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.943885564418       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.944000267901       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.944271151454       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.944276489300       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.944337639461       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.943838204847       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.944324893131       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.943892754182       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.943608732357       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.944314699540       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.944631351536       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.943954244208       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.944263960861       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.943781488753       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.944017709657       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.944715590549       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.944412887813       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.944372166825       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.943504778866       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.944615336691       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.944831403129       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.944066790171       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.944358371912       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.942290044797       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.944628342830       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.941892969449       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.944571132053       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.943304733386       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.945065598627       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.943232809283       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.943252680778       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.946375712209       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.942991326897       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.944864998476       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.944226996892       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.943429277802       residual = 7.61e-04           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.941051877231       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.944667273750       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.944747230816       residual = 5.30e-04           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.945833984054       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.943609149726       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.939042014736       residual = 6.34e-03           smallest_sin_value = 1.00e+00
davidson iteration  108:   krylov dim = 109   tar_fn =      -0.946883083137       residual = 6.09e-03           smallest_sin_value = 9.95e-01
davidson iteration  109 stopping due to small subspace S singular value of 9.40e-01
davidson solver did not converge after        109 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+10 is 2.469239e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.249336 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8166e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1403
    reference variance = 0.167246
====================================================
  Execution time = 2.8024e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7872e-01
  Total weights = 1.9575e+06
  Execution time = 2.4880e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267170431919
                                         uncertainty =       0.001531788253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267170431919
                                         uncertainty =       0.001531788253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365466939
  error estimate for blocks of size 2^( 2) =       0.000379630026
  error estimate for blocks of size 2^( 3) =       0.000392430337
  error estimate for blocks of size 2^( 4) =       0.000401485153
  error estimate for blocks of size 2^( 5) =       0.000406938185
  error estimate for blocks of size 2^( 6) =       0.000409568530
  error estimate for blocks of size 2^( 7) =       0.000411725897

      target function =      -0.946878126422
              le_mean =     -17.212327284181
             les_mean =     296.542930264616
             stat err =       0.000407429441
             autocorr =       1.242821122295
   target nu stat err =       0.000407429441
   target dn stat err =       0.001919823533
      target stat err =       0.003408809992
              std dev =       0.516856570830
             le_variance =       0.267140714810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267170431919
                                         uncertainty =       0.001531788253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267170431919
                                         uncertainty =       0.001531788253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365466939
  error estimate for blocks of size 2^( 2) =       0.000379630026
  error estimate for blocks of size 2^( 3) =       0.000392430337
  error estimate for blocks of size 2^( 4) =       0.000401485153
  error estimate for blocks of size 2^( 5) =       0.000406938185
  error estimate for blocks of size 2^( 6) =       0.000409568530
  error estimate for blocks of size 2^( 7) =       0.000411725897

      target function =      -0.946878126422
              le_mean =     -17.212327284181
             les_mean =     296.542930264616
             stat err =       0.000407429441
             autocorr =       1.242821122297
   target nu stat err =       0.000407429441
   target dn stat err =       0.001919823533
      target stat err =       0.003408809992
              std dev =       0.516856570830
             le_variance =       0.267140714810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267170431919
                                         uncertainty =       0.001531788253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267170431919
                                         uncertainty =       0.001531788253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365466939
  error estimate for blocks of size 2^( 2) =       0.000379630026
  error estimate for blocks of size 2^( 3) =       0.000392430337
  error estimate for blocks of size 2^( 4) =       0.000401485153
  error estimate for blocks of size 2^( 5) =       0.000406938185
  error estimate for blocks of size 2^( 6) =       0.000409568530
  error estimate for blocks of size 2^( 7) =       0.000411725897

      target function =      -0.946878126422
              le_mean =     -17.212327284181
             les_mean =     296.542930264616
             stat err =       0.000407429441
             autocorr =       1.242821122302
   target nu stat err =       0.000407429441
   target dn stat err =       0.001919823533
      target stat err =       0.003408809992
              std dev =       0.516856570830
             le_variance =       0.267140714810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267170431919
                                         uncertainty =       0.001531788253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267170431919
                                         uncertainty =       0.001531788253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365466939
  error estimate for blocks of size 2^( 2) =       0.000379630026
  error estimate for blocks of size 2^( 3) =       0.000392430337
  error estimate for blocks of size 2^( 4) =       0.000401485153
  error estimate for blocks of size 2^( 5) =       0.000406938185
  error estimate for blocks of size 2^( 6) =       0.000409568530
  error estimate for blocks of size 2^( 7) =       0.000411725897

      target function =      -0.946878126422
              le_mean =     -17.212327284181
             les_mean =     296.542930264616
             stat err =       0.000407429441
             autocorr =       1.242821122301
   target nu stat err =       0.000407429441
   target dn stat err =       0.001919823533
      target stat err =       0.003408809992
              std dev =       0.516856570830
             le_variance =       0.267140714810


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946878126422        initial  <--
     9.7656e+08     9.7656e+09             4.0895e-13        -0.946878126422
     3.9062e+09     3.9062e+10             1.0238e-13        -0.946878126422
     1.5625e+10     1.5625e+11             2.4692e-14        -0.946878126422

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.5752
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8749e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2165
    reference variance = 0.262338
====================================================
  Execution time = 2.8648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0382e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8029e-01
  Total weights = 1.957570283e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6560e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268936717170
                                         uncertainty =       0.001669870546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268936717170
                                         uncertainty =       0.001669870546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366676462
  error estimate for blocks of size 2^( 2) =       0.000380742701
  error estimate for blocks of size 2^( 3) =       0.000393539828
  error estimate for blocks of size 2^( 4) =       0.000402729842
  error estimate for blocks of size 2^( 5) =       0.000408529142
  error estimate for blocks of size 2^( 6) =       0.000411674976
  error estimate for blocks of size 2^( 7) =       0.000413300030

      target function =      -0.944157396787
              le_mean =     -17.212356490080
             les_mean =     296.545508212490
             stat err =       0.000409058498
             autocorr =       1.244528289419
   target nu stat err =       0.000409058498
   target dn stat err =       0.002144452462
      target stat err =       0.003769022270
              std dev =       0.518567122663
             le_variance =       0.268911860707


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721235649008e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944171304871       residual = 8.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944171304871       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944171304871       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944171304871       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944181488058       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944174481223       residual = 9.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944151733621       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944161802387       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944171836650       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944166508334       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944159453145       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944139722245       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944160008017       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944150302975       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944175410116       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944172183475       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944146964172       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944170686971       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944139494266       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944158009667       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944165188287       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944156637283       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944146412578       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944127031375       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944145099377       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944171266442       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944148432205       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944158721232       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944158762488       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944149895659       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944143934192       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944194450631       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.944177160896       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944136605310       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944166085389       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944166703780       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944200745256       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944154988982       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944180325012       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.944169163862       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944190463590       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944156471815       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.944155361626       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.944200270543       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.944174994991       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.944202156831       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.944160639836       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.944159717870       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.944198400816       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.944226961359       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.944242132061       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.944110058250       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.944225047008       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.944177710599       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.944172764453       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.944251263083       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.944181612224       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.944188158816       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.944238380893       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.944370144044       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.944134417392       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.944260595763       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.944202599054       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.944119796216       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.944366939090       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.944358802432       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.944136042384       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.944373225291       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.944369656950       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.944100115324       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.944193003092       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.944186851211       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.943697865677       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.944047023724       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.944347131840       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.944346435786       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.944231557535       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.943896219056       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.944304639422       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.944073024466       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.944010550125       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.944106184298       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.944361523252       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.944270653820       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.944802522884       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.943728776185       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.943964946655       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.944385286891       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.944514827718       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.944396014539       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.944405793712       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.944774137410       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.944172380730       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.944536054636       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.944128366029       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.944603376708       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.944699116870       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.944739800321       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.944176578903       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.944350154912       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.944482375523       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.944918123736       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.945176352764       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.945100711366       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.944333790924       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.945788292236       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.944827309245       residual = 7.95e-04           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.942521502506       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration  108:   krylov dim = 109   tar_fn =      -0.946159878808       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration  109:   krylov dim = 110   tar_fn =      -0.948414485407       residual = 1.79e-03           smallest_sin_value = 9.99e-01
davidson iteration  110:   krylov dim = 111   tar_fn =      -0.949216391946       residual = 9.03e-03           smallest_sin_value = 9.99e-01
davidson iteration  111 stopping due to small subspace S singular value of 9.10e-01
davidson solver did not converge after        111 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+09 is 5.109830e-14

solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944171304871       residual = 8.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944171304871       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944171304871       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944171304871       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944180133394       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944173032132       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944167757108       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944151528188       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944195584528       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944252247869       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944090815510       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944145854549       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944044774485       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944095883467       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944194696899       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944139931242       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944029801004       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944191294644       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944142520378       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944143063669       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944165986024       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944191880324       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944136326560       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944148864363       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944264616193       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.943968827076       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944106060130       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944184633550       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944250660009       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944054861283       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944210104593       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944033657748       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.944221099341       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944179970521       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944180896943       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944225991516       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944403999446       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944153062868       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944086259065       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.944181255697       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.943983552370       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.943968534249       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.944145228520       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.944180545066       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.944002209317       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.944086417122       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.944053759457       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.944029394158       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.943833336062       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.944243088251       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.943953029366       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.944386719893       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.944323025214       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.943986178427       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.944120891727       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.942932342384       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.943369263565       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.944372934705       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.944276421753       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.944079902290       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.943362986225       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.944859718771       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.943719619260       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.943406224451       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.944040126409       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.943437761698       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.944536130505       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.945614944641       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.943441537242       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.944266794726       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.944188420804       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.943900084504       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.941417560957       residual = 6.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.944878669269       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.943627260643       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.944210116302       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.943532695290       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.944862314867       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.945730701587       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.943872293604       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.943539012502       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.943109964534       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.942032128280       residual = 5.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.944751508620       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.946073770593       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.947389873867       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.939155748931       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.944280459975       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.945311148230       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.946691946151       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.942321136602       residual = 9.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.945692857668       residual = 7.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.945227734445       residual = 8.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.943659779778       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.945671920666       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.944012812823       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.941672540251       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.950639149947       residual = 8.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.943830540830       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.944753648440       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.940280041076       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.942981098544       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.940788536668       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.949936615543       residual = 8.85e-03           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.945141265257       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.951193839887       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.948109661220       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.945871656527       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration  108:   krylov dim = 109   tar_fn =      -0.932061889269       residual = 2.03e-02           smallest_sin_value = 9.98e-01
davidson iteration  109 stopping due to small subspace S singular value of 8.37e-01
davidson solver did not converge after        109 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+10 is 1.301780e-14

solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944171304871       residual = 8.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944171304871       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944171304871       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944250023557       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944235311775       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944389354037       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944171304871       residual = 8.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944008684693       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944056079975       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944521581010       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944155798566       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944597762487       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943927437483       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944066998443       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944236314704       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943844507678       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944227289946       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944191277227       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944288855540       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944243460509       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944133309046       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944122918415       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945212670642       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944114573695       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944308175850       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944120490067       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944139781023       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941932020665       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.943689179713       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.943324149602       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944559276727       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944230600650       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943951141440       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944026168755       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942825866773       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941649584547       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943563703006       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.943954043872       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944520153219       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943102441920       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944364585356       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.945925128386       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.944453110868       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.943531252065       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.944707889248       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.943754879330       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.945244299685       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.947320541359       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.944207630802       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.943847161419       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.943631355012       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.943579101616       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.945176418847       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.940996511593       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.945167377761       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.944459558330       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.945914866547       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.944763218012       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.945643096757       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.943985979391       residual = 7.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.943931875614       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.943738467477       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.943374205531       residual = 5.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.940302204237       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.944076348315       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.944145283906       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.943154203695       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.941643400555       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.944375292524       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.945339695407       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.944010905104       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.940174030800       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.950638088434       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.928389376302       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.946326964066       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.942855259672       residual = 4.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.943846927569       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.949889420670       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.945878346866       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.927435101008       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.937712317355       residual = 5.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.930249356100       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.952536193872       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.950036649607       residual = 5.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.936458318274       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.932892771540       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.935375433384       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.938556161767       residual = 8.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.944548534434       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.945973626791       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.950218888283       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.918212087327       residual = 7.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.937318770983       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.944248540382       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.946702286808       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.951359545172       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.934128690235       residual = 3.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.954477271813       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.911023775609       residual = 9.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.935664846850       residual = 1.34e-01           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.907951224649       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.946404020823       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.960342201552       residual = 9.15e-02           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.939040132373       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.945996444117       residual = 1.79e-02           smallest_sin_value = 9.99e-01
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.933135450282       residual = 5.65e-02           smallest_sin_value = 9.94e-01
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.932223443284       residual = 1.22e-01           smallest_sin_value = 9.94e-01
davidson iteration  107 stopping due to small subspace S singular value of 8.53e-01
davidson solver did not converge after        107 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+11 is 3.370754e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.699497 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8761e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.19
    reference variance = 0.194665
====================================================
  Execution time = 2.8040e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7932e-01
  Total weights = 1.9575e+06
  Execution time = 2.4896e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267517968521
                                         uncertainty =       0.001337237197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267517968521
                                         uncertainty =       0.001337237197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365701755
  error estimate for blocks of size 2^( 2) =       0.000379408591
  error estimate for blocks of size 2^( 3) =       0.000391509723
  error estimate for blocks of size 2^( 4) =       0.000400741834
  error estimate for blocks of size 2^( 5) =       0.000405560829
  error estimate for blocks of size 2^( 6) =       0.000408894677
  error estimate for blocks of size 2^( 7) =       0.000411200945

      target function =      -0.945868953049
              le_mean =     -17.211567451011
             les_mean =     296.517372011808
             stat err =       0.000406599571
             autocorr =       1.236174395653
   target nu stat err =       0.000406599571
   target dn stat err =       0.002092041365
      target stat err =       0.003687111848
              std dev =       0.517188656406
             le_variance =       0.267484106315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267517968521
                                         uncertainty =       0.001337237197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267517968521
                                         uncertainty =       0.001337237197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365701755
  error estimate for blocks of size 2^( 2) =       0.000379408591
  error estimate for blocks of size 2^( 3) =       0.000391509723
  error estimate for blocks of size 2^( 4) =       0.000400741834
  error estimate for blocks of size 2^( 5) =       0.000405560829
  error estimate for blocks of size 2^( 6) =       0.000408894677
  error estimate for blocks of size 2^( 7) =       0.000411200945

      target function =      -0.945868953049
              le_mean =     -17.211567451011
             les_mean =     296.517372011808
             stat err =       0.000406599571
             autocorr =       1.236174395656
   target nu stat err =       0.000406599571
   target dn stat err =       0.002092041365
      target stat err =       0.003687111848
              std dev =       0.517188656406
             le_variance =       0.267484106315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267517968521
                                         uncertainty =       0.001337237197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267517968521
                                         uncertainty =       0.001337237197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365701755
  error estimate for blocks of size 2^( 2) =       0.000379408591
  error estimate for blocks of size 2^( 3) =       0.000391509723
  error estimate for blocks of size 2^( 4) =       0.000400741834
  error estimate for blocks of size 2^( 5) =       0.000405560829
  error estimate for blocks of size 2^( 6) =       0.000408894677
  error estimate for blocks of size 2^( 7) =       0.000411200945

      target function =      -0.945868953049
              le_mean =     -17.211567451011
             les_mean =     296.517372011808
             stat err =       0.000406599571
             autocorr =       1.236174395650
   target nu stat err =       0.000406599571
   target dn stat err =       0.002092041365
      target stat err =       0.003687111848
              std dev =       0.517188656406
             le_variance =       0.267484106315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267517968521
                                         uncertainty =       0.001337237197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267517968521
                                         uncertainty =       0.001337237197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365701755
  error estimate for blocks of size 2^( 2) =       0.000379408591
  error estimate for blocks of size 2^( 3) =       0.000391509723
  error estimate for blocks of size 2^( 4) =       0.000400741834
  error estimate for blocks of size 2^( 5) =       0.000405560829
  error estimate for blocks of size 2^( 6) =       0.000408894677
  error estimate for blocks of size 2^( 7) =       0.000411200945

      target function =      -0.945868953049
              le_mean =     -17.211567451011
             les_mean =     296.517372011808
             stat err =       0.000406599571
             autocorr =       1.236174395656
   target nu stat err =       0.000406599571
   target dn stat err =       0.002092041365
      target stat err =       0.003687111848
              std dev =       0.517188656406
             le_variance =       0.267484106315


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945868953049        initial
     9.7656e+09     9.7656e+10             5.1098e-14        -0.945868953049
     3.9062e+10     3.9062e+11             1.3018e-14        -0.945868953049
     1.5625e+11     1.5625e+12             3.3708e-15        -0.945868953049  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+11     and shift_s =   1.5625e+12
*****************************************************************************

  Execution time = 4.0585e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2043
    reference variance = 0.180362
====================================================
  Execution time = 2.8274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0413e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7839e-01
  Total weights = 1.957520611e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7877e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268155975155
                                         uncertainty =       0.001517666762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268155975155
                                         uncertainty =       0.001517666762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366249106
  error estimate for blocks of size 2^( 2) =       0.000380140609
  error estimate for blocks of size 2^( 3) =       0.000393240170
  error estimate for blocks of size 2^( 4) =       0.000402267475
  error estimate for blocks of size 2^( 5) =       0.000408521601
  error estimate for blocks of size 2^( 6) =       0.000411595459
  error estimate for blocks of size 2^( 7) =       0.000413907023

      target function =      -0.947447474461
              le_mean =     -17.212428748867
             les_mean =     296.546090700808
             stat err =       0.000409072890
             autocorr =       1.247522107759
   target nu stat err =       0.000409072890
   target dn stat err =       0.002185430517
      target stat err =       0.003865082453
              std dev =       0.517962739969
             le_variance =       0.268285399996


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721242874887e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947462086490       residual = 8.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947462086490       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947462086490       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947462086490       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947462086279       residual = 9.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947462005687       residual = 8.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947459620348       residual = 7.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947484798365       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947523182006       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947355134681       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947412528985       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947453378784       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947403709860       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947494987475       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947494622801       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947430667512       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947410486358       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947514877092       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947488490275       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947616604592       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947286458267       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947466116210       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947415692935       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947361711335       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947382716097       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947343364272       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947441297367       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947422503005       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947460332796       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947457066779       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947458804932       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947473351764       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947502049705       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947421892766       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947329313902       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947370303725       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947502490849       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947404130202       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947672154139       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947555300802       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947331238848       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947570484144       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947312403462       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947574268769       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.946568324765       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.947482022258       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.947402633528       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.947063733961       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.947460853177       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.947232167503       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.947456599299       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.947597527417       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.947822971111       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.947303650332       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.947274907737       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.947289725562       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.947673889069       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.946986710408       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.948127266893       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.946577087328       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.946665969765       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.946807209653       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.948279890273       residual = 6.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.947645817843       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.947211628798       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.947530142456       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.946831492283       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.948157077361       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.945772164520       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.947513795715       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.947057388268       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.947072953073       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.946932197142       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.946704095377       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.947023243886       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.947891742746       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.948283352234       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.947122884988       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.946748918168       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.948793048639       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.947424593531       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.952579506255       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.945764306049       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.946005136810       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.946379608876       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.944560720116       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.948010294688       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.951407530545       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.946600185821       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.946831235764       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.944689221760       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.947146107605       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.944501220880       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.947522937924       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.947003325497       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.946108390272       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.947575428499       residual = 7.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.946575145422       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.952178763874       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.940195730245       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.946029708758       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.948059782031       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.947921982415       residual = 7.18e-03           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.933951828255       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.933733998930       residual = 2.87e-02           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.961842698495       residual = 1.75e-02           smallest_sin_value = 9.99e-01
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.955061274446       residual = 8.16e-03           smallest_sin_value = 9.99e-01
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.948627508604       residual = 1.64e-03           smallest_sin_value = 9.99e-01
davidson iteration  108 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+10 is 1.544938e-14

solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947462086490       residual = 8.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947462086490       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947462086490       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947461490288       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947462086451       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947462074326       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947311200311       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947414927815       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946868595539       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947247945654       residual = 9.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947410114404       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948100581885       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947832892179       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947883647235       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947194147337       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947375550118       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947621440197       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947594229472       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947268188036       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947209315368       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947293825471       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946800276742       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947317508133       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947392151731       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947428995971       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947123500205       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947625351137       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947262092495       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947893976506       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947435220969       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947448281164       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947662097683       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.948661016767       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.946451781648       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.945834038069       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.946178901122       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947167292449       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948308525431       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.946195705496       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947627327186       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947183092563       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.946396566053       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.948688194751       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.950034563365       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.948380284179       residual = 9.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.947336088409       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.943807478142       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.950632070587       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.948250751143       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.947953353403       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.948373221926       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.951107511789       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.948211917385       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.944994564432       residual = 6.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.947003257116       residual = 5.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.946060505411       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.950930999734       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.946719216475       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.945691447622       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.949600522271       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.954279766951       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.946866101170       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.947064300814       residual = 8.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.947267733333       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.949814958207       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.945250940191       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.948384750199       residual = 8.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.945768489678       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.946000961090       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.948139985560       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.943585408619       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.943338367314       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.949720230665       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.946546289074       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.947896340154       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.951954276686       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.950300397368       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.943101197667       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.946279408690       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.945602845597       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.953415208126       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.938811212238       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.953306092156       residual = 6.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.943608784489       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.946181213558       residual = 6.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.952013351340       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.955467885811       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.950846248692       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.936456713826       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.956520874090       residual = 5.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.959960432607       residual = 3.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.938926181349       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.908972180623       residual = 1.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.893920371114       residual = 2.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.910703373360       residual = 1.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.952474249134       residual = 6.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.925121806497       residual = 6.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.910789742468       residual = 3.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.917090717489       residual = 2.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.985439907331       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.922984122191       residual = 2.17e-01           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.941547208042       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.941544100447       residual = 5.81e-02           smallest_sin_value = 9.99e-01
davidson iteration  103:   krylov dim = 104   tar_fn =      -1.065260028668       residual = 1.34e+00           smallest_sin_value = 9.99e-01
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.973392900578       residual = 6.44e-01           smallest_sin_value = 9.99e-01
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.889189360186       residual = 3.64e-01           smallest_sin_value = 9.99e-01
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.931235151423       residual = 1.96e-01           smallest_sin_value = 9.99e-01
davidson iteration  107:   krylov dim = 108   tar_fn =      -1.017125943829       residual = 8.24e-01           smallest_sin_value = 9.99e-01
davidson iteration  108 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+11 is 3.953200e-15

solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947462086490       residual = 8.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947462086490       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947462086490       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947462086490       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947464361217       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947462086490       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947619791451       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946773519384       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945463314069       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947532819827       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948954352624       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947894934783       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947193841670       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947547416281       residual = 9.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947611972210       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947546759295       residual = 9.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948124949254       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947376839945       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946372359172       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946813358509       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951588013917       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944635676863       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949350173051       residual = 6.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948210903637       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946879206850       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.948501282026       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.949927528616       residual = 5.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947264283766       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947674112533       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947031357515       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.946586492629       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.943554449194       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.950216562821       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.956717911503       residual = 8.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943015580402       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.949095781930       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.940211183171       residual = 4.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944870875516       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.942627974216       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941935838844       residual = 3.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.954764708369       residual = 6.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.943839433408       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.942205373727       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.951178177332       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.941577397537       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.930526439511       residual = 3.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.952936841470       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.944747137161       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.945928860446       residual = 6.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.934243515386       residual = 5.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.946097756973       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.939999766282       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.935298377315       residual = 2.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.953451919338       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.925798603871       residual = 4.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.968231575270       residual = 5.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.943540049117       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.938958451357       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.948955433860       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.944498820364       residual = 7.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.943227807463       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.939553871728       residual = 3.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.952159654153       residual = 5.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.927674002458       residual = 4.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.939682761691       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.943293323790       residual = 5.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.955040292038       residual = 4.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.903921153216       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.958313858088       residual = 6.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.958454797206       residual = 9.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.940342359994       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.914853289759       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.963978114672       residual = 4.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.928075106728       residual = 2.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.971093705225       residual = 7.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.945683609636       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.924061311612       residual = 2.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.980189819722       residual = 2.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.985362633207       residual = 1.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.898810449015       residual = 3.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.104561395757       residual = 2.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.910272484058       residual = 1.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.999535276402       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.977476254877       residual = 2.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.945528194603       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.824691794231       residual = 1.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.835730014276       residual = 1.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.981328936495       residual = 7.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.846014372111       residual = 1.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.939182241621       residual = 1.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -1.052166103663       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.958469415676       residual = 7.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -1.103672377502       residual = 2.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -1.122831820177       residual = 6.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.897482339885       residual = 9.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.986755632394       residual = 8.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.934417899851       residual = 3.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.917699480611       residual = 4.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -1.060848639913       residual = 2.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.718311627739       residual = 6.02e+00           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -1.005099878431       residual = 4.60e+00           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.973080861940       residual = 7.67e+00           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -1.038519708523       residual = 5.34e+00           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.938715414970       residual = 1.00e+01           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.961463238931       residual = 1.53e+00           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.817512860222       residual = 2.91e+00           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -1.169054176393       residual = 4.92e+00           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.926025314666       residual = 2.51e+00           smallest_sin_value = 1.00e+00
davidson iteration  108:   krylov dim = 109   tar_fn =      -0.955355538710       residual = 1.30e+01           smallest_sin_value = 1.00e+00
davidson iteration  109 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after        109 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+11 is 2.168018e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.135755 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8505e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1813
    reference variance = 0.15715
====================================================
  Execution time = 3.0215e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7636e-01
  Total weights = 1.9573e+06
  Execution time = 2.4895e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265592954330
                                         uncertainty =       0.001456672712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265592954330
                                         uncertainty =       0.001456672712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364509453
  error estimate for blocks of size 2^( 2) =       0.000378246149
  error estimate for blocks of size 2^( 3) =       0.000391150955
  error estimate for blocks of size 2^( 4) =       0.000400766515
  error estimate for blocks of size 2^( 5) =       0.000405515011
  error estimate for blocks of size 2^( 6) =       0.000408151646
  error estimate for blocks of size 2^( 7) =       0.000408543038

      target function =      -0.950990491802
              le_mean =     -17.212023842541
             les_mean =     296.530123895366
             stat err =       0.000405744053
             autocorr =       1.239044012252
   target nu stat err =       0.000405744053
   target dn stat err =       0.002216574130
      target stat err =       0.003942684520
              std dev =       0.515502460334
             le_variance =       0.265742786611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265592954330
                                         uncertainty =       0.001456672712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265592954330
                                         uncertainty =       0.001456672712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364509453
  error estimate for blocks of size 2^( 2) =       0.000378246149
  error estimate for blocks of size 2^( 3) =       0.000391150955
  error estimate for blocks of size 2^( 4) =       0.000400766515
  error estimate for blocks of size 2^( 5) =       0.000405515011
  error estimate for blocks of size 2^( 6) =       0.000408151646
  error estimate for blocks of size 2^( 7) =       0.000408543038

      target function =      -0.950990491802
              le_mean =     -17.212023842541
             les_mean =     296.530123895366
             stat err =       0.000405744053
             autocorr =       1.239044012251
   target nu stat err =       0.000405744053
   target dn stat err =       0.002216574130
      target stat err =       0.003942684520
              std dev =       0.515502460335
             le_variance =       0.265742786611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265592954330
                                         uncertainty =       0.001456672712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265592954330
                                         uncertainty =       0.001456672712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364509453
  error estimate for blocks of size 2^( 2) =       0.000378246149
  error estimate for blocks of size 2^( 3) =       0.000391150955
  error estimate for blocks of size 2^( 4) =       0.000400766515
  error estimate for blocks of size 2^( 5) =       0.000405515011
  error estimate for blocks of size 2^( 6) =       0.000408151646
  error estimate for blocks of size 2^( 7) =       0.000408543038

      target function =      -0.950990491802
              le_mean =     -17.212023842541
             les_mean =     296.530123895366
             stat err =       0.000405744053
             autocorr =       1.239044012250
   target nu stat err =       0.000405744053
   target dn stat err =       0.002216574130
      target stat err =       0.003942684520
              std dev =       0.515502460334
             le_variance =       0.265742786611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265592954330
                                         uncertainty =       0.001456672712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265592954330
                                         uncertainty =       0.001456672712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364509453
  error estimate for blocks of size 2^( 2) =       0.000378246149
  error estimate for blocks of size 2^( 3) =       0.000391150955
  error estimate for blocks of size 2^( 4) =       0.000400766515
  error estimate for blocks of size 2^( 5) =       0.000405515011
  error estimate for blocks of size 2^( 6) =       0.000408151646
  error estimate for blocks of size 2^( 7) =       0.000408543038

      target function =      -0.950990491802
              le_mean =     -17.212023842541
             les_mean =     296.530123895366
             stat err =       0.000405744053
             autocorr =       1.239044012252
   target nu stat err =       0.000405744053
   target dn stat err =       0.002216574130
      target stat err =       0.003942684520
              std dev =       0.515502460334
             le_variance =       0.265742786611


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950990491802        initial
     3.9062e+10     3.9062e+11             1.5449e-14        -0.950990491802  <--
     1.5625e+11     1.5625e+12             3.9532e-15        -0.950990491802
     6.2500e+11     6.2500e+12             2.1680e-16        -0.950990491802

*****************************************************************************
Applying the update for shift_i =   3.9062e+10     and shift_s =   3.9062e+11
*****************************************************************************

  Execution time = 4.2747e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1258e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2205
    reference variance = 0.15657
====================================================
  Execution time = 2.8265e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0376e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7853e-01
  Total weights = 1.957168717e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7715e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267201501150
                                         uncertainty =       0.001652623561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267201501150
                                         uncertainty =       0.001652623561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365467720
  error estimate for blocks of size 2^( 2) =       0.000379294438
  error estimate for blocks of size 2^( 3) =       0.000391876688
  error estimate for blocks of size 2^( 4) =       0.000400410149
  error estimate for blocks of size 2^( 5) =       0.000405609041
  error estimate for blocks of size 2^( 6) =       0.000407922968
  error estimate for blocks of size 2^( 7) =       0.000410189920

      target function =      -0.947210478029
              le_mean =     -17.212000360815
             les_mean =     296.531487056163
             stat err =       0.000406033020
             autocorr =       1.234311164297
   target nu stat err =       0.000406033020
   target dn stat err =       0.002424688913
      target stat err =       0.004266495458
              std dev =       0.516857676235
             le_variance =       0.267141857483


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721200036081e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947228642998       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947228642998       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947228642998       residual = 5.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947228642998       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947228643195       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947228636931       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947212090743       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947232058650       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947206576518       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947217471681       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947212194747       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947229366347       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947228409372       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947225199799       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947225472289       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947249430369       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947216972757       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947230453070       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947246975644       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947216081481       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947239088437       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947244649891       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947225156368       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947266883305       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947232335175       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947290569076       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947232905997       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947218777409       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947241462430       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947237106453       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947229079070       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947217187982       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947204314051       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947226686458       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947244555758       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947229218607       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947209990798       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947237212225       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947230823353       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947222474852       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947229265993       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947235045312       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947221151556       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947234307404       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.947192636662       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.947240788313       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.947245511958       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.947205081962       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.947133885487       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.947199619514       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.947197266756       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.947309849848       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.947368732331       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.947222324980       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.947151903357       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.947178330581       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.947346016687       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.947213063318       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.947222638247       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.947189016808       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.947230876083       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.947236620510       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.947206311251       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.947222990503       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.947257884934       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.947358821854       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.947262447110       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.947182928726       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.947235064138       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.947156529606       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.947173587111       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.947240853785       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.947188586388       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.947158682122       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.946899119891       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.947441745553       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.947255812950       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.947292428478       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.947475136059       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.947363982426       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.947624517808       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.947080948134       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.948019796878       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.946101196138       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.947124015206       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.947378767476       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.946237229001       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.947807432336       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.944839412012       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.948401315688       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.947422513634       residual = 7.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.945967980016       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.948793454246       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.942598990415       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.947973130313       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.947736847501       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.943657679414       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.945460500281       residual = 8.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.948656903887       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.948105902866       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.947528220568       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.949641809658       residual = 5.86e-04           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.946042585762       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.949727555177       residual = 9.88e-04           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.959638339807       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.946783242056       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.949704759229       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.948598694267       residual = 1.28e-03           smallest_sin_value = 9.96e-01
davidson iteration  108 stopping due to small subspace S singular value of 8.86e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+09 is 5.172026e-14

solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947228642998       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947228642998       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947228642998       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947228642999       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947228642990       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947228618768       residual = 8.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947216424600       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947260249497       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947249265420       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947212934892       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947183634774       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947157993483       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947220775707       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947214353527       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947216007406       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947249640573       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947350051645       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947174767157       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947234054472       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947138758051       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947170450901       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947343511366       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947265803081       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947178864147       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947371932406       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947235936767       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947193522936       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947231097176       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947307129849       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947070123480       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947176254390       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947145427164       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947179615181       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947258320672       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947255532745       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947132414783       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947040025671       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947189542410       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947255668134       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947164058954       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947078007967       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947216156896       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947306262265       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947155432871       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.947262218787       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.947416469410       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.947370936437       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.947289472569       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.947839003510       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.947304262767       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.947259163930       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.947365147861       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.946912177761       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.946995404499       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.947077696276       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.946690922155       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.947670245940       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.947108191019       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.947291200216       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.946642141236       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.947386418788       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.947309218821       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.946304198531       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.947847881833       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.946629183673       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.947190280990       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.946721394358       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.948539753105       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.945927422282       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.947051081296       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.948709346186       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.947903695642       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.947046856406       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.947279473443       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.946817056735       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.947718828264       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.948542180607       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.947307482214       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.947239292112       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.947070196438       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.948049399992       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.947360031443       residual = 8.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.948458870282       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.947842568616       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.944048028871       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.944272856702       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.941245880924       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.941277727495       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.949917619563       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.944768466089       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.947130092180       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.943326364482       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.950188528893       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.944207512501       residual = 3.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.947803212905       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.947162474198       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.943634337062       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.948111072406       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.940279367190       residual = 5.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.943311916911       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.945214048290       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.944289558260       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.950626068077       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.950300717617       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.946285966586       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.951459305736       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.933959422711       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.938011524457       residual = 2.41e-02           smallest_sin_value = 1.00e+00
davidson iteration  108:   krylov dim = 109   tar_fn =      -0.954669512132       residual = 2.10e-02           smallest_sin_value = 9.92e-01
davidson iteration  109 stopping due to small subspace S singular value of 8.35e-01
davidson solver did not converge after        109 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+10 is 1.387558e-14

solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947228642998       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947228642998       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947228642998       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947228642998       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947228642998       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947228642995       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947228149648       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947500054189       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946947751733       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947242491608       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947057803924       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946969121808       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947012729735       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946960149277       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947449992197       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947627326136       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947155256162       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947117244642       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947569713600       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947322654469       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947521652384       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946516121021       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947203124476       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946941966422       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946588507266       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947722366034       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947019808918       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947233148693       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.945892097986       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947796311417       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947981883882       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947203150892       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947111911022       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.945343338455       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.946804986253       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947392851328       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.946967134388       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.946249831711       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947099777160       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.948767113478       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.946931752640       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.949235001336       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.949377247095       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947728209620       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.946436823623       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.948629444542       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.947069673256       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.948890095803       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.948099686025       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.952289313075       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.945394135576       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.950015013676       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.946168911679       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.949449199306       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.945910413578       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.941770717527       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.947136482519       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.948996690795       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.947653872082       residual = 5.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.947935688947       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.947621615628       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.947659038218       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.947719019179       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.938121247250       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.949475157504       residual = 6.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.946462242456       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.949499600104       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.945504460822       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.944319785676       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.949550762746       residual = 7.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.947489639010       residual = 9.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.952175845298       residual = 4.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.947120100324       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.941317413177       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.947816447061       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.951270161005       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.947747468251       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.949368174243       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.956957860596       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.951320005768       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.923773985739       residual = 6.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.942302669805       residual = 7.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.958177396412       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.936448683037       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.943721610164       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.956111036391       residual = 2.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.941235658183       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.932019826131       residual = 3.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.976351932938       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.958940123755       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.949426656291       residual = 6.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.918287438017       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.944461227968       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.970353667587       residual = 7.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.940421250644       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.935274478950       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.917829721414       residual = 9.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.952486927980       residual = 4.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.980691279085       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.915392774393       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -1.013098706887       residual = 4.46e-01           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.934097800817       residual = 6.70e-02           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.885421926094       residual = 6.80e-01           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.925408418727       residual = 4.83e-01           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.956490251212       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.933606515131       residual = 2.83e-01           smallest_sin_value = 9.99e-01
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.960762954532       residual = 1.32e-01           smallest_sin_value = 9.98e-01
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.940198342560       residual = 3.15e-01           smallest_sin_value = 9.98e-01
davidson iteration  108 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+11 is 2.104789e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.514843 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8423e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.206
    reference variance = 0.249518
====================================================
  Execution time = 2.8315e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7750e-01
  Total weights = 1.9573e+06
  Execution time = 2.4960e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265902434415
                                         uncertainty =       0.001533684439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265902434415
                                         uncertainty =       0.001533684439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364696435
  error estimate for blocks of size 2^( 2) =       0.000378418755
  error estimate for blocks of size 2^( 3) =       0.000391420894
  error estimate for blocks of size 2^( 4) =       0.000400834112
  error estimate for blocks of size 2^( 5) =       0.000406651977
  error estimate for blocks of size 2^( 6) =       0.000411113254
  error estimate for blocks of size 2^( 7) =       0.000412413281

      target function =      -0.948998558127
              le_mean =     -17.212301970971
             les_mean =     296.540835070760
             stat err =       0.000407753156
             autocorr =       1.250062208149
   target nu stat err =       0.000407753156
   target dn stat err =       0.002323040096
      target stat err =       0.004111343508
              std dev =       0.515766896683
             le_variance =       0.266015491714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265902434415
                                         uncertainty =       0.001533684439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265902434415
                                         uncertainty =       0.001533684439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364696435
  error estimate for blocks of size 2^( 2) =       0.000378418755
  error estimate for blocks of size 2^( 3) =       0.000391420894
  error estimate for blocks of size 2^( 4) =       0.000400834112
  error estimate for blocks of size 2^( 5) =       0.000406651977
  error estimate for blocks of size 2^( 6) =       0.000411113254
  error estimate for blocks of size 2^( 7) =       0.000412413281

      target function =      -0.948998558127
              le_mean =     -17.212301970971
             les_mean =     296.540835070760
             stat err =       0.000407753156
             autocorr =       1.250062208149
   target nu stat err =       0.000407753156
   target dn stat err =       0.002323040096
      target stat err =       0.004111343508
              std dev =       0.515766896683
             le_variance =       0.266015491714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265902434415
                                         uncertainty =       0.001533684439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265902434415
                                         uncertainty =       0.001533684439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364696435
  error estimate for blocks of size 2^( 2) =       0.000378418755
  error estimate for blocks of size 2^( 3) =       0.000391420894
  error estimate for blocks of size 2^( 4) =       0.000400834112
  error estimate for blocks of size 2^( 5) =       0.000406651977
  error estimate for blocks of size 2^( 6) =       0.000411113254
  error estimate for blocks of size 2^( 7) =       0.000412413281

      target function =      -0.948998558127
              le_mean =     -17.212301970971
             les_mean =     296.540835070760
             stat err =       0.000407753156
             autocorr =       1.250062208149
   target nu stat err =       0.000407753156
   target dn stat err =       0.002323040096
      target stat err =       0.004111343508
              std dev =       0.515766896683
             le_variance =       0.266015491714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265902434415
                                         uncertainty =       0.001533684439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265902434415
                                         uncertainty =       0.001533684439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364696435
  error estimate for blocks of size 2^( 2) =       0.000378418755
  error estimate for blocks of size 2^( 3) =       0.000391420894
  error estimate for blocks of size 2^( 4) =       0.000400834112
  error estimate for blocks of size 2^( 5) =       0.000406651977
  error estimate for blocks of size 2^( 6) =       0.000411113254
  error estimate for blocks of size 2^( 7) =       0.000412413281

      target function =      -0.948998558127
              le_mean =     -17.212301970971
             les_mean =     296.540835070760
             stat err =       0.000407753156
             autocorr =       1.250062208149
   target nu stat err =       0.000407753156
   target dn stat err =       0.002323040096
      target stat err =       0.004111343508
              std dev =       0.515766896683
             le_variance =       0.266015491714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948998558127        initial
     9.7656e+09     9.7656e+10             5.1720e-14        -0.948998558127
     3.9062e+10     3.9062e+11             1.3876e-14        -0.948998558127  <--
     1.5625e+11     1.5625e+12             2.1048e-15        -0.948998558127

*****************************************************************************
Applying the update for shift_i =   3.9062e+10     and shift_s =   3.9062e+11
*****************************************************************************

  Execution time = 4.0877e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9307e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1954
    reference variance = 0.203077
====================================================
  Execution time = 2.8930e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0353e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7594e-01
  Total weights = 1.957289431e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8769e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265472848028
                                         uncertainty =       0.001530522399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265472848028
                                         uncertainty =       0.001530522399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364285196
  error estimate for blocks of size 2^( 2) =       0.000377989839
  error estimate for blocks of size 2^( 3) =       0.000390794240
  error estimate for blocks of size 2^( 4) =       0.000400069893
  error estimate for blocks of size 2^( 5) =       0.000405306641
  error estimate for blocks of size 2^( 6) =       0.000408184301
  error estimate for blocks of size 2^( 7) =       0.000411328278

      target function =      -0.951724491107
              le_mean =     -17.211791524487
             les_mean =     296.521711631303
             stat err =       0.000406222278
             autocorr =       1.243496104723
   target nu stat err =       0.000406222278
   target dn stat err =       0.002029767421
      target stat err =       0.003626822092
              std dev =       0.515185307802
             le_variance =       0.265415901375


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721179152449e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951737173282       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951737173282       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951737173282       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951737173281       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951739494592       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951732781153       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951732265566       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951735225913       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951766455668       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951728144581       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951750273463       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951737173282       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951741402236       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951716477193       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951736621578       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951699071011       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951738066767       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951735242818       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951750827854       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951737177383       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951734749318       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951738775659       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951645450216       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951783549375       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.951743136345       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951737753273       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.951735951033       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951751130067       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.951699454318       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.951720344360       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951691490052       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.951724231904       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951758976854       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.951778042951       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.951747289371       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.951757833705       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.951701635349       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951764730285       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.951762778162       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.951752392909       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.951747883157       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.951812992710       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.951703743760       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.951764331103       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.951708293873       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.951734197927       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.951693266239       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.951626311277       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.951681798772       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.951765732645       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.951823594524       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.951734720314       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.951692975094       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.951753501315       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.951744266116       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.951482983511       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.951646892402       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.951762620132       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.951747771984       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.951829647181       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.951748209637       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.951584916293       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.951523580054       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.951727761535       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.951678966117       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.951594754403       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.951618402232       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.951670938496       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.951879838724       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.952002622548       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.951834463934       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.951754481761       residual = 9.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.951712060670       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.952279041612       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.951337245982       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.951615556051       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.951614123358       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.951826463645       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.951863320983       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.951721568992       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.951487625754       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.951920449426       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.952493129994       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.952386010807       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.951918545386       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.952277314712       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.952057518885       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.951163288213       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.951699752613       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.951358906719       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.951412784057       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.952037835464       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.953501461815       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.951376249725       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.951007232663       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.951261936656       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.951463427656       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.952438478946       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.952273813539       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.950914174319       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.952079147440       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.952816806681       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.951652574517       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.951944532911       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.951020335699       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.950163753563       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.948795087696       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.949272922778       residual = 1.27e-03           smallest_sin_value = 9.95e-01
davidson iteration  108 stopping due to small subspace S singular value of 9.60e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+09 is 4.923076e-14

solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951737173282       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951737173282       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951737173282       residual = 4.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951737173282       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951737173282       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951730045273       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951806176859       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951785699589       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951706953486       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951735896092       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951618411902       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951689476801       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951684711336       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951881702172       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951746172554       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951598434915       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951740879011       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951823398073       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951670358076       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951811643281       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951804358972       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951763283776       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951762701520       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951734239638       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.951739365690       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951573245274       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.951702561705       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951871967837       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.951770353492       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.951654931387       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951671699594       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.951630599429       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951598319627       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.951792779864       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.951586408191       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.951668014608       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.951897300451       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951715381705       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.951719343166       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.951855238659       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.951617825439       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.951669032959       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.951725352099       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.951540155917       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.951866950886       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.951430763188       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.952052649236       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.951601578508       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.952064607220       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.951461350371       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.951928211946       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.951981529152       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.951914390637       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.951679685885       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.951193094612       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.951562625534       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.951738060252       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.950696661905       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.951235552697       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.951623662494       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.951738911422       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.951122753588       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.951591272664       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.952558108551       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.952454430351       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.951820173189       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.951595929571       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.952118560098       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.951574507113       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.952304016058       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.952234060455       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.953065707270       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.952675464203       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.952028085530       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.951153862601       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.952228260788       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.951234981798       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.950933380198       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.952098774229       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.953397095689       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.948797500588       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.951781933339       residual = 9.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.954479754403       residual = 8.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.951143580098       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.949676594967       residual = 7.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.947922666888       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.950216914021       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.951315904576       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.947761000254       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.953793432124       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.953298036119       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.954328097146       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.950005344720       residual = 6.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.955844139916       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.946092279135       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.940400210655       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.936488481776       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.950952853984       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.951181014847       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.951555839645       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.950435347227       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.935589409396       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.962236784217       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.946648809807       residual = 6.71e-03           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.955540117602       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.956375612837       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.951457020527       residual = 7.55e-03           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.944196265748       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration  108 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+10 is 1.212728e-14

solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951737173282       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951737173282       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951737173282       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951706723384       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951697700577       residual = 9.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951724005189       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951664389980       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951595816871       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951522502253       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952259085458       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951519888982       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.952007567106       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951707689557       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.952004776779       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951634679997       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951572322822       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951506050765       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951728954666       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.952035484258       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951313081557       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.952208258781       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.952089051639       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951632620719       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951315520809       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.951876142624       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.952036819236       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.951925818243       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951716272189       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.951396658864       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.952269667117       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951541841057       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.951077859147       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951633388736       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.951502671456       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.951462243777       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.951945903434       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.951030219253       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.950861504379       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.951522114342       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.952144743425       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.953323704117       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.950903229914       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.951473595974       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.950881282512       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.952242253948       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.950929885229       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.951816418786       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.952254493219       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.951412998254       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.952777534774       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.952589653810       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.949883789694       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.950786097542       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.953299835926       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.952152245660       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.951811702072       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.951729046231       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.955544507987       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.955417457968       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.945930957928       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.945740388337       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.955658564893       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.953229664737       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.954932116475       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.951848545570       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.952556652464       residual = 4.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.947395980241       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.952466962914       residual = 5.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.954470468461       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.955789199412       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.948782478607       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.948397155492       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.953909643962       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.941711771426       residual = 9.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.944934624098       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.952361736029       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.957285942606       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.952849035782       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.981735423022       residual = 8.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.948689203538       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.955589229074       residual = 7.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.947121497133       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.956000725038       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.950271920800       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.962281905662       residual = 4.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.940929119598       residual = 2.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.951307514186       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.960579248352       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.949034675734       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.949368443870       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.953165958932       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.955307722774       residual = 6.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.940475109936       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.953092175083       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.956639201739       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.939948126490       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.924062957310       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -1.006499406181       residual = 3.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.954722493044       residual = 9.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.940353474958       residual = 3.28e-02           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.936038617802       residual = 4.58e-02           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.946787507975       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.973010986761       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.933997907385       residual = 2.59e-01           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.939670334858       residual = 8.43e-02           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.921478701163       residual = 9.01e-02           smallest_sin_value = 9.99e-01
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.912831081514       residual = 2.03e-01           smallest_sin_value = 9.99e-01
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.884126780246       residual = 5.37e-01           smallest_sin_value = 9.94e-01
davidson iteration  108 stopping due to small subspace S singular value of 9.16e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+11 is 2.165414e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               9.905243 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9204e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1131
    reference variance = 0.915359
====================================================
  Execution time = 2.8500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7614e-01
  Total weights = 1.9573e+06
  Execution time = 2.4911e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265590234082
                                         uncertainty =       0.001199057398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265590234082
                                         uncertainty =       0.001199057398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364415995
  error estimate for blocks of size 2^( 2) =       0.000378182090
  error estimate for blocks of size 2^( 3) =       0.000390868733
  error estimate for blocks of size 2^( 4) =       0.000400220952
  error estimate for blocks of size 2^( 5) =       0.000405235624
  error estimate for blocks of size 2^( 6) =       0.000407970410
  error estimate for blocks of size 2^( 7) =       0.000408967937

      target function =      -0.951371901779
              le_mean =     -17.211904364492
             les_mean =     296.525795698648
             stat err =       0.000405598731
             autocorr =       1.238791770747
   target nu stat err =       0.000405598731
   target dn stat err =       0.002069684744
      target stat err =       0.003693048314
              std dev =       0.515370288783
             le_variance =       0.265606534560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265590234082
                                         uncertainty =       0.001199057398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265590234082
                                         uncertainty =       0.001199057398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364415995
  error estimate for blocks of size 2^( 2) =       0.000378182090
  error estimate for blocks of size 2^( 3) =       0.000390868733
  error estimate for blocks of size 2^( 4) =       0.000400220952
  error estimate for blocks of size 2^( 5) =       0.000405235624
  error estimate for blocks of size 2^( 6) =       0.000407970410
  error estimate for blocks of size 2^( 7) =       0.000408967937

      target function =      -0.951371901779
              le_mean =     -17.211904364492
             les_mean =     296.525795698648
             stat err =       0.000405598731
             autocorr =       1.238791770744
   target nu stat err =       0.000405598731
   target dn stat err =       0.002069684744
      target stat err =       0.003693048314
              std dev =       0.515370288783
             le_variance =       0.265606534560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265590234082
                                         uncertainty =       0.001199057398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265590234082
                                         uncertainty =       0.001199057398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364415995
  error estimate for blocks of size 2^( 2) =       0.000378182090
  error estimate for blocks of size 2^( 3) =       0.000390868733
  error estimate for blocks of size 2^( 4) =       0.000400220952
  error estimate for blocks of size 2^( 5) =       0.000405235624
  error estimate for blocks of size 2^( 6) =       0.000407970410
  error estimate for blocks of size 2^( 7) =       0.000408967937

      target function =      -0.951371901779
              le_mean =     -17.211904364492
             les_mean =     296.525795698648
             stat err =       0.000405598731
             autocorr =       1.238791770744
   target nu stat err =       0.000405598731
   target dn stat err =       0.002069684744
      target stat err =       0.003693048314
              std dev =       0.515370288783
             le_variance =       0.265606534560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265590234082
                                         uncertainty =       0.001199057398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265590234082
                                         uncertainty =       0.001199057398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364415995
  error estimate for blocks of size 2^( 2) =       0.000378182090
  error estimate for blocks of size 2^( 3) =       0.000390868733
  error estimate for blocks of size 2^( 4) =       0.000400220952
  error estimate for blocks of size 2^( 5) =       0.000405235624
  error estimate for blocks of size 2^( 6) =       0.000407970410
  error estimate for blocks of size 2^( 7) =       0.000408967937

      target function =      -0.951371901779
              le_mean =     -17.211904364492
             les_mean =     296.525795698648
             stat err =       0.000405598731
             autocorr =       1.238791770743
   target nu stat err =       0.000405598731
   target dn stat err =       0.002069684744
      target stat err =       0.003693048314
              std dev =       0.515370288783
             le_variance =       0.265606534560


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951371901779        initial  <--
     9.7656e+09     9.7656e+10             4.9231e-14        -0.951371901779
     3.9062e+10     3.9062e+11             1.2127e-14        -0.951371901779
     1.5625e+11     1.5625e+12             2.1654e-15        -0.951371901779

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0810
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0292e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2404
    reference variance = 0.38031
====================================================
  Execution time = 2.8230e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0371e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8451e-01
  Total weights = 1.956872787e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6673e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269642260930
                                         uncertainty =       0.001642276737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269642260930
                                         uncertainty =       0.001642276737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367184732
  error estimate for blocks of size 2^( 2) =       0.000381042929
  error estimate for blocks of size 2^( 3) =       0.000393732577
  error estimate for blocks of size 2^( 4) =       0.000403296554
  error estimate for blocks of size 2^( 5) =       0.000407972651
  error estimate for blocks of size 2^( 6) =       0.000411663501
  error estimate for blocks of size 2^( 7) =       0.000415329519

      target function =      -0.936936608813
              le_mean =     -17.212384619137
             les_mean =     296.550690433819
             stat err =       0.000409565556
             autocorr =       1.244163977803
   target nu stat err =       0.000409565556
   target dn stat err =       0.003089572444
      target stat err =       0.005294068312
              std dev =       0.519285936506
             le_variance =       0.269657883853


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721238461914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936965520613       residual = 6.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936965520613       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936965520613       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936981068247       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936965520613       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936965520613       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936965520613       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937154146048       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936794669832       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936906152094       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936959370638       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937032695804       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937175990584       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937039865195       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937227095091       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936932638683       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937039373571       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936964086035       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937010625808       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937025716476       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936818461718       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937014030356       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936731998993       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936494494416       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937051418726       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937178979801       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936580975814       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937023355377       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936742861176       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937262316122       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936972846657       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936773654777       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936505816912       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936662458224       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936851441525       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936746556486       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936597794092       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936303725409       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936739996990       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936197198084       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936106902857       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936670651289       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.936453375727       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.936049211114       residual = 8.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.937149486990       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.936670313674       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.935866665918       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.936528590139       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.937146702728       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.936268399345       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.936997114140       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.936833104907       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.935520974166       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.938495986253       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.935914918468       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.937162642990       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.938530278097       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.940368229326       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.937024753460       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.932755710089       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.937827825698       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.933730910428       residual = 9.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.940487172106       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.936445167289       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.928243068462       residual = 7.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.940700487214       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.935991544698       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.931974932499       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.935748147168       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.936509404383       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.935555374849       residual = 7.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.942009588606       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.934228531256       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.932601265504       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.945319561333       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.933061285379       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.938420349678       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.940373762740       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.925043103774       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.937622206320       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.946314627200       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.943375146414       residual = 7.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.923949430173       residual = 2.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.938439540545       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.949857668840       residual = 4.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.944858497669       residual = 8.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.940325819664       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.941568128029       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.929268776738       residual = 5.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.927898970618       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.933085128871       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.933181749878       residual = 4.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.907725665817       residual = 9.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.921723624754       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.927626693815       residual = 3.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.969199778461       residual = 3.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.949770661392       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.937642455166       residual = 9.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.933740305057       residual = 2.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.960474193537       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.943580034960       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.930638250874       residual = 9.93e-02           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.918831423233       residual = 3.14e-01           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.859478009529       residual = 9.55e-01           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.948156763687       residual = 2.51e-01           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.979455727931       residual = 9.85e-01           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.858749171245       residual = 3.17e+00           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.979499703447       residual = 4.42e-01           smallest_sin_value = 9.95e-01
davidson iteration  108 stopping due to small subspace S singular value of 8.94e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+10 is 4.613180e-15

solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936965520613       residual = 6.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936965520613       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936965520613       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936965520613       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936968136088       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936965520613       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937037172026       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936912230862       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936191588471       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936403485175       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936336682235       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937257366319       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935809058229       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937558587142       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937425098616       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937402507975       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937470938540       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936948364488       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935687130248       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937387274485       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935809731925       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935638710138       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937284538002       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937232426106       residual = 9.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936755695433       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937097245500       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.935363405653       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934141228928       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.935787277407       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934973307135       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938391834196       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938488972965       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936657630357       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.935456313732       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936039370935       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937197020436       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.935086469907       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936830418334       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938820815272       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939696721960       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.938769002571       residual = 5.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.937120452712       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.941162916525       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.936053061541       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.935133983229       residual = 8.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.939052810887       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.934889079223       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.931442061549       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.933004267626       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.939962414678       residual = 8.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.937681586850       residual = 5.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.933373679794       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.936465529968       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.931983240177       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.940180520199       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.935522565329       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.933571004779       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.928264994359       residual = 6.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.937535145948       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.920757150565       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.941391104305       residual = 3.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.928144468777       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.938938111820       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.946948926145       residual = 9.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.925676538329       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.918601233812       residual = 3.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.930014697873       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.927320430077       residual = 9.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.932513895516       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.937672846852       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.947336242057       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.944537671987       residual = 8.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.930474528640       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.933985519733       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.931491887086       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.900972146661       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.915251870561       residual = 4.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.935999265224       residual = 3.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.994848254159       residual = 3.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.985687843995       residual = 2.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.914966827374       residual = 5.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.943853156802       residual = 3.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.996020728014       residual = 3.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.891608669271       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.027130909777       residual = 7.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.927228153147       residual = 7.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.927753356560       residual = 4.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.891531719570       residual = 2.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.955620994954       residual = 3.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.937789457335       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.935927924039       residual = 2.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.827255980496       residual = 1.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.905809837467       residual = 4.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.987620717462       residual = 7.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.922949624535       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -1.197498949558       residual = 5.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.803440283883       residual = 2.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.909922520903       residual = 1.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -1.113160697152       residual = 4.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.788934709954       residual = 5.57e+00           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.998035217756       residual = 8.84e-01           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -1.025710940005       residual = 1.18e+00           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.875121980756       residual = 9.86e-01           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.913637162792       residual = 5.73e-01           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.915922237737       residual = 6.26e-01           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.986488536150       residual = 9.04e-01           smallest_sin_value = 9.99e-01
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.721766802901       residual = 4.24e+00           smallest_sin_value = 9.99e-01
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.971329081285       residual = 3.30e+00           smallest_sin_value = 9.93e-01
davidson iteration  108 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+11 is 8.521110e-16

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936965520613       residual = 6.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936965520613       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936965520613       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936544195483       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936965520613       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937045812670       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936029412329       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934854881370       residual = 6.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935017743206       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934413208723       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937305789381       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936446418131       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932972294905       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938571639907       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937575769096       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936855877776       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930795634309       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934159406515       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935107737863       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936602022578       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935466712186       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935643516029       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934710589518       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935899564147       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938180847810       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938436353182       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937544972662       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.940866919752       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939533636690       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929853867984       residual = 6.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.942945643289       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.935966655520       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934214520797       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931172140361       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.928007203351       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919673900017       residual = 2.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.933819507961       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.950217688118       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938391521217       residual = 7.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.935640915187       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934465005429       residual = 9.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.932888041359       residual = 7.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.964986794230       residual = 8.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.931706228123       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934556013969       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.934403361342       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.946469772998       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.930079848465       residual = 5.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.933126573295       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.927648650625       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.937776417148       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.931595821009       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.951210151601       residual = 9.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.937202169438       residual = 7.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.942633019052       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.971874153502       residual = 1.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.953285127802       residual = 4.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.960975192471       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.955611974075       residual = 7.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.867735624135       residual = 5.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.021531693657       residual = 8.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.891193287503       residual = 6.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.954812339669       residual = 3.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.972666938814       residual = 2.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.839290994428       residual = 8.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.907759329115       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.914841503065       residual = 3.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.831316013726       residual = 1.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.871833979985       residual = 5.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.040203138871       residual = 2.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.919777887632       residual = 4.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.883775860874       residual = 7.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.950421580503       residual = 7.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.942043671179       residual = 1.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.948436896616       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.916980015790       residual = 2.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.930816324387       residual = 6.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.948230370512       residual = 2.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.923478173114       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.945792834389       residual = 2.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.959038104626       residual = 2.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.932158843046       residual = 3.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.896197387173       residual = 8.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.884616368615       residual = 3.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.927821897290       residual = 5.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.958346928147       residual = 1.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.953285462411       residual = 6.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.914036878782       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.927272851004       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.856850356441       residual = 1.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.951340164860       residual = 6.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.967344952121       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.904417045731       residual = 9.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.896272943117       residual = 6.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.923568828956       residual = 1.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -1.210674385321       residual = 1.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -1.609420925625       residual = 3.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.435855117683       residual = 2.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.868811048433       residual = 1.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -1.078756389776       residual = 1.60e+01           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -1.105120689843       residual = 7.71e+00           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.895394385695       residual = 2.05e+00           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -1.514884921933       residual = 4.85e+01           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.724841634408       residual = 1.35e+01           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -2.713587214427       residual = 2.69e+02           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =       0.618246347960       residual = 2.09e+02           smallest_sin_value = 9.99e-01
davidson iteration  106:   krylov dim = 107   tar_fn =      -1.196803507436       residual = 7.54e+01           smallest_sin_value = 9.99e-01
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.180310669879       residual = 8.03e+01           smallest_sin_value = 9.97e-01
davidson iteration  108 stopping due to small subspace S singular value of 9.08e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+12 is 1.443462e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              11.331662 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8331e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1803
    reference variance = 0.196369
====================================================
  Execution time = 2.8159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8160e-01
  Total weights = 1.9577e+06
  Execution time = 2.4936e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269597425707
                                         uncertainty =       0.001679111841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269597425707
                                         uncertainty =       0.001679111841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367121603
  error estimate for blocks of size 2^( 2) =       0.000380936929
  error estimate for blocks of size 2^( 3) =       0.000393647687
  error estimate for blocks of size 2^( 4) =       0.000403024101
  error estimate for blocks of size 2^( 5) =       0.000408880720
  error estimate for blocks of size 2^( 6) =       0.000411665048
  error estimate for blocks of size 2^( 7) =       0.000416486442

      target function =      -0.941902594224
              le_mean =     -17.212353398237
             les_mean =     296.546708712760
             stat err =       0.000410014078
             autocorr =       1.247319336485
   target nu stat err =       0.000410014078
   target dn stat err =       0.002723797384
      target stat err =       0.004729343329
              std dev =       0.519196657058
             le_variance =       0.269565168700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269597425707
                                         uncertainty =       0.001679111841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269597425707
                                         uncertainty =       0.001679111841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367121603
  error estimate for blocks of size 2^( 2) =       0.000380936929
  error estimate for blocks of size 2^( 3) =       0.000393647687
  error estimate for blocks of size 2^( 4) =       0.000403024101
  error estimate for blocks of size 2^( 5) =       0.000408880720
  error estimate for blocks of size 2^( 6) =       0.000411665048
  error estimate for blocks of size 2^( 7) =       0.000416486442

      target function =      -0.941902594224
              le_mean =     -17.212353398237
             les_mean =     296.546708712760
             stat err =       0.000410014078
             autocorr =       1.247319336485
   target nu stat err =       0.000410014078
   target dn stat err =       0.002723797384
      target stat err =       0.004729343329
              std dev =       0.519196657058
             le_variance =       0.269565168700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269597425707
                                         uncertainty =       0.001679111841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269597425707
                                         uncertainty =       0.001679111841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367121603
  error estimate for blocks of size 2^( 2) =       0.000380936929
  error estimate for blocks of size 2^( 3) =       0.000393647687
  error estimate for blocks of size 2^( 4) =       0.000403024101
  error estimate for blocks of size 2^( 5) =       0.000408880720
  error estimate for blocks of size 2^( 6) =       0.000411665048
  error estimate for blocks of size 2^( 7) =       0.000416486442

      target function =      -0.941902594224
              le_mean =     -17.212353398237
             les_mean =     296.546708712760
             stat err =       0.000410014078
             autocorr =       1.247319336485
   target nu stat err =       0.000410014078
   target dn stat err =       0.002723797384
      target stat err =       0.004729343329
              std dev =       0.519196657058
             le_variance =       0.269565168700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269597425707
                                         uncertainty =       0.001679111841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269597425707
                                         uncertainty =       0.001679111841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367121603
  error estimate for blocks of size 2^( 2) =       0.000380936929
  error estimate for blocks of size 2^( 3) =       0.000393647687
  error estimate for blocks of size 2^( 4) =       0.000403024101
  error estimate for blocks of size 2^( 5) =       0.000408880720
  error estimate for blocks of size 2^( 6) =       0.000411665048
  error estimate for blocks of size 2^( 7) =       0.000416486442

      target function =      -0.941902594224
              le_mean =     -17.212353398237
             les_mean =     296.546708712760
             stat err =       0.000410014078
             autocorr =       1.247319336481
   target nu stat err =       0.000410014078
   target dn stat err =       0.002723797384
      target stat err =       0.004729343329
              std dev =       0.519196657058
             le_variance =       0.269565168700


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941902594224        initial
     9.7656e+10     9.7656e+11             4.6132e-15        -0.941902594224  <--
     3.9062e+11     3.9062e+12             8.5211e-16        -0.941902594224
     1.5625e+12     1.5625e+13             1.4435e-16        -0.941902594224

*****************************************************************************
Applying the update for shift_i =   9.7656e+10     and shift_s =   9.7656e+11
*****************************************************************************

  Execution time = 4.0691e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9028e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2432
    reference variance = 0.228989
====================================================
  Execution time = 2.8549e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0311e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7825e-01
  Total weights = 1.957237017e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3900e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267188631401
                                         uncertainty =       0.001746595394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267188631401
                                         uncertainty =       0.001746595394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365471413
  error estimate for blocks of size 2^( 2) =       0.000379430909
  error estimate for blocks of size 2^( 3) =       0.000391832753
  error estimate for blocks of size 2^( 4) =       0.000401593920
  error estimate for blocks of size 2^( 5) =       0.000406691228
  error estimate for blocks of size 2^( 6) =       0.000410535827
  error estimate for blocks of size 2^( 7) =       0.000411892907

      target function =      -0.947696874603
              le_mean =     -17.211975270857
             les_mean =     296.530346797016
             stat err =       0.000407678470
             autocorr =       1.244310396497
   target nu stat err =       0.000407678470
   target dn stat err =       0.001991906785
      target stat err =       0.003534451386
              std dev =       0.516862898037
             le_variance =       0.267147255367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721197527086e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947708956054       residual = 6.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947708956054       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947708956054       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947705028743       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947702513319       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947708956054       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947692740541       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947690538375       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947761390074       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947710175710       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947735807799       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947647047649       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947684084306       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947749253009       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947703351791       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947750797361       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947683761818       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947691074475       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947760601154       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947649040336       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947734804549       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947809548768       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947706941755       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947692007983       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947654889311       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947684838866       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947744225537       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947758468361       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947643858533       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947709890535       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947667628014       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947826902896       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947671785021       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947689479587       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947808325568       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947718986836       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947706995202       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947712462484       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947719684582       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947734525693       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947463642273       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947674063238       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947679363115       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947693247596       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.947578131953       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.947626386049       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.947181340970       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.947882853057       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.947342291705       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.947624368997       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.947515578236       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.947858772659       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.947799943528       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.947395077642       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.947798533870       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.947414038971       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.947257428208       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.947908419202       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.947268701041       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.947893577474       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.948034114430       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.947390900767       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.947824503268       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.947419613614       residual = 9.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.947168513693       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.947920655414       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.947428773700       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.947680775956       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.947534614487       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.947192128142       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.947838839511       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.947446254257       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.946903626266       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.947734053644       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.947871368571       residual = 5.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.948586471319       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.947627149525       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.947652730676       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.948237953720       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.947681938037       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.946998206453       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.947913517635       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.947477824617       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.947123846204       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.947834920768       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.948144003714       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.946271268157       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.951478202810       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.946994593819       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.947289269997       residual = 9.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.949925643952       residual = 6.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.948270801313       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.948655915702       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.947345451480       residual = 6.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.948314625974       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.951220491976       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.946948604162       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.946086468512       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.950746320164       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.941533488603       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.949820756582       residual = 8.14e-04           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.942177786202       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.948343890949       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.949901527364       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.951496900400       residual = 4.45e-03           smallest_sin_value = 9.99e-01
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.931600627706       residual = 2.55e-02           smallest_sin_value = 9.99e-01
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.944414471732       residual = 2.26e-03           smallest_sin_value = 9.98e-01
davidson iteration  107 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after        107 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+10 is 1.834334e-14

solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947708956054       residual = 6.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947708956054       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947708956054       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947707413357       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947773058810       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947708954112       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947638510956       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947740140236       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947722604931       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947852952994       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947651926323       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947706345263       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947559213955       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947525422612       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947768714518       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947762411535       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947363604830       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947440063089       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947994031822       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948181324881       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947698837945       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947613461887       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947339445310       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947917725726       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947638258712       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947602033542       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.948266074754       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947395901124       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947165087632       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.948342889621       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947425244532       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947941283364       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.948099201520       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947694571363       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.948126273572       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947716265628       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947903823743       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.946975636864       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947690671628       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947694301493       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.948276786677       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947015459070       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947427181411       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947392632634       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.948557752773       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.947354091981       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.948223511922       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.947967217180       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.946511885576       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.949417330708       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.948132231699       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.947487010695       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.946848777420       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.945970100473       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.946531574828       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.946992761578       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.947215677563       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.946639999719       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.948673234327       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.948369979320       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.947459317598       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.946647142934       residual = 9.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.948099431584       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.946883777339       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.946721579779       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.947689859151       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.948775737283       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.947536769367       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.947817263183       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.947111357826       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.946886205397       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.946287152911       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.947920916436       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.946349163672       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.946713602114       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.946097532036       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.948832191138       residual = 6.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.948484262266       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.945953723678       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.948134852919       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.948088930367       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.950995950990       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.948664337291       residual = 7.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.948089841134       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.940538356405       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.932276653428       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.946367330757       residual = 9.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.958259775696       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.942925260615       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.944668849911       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.952429417750       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.941870573555       residual = 6.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.949733642373       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.951582418843       residual = 7.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.947436800103       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.923376538453       residual = 7.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.945573001108       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.962182972524       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.943093726398       residual = 7.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.942660541617       residual = 3.07e-02           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.956672959582       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.978918063808       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.936578908626       residual = 4.44e-02           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.921431198975       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.944655313412       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.960733133551       residual = 2.79e-02           smallest_sin_value = 9.99e-01
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.982318235926       residual = 1.69e-01           smallest_sin_value = 9.99e-01
davidson iteration  107:   krylov dim = 108   tar_fn =      -1.010347206772       residual = 5.99e-01           smallest_sin_value = 9.93e-01
davidson iteration  108 stopping due to small subspace S singular value of 9.13e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+10 is 3.846660e-15

solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947708956054       residual = 6.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947708956054       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947708956054       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947708956054       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947708961474       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947679253232       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947761638908       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948340467315       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947371864813       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948535127023       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947199136930       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947986435201       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947891706908       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947403833299       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948130363398       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948142704800       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947787693216       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947770846736       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947459461693       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946814782659       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945197749919       residual = 9.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948671667543       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947898939614       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946489186562       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948983979827       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.949854102038       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.946349530205       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947305283194       residual = 9.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947066948261       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.948356616010       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.949794409629       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947848468810       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.945821877835       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.946201123907       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.949813686405       residual = 5.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.949241590389       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.945519952790       residual = 6.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.945886050471       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.945839367052       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947212788960       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.945523637413       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.952526242723       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.946195840090       residual = 6.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.948894764779       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.944463307248       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.947756101255       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.951413285069       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.939223610607       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.953482007379       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.943048530630       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.936835087952       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.952010293567       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.956002891450       residual = 6.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.956133799738       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.943666663779       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.937069692058       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.939301563399       residual = 9.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.953680728310       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.951767192590       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.952068599485       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.936116625735       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.925818522108       residual = 4.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.935888772789       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.953206753453       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.923783392661       residual = 4.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.946465897264       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.903726549206       residual = 1.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.926173436403       residual = 5.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.964539022130       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.922223797109       residual = 7.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.979523329031       residual = 9.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.863411658415       residual = 6.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.986541883865       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.971816886592       residual = 5.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.944508712363       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.937152134038       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.952685769612       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.949822616770       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.916931357920       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.946026062483       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.916065447964       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.954582136481       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.955528053403       residual = 2.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.002892578714       residual = 4.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.989155299414       residual = 3.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.965915475616       residual = 9.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.965976079245       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.907275071792       residual = 3.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.943491644157       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.959688510397       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.969301762195       residual = 7.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.924967506374       residual = 1.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -1.016917965064       residual = 4.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.969033297559       residual = 2.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.937947501688       residual = 3.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.988752213943       residual = 5.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.922426696191       residual = 2.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.941873314848       residual = 9.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -1.016607206504       residual = 5.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.958274742009       residual = 2.09e-01           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.932292165195       residual = 3.30e-01           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.907427791241       residual = 2.27e-01           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.997393628049       residual = 1.66e+00           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.992659430833       residual = 3.16e+00           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.929160027295       residual = 2.12e-01           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.977638862748       residual = 4.82e-01           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.957982834647       residual = 1.21e+00           smallest_sin_value = 9.99e-01
davidson iteration  107 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after        107 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+11 is 3.223587e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              12.705504 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9481e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1502
    reference variance = 0.157969
====================================================
  Execution time = 2.7945e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7541e-01
  Total weights = 1.9575e+06
  Execution time = 2.4820e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265837478416
                                         uncertainty =       0.001456268106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265837478416
                                         uncertainty =       0.001456268106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364623710
  error estimate for blocks of size 2^( 2) =       0.000378392977
  error estimate for blocks of size 2^( 3) =       0.000391389731
  error estimate for blocks of size 2^( 4) =       0.000401193116
  error estimate for blocks of size 2^( 5) =       0.000405973412
  error estimate for blocks of size 2^( 6) =       0.000409839994
  error estimate for blocks of size 2^( 7) =       0.000410406280

      target function =      -0.952645880335
              le_mean =     -17.212542560495
             les_mean =     296.547028791716
             stat err =       0.000406853200
             autocorr =       1.245046759503
   target nu stat err =       0.000406853200
   target dn stat err =       0.001952006412
      target stat err =       0.003505814637
              std dev =       0.515664045895
             le_variance =       0.265909408228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265837478416
                                         uncertainty =       0.001456268106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265837478416
                                         uncertainty =       0.001456268106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364623710
  error estimate for blocks of size 2^( 2) =       0.000378392977
  error estimate for blocks of size 2^( 3) =       0.000391389731
  error estimate for blocks of size 2^( 4) =       0.000401193116
  error estimate for blocks of size 2^( 5) =       0.000405973412
  error estimate for blocks of size 2^( 6) =       0.000409839994
  error estimate for blocks of size 2^( 7) =       0.000410406280

      target function =      -0.952645880335
              le_mean =     -17.212542560495
             les_mean =     296.547028791716
             stat err =       0.000406853200
             autocorr =       1.245046759499
   target nu stat err =       0.000406853200
   target dn stat err =       0.001952006412
      target stat err =       0.003505814637
              std dev =       0.515664045894
             le_variance =       0.265909408228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265837478416
                                         uncertainty =       0.001456268106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265837478416
                                         uncertainty =       0.001456268106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364623710
  error estimate for blocks of size 2^( 2) =       0.000378392977
  error estimate for blocks of size 2^( 3) =       0.000391389731
  error estimate for blocks of size 2^( 4) =       0.000401193116
  error estimate for blocks of size 2^( 5) =       0.000405973412
  error estimate for blocks of size 2^( 6) =       0.000409839994
  error estimate for blocks of size 2^( 7) =       0.000410406280

      target function =      -0.952645880335
              le_mean =     -17.212542560495
             les_mean =     296.547028791716
             stat err =       0.000406853200
             autocorr =       1.245046759498
   target nu stat err =       0.000406853200
   target dn stat err =       0.001952006412
      target stat err =       0.003505814637
              std dev =       0.515664045895
             le_variance =       0.265909408228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265837478416
                                         uncertainty =       0.001456268106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265837478416
                                         uncertainty =       0.001456268106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364623710
  error estimate for blocks of size 2^( 2) =       0.000378392977
  error estimate for blocks of size 2^( 3) =       0.000391389731
  error estimate for blocks of size 2^( 4) =       0.000401193116
  error estimate for blocks of size 2^( 5) =       0.000405973412
  error estimate for blocks of size 2^( 6) =       0.000409839994
  error estimate for blocks of size 2^( 7) =       0.000410406280

      target function =      -0.952645880335
              le_mean =     -17.212542560495
             les_mean =     296.547028791716
             stat err =       0.000406853200
             autocorr =       1.245046759503
   target nu stat err =       0.000406853200
   target dn stat err =       0.001952006412
      target stat err =       0.003505814637
              std dev =       0.515664045895
             le_variance =       0.265909408228


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.952645880335        initial
     2.4414e+10     2.4414e+11             1.8343e-14        -0.952645880335
     9.7656e+10     9.7656e+11             3.8467e-15        -0.952645880335  <--
     3.9062e+11     3.9062e+12             3.2236e-16        -0.952645880335

*****************************************************************************
Applying the update for shift_i =   9.7656e+10     and shift_s =   9.7656e+11
*****************************************************************************

  Execution time = 4.0461e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9950e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2224
    reference variance = 0.19928
====================================================
  Execution time = 2.8254e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0401e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8060e-01
  Total weights = 1.957354111e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7439e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267356130772
                                         uncertainty =       0.001560619130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267356130772
                                         uncertainty =       0.001560619130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365649441
  error estimate for blocks of size 2^( 2) =       0.000379542025
  error estimate for blocks of size 2^( 3) =       0.000391872428
  error estimate for blocks of size 2^( 4) =       0.000401737214
  error estimate for blocks of size 2^( 5) =       0.000407527058
  error estimate for blocks of size 2^( 6) =       0.000409945602
  error estimate for blocks of size 2^( 7) =       0.000412240055

      target function =      -0.943644705142
              le_mean =     -17.211859477800
             les_mean =     296.528705729512
             stat err =       0.000407862482
             autocorr =       1.244221458238
   target nu stat err =       0.000407862482
   target dn stat err =       0.002500924110
      target stat err =       0.004363449682
              std dev =       0.517114672645
             le_variance =       0.267407584665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721185947780e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943663873500       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943663873500       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943663873500       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943663873500       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943665734661       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943665328471       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943723410191       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943650056558       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943689599403       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943652458630       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943619531720       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943631555020       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943552844103       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943680810555       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943645750341       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943634784897       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943661494528       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943706852042       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943706322264       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943632078955       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943611875293       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943612100870       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943694588018       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943724165192       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943577359279       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.943643281130       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.943687417495       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.943661881691       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.943631721419       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.943695209874       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943693546702       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.943600598193       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943575076388       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.943733319022       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943722129629       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.943639232939       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943736009068       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.943653524400       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.943602801022       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943686901026       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.943592472406       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.943573458780       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.943622002658       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.943626741322       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.943706206287       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.943486729913       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.943682465999       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.943675959744       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.943658704746       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.943688721199       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.943697033695       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.943475366960       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.943768415043       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.943621922408       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.943391344313       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.943508483253       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.943668626845       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.943823670251       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.943056504552       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.943626438385       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.943761268915       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.943552719007       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.943501842188       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.943267066870       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.943987640488       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.943700197691       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.943652241113       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.943729565683       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.944030340065       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.943717417198       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.943335236174       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.943798111674       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.943498961978       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.943739928651       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.943291460185       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.942641290510       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.943995506334       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.944131552721       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.944293360782       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.943941600984       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.944247678607       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.943334009253       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.942187181474       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.941735541205       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.944816945097       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.945221493615       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.944784776400       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.944987631843       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.945951429012       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.942939290377       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.943364357849       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.941905048203       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.941085696316       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.944709072758       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.941927903522       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.943367271048       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.942943701798       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.946865445236       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.939625225490       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.940301022656       residual = 7.07e-03           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.937253524389       residual = 7.02e-03           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.941341115000       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.952843894551       residual = 9.45e-03           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.939086538275       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.944444825834       residual = 1.00e-03           smallest_sin_value = 9.99e-01
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.946067210384       residual = 1.10e-03           smallest_sin_value = 9.99e-01
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.941638317861       residual = 6.34e-04           smallest_sin_value = 9.97e-01
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.938738722798       residual = 2.99e-03           smallest_sin_value = 9.96e-01
davidson iteration  108 stopping due to small subspace S singular value of 7.83e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+10 is 1.893093e-14

solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943663873500       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943663873500       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943663873500       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943663873500       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943663873568       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943617698713       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943668981553       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943768975449       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943501235806       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943740063080       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943671355306       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943598108624       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943649698565       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943513455209       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943639859506       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943496335426       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943637194565       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943705196328       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943725018182       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943974845205       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943306384679       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943986838593       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943648103733       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943382054829       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943044880967       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.943622737987       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.943440071711       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.943623363606       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944192850941       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.943596131274       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943652339533       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.943576242382       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943524446428       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.943873862574       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943525675267       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944130146497       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943141475251       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944140262174       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.942779777764       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943964153280       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.942889935230       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944338936054       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.943725418473       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.943301107013       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.944299798484       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.942938295233       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.944253572550       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.942484375004       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.943048050953       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.943199676783       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.944306510914       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.945061348244       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.943477736171       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.945928915584       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.947685645941       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.942803365557       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.942137855855       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.941552895386       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.942816539702       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.942396210915       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.944642828212       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.943611594943       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.943541749972       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.936271232911       residual = 4.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.938360616200       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.945647925849       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.942851895551       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.948276300092       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.943595875444       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.947187159875       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.941938235691       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.945316016537       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.942825590912       residual = 5.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.945224002878       residual = 7.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.945473965762       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.946966766511       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.941384783301       residual = 8.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.948800979237       residual = 5.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.942803980908       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.936382120272       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.940001722394       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.930038419187       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.932772816577       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.940053410242       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.938338043100       residual = 6.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.948964695719       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.950081583421       residual = 9.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.932832859905       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.949736637127       residual = 8.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.938732490786       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.951595294919       residual = 8.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.962060716878       residual = 3.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.941449777315       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.938364712065       residual = 8.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.946163234791       residual = 5.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.951200605932       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.947970106590       residual = 8.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.939562562759       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.959006157128       residual = 2.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.916808547575       residual = 8.77e-02           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.931171890673       residual = 3.99e-02           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.965836606584       residual = 9.51e-02           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.991146693258       residual = 3.09e-01           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.948782181285       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.962457051837       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.948091463428       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.922899503195       residual = 6.89e-02           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.910136487445       residual = 2.76e-01           smallest_sin_value = 1.00e+00
davidson iteration  108:   krylov dim = 109   tar_fn =      -0.930518107406       residual = 6.10e-02           smallest_sin_value = 1.00e+00
davidson iteration  109:   krylov dim = 110   tar_fn =      -0.921097508011       residual = 2.37e-01           smallest_sin_value = 9.99e-01
davidson iteration  110 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after        110 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+10 is 3.549015e-15

solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943663873500       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943663873500       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943663873500       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943663873500       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943663873500       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943663829983       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943743219959       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942606423873       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943663873500       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944061339554       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943301820505       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943668077273       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943802419488       residual = 7.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943932428385       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943048612146       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941785439287       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944573030401       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944040396264       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943676096686       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942358162108       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944192391266       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943914125234       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943447690993       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943443096545       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944796930131       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.942145702610       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941725114550       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.942632326242       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.940797006132       residual = 8.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942849009894       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943175754984       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944178300083       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941999523447       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.945196438956       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942974700973       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944021473081       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.941742437082       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947888589158       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.940089710840       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.945971536664       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.943148970769       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944118763039       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.945626788407       residual = 8.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947246422401       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.939348100089       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.940094654421       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.939036685180       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.943578404904       residual = 7.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.944471734907       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.941193565690       residual = 8.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.940328517499       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.950586494466       residual = 6.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.941589673274       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.940106004578       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.932916736936       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.923515753558       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.944906314702       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.929109156539       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.936146367157       residual = 4.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.935014321491       residual = 8.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.942074790313       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.935889298487       residual = 5.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.954464564556       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.935595042853       residual = 8.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.943012634572       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.939817392963       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.943694982164       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.939810637077       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.932612612128       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.943430273787       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.969664355947       residual = 8.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.983191965603       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.954411412153       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.925600560746       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.968506655391       residual = 7.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.961489080262       residual = 3.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.884988701523       residual = 3.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.938768417162       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.917352879376       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.930318453294       residual = 3.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.939373493537       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.937870337251       residual = 4.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.951289702273       residual = 6.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.957347946756       residual = 4.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.901891184114       residual = 1.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.879050822911       residual = 3.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.999868014463       residual = 2.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.949763981181       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.938211757766       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.893074638332       residual = 2.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.878414431239       residual = 4.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -1.049769681431       residual = 1.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.928444344678       residual = 2.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.946568325721       residual = 2.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.926489784430       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.943784575826       residual = 6.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -1.005821572758       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.985858960072       residual = 3.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.913519810485       residual = 2.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.937030643255       residual = 1.58e-01           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -1.027681750240       residual = 1.67e+00           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.958078857181       residual = 4.30e-01           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.972010451199       residual = 2.39e-01           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.958316964157       residual = 8.97e-01           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -1.041049072550       residual = 2.35e+00           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.990640605519       residual = 5.77e-01           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.883544465833       residual = 2.58e+00           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.846202022977       residual = 4.76e+00           smallest_sin_value = 1.00e+00
davidson iteration  108 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+11 is 4.251969e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.139481 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8439e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1863
    reference variance = 0.142894
====================================================
  Execution time = 2.8515e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7801e-01
  Total weights = 1.9574e+06
  Execution time = 2.4875e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266799583340
                                         uncertainty =       0.001790259958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266799583340
                                         uncertainty =       0.001790259958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365234176
  error estimate for blocks of size 2^( 2) =       0.000378765241
  error estimate for blocks of size 2^( 3) =       0.000391169362
  error estimate for blocks of size 2^( 4) =       0.000400559735
  error estimate for blocks of size 2^( 5) =       0.000405023861
  error estimate for blocks of size 2^( 6) =       0.000408677882
  error estimate for blocks of size 2^( 7) =       0.000410975962

      target function =      -0.948078821122
              le_mean =     -17.212909215995
             les_mean =     296.562255950066
             stat err =       0.000406309360
             autocorr =       1.237573029424
   target nu stat err =       0.000406309360
   target dn stat err =       0.002355584884
      target stat err =       0.004163519533
              std dev =       0.516527389409
             le_variance =       0.266800544010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266799583340
                                         uncertainty =       0.001790259958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266799583340
                                         uncertainty =       0.001790259958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365234176
  error estimate for blocks of size 2^( 2) =       0.000378765241
  error estimate for blocks of size 2^( 3) =       0.000391169362
  error estimate for blocks of size 2^( 4) =       0.000400559735
  error estimate for blocks of size 2^( 5) =       0.000405023861
  error estimate for blocks of size 2^( 6) =       0.000408677882
  error estimate for blocks of size 2^( 7) =       0.000410975962

      target function =      -0.948078821122
              le_mean =     -17.212909215995
             les_mean =     296.562255950066
             stat err =       0.000406309360
             autocorr =       1.237573029416
   target nu stat err =       0.000406309360
   target dn stat err =       0.002355584884
      target stat err =       0.004163519533
              std dev =       0.516527389409
             le_variance =       0.266800544010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266799583340
                                         uncertainty =       0.001790259958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266799583340
                                         uncertainty =       0.001790259958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365234176
  error estimate for blocks of size 2^( 2) =       0.000378765241
  error estimate for blocks of size 2^( 3) =       0.000391169362
  error estimate for blocks of size 2^( 4) =       0.000400559735
  error estimate for blocks of size 2^( 5) =       0.000405023861
  error estimate for blocks of size 2^( 6) =       0.000408677882
  error estimate for blocks of size 2^( 7) =       0.000410975962

      target function =      -0.948078821122
              le_mean =     -17.212909215995
             les_mean =     296.562255950066
             stat err =       0.000406309360
             autocorr =       1.237573029414
   target nu stat err =       0.000406309360
   target dn stat err =       0.002355584884
      target stat err =       0.004163519533
              std dev =       0.516527389409
             le_variance =       0.266800544010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266799583340
                                         uncertainty =       0.001790259958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266799583340
                                         uncertainty =       0.001790259958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365234176
  error estimate for blocks of size 2^( 2) =       0.000378765241
  error estimate for blocks of size 2^( 3) =       0.000391169362
  error estimate for blocks of size 2^( 4) =       0.000400559735
  error estimate for blocks of size 2^( 5) =       0.000405023861
  error estimate for blocks of size 2^( 6) =       0.000408677882
  error estimate for blocks of size 2^( 7) =       0.000410975962

      target function =      -0.948078821122
              le_mean =     -17.212909215995
             les_mean =     296.562255950066
             stat err =       0.000406309360
             autocorr =       1.237573029422
   target nu stat err =       0.000406309360
   target dn stat err =       0.002355584884
      target stat err =       0.004163519533
              std dev =       0.516527389409
             le_variance =       0.266800544010


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948078821122        initial  <--
     2.4414e+10     2.4414e+11             1.8931e-14        -0.948078821122
     9.7656e+10     9.7656e+11             3.5490e-15        -0.948078821122
     3.9062e+11     3.9062e+12             4.2520e-16        -0.948078821122

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0487
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9494e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1348
    reference variance = 0.182674
====================================================
  Execution time = 2.8246e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0363e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8089e-01
  Total weights = 1.957452913e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6680e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267313771048
                                         uncertainty =       0.001543251308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267313771048
                                         uncertainty =       0.001543251308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365593344
  error estimate for blocks of size 2^( 2) =       0.000379346984
  error estimate for blocks of size 2^( 3) =       0.000392064107
  error estimate for blocks of size 2^( 4) =       0.000401862977
  error estimate for blocks of size 2^( 5) =       0.000407015181
  error estimate for blocks of size 2^( 6) =       0.000410117733
  error estimate for blocks of size 2^( 7) =       0.000411134725

      target function =      -0.943122868072
              le_mean =     -17.211846112979
             les_mean =     296.528539083728
             stat err =       0.000407532654
             autocorr =       1.242591171640
   target nu stat err =       0.000407532654
   target dn stat err =       0.003482413317
      target stat err =       0.006026338521
              std dev =       0.517035338181
             le_variance =       0.267325540928


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721184611298e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943160227823       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943160227823       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943160227823       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943160227823       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943160204789       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943160242920       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943268433975       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943258113243       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942455565992       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943512455931       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942874882997       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942925108386       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943065483328       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943018877902       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942661747900       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943555450011       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942977358640       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942502091352       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943461576203       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942345805218       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943166551630       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943164148370       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942553411156       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943020491231       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946072860543       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941441150227       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.942713638364       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.943885408491       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.942007158579       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.943780590799       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941225424062       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.942380053711       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943010882464       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941814731437       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942801310782       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.945157774985       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943383017537       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944753112617       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.942138658145       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943947817961       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.945732654453       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.945962480312       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.946451175419       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.942909751997       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.939486433659       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.942978097512       residual = 8.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.943709856398       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.944626512016       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.940340165997       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.942742515845       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.939274754876       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.937086488245       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.943803835435       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.946350503546       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.945701619221       residual = 9.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.937415662159       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.937327235336       residual = 7.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.945291525064       residual = 8.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.938476490371       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.940290287314       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.936788756826       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.938821866245       residual = 9.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.940852041737       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.943025062878       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.942841350072       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.940579989079       residual = 8.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.943449726329       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.940673836390       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.937536216401       residual = 6.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.949420893933       residual = 6.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.958326304062       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.946154171676       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.941935835627       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.941733497618       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.953557988122       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.944761126247       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.924884354741       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.954683998717       residual = 3.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.950054514654       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.950684939801       residual = 3.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.944808047908       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.935536215721       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.915529791733       residual = 9.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.916355495924       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.975111759281       residual = 9.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.961886047175       residual = 4.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.937083482420       residual = 6.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.937362182093       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.936411934761       residual = 4.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.941019141434       residual = 5.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.899124713144       residual = 2.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.939139811456       residual = 4.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.974887378705       residual = 9.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.942543610689       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.958661515127       residual = 5.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.889539164466       residual = 4.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.930253678798       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.995000295410       residual = 2.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.946293612686       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.929657368236       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.944665263158       residual = 5.19e-02           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.943479564391       residual = 5.35e-02           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.972520707823       residual = 2.65e-01           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -1.015830370264       residual = 5.74e-01           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.916521959414       residual = 4.27e-01           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.958482872740       residual = 1.47e-01           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.952393638629       residual = 5.85e-01           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.782501581713       residual = 2.74e+00           smallest_sin_value = 1.00e+00
davidson iteration  108:   krylov dim = 109   tar_fn =      -1.008432189971       residual = 1.20e+00           smallest_sin_value = 1.00e+00
davidson iteration  109 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after        109 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+11 is 6.951456e-16

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943160227823       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943160227823       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943160227823       residual = 6.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943160227836       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943228948802       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942705143980       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944220536447       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941970735934       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943681308602       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941109541214       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945028024534       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942063740440       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943880925616       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945705310499       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943587436104       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939653360058       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942969653373       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946985174299       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935049259677       residual = 5.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942865284425       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943001292778       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943956354796       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944133045323       residual = 7.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945127107225       residual = 9.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946412334717       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.940951869538       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941690858003       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941746249487       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944127872376       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938056219993       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943506647148       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.943178084873       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943007932065       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.943175111463       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944574337196       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.945395466313       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.940233286310       residual = 3.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.942520694642       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944488614990       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939186591876       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.949023143045       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.949634110487       residual = 4.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.942561627141       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.955700377573       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.940611949057       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.935465592135       residual = 6.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.931973581628       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.954305376153       residual = 4.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.972642558265       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.025972035589       residual = 5.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.863803310612       residual = 5.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.946363684707       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.888513593037       residual = 3.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.957856921266       residual = 5.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.007124037539       residual = 3.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.962479998167       residual = 2.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.882098487250       residual = 5.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.019215545863       residual = 5.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.967291259063       residual = 8.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.926121317682       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.902203324404       residual = 2.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.880192765444       residual = 5.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.976394797011       residual = 1.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.013515766113       residual = 5.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.964127199759       residual = 9.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.970403677745       residual = 1.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.905820338209       residual = 2.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.904044706711       residual = 2.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.983172333717       residual = 4.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.028339229005       residual = 8.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.756313900666       residual = 3.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.929564844382       residual = 5.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.993404136527       residual = 4.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.757745476173       residual = 3.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.946573448880       residual = 6.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.917888836256       residual = 3.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.177227032723       residual = 5.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.004276272883       residual = 6.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.904900832698       residual = 6.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.039450893717       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.907604895060       residual = 5.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.050535929793       residual = 1.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.801844496142       residual = 2.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.690966829580       residual = 8.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.858727405397       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.817458421992       residual = 1.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -1.028122372121       residual = 1.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.970907311523       residual = 4.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -1.078967673214       residual = 8.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -1.088976990144       residual = 3.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.938966759172       residual = 2.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -1.033221947881       residual = 4.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -1.010794906380       residual = 1.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.951524369111       residual = 1.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.850788877607       residual = 1.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.962422586348       residual = 3.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.716718226934       residual = 4.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -1.116802092844       residual = 5.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -1.059334836706       residual = 7.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.653807475633       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -1.145662336935       residual = 3.87e+00           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.945940588617       residual = 5.12e+00           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -1.415607326136       residual = 3.00e+01           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.719084166796       residual = 1.32e+01           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.395782839518       residual = 3.08e+01           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.266230486168       residual = 4.16e+01           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -1.176050469900       residual = 2.07e+01           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.900246428795       residual = 9.45e+00           smallest_sin_value = 9.96e-01
davidson iteration  108 stopping due to small subspace S singular value of 8.93e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+11 is 1.788627e-16

solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943160227823       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943160227823       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943160227823       residual = 9.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943160227822       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943160228030       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943167601545       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943003298837       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943680393263       residual = 7.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949771901738       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942922979541       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945423062560       residual = 7.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947977517233       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948228083318       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938673898445       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947807261092       residual = 5.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934361237603       residual = 7.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936315581909       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938431641430       residual = 5.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948163942647       residual = 5.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937384277820       residual = 2.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937147682027       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951025146058       residual = 9.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949486279549       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947696850716       residual = 6.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914550986328       residual = 7.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938302409366       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947439387183       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938648708933       residual = 6.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928384181286       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.963447079859       residual = 5.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944972326540       residual = 3.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.960179506252       residual = 5.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.973233033692       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.948249594604       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.020700188819       residual = 5.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938573679544       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.940487111707       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.971188119735       residual = 8.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.017012551538       residual = 4.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.963697283206       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.920360306021       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.875635540632       residual = 5.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929341211301       residual = 1.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.983140832842       residual = 3.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.905201244329       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.880000166644       residual = 4.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.915891497649       residual = 3.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.959851118835       residual = 5.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.974448408588       residual = 8.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.985273216914       residual = 7.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.676890401908       residual = 6.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.899954089105       residual = 3.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -1.107115447268       residual = 2.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.787320563503       residual = 4.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.058973125009       residual = 1.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.874609571430       residual = 3.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.900283542613       residual = 9.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.958620943799       residual = 3.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.637331490193       residual = 1.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.168590987567       residual = 6.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.926801954397       residual = 2.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.944873348645       residual = 7.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.222105856096       residual = 2.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.898759064565       residual = 5.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.873918443937       residual = 8.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.911985572226       residual = 8.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.793264685396       residual = 3.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.908929586057       residual = 5.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.864918985115       residual = 2.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.840624104916       residual = 3.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.078401355246       residual = 6.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.995703876141       residual = 8.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.357641559521       residual = 2.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.791949692606       residual = 1.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.318300639261       residual = 5.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.635966903295       residual = 1.94e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.777131309763       residual = 5.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.776348225337       residual = 6.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.181888555053       residual = 2.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.995976678840       residual = 1.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.225888984874       residual = 1.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.999369002424       residual = 1.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.953842369608       residual = 1.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.137844110854       residual = 1.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.737418717542       residual = 1.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.359341018395       residual = 4.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.884761570836       residual = 1.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.832977723832       residual = 2.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -1.086917671875       residual = 4.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.547893672931       residual = 5.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.761261423968       residual = 2.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -1.474865573362       residual = 5.79e+01           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -1.518396841863       residual = 6.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -1.825344652501       residual = 1.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -1.633859543547       residual = 6.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -2.087367840402       residual = 4.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =       0.108099581037       residual = 1.87e+02           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =       5.093098876529       residual = 3.64e+03           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -1.438295812414       residual = 1.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -1.509025829541       residual = 7.00e+01           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =       0.234487339181       residual = 1.71e+02           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.668405102586       residual = 1.46e+02           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -2.518441793465       residual = 2.63e+03           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -1.135742090778       residual = 6.83e+01           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.235974209669       residual = 1.52e+02           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =       0.771787690411       residual = 1.13e+03           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =       1.572966293747       residual = 9.61e+02           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =       0.684082180726       residual = 5.89e+02           smallest_sin_value = 1.00e+00
davidson iteration  108:   krylov dim = 109   tar_fn =      -0.001422437381       residual = 1.28e+03           smallest_sin_value = 9.96e-01
davidson iteration  109 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after        109 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+12 is 4.567983e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              15.615304 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8397e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2748
    reference variance = 0.237838
====================================================
  Execution time = 2.8182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7628e-01
  Total weights = 1.9573e+06
  Execution time = 2.4782e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265821912095
                                         uncertainty =       0.001438386203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265821912095
                                         uncertainty =       0.001438386203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364561160
  error estimate for blocks of size 2^( 2) =       0.000377969795
  error estimate for blocks of size 2^( 3) =       0.000390909906
  error estimate for blocks of size 2^( 4) =       0.000400354250
  error estimate for blocks of size 2^( 5) =       0.000406128446
  error estimate for blocks of size 2^( 6) =       0.000411359832
  error estimate for blocks of size 2^( 7) =       0.000413981131

      target function =      -0.951126928091
              le_mean =     -17.212296832050
             les_mean =     296.539440578920
             stat err =       0.000407955915
             autocorr =       1.252234525316
   target nu stat err =       0.000407955915
   target dn stat err =       0.001986743044
      target stat err =       0.003553007050
              std dev =       0.515575585659
             le_variance =       0.265818184528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265821912095
                                         uncertainty =       0.001438386203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265821912095
                                         uncertainty =       0.001438386203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364561160
  error estimate for blocks of size 2^( 2) =       0.000377969795
  error estimate for blocks of size 2^( 3) =       0.000390909906
  error estimate for blocks of size 2^( 4) =       0.000400354250
  error estimate for blocks of size 2^( 5) =       0.000406128446
  error estimate for blocks of size 2^( 6) =       0.000411359832
  error estimate for blocks of size 2^( 7) =       0.000413981131

      target function =      -0.951126928091
              le_mean =     -17.212296832050
             les_mean =     296.539440578920
             stat err =       0.000407955915
             autocorr =       1.252234525317
   target nu stat err =       0.000407955915
   target dn stat err =       0.001986743044
      target stat err =       0.003553007050
              std dev =       0.515575585659
             le_variance =       0.265818184528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265821912095
                                         uncertainty =       0.001438386203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265821912095
                                         uncertainty =       0.001438386203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364561160
  error estimate for blocks of size 2^( 2) =       0.000377969795
  error estimate for blocks of size 2^( 3) =       0.000390909906
  error estimate for blocks of size 2^( 4) =       0.000400354250
  error estimate for blocks of size 2^( 5) =       0.000406128446
  error estimate for blocks of size 2^( 6) =       0.000411359832
  error estimate for blocks of size 2^( 7) =       0.000413981131

      target function =      -0.951126928091
              le_mean =     -17.212296832050
             les_mean =     296.539440578920
             stat err =       0.000407955915
             autocorr =       1.252234525317
   target nu stat err =       0.000407955915
   target dn stat err =       0.001986743044
      target stat err =       0.003553007050
              std dev =       0.515575585659
             le_variance =       0.265818184528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265821912095
                                         uncertainty =       0.001438386203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265821912095
                                         uncertainty =       0.001438386203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364561160
  error estimate for blocks of size 2^( 2) =       0.000377969795
  error estimate for blocks of size 2^( 3) =       0.000390909906
  error estimate for blocks of size 2^( 4) =       0.000400354250
  error estimate for blocks of size 2^( 5) =       0.000406128446
  error estimate for blocks of size 2^( 6) =       0.000411359832
  error estimate for blocks of size 2^( 7) =       0.000413981131

      target function =      -0.951126928091
              le_mean =     -17.212296832050
             les_mean =     296.539440578920
             stat err =       0.000407955915
             autocorr =       1.252234525317
   target nu stat err =       0.000407955915
   target dn stat err =       0.001986743044
      target stat err =       0.003553007050
              std dev =       0.515575585659
             le_variance =       0.265818184528


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951126928091        initial
     2.4414e+11     2.4414e+12             6.9515e-16        -0.951126928091  <--
     9.7656e+11     9.7656e+12             1.7886e-16        -0.951126928091
     3.9062e+12     3.9062e+13             4.5680e-17        -0.951126928091

*****************************************************************************
Applying the update for shift_i =   2.4414e+11     and shift_s =   2.4414e+12
*****************************************************************************

  Execution time = 4.0713e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9117e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.3118
    reference variance = 0.228108
====================================================
  Execution time = 2.8338e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0383e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7757e-01
  Total weights = 1.957420555e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7807e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265830127212
                                         uncertainty =       0.001250018427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265830127212
                                         uncertainty =       0.001250018427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364704911
  error estimate for blocks of size 2^( 2) =       0.000378368172
  error estimate for blocks of size 2^( 3) =       0.000391123585
  error estimate for blocks of size 2^( 4) =       0.000400109591
  error estimate for blocks of size 2^( 5) =       0.000405821850
  error estimate for blocks of size 2^( 6) =       0.000407750576
  error estimate for blocks of size 2^( 7) =       0.000408490550

      target function =      -0.948883295330
              le_mean =     -17.212292520728
             les_mean =     296.540579254850
             stat err =       0.000405543142
             autocorr =       1.236490830625
   target nu stat err =       0.000405543142
   target dn stat err =       0.001913226675
      target stat err =       0.003410732104
              std dev =       0.515778883407
             le_variance =       0.266027856569


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721229252073e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948894654147       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948894654147       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948894654147       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948894654147       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948894654147       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948894654147       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948894654147       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948947270587       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948807035623       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948873953788       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948969336679       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948852686265       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948898540996       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949063706723       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948783004544       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948804401901       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948932353855       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948972998233       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948832562964       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949002881302       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948944068984       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948875645049       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948954236359       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948745550452       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948876748130       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.948649202444       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.948733806047       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.948793151347       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.949035338341       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.948918435275       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.948770829331       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.948886213974       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.948864165576       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.949111312762       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.948984133047       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.948750863408       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.948987999856       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948678117448       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.948756571340       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.948709745774       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.949378843115       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.948835925137       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.948848172429       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.948915909546       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.948522904265       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.948947793890       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.949367038022       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.948875061819       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.949162853781       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.948832158563       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.948358379875       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.948622685295       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.948281681270       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.948577091553       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.948148460810       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.949031975930       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.948120918262       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.947851216275       residual = 9.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.947749381438       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.948751860490       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.948878705957       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.948562981861       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.947884933722       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.949431457831       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.948879028816       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.948936030445       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.949994748207       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.949276905433       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.948147677970       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.947715430804       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.948459553808       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.952803446764       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.950578060325       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.951404766430       residual = 6.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.949574085834       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.947989374139       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.949868482068       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.946861710336       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.945296688708       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.949021023270       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.944445488586       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.952141281677       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.953616665932       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.948047491290       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.946277937889       residual = 8.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.949321722474       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.947899992071       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.947791716295       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.948725115943       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.949557278067       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.951778169310       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.951217709890       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.947249753087       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.951452786140       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.949748104055       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.941465945457       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.958143147748       residual = 7.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.951030492529       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.947305738106       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.938917065902       residual = 8.38e-03           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.949504033805       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.953402247691       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.944520315346       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.954659985056       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.944883886394       residual = 1.35e-02           smallest_sin_value = 9.99e-01
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.956716942005       residual = 9.84e-03           smallest_sin_value = 9.96e-01
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.953737365463       residual = 9.62e-03           smallest_sin_value = 9.94e-01
davidson iteration  107 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after        107 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+10 is 7.259592e-15

solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948894654147       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948894654147       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948894654147       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948894654147       residual = 9.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948894654147       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948884950658       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948887298984       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948830852958       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948894654147       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949144934685       residual = 6.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949502809808       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948284201395       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948883005067       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948860681565       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948724689765       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948348954349       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948932468154       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949562815688       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948930156316       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949486207478       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949062388926       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948886914790       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948338806834       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948860694582       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.949165104029       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.948689272365       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.949159851440       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.949122494241       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.948862322890       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947943617152       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.948994507680       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.949077466570       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.949455380061       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.948883461683       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.949154852861       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.949218755815       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.948696027712       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948337462534       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.950262933945       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.949022030616       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.949936585318       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.948577992220       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.948373205121       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.949352216999       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.948566805371       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.948326379394       residual = 9.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.949608497212       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.949856940853       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.947350489181       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.948098844097       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.947466991331       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.949825660485       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.949219298390       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.949531803074       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.949401463388       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.949090203597       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.949128669196       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.949679283091       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.950130231778       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.950456431678       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.949099916299       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.949326644464       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.945679604200       residual = 9.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.947864245511       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.946529149407       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.949610651545       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.952334749491       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.950460318835       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.952270634501       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.943566698753       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.947483329598       residual = 3.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.948753218603       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.955787059967       residual = 8.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.947165319721       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.937756026082       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.955231492278       residual = 6.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.951151435966       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.945070961164       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.940068638823       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.947954403129       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.946869001678       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.945385663083       residual = 5.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.944359004058       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.951980865193       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.950415994000       residual = 4.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.949991939258       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.956018068787       residual = 4.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.948814030923       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.950560385684       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.939869151698       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.946385909836       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.915106371753       residual = 1.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -1.001359892688       residual = 3.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.946274586968       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.930096530215       residual = 5.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.912645650045       residual = 1.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.935093504473       residual = 3.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.954349931728       residual = 3.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.986938569917       residual = 1.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.941921962636       residual = 5.56e-02           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.961614377186       residual = 3.09e-02           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.937588853633       residual = 5.51e-02           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.941104471860       residual = 5.48e-02           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.972132430331       residual = 6.18e-02           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.928590857200       residual = 6.30e-02           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.968113820594       residual = 6.66e-02           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.940755368207       residual = 4.08e-02           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.883910242061       residual = 5.25e-01           smallest_sin_value = 9.99e-01
davidson iteration  108:   krylov dim = 109   tar_fn =      -0.973039823519       residual = 3.34e-01           smallest_sin_value = 9.95e-01
davidson iteration  109 stopping due to small subspace S singular value of 9.37e-01
davidson solver did not converge after        109 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+11 is 1.790337e-15

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948894654147       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948894654147       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948894654147       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948934454025       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948894654147       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950140583667       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948894654147       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948374936833       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949593402606       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948476043646       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.950496185873       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951192623094       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.952265985331       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946139840813       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946587330578       residual = 9.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949773704940       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.950063526939       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951895311413       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949119286079       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951657259889       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947063062528       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947985999344       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948759233112       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948398818644       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947982793910       residual = 7.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951623338196       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947270188246       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.949859000882       residual = 9.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.952362672416       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.948008366144       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.953927571175       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937889761841       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.950350903278       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.952144545352       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939594130868       residual = 9.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.948462276047       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947213292471       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.952667901705       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.948312795775       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.940050622082       residual = 7.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.952099120252       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.935487570953       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.937480437645       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.956192610219       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.951937122523       residual = 7.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.948407320500       residual = 9.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.943430093110       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.957048554639       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.934535636089       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.949185874471       residual = 7.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.939642737442       residual = 9.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.944911940868       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.940025884982       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.940603620060       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.951875627457       residual = 9.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.947159409345       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.944853838890       residual = 4.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.944488542787       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.962638409595       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.936169374395       residual = 2.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.952635284450       residual = 6.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.957148966349       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.918821848159       residual = 7.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.940526020123       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.948538133182       residual = 2.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.887572891458       residual = 4.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.945389122505       residual = 5.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.983348019717       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.924560402290       residual = 8.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.925158686214       residual = 6.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.920408078706       residual = 8.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.963387298739       residual = 7.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.948414560006       residual = 9.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.950813249179       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.942517293617       residual = 7.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.884281159894       residual = 7.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.017871541280       residual = 5.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.917413096765       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.940273691764       residual = 1.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.918848922951       residual = 2.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.992612105873       residual = 2.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.940437656883       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.909115206755       residual = 2.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.999464043336       residual = 4.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.930877326426       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.025298478832       residual = 5.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -1.033290488266       residual = 6.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.937746313437       residual = 4.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.934114920276       residual = 8.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.886188301568       residual = 2.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.978036794493       residual = 1.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.940018940706       residual = 8.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.986190022507       residual = 7.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.895904241755       residual = 5.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.999637727606       residual = 2.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -1.318410626690       residual = 1.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.719382621990       residual = 5.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.814603433269       residual = 2.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -1.164566742621       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.989417836528       residual = 7.92e+00           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.731582230644       residual = 1.56e+01           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.806927453136       residual = 8.37e+00           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.814173572892       residual = 4.68e+00           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -1.003916176283       residual = 1.06e+01           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -1.269867081261       residual = 1.26e+01           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.866119302411       residual = 8.79e+00           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.917333784469       residual = 8.62e+00           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.884689396772       residual = 1.83e+01           smallest_sin_value = 1.00e+00
davidson iteration  108 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+11 is 1.586384e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              17.020447 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8531e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2929
    reference variance = 0.176016
====================================================
  Execution time = 2.8223e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8370e-01
  Total weights = 1.9572e+06
  Execution time = 2.4771e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271373597281
                                         uncertainty =       0.001734748944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271373597281
                                         uncertainty =       0.001734748944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368356715
  error estimate for blocks of size 2^( 2) =       0.000382186267
  error estimate for blocks of size 2^( 3) =       0.000394858907
  error estimate for blocks of size 2^( 4) =       0.000404330612
  error estimate for blocks of size 2^( 5) =       0.000409586615
  error estimate for blocks of size 2^( 6) =       0.000414323109
  error estimate for blocks of size 2^( 7) =       0.000415991921

      target function =      -0.938336845591
              le_mean =     -17.212103950346
             les_mean =     296.540217718701
             stat err =       0.000411058064
             autocorr =       1.245286162415
   target nu stat err =       0.000411058064
   target dn stat err =       0.002652835706
      target stat err =       0.004572961328
              std dev =       0.520943397415
             le_variance =       0.271382023310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271373597281
                                         uncertainty =       0.001734748944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271373597281
                                         uncertainty =       0.001734748944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368356715
  error estimate for blocks of size 2^( 2) =       0.000382186267
  error estimate for blocks of size 2^( 3) =       0.000394858907
  error estimate for blocks of size 2^( 4) =       0.000404330612
  error estimate for blocks of size 2^( 5) =       0.000409586615
  error estimate for blocks of size 2^( 6) =       0.000414323109
  error estimate for blocks of size 2^( 7) =       0.000415991921

      target function =      -0.938336845591
              le_mean =     -17.212103950346
             les_mean =     296.540217718701
             stat err =       0.000411058064
             autocorr =       1.245286162410
   target nu stat err =       0.000411058064
   target dn stat err =       0.002652835706
      target stat err =       0.004572961328
              std dev =       0.520943397414
             le_variance =       0.271382023310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271373597281
                                         uncertainty =       0.001734748944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271373597281
                                         uncertainty =       0.001734748944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368356715
  error estimate for blocks of size 2^( 2) =       0.000382186267
  error estimate for blocks of size 2^( 3) =       0.000394858907
  error estimate for blocks of size 2^( 4) =       0.000404330612
  error estimate for blocks of size 2^( 5) =       0.000409586615
  error estimate for blocks of size 2^( 6) =       0.000414323109
  error estimate for blocks of size 2^( 7) =       0.000415991921

      target function =      -0.938336845591
              le_mean =     -17.212103950346
             les_mean =     296.540217718701
             stat err =       0.000411058064
             autocorr =       1.245286162410
   target nu stat err =       0.000411058064
   target dn stat err =       0.002652835706
      target stat err =       0.004572961328
              std dev =       0.520943397414
             le_variance =       0.271382023310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271373597281
                                         uncertainty =       0.001734748944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271373597281
                                         uncertainty =       0.001734748944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368356715
  error estimate for blocks of size 2^( 2) =       0.000382186267
  error estimate for blocks of size 2^( 3) =       0.000394858907
  error estimate for blocks of size 2^( 4) =       0.000404330612
  error estimate for blocks of size 2^( 5) =       0.000409586615
  error estimate for blocks of size 2^( 6) =       0.000414323109
  error estimate for blocks of size 2^( 7) =       0.000415991921

      target function =      -0.938336845591
              le_mean =     -17.212103950346
             les_mean =     296.540217718701
             stat err =       0.000411058064
             autocorr =       1.245286162415
   target nu stat err =       0.000411058064
   target dn stat err =       0.002652835706
      target stat err =       0.004572961328
              std dev =       0.520943397414
             le_variance =       0.271382023310


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938336845591        initial
     6.1035e+10     6.1035e+11             7.2596e-15        -0.938336845591
     2.4414e+11     2.4414e+12             1.7903e-15        -0.938336845591
     9.7656e+11     9.7656e+12             1.5864e-16        -0.938336845591  <--

*****************************************************************************
Applying the update for shift_i =   9.7656e+11     and shift_s =   9.7656e+12
*****************************************************************************

  Execution time = 4.0755e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9294e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2611
    reference variance = 0.089342
====================================================
  Execution time = 3.0537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0397e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8072e-01
  Total weights = 1.957129939e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6572e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269125222664
                                         uncertainty =       0.001786158208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269125222664
                                         uncertainty =       0.001786158208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366938993
  error estimate for blocks of size 2^( 2) =       0.000380533306
  error estimate for blocks of size 2^( 3) =       0.000393657878
  error estimate for blocks of size 2^( 4) =       0.000402657524
  error estimate for blocks of size 2^( 5) =       0.000408552828
  error estimate for blocks of size 2^( 6) =       0.000411884503
  error estimate for blocks of size 2^( 7) =       0.000414870653

      target function =      -0.943424286968
              le_mean =     -17.212372570830
             les_mean =     296.546487166735
             stat err =       0.000409491377
             autocorr =       1.245379729701
   target nu stat err =       0.000409491377
   target dn stat err =       0.002157516754
      target stat err =       0.003785588670
              std dev =       0.518938403050
             le_variance =       0.269297066160


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721237257083e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943438342807       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943438342807       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943438342807       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943438342807       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943438342807       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943438341724       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943109407422       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943026459707       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943064839128       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942118055465       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943128979870       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943569314577       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943802073953       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943314743623       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942905320835       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943131118940       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943285741260       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943428165593       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942993260660       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943524208878       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943300456257       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943628955117       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943393406731       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943248155033       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944230786369       residual = 8.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.943818706273       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944092424351       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.942742830783       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944224377753       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942885731611       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944023572754       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.945427777299       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943826900450       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944372286751       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943791249585       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941723186444       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943883312015       residual = 8.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941374092912       residual = 6.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.941196656347       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943141706066       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.945152817609       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.945094517908       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.943486963421       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.940583743063       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.944928801650       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.945178728346       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.944462706617       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.940082774054       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.939056239603       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.943180550918       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.946297050198       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.942790713521       residual = 7.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.942001300055       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.943674952878       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.947653504078       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.938478856322       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.939090469735       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.946259396661       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.942306633492       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.944391273056       residual = 8.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.940004453989       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.944027972338       residual = 7.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.945338510813       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.943294683580       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.941508043272       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.941748897171       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.950635192460       residual = 5.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.952873916325       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.951626959369       residual = 7.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.950075767708       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.934858010039       residual = 8.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.938634487468       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.943134077797       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.940201436664       residual = 3.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.936243593266       residual = 8.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.951331653430       residual = 6.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.966944207604       residual = 5.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.942649118318       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.946067016062       residual = 3.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.935379762479       residual = 6.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.949577890384       residual = 6.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.946549303660       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.942607111387       residual = 2.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.935088779969       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.960903976903       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.946636409394       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.944650505431       residual = 3.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.950889980425       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.951489564163       residual = 4.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.940431317903       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.981408473789       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.958812906376       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.963600301772       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.936480645389       residual = 2.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.956952765987       residual = 2.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.957388510543       residual = 7.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.896293956078       residual = 3.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.936915110536       residual = 7.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.955191083017       residual = 4.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.944278829468       residual = 3.74e-01           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.908867602617       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -1.030322160871       residual = 8.21e-01           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.820618359524       residual = 1.92e+00           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.780949802563       residual = 3.30e+00           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.914160288384       residual = 5.78e-01           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -1.119111317047       residual = 3.56e+00           smallest_sin_value = 9.98e-01
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.955859784225       residual = 5.60e-01           smallest_sin_value = 9.98e-01
davidson iteration  107:   krylov dim = 108   tar_fn =      -1.029651584105       residual = 1.08e+00           smallest_sin_value = 9.97e-01
davidson iteration  108:   krylov dim = 109   tar_fn =      -0.804539019556       residual = 2.20e+00           smallest_sin_value = 9.90e-01
davidson iteration  109 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after        109 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+11 is 1.025401e-15

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943438342807       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943438342807       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943438342807       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943438342807       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943438342274       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943438346687       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943430907623       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942991832817       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944185293521       residual = 5.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942941725762       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943888508918       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940322522358       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943912097104       residual = 5.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943306439052       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944553677455       residual = 8.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944162418825       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941304510259       residual = 6.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942658604596       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943431907307       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928777859790       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945332293151       residual = 8.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940357000496       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946642338889       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942963683181       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.942905659798       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.942028627192       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941181908046       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.942499504375       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938365445635       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.943892530350       residual = 9.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.942934822849       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.925054305592       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.942098410908       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.956942068788       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944323519633       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.945919682438       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943079560377       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.945280658533       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.949345929552       residual = 7.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.953354526315       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.940705148526       residual = 5.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.948136326462       residual = 5.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.942392888666       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.955618241300       residual = 4.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.948205880636       residual = 9.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.932067521628       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.934405201837       residual = 7.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.948597696835       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.956218961256       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.964179016906       residual = 4.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.956560713237       residual = 5.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.913776944544       residual = 3.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.909641357853       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.951487122079       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.955269267411       residual = 5.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.941771845989       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.945491680416       residual = 5.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.929258389065       residual = 2.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.931780046320       residual = 4.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.920487615196       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.892699529442       residual = 2.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.832445803130       residual = 1.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.992698732079       residual = 4.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.892296024025       residual = 3.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.908471968839       residual = 1.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.892814377949       residual = 9.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.884954482019       residual = 4.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.975419854202       residual = 7.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.070442707313       residual = 2.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.997364651741       residual = 3.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.955728268634       residual = 9.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.890351956229       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.969583789434       residual = 4.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.891150843624       residual = 4.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.956898495836       residual = 3.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.887028685609       residual = 1.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.023878994292       residual = 9.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.932128738305       residual = 2.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.871276758990       residual = 2.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.964294878808       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.922902456755       residual = 7.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.772477765667       residual = 4.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.968585256680       residual = 3.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.033812415559       residual = 7.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.999817079168       residual = 5.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.101385033024       residual = 4.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -1.037149498322       residual = 1.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -1.275037905164       residual = 1.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.942305684630       residual = 2.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -1.031965194095       residual = 2.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.837811121382       residual = 3.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.942513527267       residual = 2.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.959461250807       residual = 6.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.905408366907       residual = 1.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.858963258134       residual = 1.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.688908032180       residual = 7.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.885192411571       residual = 9.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.761032134663       residual = 7.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -1.223020081852       residual = 9.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -1.151173655526       residual = 5.29e+00           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.680034614387       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.772167445383       residual = 4.87e+00           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.831064573320       residual = 9.34e+00           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.909374869392       residual = 5.66e+00           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -1.068682765488       residual = 2.10e+01           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.394819356728       residual = 4.77e+01           smallest_sin_value = 9.90e-01
davidson iteration  106 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after        106 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+11 is 1.448717e-16

solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943438342807       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943438342807       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943438342807       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943438342807       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943438341106       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943438427571       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943437817538       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941889840574       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943171970167       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940546267864       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943735464508       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939510556767       residual = 7.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939373295109       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931138947177       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944151966622       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945317645002       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948289630452       residual = 6.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936488174520       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946972433682       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928035742542       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930398530788       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951615592276       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.956973461115       residual = 2.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.967964231345       residual = 7.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.953781683889       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.940775523770       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.946746448998       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.940623812077       residual = 8.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.951005956814       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.969987612269       residual = 8.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.945855035794       residual = 5.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937164294611       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938922883080       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.907821893722       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.933142867180       residual = 4.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.940339547753       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932156384092       residual = 4.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936578321266       residual = 6.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930747431833       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.918268062333       residual = 2.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.955799571546       residual = 9.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.926492567963       residual = 2.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.918440067017       residual = 1.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.943164542337       residual = 1.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934840882465       residual = 7.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.971205730552       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.841921269973       residual = 1.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.971375374160       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.917591760652       residual = 5.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.880408024592       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.089845583511       residual = 4.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.986175757567       residual = 1.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.922751716382       residual = 1.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.997253811333       residual = 3.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.932997985048       residual = 3.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.775429398286       residual = 3.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.946766224703       residual = 3.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.831325804844       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.916984352171       residual = 6.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.745133632339       residual = 4.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.090384246911       residual = 2.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.994532784715       residual = 2.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.159114865121       residual = 6.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.014053525578       residual = 6.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.024494927520       residual = 2.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.135574940993       residual = 5.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.142515528814       residual = 8.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.155857377399       residual = 1.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.914617371356       residual = 5.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.101627591123       residual = 4.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.769942589641       residual = 3.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.969779532218       residual = 4.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.968562660905       residual = 5.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.851081125730       residual = 8.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.833192847084       residual = 7.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.097133167065       residual = 4.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.998627047290       residual = 2.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.175356965091       residual = 6.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.205754444849       residual = 9.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.561843474889       residual = 1.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.539812773262       residual = 4.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.269541073762       residual = 7.79e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.755488165208       residual = 6.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.310942449780       residual = 2.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.628443943062       residual = 2.41e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.456858113995       residual = 4.82e+01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.829382532173       residual = 2.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.661838839236       residual = 1.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -1.616840966433       residual = 5.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -1.093130222227       residual = 1.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -1.347851689285       residual = 2.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.528794067223       residual = 1.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -1.059575275301       residual = 6.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -1.034034966888       residual = 2.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =       0.101538684367       residual = 1.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -1.148134418706       residual = 1.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.193375397479       residual = 6.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -1.974302220295       residual = 9.57e+01           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.978592550470       residual = 4.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.649185534547       residual = 1.96e+01           smallest_sin_value = 9.99e-01
davidson iteration  100:   krylov dim = 101   tar_fn =      -1.374265640634       residual = 8.47e+01           smallest_sin_value = 9.99e-01
davidson iteration  101:   krylov dim = 102   tar_fn =       1.036439156261       residual = 4.57e+02           smallest_sin_value = 9.99e-01
davidson iteration  102:   krylov dim = 103   tar_fn =      -1.291457672177       residual = 1.01e+02           smallest_sin_value = 9.90e-01
davidson iteration  103 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after        103 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+12 is 3.824336e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              18.365935 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0547e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.236
    reference variance = 0.205936
====================================================
  Execution time = 2.8052e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7777e-01
  Total weights = 1.9577e+06
  Execution time = 2.5078e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266138202730
                                         uncertainty =       0.001367315881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266138202730
                                         uncertainty =       0.001367315881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364792945
  error estimate for blocks of size 2^( 2) =       0.000378791182
  error estimate for blocks of size 2^( 3) =       0.000391854427
  error estimate for blocks of size 2^( 4) =       0.000400699832
  error estimate for blocks of size 2^( 5) =       0.000407224312
  error estimate for blocks of size 2^( 6) =       0.000410647605
  error estimate for blocks of size 2^( 7) =       0.000414748883

      target function =      -0.948553621453
              le_mean =     -17.211394670653
             les_mean =     296.509874750747
             stat err =       0.000408330158
             autocorr =       1.252939360236
   target nu stat err =       0.000408330158
   target dn stat err =       0.002344324534
      target stat err =       0.004136885768
              std dev =       0.515903384838
             le_variance =       0.266156302487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266138202730
                                         uncertainty =       0.001367315881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266138202730
                                         uncertainty =       0.001367315881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364792945
  error estimate for blocks of size 2^( 2) =       0.000378791182
  error estimate for blocks of size 2^( 3) =       0.000391854427
  error estimate for blocks of size 2^( 4) =       0.000400699832
  error estimate for blocks of size 2^( 5) =       0.000407224312
  error estimate for blocks of size 2^( 6) =       0.000410647605
  error estimate for blocks of size 2^( 7) =       0.000414748883

      target function =      -0.948553621453
              le_mean =     -17.211394670653
             les_mean =     296.509874750747
             stat err =       0.000408330158
             autocorr =       1.252939360236
   target nu stat err =       0.000408330158
   target dn stat err =       0.002344324534
      target stat err =       0.004136885768
              std dev =       0.515903384838
             le_variance =       0.266156302487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266138202730
                                         uncertainty =       0.001367315881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266138202730
                                         uncertainty =       0.001367315881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364792945
  error estimate for blocks of size 2^( 2) =       0.000378791182
  error estimate for blocks of size 2^( 3) =       0.000391854427
  error estimate for blocks of size 2^( 4) =       0.000400699832
  error estimate for blocks of size 2^( 5) =       0.000407224312
  error estimate for blocks of size 2^( 6) =       0.000410647605
  error estimate for blocks of size 2^( 7) =       0.000414748883

      target function =      -0.948553621453
              le_mean =     -17.211394670653
             les_mean =     296.509874750747
             stat err =       0.000408330158
             autocorr =       1.252939360240
   target nu stat err =       0.000408330158
   target dn stat err =       0.002344324534
      target stat err =       0.004136885768
              std dev =       0.515903384838
             le_variance =       0.266156302487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266138202730
                                         uncertainty =       0.001367315881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266138202730
                                         uncertainty =       0.001367315881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364792945
  error estimate for blocks of size 2^( 2) =       0.000378791182
  error estimate for blocks of size 2^( 3) =       0.000391854427
  error estimate for blocks of size 2^( 4) =       0.000400699832
  error estimate for blocks of size 2^( 5) =       0.000407224312
  error estimate for blocks of size 2^( 6) =       0.000410647605
  error estimate for blocks of size 2^( 7) =       0.000414748883

      target function =      -0.948553621453
              le_mean =     -17.211394670653
             les_mean =     296.509874750747
             stat err =       0.000408330158
             autocorr =       1.252939360236
   target nu stat err =       0.000408330158
   target dn stat err =       0.002344324534
      target stat err =       0.004136885768
              std dev =       0.515903384838
             le_variance =       0.266156302487


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948553621453        initial  <--
     2.4414e+11     2.4414e+12             1.0254e-15        -0.948553621453
     9.7656e+11     9.7656e+12             1.4487e-16        -0.948553621453
     3.9062e+12     3.9062e+13             3.8243e-17        -0.948553621453

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7508
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1309e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1359
    reference variance = 0.150355
====================================================
  Execution time = 2.8104e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0389e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7758e-01
  Total weights = 1.957449827e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7090e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266920576331
                                         uncertainty =       0.001617387360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266920576331
                                         uncertainty =       0.001617387360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365265115
  error estimate for blocks of size 2^( 2) =       0.000379154640
  error estimate for blocks of size 2^( 3) =       0.000392083053
  error estimate for blocks of size 2^( 4) =       0.000402122938
  error estimate for blocks of size 2^( 5) =       0.000408179791
  error estimate for blocks of size 2^( 6) =       0.000412154943
  error estimate for blocks of size 2^( 7) =       0.000413168244

      target function =      -0.948868856416
              le_mean =     -17.212137998910
             les_mean =     296.535269608657
             stat err =       0.000408906479
             autocorr =       1.253232335684
   target nu stat err =       0.000408906479
   target dn stat err =       0.002134542890
      target stat err =       0.003787435089
              std dev =       0.516571143848
             le_variance =       0.266845746657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721213799891e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948882837554       residual = 8.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948882837554       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948882837554       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948882837554       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948882837484       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948882837553       residual = 9.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948882907572       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944885061362       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946541837674       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945770671319       residual = 3.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948068622852       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949592465583       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.953238591028       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946525892313       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946730109156       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947627409644       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942119757920       residual = 4.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951808767435       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932951513894       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.953577434215       residual = 5.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947546696893       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948767629679       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.958140647128       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937569264780       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.978729521302       residual = 7.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.940444062342       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939472427988       residual = 9.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.957413567942       residual = 9.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.976172522089       residual = 6.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942967833962       residual = 7.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951581561660       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938331204931       residual = 2.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.952010455000       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.928460342282       residual = 6.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.991657437307       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.961336121922       residual = 3.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.949112245179       residual = 6.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928556853823       residual = 4.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915760024331       residual = 9.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939383961003       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.976189952014       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.952479341499       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.945344157210       residual = 9.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.977746480047       residual = 9.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.977482921156       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.952818825301       residual = 2.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.902172305791       residual = 3.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.922315807000       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.946995765659       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.974286328279       residual = 2.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.986753111733       residual = 6.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.812684721547       residual = 3.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.867949949469       residual = 9.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.997050287198       residual = 3.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.031068875104       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.860269007856       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.967474769279       residual = 2.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.977602368196       residual = 3.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.932439766193       residual = 4.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.941626089493       residual = 5.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.006878530812       residual = 1.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.965383663429       residual = 1.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.909528883029       residual = 1.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.915420479388       residual = 7.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.014123164503       residual = 8.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.949564391052       residual = 5.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.804034496780       residual = 2.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.988378898838       residual = 7.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.014888959572       residual = 2.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.050360326802       residual = 3.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.898602273935       residual = 2.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.982469305889       residual = 3.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.892211020213       residual = 5.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -1.081534303764       residual = 1.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.815740969036       residual = 2.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.093418276752       residual = 2.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.001012139954       residual = 2.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.835028561763       residual = 1.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.763315792780       residual = 3.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.907258831981       residual = 3.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.008964350452       residual = 8.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.216771438291       residual = 1.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.684593308426       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.044972715806       residual = 4.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.088625225239       residual = 9.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.953547550061       residual = 6.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.934820440614       residual = 6.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -1.332024256392       residual = 2.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.588357340765       residual = 1.82e+01           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.912088215937       residual = 1.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.884639322758       residual = 4.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.949271917343       residual = 3.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -1.450530350208       residual = 4.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -1.068747043610       residual = 7.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -1.014512327019       residual = 2.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.188022296264       residual = 5.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =       0.002644807936       residual = 9.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.822399637302       residual = 1.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -1.147895269013       residual = 1.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -1.781506631864       residual = 7.98e+01           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.899786261175       residual = 6.66e+00           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.707260062720       residual = 9.12e+00           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.636185844920       residual = 2.12e+01           smallest_sin_value = 9.99e-01
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.612632275673       residual = 3.67e+01           smallest_sin_value = 9.98e-01
davidson iteration  104:   krylov dim = 105   tar_fn =      -1.395385573451       residual = 2.25e+01           smallest_sin_value = 9.97e-01
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.268700524068       residual = 1.19e+02           smallest_sin_value = 9.92e-01
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.134995554008       residual = 7.69e+01           smallest_sin_value = 9.92e-01
davidson iteration  107 stopping due to small subspace S singular value of 8.96e-01
davidson solver did not converge after        107 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+12 is 6.359278e-17

solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948882837554       residual = 8.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948882837554       residual = 8.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+13, overlap shift 3.9062e+14 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948882837554       residual = 8.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948882837554       residual = 8.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              18.829035 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7283e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2898
    reference variance = 0.284049
====================================================
  Execution time = 2.8292e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8130e-01
  Total weights = 1.9573e+06
  Execution time = 2.5261e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269393527929
                                         uncertainty =       0.002242457446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269393527929
                                         uncertainty =       0.002242457446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366996887
  error estimate for blocks of size 2^( 2) =       0.000381018078
  error estimate for blocks of size 2^( 3) =       0.000394004996
  error estimate for blocks of size 2^( 4) =       0.000403560575
  error estimate for blocks of size 2^( 5) =       0.000408658317
  error estimate for blocks of size 2^( 6) =       0.000410094302
  error estimate for blocks of size 2^( 7) =       0.000410217506

      target function =      -0.942447037906
              le_mean =     -17.211710263762
             les_mean =     296.524266910883
             stat err =       0.000408132675
             autocorr =       1.236738753832
   target nu stat err =       0.000408132675
   target dn stat err =       0.002861407636
      target stat err =       0.004961472832
              std dev =       0.519020279388
             le_variance =       0.269382050416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269393527929
                                         uncertainty =       0.002242457446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269393527929
                                         uncertainty =       0.002242457446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366996887
  error estimate for blocks of size 2^( 2) =       0.000381018078
  error estimate for blocks of size 2^( 3) =       0.000394004996
  error estimate for blocks of size 2^( 4) =       0.000403560575
  error estimate for blocks of size 2^( 5) =       0.000408658317
  error estimate for blocks of size 2^( 6) =       0.000410094302
  error estimate for blocks of size 2^( 7) =       0.000410217506

      target function =      -0.942447037906
              le_mean =     -17.211710263762
             les_mean =     296.524266910883
             stat err =       0.000408132675
             autocorr =       1.236738753832
   target nu stat err =       0.000408132675
   target dn stat err =       0.002861407636
      target stat err =       0.004961472832
              std dev =       0.519020279388
             le_variance =       0.269382050416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269393527929
                                         uncertainty =       0.002242457446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269393527929
                                         uncertainty =       0.002242457446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366996887
  error estimate for blocks of size 2^( 2) =       0.000381018078
  error estimate for blocks of size 2^( 3) =       0.000394004996
  error estimate for blocks of size 2^( 4) =       0.000403560575
  error estimate for blocks of size 2^( 5) =       0.000408658317
  error estimate for blocks of size 2^( 6) =       0.000410094302
  error estimate for blocks of size 2^( 7) =       0.000410217506

      target function =      -0.942447037906
              le_mean =     -17.211710263762
             les_mean =     296.524266910883
             stat err =       0.000408132675
             autocorr =       1.236738753832
   target nu stat err =       0.000408132675
   target dn stat err =       0.002861407636
      target stat err =       0.004961472832
              std dev =       0.519020279388
             le_variance =       0.269382050416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269393527929
                                         uncertainty =       0.002242457446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269393527929
                                         uncertainty =       0.002242457446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366996887
  error estimate for blocks of size 2^( 2) =       0.000381018078
  error estimate for blocks of size 2^( 3) =       0.000394004996
  error estimate for blocks of size 2^( 4) =       0.000403560575
  error estimate for blocks of size 2^( 5) =       0.000408658317
  error estimate for blocks of size 2^( 6) =       0.000410094302
  error estimate for blocks of size 2^( 7) =       0.000410217506

      target function =      -0.942447037906
              le_mean =     -17.211710263762
             les_mean =     296.524266910883
             stat err =       0.000408132675
             autocorr =       1.236738753832
   target nu stat err =       0.000408132675
   target dn stat err =       0.002861407636
      target stat err =       0.004961472832
              std dev =       0.519020279388
             le_variance =       0.269382050416


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942447037906        initial
     2.4414e+12     2.4414e+13             6.3593e-17        -0.942447037906  <--
     9.7656e+12     9.7656e+13             0.0000e+00        -0.942447037906
     3.9062e+13     3.9062e+14             0.0000e+00        -0.942447037906

*****************************************************************************
Applying the update for shift_i =   2.4414e+12     and shift_s =   2.4414e+13
*****************************************************************************

  Execution time = 4.1072e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8364e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1871
    reference variance = 0.208236
====================================================
  Execution time = 2.8048e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0387e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8050e-01
  Total weights = 1.957440416e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7246e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268586081971
                                         uncertainty =       0.001449531019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268586081971
                                         uncertainty =       0.001449531019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366416988
  error estimate for blocks of size 2^( 2) =       0.000380106462
  error estimate for blocks of size 2^( 3) =       0.000392416533
  error estimate for blocks of size 2^( 4) =       0.000402270880
  error estimate for blocks of size 2^( 5) =       0.000407761691
  error estimate for blocks of size 2^( 6) =       0.000410184837
  error estimate for blocks of size 2^( 7) =       0.000412477228

      target function =      -0.943824714680
              le_mean =     -17.211882851836
             les_mean =     296.529407273729
             stat err =       0.000408173659
             autocorr =       1.240905614739
   target nu stat err =       0.000408173659
   target dn stat err =       0.002263937782
      target stat err =       0.003964325677
              std dev =       0.518200164354
             le_variance =       0.268531410337


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721188285184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+11, overlap shift 6.1035e+12 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943840177656       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943840177656       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943840177656       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943840177656       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943840177656       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943840177656       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943840177656       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943840177656       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943378289564       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943840177656       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943598181734       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945318257405       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946972001301       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944173379082       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944261727473       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944198173265       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941951001218       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942665349021       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943362431840       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943497775563       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943397207174       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943914568696       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940219176324       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944216154627       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.942287808272       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.945364610052       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947308078164       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.942619928207       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.946253894182       residual = 6.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941150848977       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943147922961       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.940099274639       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943613293412       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.953216324759       residual = 8.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947256190635       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.946376859610       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.942656850617       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944335432067       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.943464526781       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.944216208062       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.950027315352       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936324174228       residual = 5.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.946650774323       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.933123799331       residual = 9.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.935956602441       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.943513383766       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.938337453820       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.951822697753       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.966032865440       residual = 4.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.949512338844       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.925940501399       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.951085881858       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.907444389927       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.927719353288       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.958556487701       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.936259798183       residual = 5.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.941846696503       residual = 9.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.960910656511       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.936497586122       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.942232840037       residual = 7.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.944548281215       residual = 8.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.943601531695       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.932093414963       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.947241183282       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.938781573626       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.971401833079       residual = 6.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.921900827058       residual = 4.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.949692460974       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.923482483421       residual = 4.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.999023498127       residual = 2.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.927201981419       residual = 4.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.938366312643       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.928705583942       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.962285125996       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.994798836632       residual = 2.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.963988565188       residual = 8.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.977719878682       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.963035962062       residual = 5.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.951091945307       residual = 8.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.882338967574       residual = 3.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.933727785825       residual = 6.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.959669573227       residual = 3.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.947733379856       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.955251345452       residual = 4.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.957148660385       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.895815762181       residual = 2.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.918627828868       residual = 1.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.947305318172       residual = 4.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.959467580034       residual = 6.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.983144036617       residual = 3.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.963366532343       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -1.076472641856       residual = 1.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -1.006655165828       residual = 1.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.926320888553       residual = 3.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -1.034691243862       residual = 1.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -0.743620596854       residual = 4.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -1.021531675979       residual = 1.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -0.923478549167       residual = 8.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -0.980153140374       residual = 2.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.978449366540       residual = 2.63e+00           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.913012803253       residual = 1.21e+00           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.947474035350       residual = 2.01e+00           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -1.032476251227       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -0.945902736384       residual = 2.21e-01           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -0.719289459285       residual = 4.75e+00           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -0.910663801195       residual = 1.59e+00           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -0.911454005363       residual = 2.20e+00           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.948513967894       residual = 1.10e+00           smallest_sin_value = 1.00e+00
davidson iteration  108 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after        108 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+11 is 2.543482e-16

solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943840177656       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943840177656       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943840177656       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943840177656       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943840177656       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943840177656       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943840177656       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943840177656       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943840177656       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943840177656       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941549825067       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943230734560       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944962165792       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948941005832       residual = 6.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939621521606       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945246811627       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945775882162       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943645939007       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942774542660       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941777344594       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.954037689134       residual = 8.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944149185228       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931487850994       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944378712840       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945598794446       residual = 5.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.949481428202       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937426743332       residual = 7.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.930715037441       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.926882643411       residual = 2.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942994565601       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.959328642952       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.927757309120       residual = 3.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.945705907137       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932502079990       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.905010914369       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.922821322651       residual = 4.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.933739568007       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.927459316679       residual = 3.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.943345465598       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.953783504968       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.957890092436       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.961733270603       residual = 6.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.956200725049       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.952706968602       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.966147978081       residual = 5.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.966721766521       residual = 5.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.909741009500       residual = 9.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.972531310779       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.960392191629       residual = 5.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.974055685448       residual = 9.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.955837047109       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.937875337227       residual = 5.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.895709368810       residual = 2.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.958990096797       residual = 3.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.929220170486       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.877099238314       residual = 3.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.059315158722       residual = 1.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.942839864307       residual = 1.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.872720812331       residual = 4.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.995349160861       residual = 3.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.944792435021       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.947737909214       residual = 6.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.885294585061       residual = 3.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.965632511143       residual = 6.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.957482486784       residual = 2.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.873822160415       residual = 8.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.880832683522       residual = 8.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.948951501369       residual = 2.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.923771449898       residual = 5.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.928871767986       residual = 1.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.079660970366       residual = 1.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.953698998195       residual = 5.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.941277870971       residual = 3.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.882462084177       residual = 8.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.069727980991       residual = 2.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.013215767411       residual = 7.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.796282003115       residual = 5.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.916618927742       residual = 1.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.024742318185       residual = 5.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.065865272781       residual = 6.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.090955982902       residual = 2.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.863383221227       residual = 1.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.930835623733       residual = 3.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.815452219083       residual = 4.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.982307674218       residual = 2.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.156666310945       residual = 2.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.962842733957       residual = 4.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -1.224567173475       residual = 1.44e+01           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -1.064807968563       residual = 5.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.949618616287       residual = 1.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.867047274870       residual = 3.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.692116737696       residual = 8.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.915626329277       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.408966026732       residual = 2.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -0.964044958416       residual = 2.33e+00           smallest_sin_value = 9.99e-01
davidson iteration   95:   krylov dim =  96   tar_fn =      -1.056233427836       residual = 2.85e+00           smallest_sin_value = 9.99e-01
davidson iteration   96:   krylov dim =  97   tar_fn =      -1.212380479096       residual = 1.51e+01           smallest_sin_value = 9.98e-01
davidson iteration   97:   krylov dim =  98   tar_fn =      -1.155149128395       residual = 9.66e+00           smallest_sin_value = 9.98e-01
davidson iteration   98:   krylov dim =  99   tar_fn =      -1.099152007764       residual = 6.44e+00           smallest_sin_value = 9.98e-01
davidson iteration   99:   krylov dim = 100   tar_fn =      -0.895352700481       residual = 4.12e+00           smallest_sin_value = 9.98e-01
davidson iteration  100:   krylov dim = 101   tar_fn =      -0.806041588792       residual = 8.48e+00           smallest_sin_value = 9.98e-01
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.538207522140       residual = 2.34e+01           smallest_sin_value = 9.97e-01
davidson iteration  102 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after        102 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+12 is 6.381302e-17

solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943840177656       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943840177656       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              19.695537 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7646e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2438
    reference variance = 0.316576
====================================================
  Execution time = 2.8100e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7975e-01
  Total weights = 1.9574e+06
  Execution time = 2.5069e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267354521325
                                         uncertainty =       0.001538529564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267354521325
                                         uncertainty =       0.001538529564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365583006
  error estimate for blocks of size 2^( 2) =       0.000379345011
  error estimate for blocks of size 2^( 3) =       0.000391738804
  error estimate for blocks of size 2^( 4) =       0.000401294150
  error estimate for blocks of size 2^( 5) =       0.000407048294
  error estimate for blocks of size 2^( 6) =       0.000410976597
  error estimate for blocks of size 2^( 7) =       0.000412547395

      target function =      -0.945119907611
              le_mean =     -17.211422499344
             les_mean =     296.512817980499
             stat err =       0.000407966609
             autocorr =       1.245309323387
   target nu stat err =       0.000407966609
   target dn stat err =       0.002300031276
      target stat err =       0.004032535718
              std dev =       0.517020716870
             le_variance =       0.267310421673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267354521325
                                         uncertainty =       0.001538529564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267354521325
                                         uncertainty =       0.001538529564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365583006
  error estimate for blocks of size 2^( 2) =       0.000379345011
  error estimate for blocks of size 2^( 3) =       0.000391738804
  error estimate for blocks of size 2^( 4) =       0.000401294150
  error estimate for blocks of size 2^( 5) =       0.000407048294
  error estimate for blocks of size 2^( 6) =       0.000410976597
  error estimate for blocks of size 2^( 7) =       0.000412547395

      target function =      -0.945119907611
              le_mean =     -17.211422499344
             les_mean =     296.512817980499
             stat err =       0.000407966609
             autocorr =       1.245309323381
   target nu stat err =       0.000407966609
   target dn stat err =       0.002300031276
      target stat err =       0.004032535718
              std dev =       0.517020716870
             le_variance =       0.267310421673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267354521325
                                         uncertainty =       0.001538529564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267354521325
                                         uncertainty =       0.001538529564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365583006
  error estimate for blocks of size 2^( 2) =       0.000379345011
  error estimate for blocks of size 2^( 3) =       0.000391738804
  error estimate for blocks of size 2^( 4) =       0.000401294150
  error estimate for blocks of size 2^( 5) =       0.000407048294
  error estimate for blocks of size 2^( 6) =       0.000410976597
  error estimate for blocks of size 2^( 7) =       0.000412547395

      target function =      -0.945119907611
              le_mean =     -17.211422499344
             les_mean =     296.512817980499
             stat err =       0.000407966609
             autocorr =       1.245309323385
   target nu stat err =       0.000407966609
   target dn stat err =       0.002300031276
      target stat err =       0.004032535718
              std dev =       0.517020716870
             le_variance =       0.267310421673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267354521325
                                         uncertainty =       0.001538529564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267354521325
                                         uncertainty =       0.001538529564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365583006
  error estimate for blocks of size 2^( 2) =       0.000379345011
  error estimate for blocks of size 2^( 3) =       0.000391738804
  error estimate for blocks of size 2^( 4) =       0.000401294150
  error estimate for blocks of size 2^( 5) =       0.000407048294
  error estimate for blocks of size 2^( 6) =       0.000410976597
  error estimate for blocks of size 2^( 7) =       0.000412547395

      target function =      -0.945119907611
              le_mean =     -17.211422499344
             les_mean =     296.512817980499
             stat err =       0.000407966609
             autocorr =       1.245309323385
   target nu stat err =       0.000407966609
   target dn stat err =       0.002300031276
      target stat err =       0.004032535718
              std dev =       0.517020716870
             le_variance =       0.267310421673


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945119907611        initial  <--
     6.1035e+11     6.1035e+12             2.5435e-16        -0.945119907611
     2.4414e+12     2.4414e+13             6.3813e-17        -0.945119907611
     9.7656e+12     9.7656e+13             0.0000e+00        -0.945119907611

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8055
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8459e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1928
    reference variance = 0.218981
====================================================
  Execution time = 2.8127e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0389e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7567e-01
  Total weights = 1.957528267e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7581e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265263471147
                                         uncertainty =       0.001325278001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265263471147
                                         uncertainty =       0.001325278001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364278889
  error estimate for blocks of size 2^( 2) =       0.000377619569
  error estimate for blocks of size 2^( 3) =       0.000390035228
  error estimate for blocks of size 2^( 4) =       0.000400154162
  error estimate for blocks of size 2^( 5) =       0.000405299182
  error estimate for blocks of size 2^( 6) =       0.000409486202
  error estimate for blocks of size 2^( 7) =       0.000411545768

      target function =      -0.952207848312
              le_mean =     -17.211580183355
             les_mean =     296.514164701917
             stat err =       0.000406621328
             autocorr =       1.245983534335
   target nu stat err =       0.000406621328
   target dn stat err =       0.001811754939
      target stat err =       0.003256765911
              std dev =       0.515176387593
             le_variance =       0.265406710334


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721158018336e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+12, overlap shift 6.1035e+13 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952217931204       residual = 7.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952217931204       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952217931204       residual = 6.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952436917752       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952217931204       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.954935251108       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943261513409       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952501804007       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937616371313       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943987231196       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.954700502890       residual = 7.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.954422130306       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944526120273       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949268873194       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.965289700500       residual = 2.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.976309765023       residual = 6.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939343864600       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945673180789       residual = 6.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.960327332565       residual = 4.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949149856514       residual = 6.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949392670994       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.968873349837       residual = 7.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947447148280       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948074842681       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.955122261077       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.950745525662       residual = 3.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.943457733158       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.948557035531       residual = 6.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.957321102202       residual = 7.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.964936267291       residual = 5.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.946923592878       residual = 7.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.953626932467       residual = 8.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.986601284549       residual = 2.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.984415284023       residual = 2.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.884329425304       residual = 6.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.003089722546       residual = 3.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.960565904416       residual = 3.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912354819488       residual = 2.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.045907140907       residual = 9.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.987619323394       residual = 5.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.949447013457       residual = 1.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.983176428483       residual = 4.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.025519608102       residual = 1.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.970897717384       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.927296824045       residual = 6.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.859619698849       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.776046612669       residual = 3.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -1.110528545631       residual = 3.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.846451796336       residual = 1.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.130218345445       residual = 3.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.837491300620       residual = 2.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.926055485034       residual = 2.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -1.147190792183       residual = 4.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.992452273579       residual = 1.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.968218152602       residual = 6.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.951309644535       residual = 8.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.094902626927       residual = 2.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.866857301373       residual = 3.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.924531039806       residual = 4.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.961939104246       residual = 4.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.859458525662       residual = 9.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.110317118363       residual = 4.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.236362246739       residual = 7.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.086674975588       residual = 2.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.136541694822       residual = 6.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.772433690365       residual = 5.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.002382537850       residual = 2.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.672545414977       residual = 9.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.844838142286       residual = 8.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.147939531471       residual = 7.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.655493371731       residual = 9.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -1.035074565429       residual = 2.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.719063458429       residual = 5.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.885333210717       residual = 1.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.331452353892       residual = 9.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.668333600279       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.104660979497       residual = 6.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.518574253753       residual = 6.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.443986911535       residual = 8.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.707890015128       residual = 7.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.508769658508       residual = 1.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.922635295473       residual = 2.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.699111511000       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -2.124301865393       residual = 2.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =       0.754477764991       residual = 4.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.817203020182       residual = 2.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -3.310041342650       residual = 5.59e+02           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.778619500243       residual = 1.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   88:   krylov dim =  89   tar_fn =      -0.202950117622       residual = 7.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   89:   krylov dim =  90   tar_fn =      -0.893785775948       residual = 1.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   90:   krylov dim =  91   tar_fn =      -0.871900877812       residual = 9.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   91:   krylov dim =  92   tar_fn =      -0.556960597909       residual = 2.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   92:   krylov dim =  93   tar_fn =      -0.549666356694       residual = 2.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   93:   krylov dim =  94   tar_fn =      -0.919951538582       residual = 1.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   94:   krylov dim =  95   tar_fn =      -1.532784930375       residual = 4.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   95:   krylov dim =  96   tar_fn =      -1.105906848575       residual = 1.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   96:   krylov dim =  97   tar_fn =      -0.929649716404       residual = 5.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   97:   krylov dim =  98   tar_fn =      -2.067410009670       residual = 3.98e+02           smallest_sin_value = 1.00e+00
davidson iteration   98:   krylov dim =  99   tar_fn =      -1.941326058613       residual = 1.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   99:   krylov dim = 100   tar_fn =       0.447813787553       residual = 3.24e+02           smallest_sin_value = 1.00e+00
davidson iteration  100:   krylov dim = 101   tar_fn =       0.958579633861       residual = 4.59e+02           smallest_sin_value = 1.00e+00
davidson iteration  101:   krylov dim = 102   tar_fn =      -0.211574490205       residual = 9.24e+01           smallest_sin_value = 1.00e+00
davidson iteration  102:   krylov dim = 103   tar_fn =      -0.238039652762       residual = 9.40e+01           smallest_sin_value = 1.00e+00
davidson iteration  103:   krylov dim = 104   tar_fn =      -1.807803559175       residual = 3.14e+02           smallest_sin_value = 1.00e+00
davidson iteration  104:   krylov dim = 105   tar_fn =      -1.684744736082       residual = 3.98e+02           smallest_sin_value = 1.00e+00
davidson iteration  105:   krylov dim = 106   tar_fn =      -1.218682338583       residual = 1.63e+02           smallest_sin_value = 1.00e+00
davidson iteration  106:   krylov dim = 107   tar_fn =      -1.752968043657       residual = 9.71e+01           smallest_sin_value = 1.00e+00
davidson iteration  107:   krylov dim = 108   tar_fn =      -0.886139356880       residual = 3.62e+02           smallest_sin_value = 1.00e+00
davidson iteration  108:   krylov dim = 109   tar_fn =       0.333637872522       residual = 7.72e+02           smallest_sin_value = 9.93e-01
davidson iteration  109 stopping due to small subspace S singular value of 8.32e-01
davidson solver did not converge after        109 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+12 is 1.817758e-17

solving harmonic davidson linear method for identity shift 2.4414e+13, overlap shift 2.4414e+14 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952217931204       residual = 7.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952217931204       residual = 7.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+13, overlap shift 9.7656e+14 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952217931204       residual = 7.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952217931204       residual = 7.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.195053 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7392e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2313
    reference variance = 0.199957
====================================================
  Execution time = 2.8313e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8187e-01
  Total weights = 1.9575e+06
  Execution time = 2.5131e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269206219688
                                         uncertainty =       0.001805052987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269206219688
                                         uncertainty =       0.001805052987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366886163
  error estimate for blocks of size 2^( 2) =       0.000380599056
  error estimate for blocks of size 2^( 3) =       0.000393473903
  error estimate for blocks of size 2^( 4) =       0.000402717231
  error estimate for blocks of size 2^( 5) =       0.000408620169
  error estimate for blocks of size 2^( 6) =       0.000411613831
  error estimate for blocks of size 2^( 7) =       0.000411208834

      target function =      -0.941428096506
              le_mean =     -17.212411545828
             les_mean =     296.548985850647
             stat err =       0.000408540016
             autocorr =       1.239956750195
   target nu stat err =       0.000408540016
   target dn stat err =       0.002720491758
      target stat err =       0.004719154132
              std dev =       0.518863689604
             le_variance =       0.269219528390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269206219688
                                         uncertainty =       0.001805052987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269206219688
                                         uncertainty =       0.001805052987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366886163
  error estimate for blocks of size 2^( 2) =       0.000380599056
  error estimate for blocks of size 2^( 3) =       0.000393473903
  error estimate for blocks of size 2^( 4) =       0.000402717231
  error estimate for blocks of size 2^( 5) =       0.000408620169
  error estimate for blocks of size 2^( 6) =       0.000411613831
  error estimate for blocks of size 2^( 7) =       0.000411208834

      target function =      -0.941428096506
              le_mean =     -17.212411545828
             les_mean =     296.548985850647
             stat err =       0.000408540016
             autocorr =       1.239956750186
   target nu stat err =       0.000408540016
   target dn stat err =       0.002720491758
      target stat err =       0.004719154132
              std dev =       0.518863689604
             le_variance =       0.269219528390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269206219688
                                         uncertainty =       0.001805052987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269206219688
                                         uncertainty =       0.001805052987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366886163
  error estimate for blocks of size 2^( 2) =       0.000380599056
  error estimate for blocks of size 2^( 3) =       0.000393473903
  error estimate for blocks of size 2^( 4) =       0.000402717231
  error estimate for blocks of size 2^( 5) =       0.000408620169
  error estimate for blocks of size 2^( 6) =       0.000411613831
  error estimate for blocks of size 2^( 7) =       0.000411208834

      target function =      -0.941428096506
              le_mean =     -17.212411545828
             les_mean =     296.548985850647
             stat err =       0.000408540016
             autocorr =       1.239956750196
   target nu stat err =       0.000408540016
   target dn stat err =       0.002720491758
      target stat err =       0.004719154132
              std dev =       0.518863689604
             le_variance =       0.269219528390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269206219688
                                         uncertainty =       0.001805052987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269206219688
                                         uncertainty =       0.001805052987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366886163
  error estimate for blocks of size 2^( 2) =       0.000380599056
  error estimate for blocks of size 2^( 3) =       0.000393473903
  error estimate for blocks of size 2^( 4) =       0.000402717231
  error estimate for blocks of size 2^( 5) =       0.000408620169
  error estimate for blocks of size 2^( 6) =       0.000411613831
  error estimate for blocks of size 2^( 7) =       0.000411208834

      target function =      -0.941428096506
              le_mean =     -17.212411545828
             les_mean =     296.548985850647
             stat err =       0.000408540016
             autocorr =       1.239956750196
   target nu stat err =       0.000408540016
   target dn stat err =       0.002720491758
      target stat err =       0.004719154132
              std dev =       0.518863689604
             le_variance =       0.269219528390


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941428096506        initial  <--
     6.1035e+12     6.1035e+13             1.8178e-17        -0.941428096506
     2.4414e+13     2.4414e+14             0.0000e+00        -0.941428096506
     9.7656e+13     9.7656e+14             0.0000e+00        -0.941428096506

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3399
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1738e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2364
    reference variance = 0.227717
====================================================
  Execution time = 2.8322e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0365e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7607e-01
  Total weights = 1.957577192e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7064e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265590090773
                                         uncertainty =       0.001643978135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265590090773
                                         uncertainty =       0.001643978135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364377249
  error estimate for blocks of size 2^( 2) =       0.000378203742
  error estimate for blocks of size 2^( 3) =       0.000390924490
  error estimate for blocks of size 2^( 4) =       0.000399801181
  error estimate for blocks of size 2^( 5) =       0.000406250866
  error estimate for blocks of size 2^( 6) =       0.000410098516
  error estimate for blocks of size 2^( 7) =       0.000410967083

      target function =      -0.951484834876
              le_mean =     -17.212476213062
             les_mean =     296.545407502198
             stat err =       0.000406779411
             autocorr =       1.246279413333
   target nu stat err =       0.000406779411
   target dn stat err =       0.002071351657
      target stat err =       0.003701286747
              std dev =       0.515315492390
             le_variance =       0.265550056697


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721247621306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+13, overlap shift 6.1035e+14 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951498258812       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951498258812       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951498258812       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+13 is 1.965734e-18

solving harmonic davidson linear method for identity shift 2.4414e+14, overlap shift 2.4414e+15 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951498258812       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951498258812       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951498258812       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+14 is 4.914335e-19

solving harmonic davidson linear method for identity shift 9.7656e+14, overlap shift 9.7656e+15 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951498258812       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951498258812       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951498258812       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+14 is 1.228584e-19

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.196719 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7037e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2019
    reference variance = 0.193139
====================================================
  Execution time = 2.7877e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7691e-01
  Total weights = 1.9572e+06
  Execution time = 2.4940e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267181326924
                                         uncertainty =       0.001371742759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267181326924
                                         uncertainty =       0.001371742759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365462263
  error estimate for blocks of size 2^( 2) =       0.000379114784
  error estimate for blocks of size 2^( 3) =       0.000392080705
  error estimate for blocks of size 2^( 4) =       0.000401652795
  error estimate for blocks of size 2^( 5) =       0.000407176133
  error estimate for blocks of size 2^( 6) =       0.000409750252
  error estimate for blocks of size 2^( 7) =       0.000411550981

      target function =      -0.950032115287
              le_mean =     -17.212050123189
             les_mean =     296.531580005353
             stat err =       0.000407532540
             autocorr =       1.243482005850
   target nu stat err =       0.000407532540
   target dn stat err =       0.001867431923
      target stat err =       0.003340141934
              std dev =       0.516849958395
             le_variance =       0.267133879493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267181326924
                                         uncertainty =       0.001371742759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267181326924
                                         uncertainty =       0.001371742759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365462263
  error estimate for blocks of size 2^( 2) =       0.000379114784
  error estimate for blocks of size 2^( 3) =       0.000392080705
  error estimate for blocks of size 2^( 4) =       0.000401652795
  error estimate for blocks of size 2^( 5) =       0.000407176133
  error estimate for blocks of size 2^( 6) =       0.000409750252
  error estimate for blocks of size 2^( 7) =       0.000411550981

      target function =      -0.950032115287
              le_mean =     -17.212050123189
             les_mean =     296.531580005353
             stat err =       0.000407532540
             autocorr =       1.243482005850
   target nu stat err =       0.000407532540
   target dn stat err =       0.001867431923
      target stat err =       0.003340141934
              std dev =       0.516849958395
             le_variance =       0.267133879493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267181326924
                                         uncertainty =       0.001371742759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267181326924
                                         uncertainty =       0.001371742759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365462263
  error estimate for blocks of size 2^( 2) =       0.000379114784
  error estimate for blocks of size 2^( 3) =       0.000392080705
  error estimate for blocks of size 2^( 4) =       0.000401652795
  error estimate for blocks of size 2^( 5) =       0.000407176133
  error estimate for blocks of size 2^( 6) =       0.000409750252
  error estimate for blocks of size 2^( 7) =       0.000411550981

      target function =      -0.950032115287
              le_mean =     -17.212050123189
             les_mean =     296.531580005353
             stat err =       0.000407532540
             autocorr =       1.243482005850
   target nu stat err =       0.000407532540
   target dn stat err =       0.001867431923
      target stat err =       0.003340141934
              std dev =       0.516849958395
             le_variance =       0.267133879493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267181326924
                                         uncertainty =       0.001371742759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267181326924
                                         uncertainty =       0.001371742759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365462263
  error estimate for blocks of size 2^( 2) =       0.000379114784
  error estimate for blocks of size 2^( 3) =       0.000392080705
  error estimate for blocks of size 2^( 4) =       0.000401652795
  error estimate for blocks of size 2^( 5) =       0.000407176133
  error estimate for blocks of size 2^( 6) =       0.000409750252
  error estimate for blocks of size 2^( 7) =       0.000411550981

      target function =      -0.950032115287
              le_mean =     -17.212050123189
             les_mean =     296.531580005353
             stat err =       0.000407532540
             autocorr =       1.243482005850
   target nu stat err =       0.000407532540
   target dn stat err =       0.001867431923
      target stat err =       0.003340141934
              std dev =       0.516849958395
             le_variance =       0.267133879493


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950032115287        initial  <--
     6.1035e+13     6.1035e+14             1.9657e-18        -0.950032115287
     2.4414e+14     2.4414e+15             4.9143e-19        -0.950032115287
     9.7656e+14     9.7656e+15             1.2286e-19        -0.950032115287

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.4876
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7534e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2652
    reference variance = 0.508646
====================================================
  Execution time = 2.8625e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0394e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7853e-01
  Total weights = 1.957248026e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7727e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268141422704
                                         uncertainty =       0.001493990968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268141422704
                                         uncertainty =       0.001493990968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366118787
  error estimate for blocks of size 2^( 2) =       0.000379807050
  error estimate for blocks of size 2^( 3) =       0.000392341938
  error estimate for blocks of size 2^( 4) =       0.000401770308
  error estimate for blocks of size 2^( 5) =       0.000407517821
  error estimate for blocks of size 2^( 6) =       0.000411769343
  error estimate for blocks of size 2^( 7) =       0.000415903875

      target function =      -0.947216700271
              le_mean =     -17.212041462214
             les_mean =     296.532901647285
             stat err =       0.000409240337
             autocorr =       1.249432607022
   target nu stat err =       0.000409240337
   target dn stat err =       0.001905768059
      target stat err =       0.003386273922
              std dev =       0.517778438832
             le_variance =       0.268094511719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721204146221e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+14, overlap shift 6.1035e+15 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947227703783       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947227703783       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947227703783       residual = 4.03e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947227703779       residual = 4.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.591119232046       residual = 1.82e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947227702588       residual = 4.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.582150777842       residual = 1.34e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915952642299       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.519536082465       residual = 2.96e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -1.492547360096       residual = 1.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -1.255104777016       residual = 1.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.764371450328       residual = 5.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -3.625742652146       residual = 9.85e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       1.102092368009       residual = 3.43e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -3.242521268235       residual = 5.43e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.145676649240       residual = 1.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -3.355002408880       residual = 7.77e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.530208467550       residual = 2.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =       0.083365380446       residual = 2.44e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -3.278943098084       residual = 7.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.843923467008       residual = 2.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       1.192299602079       residual = 8.77e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.350431778740       residual = 2.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =       0.622790740128       residual = 1.24e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       0.876262412792       residual = 4.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -3.033433449727       residual = 9.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       0.267289308575       residual = 1.24e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -2.076266642387       residual = 3.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -4.180566730998       residual = 1.22e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       0.090071287856       residual = 7.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       1.212467654927       residual = 8.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.841617302020       residual = 4.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.957406033787       residual = 4.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.735584911214       residual = 8.64e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -2.628654477381       residual = 1.72e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.424981900485       residual = 1.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =       3.077887896132       residual = 1.73e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       1.814155920616       residual = 3.28e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       9.048397626691       residual = 9.84e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       2.106611930445       residual = 2.51e+03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -4.949586393850       residual = 2.98e+03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =       3.851405225403       residual = 7.61e+03           smallest_sin_value = 1.00e+00
davidson iteration   42 stopping due to too large eigenvalue change
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+14 is 1.187548e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+15, overlap shift 2.4414e+16 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947227703783       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947227703783       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947227703782       residual = 2.59e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913962684024       residual = 6.99e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947227703783       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+15 is 2.968869e-20

solving harmonic davidson linear method for identity shift 9.7656e+15, overlap shift 9.7656e+16 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947227703783       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947227703783       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947227703783       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947227703783       residual = 1.00e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.685616374103       residual = 6.03e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.577911410906       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       4.694052131202       residual = 2.71e+03           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+15 is 8.631472e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.229247 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7438e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1957
    reference variance = 0.250342
====================================================
  Execution time = 2.8034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8143e-01
  Total weights = 1.9576e+06
  Execution time = 2.5061e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269085033943
                                         uncertainty =       0.002054481049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269085033943
                                         uncertainty =       0.002054481049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366765338
  error estimate for blocks of size 2^( 2) =       0.000380982655
  error estimate for blocks of size 2^( 3) =       0.000393400519
  error estimate for blocks of size 2^( 4) =       0.000402619636
  error estimate for blocks of size 2^( 5) =       0.000409604719
  error estimate for blocks of size 2^( 6) =       0.000413827268
  error estimate for blocks of size 2^( 7) =       0.000414631156

      target function =      -0.942225355744
              le_mean =     -17.211773157833
             les_mean =     296.526562314327
             stat err =       0.000410170695
             autocorr =       1.250698665118
   target nu stat err =       0.000410170695
   target dn stat err =       0.002608573039
      target stat err =       0.004532390138
              std dev =       0.518692814432
             le_variance =       0.269042235743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269085033943
                                         uncertainty =       0.002054481049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269085033943
                                         uncertainty =       0.002054481049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366765338
  error estimate for blocks of size 2^( 2) =       0.000380982655
  error estimate for blocks of size 2^( 3) =       0.000393400519
  error estimate for blocks of size 2^( 4) =       0.000402619636
  error estimate for blocks of size 2^( 5) =       0.000409604719
  error estimate for blocks of size 2^( 6) =       0.000413827268
  error estimate for blocks of size 2^( 7) =       0.000414631156

      target function =      -0.942225355744
              le_mean =     -17.211773157833
             les_mean =     296.526562314327
             stat err =       0.000410170695
             autocorr =       1.250698665118
   target nu stat err =       0.000410170695
   target dn stat err =       0.002608573039
      target stat err =       0.004532390138
              std dev =       0.518692814432
             le_variance =       0.269042235743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269085033943
                                         uncertainty =       0.002054481049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269085033943
                                         uncertainty =       0.002054481049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366765338
  error estimate for blocks of size 2^( 2) =       0.000380982655
  error estimate for blocks of size 2^( 3) =       0.000393400519
  error estimate for blocks of size 2^( 4) =       0.000402619636
  error estimate for blocks of size 2^( 5) =       0.000409604719
  error estimate for blocks of size 2^( 6) =       0.000413827268
  error estimate for blocks of size 2^( 7) =       0.000414631156

      target function =      -0.942225355744
              le_mean =     -17.211773157833
             les_mean =     296.526562314327
             stat err =       0.000410170695
             autocorr =       1.250698665118
   target nu stat err =       0.000410170695
   target dn stat err =       0.002608573039
      target stat err =       0.004532390138
              std dev =       0.518692814432
             le_variance =       0.269042235743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269085033943
                                         uncertainty =       0.002054481049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269085033943
                                         uncertainty =       0.002054481049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366765338
  error estimate for blocks of size 2^( 2) =       0.000380982655
  error estimate for blocks of size 2^( 3) =       0.000393400519
  error estimate for blocks of size 2^( 4) =       0.000402619636
  error estimate for blocks of size 2^( 5) =       0.000409604719
  error estimate for blocks of size 2^( 6) =       0.000413827268
  error estimate for blocks of size 2^( 7) =       0.000414631156

      target function =      -0.942225355744
              le_mean =     -17.211773157833
             les_mean =     296.526562314327
             stat err =       0.000410170695
             autocorr =       1.250698665118
   target nu stat err =       0.000410170695
   target dn stat err =       0.002608573039
      target stat err =       0.004532390138
              std dev =       0.518692814432
             le_variance =       0.269042235743


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942225355744        initial  <--
     6.1035e+14     6.1035e+15             1.1875e-19        -0.942225355744
     2.4414e+15     2.4414e+16             2.9689e-20        -0.942225355744
     9.7656e+15     9.7656e+16             8.6315e-21        -0.942225355744

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7108
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8157e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1735
    reference variance = 0.249617
====================================================
  Execution time = 2.8415e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0390e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7698e-01
  Total weights = 1.957516250e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6834e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266617717726
                                         uncertainty =       0.001286004475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266617717726
                                         uncertainty =       0.001286004475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365109514
  error estimate for blocks of size 2^( 2) =       0.000378856164
  error estimate for blocks of size 2^( 3) =       0.000391538323
  error estimate for blocks of size 2^( 4) =       0.000400340030
  error estimate for blocks of size 2^( 5) =       0.000405204101
  error estimate for blocks of size 2^( 6) =       0.000409008917
  error estimate for blocks of size 2^( 7) =       0.000411426182

      target function =      -0.949892462459
              le_mean =     -17.212527544696
             les_mean =     296.548087086251
             stat err =       0.000406494807
             autocorr =       1.239549011519
   target nu stat err =       0.000406494807
   target dn stat err =       0.001806782434
      target stat err =       0.003238804929
              std dev =       0.516351088553
             le_variance =       0.266618446650


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721252754470e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+15, overlap shift 6.1035e+16 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949902419016       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949902419016       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+16, overlap shift 2.4414e+17 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949902419016       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949902419016       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+16, overlap shift 9.7656e+17 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949902419016       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949902419016       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.230539 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7107e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2536
    reference variance = 0.359865
====================================================
  Execution time = 2.8408e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8089e-01
  Total weights = 1.9575e+06
  Execution time = 2.4966e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268331057113
                                         uncertainty =       0.001619258264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268331057113
                                         uncertainty =       0.001619258264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366407888
  error estimate for blocks of size 2^( 2) =       0.000380220819
  error estimate for blocks of size 2^( 3) =       0.000392292830
  error estimate for blocks of size 2^( 4) =       0.000401492185
  error estimate for blocks of size 2^( 5) =       0.000406586720
  error estimate for blocks of size 2^( 6) =       0.000411150411
  error estimate for blocks of size 2^( 7) =       0.000411552137

      target function =      -0.943148506387
              le_mean =     -17.212009727745
             les_mean =     296.534165249606
             stat err =       0.000407695363
             autocorr =       1.238060638292
   target nu stat err =       0.000407695363
   target dn stat err =       0.002233277150
      target stat err =       0.003907827222
              std dev =       0.518187295007
             le_variance =       0.268518072707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268331057113
                                         uncertainty =       0.001619258264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268331057113
                                         uncertainty =       0.001619258264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366407888
  error estimate for blocks of size 2^( 2) =       0.000380220819
  error estimate for blocks of size 2^( 3) =       0.000392292830
  error estimate for blocks of size 2^( 4) =       0.000401492185
  error estimate for blocks of size 2^( 5) =       0.000406586720
  error estimate for blocks of size 2^( 6) =       0.000411150411
  error estimate for blocks of size 2^( 7) =       0.000411552137

      target function =      -0.943148506387
              le_mean =     -17.212009727745
             les_mean =     296.534165249606
             stat err =       0.000407695363
             autocorr =       1.238060638288
   target nu stat err =       0.000407695363
   target dn stat err =       0.002233277150
      target stat err =       0.003907827222
              std dev =       0.518187295007
             le_variance =       0.268518072707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268331057113
                                         uncertainty =       0.001619258264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268331057113
                                         uncertainty =       0.001619258264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366407888
  error estimate for blocks of size 2^( 2) =       0.000380220819
  error estimate for blocks of size 2^( 3) =       0.000392292830
  error estimate for blocks of size 2^( 4) =       0.000401492185
  error estimate for blocks of size 2^( 5) =       0.000406586720
  error estimate for blocks of size 2^( 6) =       0.000411150411
  error estimate for blocks of size 2^( 7) =       0.000411552137

      target function =      -0.943148506387
              le_mean =     -17.212009727745
             les_mean =     296.534165249606
             stat err =       0.000407695363
             autocorr =       1.238060638288
   target nu stat err =       0.000407695363
   target dn stat err =       0.002233277150
      target stat err =       0.003907827222
              std dev =       0.518187295007
             le_variance =       0.268518072707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268331057113
                                         uncertainty =       0.001619258264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268331057113
                                         uncertainty =       0.001619258264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366407888
  error estimate for blocks of size 2^( 2) =       0.000380220819
  error estimate for blocks of size 2^( 3) =       0.000392292830
  error estimate for blocks of size 2^( 4) =       0.000401492185
  error estimate for blocks of size 2^( 5) =       0.000406586720
  error estimate for blocks of size 2^( 6) =       0.000411150411
  error estimate for blocks of size 2^( 7) =       0.000411552137

      target function =      -0.943148506387
              le_mean =     -17.212009727745
             les_mean =     296.534165249606
             stat err =       0.000407695363
             autocorr =       1.238060638288
   target nu stat err =       0.000407695363
   target dn stat err =       0.002233277150
      target stat err =       0.003907827222
              std dev =       0.518187295007
             le_variance =       0.268518072707


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943148506387        initial  <--
     6.1035e+15     6.1035e+16             0.0000e+00        -0.943148506387
     2.4414e+16     2.4414e+17             0.0000e+00        -0.943148506387
     9.7656e+16     9.7656e+17             0.0000e+00        -0.943148506387

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0191
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2295
    reference variance = 0.220895
====================================================
  Execution time = 2.8309e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0394e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7671e-01
  Total weights = 1.957472991e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8022e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266067864206
                                         uncertainty =       0.001373746910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266067864206
                                         uncertainty =       0.001373746910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364773455
  error estimate for blocks of size 2^( 2) =       0.000378879666
  error estimate for blocks of size 2^( 3) =       0.000391552304
  error estimate for blocks of size 2^( 4) =       0.000401765864
  error estimate for blocks of size 2^( 5) =       0.000407858041
  error estimate for blocks of size 2^( 6) =       0.000410903580
  error estimate for blocks of size 2^( 7) =       0.000412869529

      target function =      -0.950375340680
              le_mean =     -17.212437765454
             les_mean =     296.544720424791
             stat err =       0.000408349254
             autocorr =       1.253190453285
   target nu stat err =       0.000408349254
   target dn stat err =       0.001942636521
      target stat err =       0.003473412537
              std dev =       0.515875821583
             le_variance =       0.266127863294


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721243776545e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+16, overlap shift 6.1035e+17 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950386877488       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950386877488       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.44e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+17, overlap shift 2.4414e+18 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950386877488       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950386877488       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.44e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+17, overlap shift 9.7656e+18 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950386877488       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950386877488       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.231853 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7123e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.297
    reference variance = 0.918045
====================================================
  Execution time = 3.0410e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8261e-01
  Total weights = 1.9573e+06
  Execution time = 2.4944e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269462808947
                                         uncertainty =       0.002830046951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269462808947
                                         uncertainty =       0.002830046951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367099418
  error estimate for blocks of size 2^( 2) =       0.000381084162
  error estimate for blocks of size 2^( 3) =       0.000393686773
  error estimate for blocks of size 2^( 4) =       0.000403016394
  error estimate for blocks of size 2^( 5) =       0.000409100139
  error estimate for blocks of size 2^( 6) =       0.000411478626
  error estimate for blocks of size 2^( 7) =       0.000412976205

      target function =      -0.940172039510
              le_mean =     -17.211941191638
             les_mean =     296.533532434296
             stat err =       0.000409142841
             autocorr =       1.242174250197
   target nu stat err =       0.000409142841
   target dn stat err =       0.003549734391
      target stat err =       0.006104482480
              std dev =       0.519165281679
             le_variance =       0.269532589701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269462808947
                                         uncertainty =       0.002830046951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269462808947
                                         uncertainty =       0.002830046951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367099418
  error estimate for blocks of size 2^( 2) =       0.000381084162
  error estimate for blocks of size 2^( 3) =       0.000393686773
  error estimate for blocks of size 2^( 4) =       0.000403016394
  error estimate for blocks of size 2^( 5) =       0.000409100139
  error estimate for blocks of size 2^( 6) =       0.000411478626
  error estimate for blocks of size 2^( 7) =       0.000412976205

      target function =      -0.940172039510
              le_mean =     -17.211941191638
             les_mean =     296.533532434296
             stat err =       0.000409142841
             autocorr =       1.242174250197
   target nu stat err =       0.000409142841
   target dn stat err =       0.003549734391
      target stat err =       0.006104482480
              std dev =       0.519165281679
             le_variance =       0.269532589701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269462808947
                                         uncertainty =       0.002830046951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269462808947
                                         uncertainty =       0.002830046951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367099418
  error estimate for blocks of size 2^( 2) =       0.000381084162
  error estimate for blocks of size 2^( 3) =       0.000393686773
  error estimate for blocks of size 2^( 4) =       0.000403016394
  error estimate for blocks of size 2^( 5) =       0.000409100139
  error estimate for blocks of size 2^( 6) =       0.000411478626
  error estimate for blocks of size 2^( 7) =       0.000412976205

      target function =      -0.940172039510
              le_mean =     -17.211941191638
             les_mean =     296.533532434296
             stat err =       0.000409142841
             autocorr =       1.242174250197
   target nu stat err =       0.000409142841
   target dn stat err =       0.003549734391
      target stat err =       0.006104482480
              std dev =       0.519165281679
             le_variance =       0.269532589701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269462808947
                                         uncertainty =       0.002830046951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269462808947
                                         uncertainty =       0.002830046951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367099418
  error estimate for blocks of size 2^( 2) =       0.000381084162
  error estimate for blocks of size 2^( 3) =       0.000393686773
  error estimate for blocks of size 2^( 4) =       0.000403016394
  error estimate for blocks of size 2^( 5) =       0.000409100139
  error estimate for blocks of size 2^( 6) =       0.000411478626
  error estimate for blocks of size 2^( 7) =       0.000412976205

      target function =      -0.940172039510
              le_mean =     -17.211941191638
             les_mean =     296.533532434296
             stat err =       0.000409142841
             autocorr =       1.242174250197
   target nu stat err =       0.000409142841
   target dn stat err =       0.003549734391
      target stat err =       0.006104482480
              std dev =       0.519165281679
             le_variance =       0.269532589701


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940172039510        initial  <--
     6.1035e+16     6.1035e+17             0.0000e+00        -0.940172039510
     2.4414e+17     2.4414e+18             0.0000e+00        -0.940172039510
     9.7656e+17     9.7656e+18             0.0000e+00        -0.940172039510

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9905
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0125e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1482
    reference variance = 0.213773
====================================================
  Execution time = 2.8184e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0370e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7852e-01
  Total weights = 1.957477583e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7619e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267080309134
                                         uncertainty =       0.001877543230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267080309134
                                         uncertainty =       0.001877543230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365557498
  error estimate for blocks of size 2^( 2) =       0.000379666478
  error estimate for blocks of size 2^( 3) =       0.000392592939
  error estimate for blocks of size 2^( 4) =       0.000401856609
  error estimate for blocks of size 2^( 5) =       0.000407976770
  error estimate for blocks of size 2^( 6) =       0.000409215974
  error estimate for blocks of size 2^( 7) =       0.000409413447

      target function =      -0.947228315691
              le_mean =     -17.211879974438
             les_mean =     296.527333074901
             stat err =       0.000407115700
             autocorr =       1.240293051414
   target nu stat err =       0.000407115700
   target dn stat err =       0.002655050426
      target stat err =       0.004659496354
              std dev =       0.516984642540
             le_variance =       0.267273120622


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721187997444e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+17, overlap shift 6.1035e+18 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947249812718       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947249812718       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947249812718       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947249812718       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+17 is 2.181293e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+18, overlap shift 2.4414e+19 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947249812718       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947249812718       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947249812718       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947249812718       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947249812718       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+18 is 5.707622e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+18, overlap shift 9.7656e+19 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947249812718       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947249812718       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947249812718       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947249812718       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947249799965       residual = 2.35e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+18 is 1.363308e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.234192 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6956e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1109
    reference variance = 0.208669
====================================================
  Execution time = 2.8192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8097e-01
  Total weights = 1.9575e+06
  Execution time = 2.5059e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269634881294
                                         uncertainty =       0.001796972273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269634881294
                                         uncertainty =       0.001796972273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367161160
  error estimate for blocks of size 2^( 2) =       0.000380923656
  error estimate for blocks of size 2^( 3) =       0.000393783428
  error estimate for blocks of size 2^( 4) =       0.000402998756
  error estimate for blocks of size 2^( 5) =       0.000408480930
  error estimate for blocks of size 2^( 6) =       0.000413216529
  error estimate for blocks of size 2^( 7) =       0.000416487337

      target function =      -0.942998410734
              le_mean =     -17.212279493415
             les_mean =     296.543531721160
             stat err =       0.000410295888
             autocorr =       1.248765417610
   target nu stat err =       0.000410295888
   target dn stat err =       0.002327414675
      target stat err =       0.004068437531
              std dev =       0.519252599493
             le_variance =       0.269623262081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269634881294
                                         uncertainty =       0.001796972273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269634881294
                                         uncertainty =       0.001796972273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367161160
  error estimate for blocks of size 2^( 2) =       0.000380923656
  error estimate for blocks of size 2^( 3) =       0.000393783428
  error estimate for blocks of size 2^( 4) =       0.000402998756
  error estimate for blocks of size 2^( 5) =       0.000408480930
  error estimate for blocks of size 2^( 6) =       0.000413216529
  error estimate for blocks of size 2^( 7) =       0.000416487337

      target function =      -0.942998410734
              le_mean =     -17.212279493415
             les_mean =     296.543531721160
             stat err =       0.000410295888
             autocorr =       1.248765417610
   target nu stat err =       0.000410295888
   target dn stat err =       0.002327414675
      target stat err =       0.004068437531
              std dev =       0.519252599493
             le_variance =       0.269623262081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269634881294
                                         uncertainty =       0.001796972273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269634881294
                                         uncertainty =       0.001796972273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367161160
  error estimate for blocks of size 2^( 2) =       0.000380923656
  error estimate for blocks of size 2^( 3) =       0.000393783428
  error estimate for blocks of size 2^( 4) =       0.000402998756
  error estimate for blocks of size 2^( 5) =       0.000408480930
  error estimate for blocks of size 2^( 6) =       0.000413216529
  error estimate for blocks of size 2^( 7) =       0.000416487337

      target function =      -0.942998410734
              le_mean =     -17.212279493415
             les_mean =     296.543531721160
             stat err =       0.000410295888
             autocorr =       1.248765417610
   target nu stat err =       0.000410295888
   target dn stat err =       0.002327414675
      target stat err =       0.004068437531
              std dev =       0.519252599493
             le_variance =       0.269623262081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269634881294
                                         uncertainty =       0.001796972273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269634881294
                                         uncertainty =       0.001796972273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367161160
  error estimate for blocks of size 2^( 2) =       0.000380923656
  error estimate for blocks of size 2^( 3) =       0.000393783428
  error estimate for blocks of size 2^( 4) =       0.000402998756
  error estimate for blocks of size 2^( 5) =       0.000408480930
  error estimate for blocks of size 2^( 6) =       0.000413216529
  error estimate for blocks of size 2^( 7) =       0.000416487337

      target function =      -0.942998410734
              le_mean =     -17.212279493415
             les_mean =     296.543531721160
             stat err =       0.000410295888
             autocorr =       1.248765417610
   target nu stat err =       0.000410295888
   target dn stat err =       0.002327414675
      target stat err =       0.004068437531
              std dev =       0.519252599493
             le_variance =       0.269623262081


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942998410734        initial  <--
     6.1035e+17     6.1035e+18             2.1813e-22        -0.942998410734
     2.4414e+18     2.4414e+19             5.7076e-23        -0.942998410734
     9.7656e+18     9.7656e+19             1.3633e-23        -0.942998410734

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8467
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1344
    reference variance = 0.191759
====================================================
  Execution time = 2.8371e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0396e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8159e-01
  Total weights = 1.957354443e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8216e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268499768475
                                         uncertainty =       0.001732565701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268499768475
                                         uncertainty =       0.001732565701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366427552
  error estimate for blocks of size 2^( 2) =       0.000380337493
  error estimate for blocks of size 2^( 3) =       0.000393141231
  error estimate for blocks of size 2^( 4) =       0.000402273744
  error estimate for blocks of size 2^( 5) =       0.000408269427
  error estimate for blocks of size 2^( 6) =       0.000411985586
  error estimate for blocks of size 2^( 7) =       0.000412397684

      target function =      -0.941933038255
              le_mean =     -17.212001258884
             les_mean =     296.534580305078
             stat err =       0.000408731610
             autocorr =       1.244228684037
   target nu stat err =       0.000408731610
   target dn stat err =       0.002486335891
      target stat err =       0.004324696095
              std dev =       0.518215105376
             le_variance =       0.268546895439


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721200125888e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+18, overlap shift 6.1035e+19 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941951842630       residual = 8.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941951842630       residual = 8.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+19, overlap shift 2.4414e+20 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941951842630       residual = 8.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941951842630       residual = 8.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+19, overlap shift 9.7656e+20 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941951842630       residual = 8.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941951842630       residual = 8.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.235513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7202e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1638
    reference variance = 0.1711
====================================================
  Execution time = 2.8529e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7773e-01
  Total weights = 1.9577e+06
  Execution time = 2.5045e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266075146163
                                         uncertainty =       0.001394237474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266075146163
                                         uncertainty =       0.001394237474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364699925
  error estimate for blocks of size 2^( 2) =       0.000378334494
  error estimate for blocks of size 2^( 3) =       0.000390622278
  error estimate for blocks of size 2^( 4) =       0.000400261191
  error estimate for blocks of size 2^( 5) =       0.000406161465
  error estimate for blocks of size 2^( 6) =       0.000409457057
  error estimate for blocks of size 2^( 7) =       0.000411732067

      target function =      -0.948593760594
              le_mean =     -17.212303644218
             les_mean =     296.541126124144
             stat err =       0.000406902945
             autocorr =       1.244830781607
   target nu stat err =       0.000406902945
   target dn stat err =       0.002225853075
      target stat err =       0.003941557668
              std dev =       0.515771832065
             le_variance =       0.266020582752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266075146163
                                         uncertainty =       0.001394237474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266075146163
                                         uncertainty =       0.001394237474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364699925
  error estimate for blocks of size 2^( 2) =       0.000378334494
  error estimate for blocks of size 2^( 3) =       0.000390622278
  error estimate for blocks of size 2^( 4) =       0.000400261191
  error estimate for blocks of size 2^( 5) =       0.000406161465
  error estimate for blocks of size 2^( 6) =       0.000409457057
  error estimate for blocks of size 2^( 7) =       0.000411732067

      target function =      -0.948593760594
              le_mean =     -17.212303644218
             les_mean =     296.541126124144
             stat err =       0.000406902945
             autocorr =       1.244830781607
   target nu stat err =       0.000406902945
   target dn stat err =       0.002225853075
      target stat err =       0.003941557668
              std dev =       0.515771832065
             le_variance =       0.266020582752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266075146163
                                         uncertainty =       0.001394237474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266075146163
                                         uncertainty =       0.001394237474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364699925
  error estimate for blocks of size 2^( 2) =       0.000378334494
  error estimate for blocks of size 2^( 3) =       0.000390622278
  error estimate for blocks of size 2^( 4) =       0.000400261191
  error estimate for blocks of size 2^( 5) =       0.000406161465
  error estimate for blocks of size 2^( 6) =       0.000409457057
  error estimate for blocks of size 2^( 7) =       0.000411732067

      target function =      -0.948593760594
              le_mean =     -17.212303644218
             les_mean =     296.541126124144
             stat err =       0.000406902945
             autocorr =       1.244830781607
   target nu stat err =       0.000406902945
   target dn stat err =       0.002225853075
      target stat err =       0.003941557668
              std dev =       0.515771832065
             le_variance =       0.266020582752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266075146163
                                         uncertainty =       0.001394237474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266075146163
                                         uncertainty =       0.001394237474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364699925
  error estimate for blocks of size 2^( 2) =       0.000378334494
  error estimate for blocks of size 2^( 3) =       0.000390622278
  error estimate for blocks of size 2^( 4) =       0.000400261191
  error estimate for blocks of size 2^( 5) =       0.000406161465
  error estimate for blocks of size 2^( 6) =       0.000409457057
  error estimate for blocks of size 2^( 7) =       0.000411732067

      target function =      -0.948593760594
              le_mean =     -17.212303644218
             les_mean =     296.541126124144
             stat err =       0.000406902945
             autocorr =       1.244830781607
   target nu stat err =       0.000406902945
   target dn stat err =       0.002225853075
      target stat err =       0.003941557668
              std dev =       0.515771832065
             le_variance =       0.266020582752


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948593760594        initial  <--
     6.1035e+18     6.1035e+19             0.0000e+00        -0.948593760594
     2.4414e+19     2.4414e+20             0.0000e+00        -0.948593760594
     9.7656e+19     9.7656e+20             0.0000e+00        -0.948593760594

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.2114
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8421e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2235
    reference variance = 0.143933
====================================================
  Execution time = 2.8402e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0379e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7767e-01
  Total weights = 1.957282754e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8586e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265890706922
                                         uncertainty =       0.001520989012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265890706922
                                         uncertainty =       0.001520989012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364617072
  error estimate for blocks of size 2^( 2) =       0.000378560687
  error estimate for blocks of size 2^( 3) =       0.000391459037
  error estimate for blocks of size 2^( 4) =       0.000400424824
  error estimate for blocks of size 2^( 5) =       0.000406863139
  error estimate for blocks of size 2^( 6) =       0.000411339563
  error estimate for blocks of size 2^( 7) =       0.000413111682

      target function =      -0.948696605804
              le_mean =     -17.212290327383
             les_mean =     296.540605910431
             stat err =       0.000407934802
             autocorr =       1.251720940811
   target nu stat err =       0.000407934802
   target dn stat err =       0.002559018415
      target stat err =       0.004512921049
              std dev =       0.515654657922
             le_variance =       0.265899726237


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721229032738e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+19, overlap shift 6.1035e+20 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948717015494       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948717015494       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948717015518       residual = 3.51e+04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948717015494       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+19 is 1.390813e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+20, overlap shift 2.4414e+21 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948717015494       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948717015494       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948717015494       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+20 is 3.477032e-25

solving harmonic davidson linear method for identity shift 9.7656e+20, overlap shift 9.7656e+21 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948717015494       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948717015494       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948717015494       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+20 is 8.692580e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.237308 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7269e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.1636
    reference variance = 0.340856
====================================================
  Execution time = 2.8354e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8051e-01
  Total weights = 1.9571e+06
  Execution time = 2.5124e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318497835
                                         uncertainty =       0.001377646185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318497835
                                         uncertainty =       0.001377646185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365548466
  error estimate for blocks of size 2^( 2) =       0.000379203086
  error estimate for blocks of size 2^( 3) =       0.000391590855
  error estimate for blocks of size 2^( 4) =       0.000401479031
  error estimate for blocks of size 2^( 5) =       0.000408531733
  error estimate for blocks of size 2^( 6) =       0.000410112043
  error estimate for blocks of size 2^( 7) =       0.000410661994

      target function =      -0.943799478612
              le_mean =     -17.211938341155
             les_mean =     296.531330078355
             stat err =       0.000407696200
             autocorr =       1.243894065973
   target nu stat err =       0.000407696200
   target dn stat err =       0.002340348704
      target stat err =       0.004093561179
              std dev =       0.516971869762
             le_variance =       0.267259914126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318497835
                                         uncertainty =       0.001377646185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318497835
                                         uncertainty =       0.001377646185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365548466
  error estimate for blocks of size 2^( 2) =       0.000379203086
  error estimate for blocks of size 2^( 3) =       0.000391590855
  error estimate for blocks of size 2^( 4) =       0.000401479031
  error estimate for blocks of size 2^( 5) =       0.000408531733
  error estimate for blocks of size 2^( 6) =       0.000410112043
  error estimate for blocks of size 2^( 7) =       0.000410661994

      target function =      -0.943799478612
              le_mean =     -17.211938341155
             les_mean =     296.531330078355
             stat err =       0.000407696200
             autocorr =       1.243894065973
   target nu stat err =       0.000407696200
   target dn stat err =       0.002340348704
      target stat err =       0.004093561179
              std dev =       0.516971869762
             le_variance =       0.267259914126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318497835
                                         uncertainty =       0.001377646185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318497835
                                         uncertainty =       0.001377646185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365548466
  error estimate for blocks of size 2^( 2) =       0.000379203086
  error estimate for blocks of size 2^( 3) =       0.000391590855
  error estimate for blocks of size 2^( 4) =       0.000401479031
  error estimate for blocks of size 2^( 5) =       0.000408531733
  error estimate for blocks of size 2^( 6) =       0.000410112043
  error estimate for blocks of size 2^( 7) =       0.000410661994

      target function =      -0.943799478612
              le_mean =     -17.211938341155
             les_mean =     296.531330078355
             stat err =       0.000407696200
             autocorr =       1.243894065973
   target nu stat err =       0.000407696200
   target dn stat err =       0.002340348704
      target stat err =       0.004093561179
              std dev =       0.516971869762
             le_variance =       0.267259914126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318497835
                                         uncertainty =       0.001377646185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318497835
                                         uncertainty =       0.001377646185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365548466
  error estimate for blocks of size 2^( 2) =       0.000379203086
  error estimate for blocks of size 2^( 3) =       0.000391590855
  error estimate for blocks of size 2^( 4) =       0.000401479031
  error estimate for blocks of size 2^( 5) =       0.000408531733
  error estimate for blocks of size 2^( 6) =       0.000410112043
  error estimate for blocks of size 2^( 7) =       0.000410661994

      target function =      -0.943799478612
              le_mean =     -17.211938341155
             les_mean =     296.531330078355
             stat err =       0.000407696200
             autocorr =       1.243894065973
   target nu stat err =       0.000407696200
   target dn stat err =       0.002340348704
      target stat err =       0.004093561179
              std dev =       0.516971869762
             le_variance =       0.267259914126


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943799478612        initial  <--
     6.1035e+19     6.1035e+20             1.3908e-24        -0.943799478612
     2.4414e+20     2.4414e+21             3.4770e-25        -0.943799478612
     9.7656e+20     9.7656e+21             8.6926e-26        -0.943799478612

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0534
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.1915
    reference variance = 0.179074
====================================================
  Execution time = 2.8498e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0401e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7752e-01
  Total weights = 1.957319633e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7908e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267336112156
                                         uncertainty =       0.001581755485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267336112156
                                         uncertainty =       0.001581755485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365599883
  error estimate for blocks of size 2^( 2) =       0.000379483700
  error estimate for blocks of size 2^( 3) =       0.000392349810
  error estimate for blocks of size 2^( 4) =       0.000401710118
  error estimate for blocks of size 2^( 5) =       0.000405848173
  error estimate for blocks of size 2^( 6) =       0.000409452962
  error estimate for blocks of size 2^( 7) =       0.000412057934

      target function =      -0.948968463370
              le_mean =     -17.212206491724
             les_mean =     296.537569474662
             stat err =       0.000407267297
             autocorr =       1.240929128409
   target nu stat err =       0.000407267297
   target dn stat err =       0.002048925603
      target stat err =       0.003642197620
              std dev =       0.517044585970
             le_variance =       0.267335103880


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721220649172e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+20, overlap shift 6.1035e+21 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948981444843       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948981444843       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+21, overlap shift 2.4414e+22 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948981444843       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948981444843       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+21, overlap shift 9.7656e+22 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948981444843       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948981444843       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.238658 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7297e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2476
    reference variance = 0.205187
====================================================
  Execution time = 3.0414e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8062e-01
  Total weights = 1.9575e+06
  Execution time = 2.5058e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267293960505
                                         uncertainty =       0.001634997890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267293960505
                                         uncertainty =       0.001634997890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365559581
  error estimate for blocks of size 2^( 2) =       0.000379225924
  error estimate for blocks of size 2^( 3) =       0.000392190619
  error estimate for blocks of size 2^( 4) =       0.000401634855
  error estimate for blocks of size 2^( 5) =       0.000407823088
  error estimate for blocks of size 2^( 6) =       0.000411120148
  error estimate for blocks of size 2^( 7) =       0.000411414687

      target function =      -0.943593354768
              le_mean =     -17.211978095244
             les_mean =     296.532805931564
             stat err =       0.000407998194
             autocorr =       1.245661782230
   target nu stat err =       0.000407998194
   target dn stat err =       0.003456799188
      target stat err =       0.005990238440
              std dev =       0.516987589010
             le_variance =       0.267276167190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267293960505
                                         uncertainty =       0.001634997890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267293960505
                                         uncertainty =       0.001634997890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365559581
  error estimate for blocks of size 2^( 2) =       0.000379225924
  error estimate for blocks of size 2^( 3) =       0.000392190619
  error estimate for blocks of size 2^( 4) =       0.000401634855
  error estimate for blocks of size 2^( 5) =       0.000407823088
  error estimate for blocks of size 2^( 6) =       0.000411120148
  error estimate for blocks of size 2^( 7) =       0.000411414687

      target function =      -0.943593354768
              le_mean =     -17.211978095244
             les_mean =     296.532805931564
             stat err =       0.000407998194
             autocorr =       1.245661782230
   target nu stat err =       0.000407998194
   target dn stat err =       0.003456799188
      target stat err =       0.005990238440
              std dev =       0.516987589010
             le_variance =       0.267276167190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267293960505
                                         uncertainty =       0.001634997890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267293960505
                                         uncertainty =       0.001634997890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365559581
  error estimate for blocks of size 2^( 2) =       0.000379225924
  error estimate for blocks of size 2^( 3) =       0.000392190619
  error estimate for blocks of size 2^( 4) =       0.000401634855
  error estimate for blocks of size 2^( 5) =       0.000407823088
  error estimate for blocks of size 2^( 6) =       0.000411120148
  error estimate for blocks of size 2^( 7) =       0.000411414687

      target function =      -0.943593354768
              le_mean =     -17.211978095244
             les_mean =     296.532805931564
             stat err =       0.000407998194
             autocorr =       1.245661782230
   target nu stat err =       0.000407998194
   target dn stat err =       0.003456799188
      target stat err =       0.005990238440
              std dev =       0.516987589010
             le_variance =       0.267276167190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267293960505
                                         uncertainty =       0.001634997890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267293960505
                                         uncertainty =       0.001634997890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365559581
  error estimate for blocks of size 2^( 2) =       0.000379225924
  error estimate for blocks of size 2^( 3) =       0.000392190619
  error estimate for blocks of size 2^( 4) =       0.000401634855
  error estimate for blocks of size 2^( 5) =       0.000407823088
  error estimate for blocks of size 2^( 6) =       0.000411120148
  error estimate for blocks of size 2^( 7) =       0.000411414687

      target function =      -0.943593354768
              le_mean =     -17.211978095244
             les_mean =     296.532805931564
             stat err =       0.000407998194
             autocorr =       1.245661782230
   target nu stat err =       0.000407998194
   target dn stat err =       0.003456799188
      target stat err =       0.005990238440
              std dev =       0.516987589010
             le_variance =       0.267276167190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943593354768        initial  <--
     6.1035e+20     6.1035e+21             0.0000e+00        -0.943593354768
     2.4414e+21     2.4414e+22             0.0000e+00        -0.943593354768
     9.7656e+21     9.7656e+22             0.0000e+00        -0.943593354768

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0425
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0346e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1277
    reference variance = 0.298562
====================================================
  Execution time = 2.7994e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0377e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7905e-01
  Total weights = 1.957542730e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7416e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268192717813
                                         uncertainty =       0.001570147742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268192717813
                                         uncertainty =       0.001570147742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366198870
  error estimate for blocks of size 2^( 2) =       0.000379932746
  error estimate for blocks of size 2^( 3) =       0.000393047660
  error estimate for blocks of size 2^( 4) =       0.000402716270
  error estimate for blocks of size 2^( 5) =       0.000408373332
  error estimate for blocks of size 2^( 6) =       0.000411455133
  error estimate for blocks of size 2^( 7) =       0.000413368088

      target function =      -0.946327821450
              le_mean =     -17.211725280705
             les_mean =     296.522534820330
             stat err =       0.000408978206
             autocorr =       1.247286814942
   target nu stat err =       0.000408978206
   target dn stat err =       0.002263954557
      target stat err =       0.003984102743
              std dev =       0.517891694170
             le_variance =       0.268211806891


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721172528071e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+21, overlap shift 6.1035e+22 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946343467134       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946343467134       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946343467134       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946343467134       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946343486768       residual = 2.62e+05           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+21 is 2.588934e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+22, overlap shift 2.4414e+23 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946343467134       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946343467134       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946343467134       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946343467134       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946310754134       residual = 7.84e+05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937546740432       residual = 1.56e+06           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+22 is 5.227069e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+22, overlap shift 9.7656e+23 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946343467134       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946343467134       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946343467134       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946343467134       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946343467134       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946343458447       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+22 is 1.497546e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.241439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6745e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2841
    reference variance = 0.194551
====================================================
  Execution time = 2.7895e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7958e-01
  Total weights = 1.9571e+06
  Execution time = 2.4988e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267057438849
                                         uncertainty =       0.001214717499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267057438849
                                         uncertainty =       0.001214717499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365381971
  error estimate for blocks of size 2^( 2) =       0.000379184628
  error estimate for blocks of size 2^( 3) =       0.000391625810
  error estimate for blocks of size 2^( 4) =       0.000401124186
  error estimate for blocks of size 2^( 5) =       0.000406443258
  error estimate for blocks of size 2^( 6) =       0.000410654464
  error estimate for blocks of size 2^( 7) =       0.000412304755

      target function =      -0.945419343941
              le_mean =     -17.211753392769
             les_mean =     296.524030839804
             stat err =       0.000407631666
             autocorr =       1.244633820150
   target nu stat err =       0.000407631666
   target dn stat err =       0.001882933854
      target stat err =       0.003332808382
              std dev =       0.516736407065
             le_variance =       0.267016514387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267057438849
                                         uncertainty =       0.001214717499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267057438849
                                         uncertainty =       0.001214717499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365381971
  error estimate for blocks of size 2^( 2) =       0.000379184628
  error estimate for blocks of size 2^( 3) =       0.000391625810
  error estimate for blocks of size 2^( 4) =       0.000401124186
  error estimate for blocks of size 2^( 5) =       0.000406443258
  error estimate for blocks of size 2^( 6) =       0.000410654464
  error estimate for blocks of size 2^( 7) =       0.000412304755

      target function =      -0.945419343941
              le_mean =     -17.211753392769
             les_mean =     296.524030839804
             stat err =       0.000407631666
             autocorr =       1.244633820150
   target nu stat err =       0.000407631666
   target dn stat err =       0.001882933854
      target stat err =       0.003332808382
              std dev =       0.516736407065
             le_variance =       0.267016514387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267057438849
                                         uncertainty =       0.001214717499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267057438849
                                         uncertainty =       0.001214717499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365381971
  error estimate for blocks of size 2^( 2) =       0.000379184628
  error estimate for blocks of size 2^( 3) =       0.000391625810
  error estimate for blocks of size 2^( 4) =       0.000401124186
  error estimate for blocks of size 2^( 5) =       0.000406443258
  error estimate for blocks of size 2^( 6) =       0.000410654464
  error estimate for blocks of size 2^( 7) =       0.000412304755

      target function =      -0.945419343941
              le_mean =     -17.211753392769
             les_mean =     296.524030839804
             stat err =       0.000407631666
             autocorr =       1.244633820150
   target nu stat err =       0.000407631666
   target dn stat err =       0.001882933854
      target stat err =       0.003332808382
              std dev =       0.516736407065
             le_variance =       0.267016514387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267057438849
                                         uncertainty =       0.001214717499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267057438849
                                         uncertainty =       0.001214717499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365381971
  error estimate for blocks of size 2^( 2) =       0.000379184628
  error estimate for blocks of size 2^( 3) =       0.000391625810
  error estimate for blocks of size 2^( 4) =       0.000401124186
  error estimate for blocks of size 2^( 5) =       0.000406443258
  error estimate for blocks of size 2^( 6) =       0.000410654464
  error estimate for blocks of size 2^( 7) =       0.000412304755

      target function =      -0.945419343941
              le_mean =     -17.211753392769
             les_mean =     296.524030839804
             stat err =       0.000407631666
             autocorr =       1.244633820150
   target nu stat err =       0.000407631666
   target dn stat err =       0.001882933854
      target stat err =       0.003332808382
              std dev =       0.516736407065
             le_variance =       0.267016514387


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945419343941        initial  <--
     6.1035e+21     6.1035e+22             2.5889e-26        -0.945419343941
     2.4414e+22     2.4414e+23             5.2271e-27        -0.945419343941
     9.7656e+22     9.7656e+23             1.4975e-27        -0.945419343941

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.5167
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7269e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2832
    reference variance = 0.331481
====================================================
  Execution time = 2.8045e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0398e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7699e-01
  Total weights = 1.957298628e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6799e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264941255078
                                         uncertainty =       0.001298643560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264941255078
                                         uncertainty =       0.001298643560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364018740
  error estimate for blocks of size 2^( 2) =       0.000377624130
  error estimate for blocks of size 2^( 3) =       0.000390267515
  error estimate for blocks of size 2^( 4) =       0.000399328308
  error estimate for blocks of size 2^( 5) =       0.000403585015
  error estimate for blocks of size 2^( 6) =       0.000407021522
  error estimate for blocks of size 2^( 7) =       0.000408432824

      target function =      -0.949892056480
              le_mean =     -17.212073810714
             les_mean =     296.532473529838
             stat err =       0.000404591917
             autocorr =       1.235341182658
   target nu stat err =       0.000404591917
   target dn stat err =       0.002112740474
      target stat err =       0.003756164244
              std dev =       0.514808476281
             le_variance =       0.265027767251


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721207381071e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+22, overlap shift 6.1035e+23 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949905880622       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949905880622       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+23, overlap shift 2.4414e+24 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949905880622       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949905880622       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+23, overlap shift 9.7656e+24 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949905880622       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949905880622       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.242761 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6733e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2049
    reference variance = 0.238067
====================================================
  Execution time = 2.8293e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8078e-01
  Total weights = 1.9575e+06
  Execution time = 2.4922e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269300233119
                                         uncertainty =       0.001486061357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269300233119
                                         uncertainty =       0.001486061357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366893745
  error estimate for blocks of size 2^( 2) =       0.000380686728
  error estimate for blocks of size 2^( 3) =       0.000393949112
  error estimate for blocks of size 2^( 4) =       0.000402899388
  error estimate for blocks of size 2^( 5) =       0.000408037122
  error estimate for blocks of size 2^( 6) =       0.000409394443
  error estimate for blocks of size 2^( 7) =       0.000412360302

      target function =      -0.943344667249
              le_mean =     -17.211799437014
             les_mean =     296.526818589976
             stat err =       0.000408172814
             autocorr =       1.237677610048
   target nu stat err =       0.000408172814
   target dn stat err =       0.002075114503
      target stat err =       0.003641604375
              std dev =       0.518874412320
             le_variance =       0.269230655760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269300233119
                                         uncertainty =       0.001486061357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269300233119
                                         uncertainty =       0.001486061357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366893745
  error estimate for blocks of size 2^( 2) =       0.000380686728
  error estimate for blocks of size 2^( 3) =       0.000393949112
  error estimate for blocks of size 2^( 4) =       0.000402899388
  error estimate for blocks of size 2^( 5) =       0.000408037122
  error estimate for blocks of size 2^( 6) =       0.000409394443
  error estimate for blocks of size 2^( 7) =       0.000412360302

      target function =      -0.943344667249
              le_mean =     -17.211799437014
             les_mean =     296.526818589976
             stat err =       0.000408172814
             autocorr =       1.237677610048
   target nu stat err =       0.000408172814
   target dn stat err =       0.002075114503
      target stat err =       0.003641604375
              std dev =       0.518874412320
             le_variance =       0.269230655760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269300233119
                                         uncertainty =       0.001486061357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269300233119
                                         uncertainty =       0.001486061357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366893745
  error estimate for blocks of size 2^( 2) =       0.000380686728
  error estimate for blocks of size 2^( 3) =       0.000393949112
  error estimate for blocks of size 2^( 4) =       0.000402899388
  error estimate for blocks of size 2^( 5) =       0.000408037122
  error estimate for blocks of size 2^( 6) =       0.000409394443
  error estimate for blocks of size 2^( 7) =       0.000412360302

      target function =      -0.943344667249
              le_mean =     -17.211799437014
             les_mean =     296.526818589976
             stat err =       0.000408172814
             autocorr =       1.237677610048
   target nu stat err =       0.000408172814
   target dn stat err =       0.002075114503
      target stat err =       0.003641604375
              std dev =       0.518874412320
             le_variance =       0.269230655760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269300233119
                                         uncertainty =       0.001486061357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269300233119
                                         uncertainty =       0.001486061357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366893745
  error estimate for blocks of size 2^( 2) =       0.000380686728
  error estimate for blocks of size 2^( 3) =       0.000393949112
  error estimate for blocks of size 2^( 4) =       0.000402899388
  error estimate for blocks of size 2^( 5) =       0.000408037122
  error estimate for blocks of size 2^( 6) =       0.000409394443
  error estimate for blocks of size 2^( 7) =       0.000412360302

      target function =      -0.943344667249
              le_mean =     -17.211799437014
             les_mean =     296.526818589976
             stat err =       0.000408172814
             autocorr =       1.237677610048
   target nu stat err =       0.000408172814
   target dn stat err =       0.002075114503
      target stat err =       0.003641604375
              std dev =       0.518874412320
             le_variance =       0.269230655760


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943344667249        initial  <--
     6.1035e+22     6.1035e+23             0.0000e+00        -0.943344667249
     2.4414e+23     2.4414e+24             0.0000e+00        -0.943344667249
     9.7656e+23     9.7656e+24             0.0000e+00        -0.943344667249

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8793
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7623e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2772
    reference variance = 0.193305
====================================================
  Execution time = 2.8225e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0397e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7565e-01
  Total weights = 1.957747417e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8486e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266179643381
                                         uncertainty =       0.002160099927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266179643381
                                         uncertainty =       0.002160099927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364818233
  error estimate for blocks of size 2^( 2) =       0.000378652127
  error estimate for blocks of size 2^( 3) =       0.000391407505
  error estimate for blocks of size 2^( 4) =       0.000400806204
  error estimate for blocks of size 2^( 5) =       0.000406820774
  error estimate for blocks of size 2^( 6) =       0.000410958768
  error estimate for blocks of size 2^( 7) =       0.000411996472

      target function =      -0.952199023340
              le_mean =     -17.212693668509
             les_mean =     296.552475057636
             stat err =       0.000407645554
             autocorr =       1.248568428157
   target nu stat err =       0.000407645554
   target dn stat err =       0.002848021967
      target stat err =       0.005049814391
              std dev =       0.515939148406
             le_variance =       0.266193204858


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721269366851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+23, overlap shift 6.1035e+24 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952225018671       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952225018671       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+24, overlap shift 2.4414e+25 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952225018671       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952225018671       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+24, overlap shift 9.7656e+25 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952225018671       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952225018671       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.244064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7082e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2551
    reference variance = 0.282628
====================================================
  Execution time = 2.8067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7602e-01
  Total weights = 1.9572e+06
  Execution time = 2.5003e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265166105780
                                         uncertainty =       0.001202045181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265166105780
                                         uncertainty =       0.001202045181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364102307
  error estimate for blocks of size 2^( 2) =       0.000377921759
  error estimate for blocks of size 2^( 3) =       0.000390226345
  error estimate for blocks of size 2^( 4) =       0.000399448188
  error estimate for blocks of size 2^( 5) =       0.000404806356
  error estimate for blocks of size 2^( 6) =       0.000408440165
  error estimate for blocks of size 2^( 7) =       0.000410567388

      target function =      -0.951604047842
              le_mean =     -17.211668720410
             les_mean =     296.517556661868
             stat err =       0.000405815524
             autocorr =       1.242254133162
   target nu stat err =       0.000405815524
   target dn stat err =       0.001789985667
      target stat err =       0.003215938410
              std dev =       0.514926659914
             le_variance =       0.265149465090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265166105780
                                         uncertainty =       0.001202045181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265166105780
                                         uncertainty =       0.001202045181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364102307
  error estimate for blocks of size 2^( 2) =       0.000377921759
  error estimate for blocks of size 2^( 3) =       0.000390226345
  error estimate for blocks of size 2^( 4) =       0.000399448188
  error estimate for blocks of size 2^( 5) =       0.000404806356
  error estimate for blocks of size 2^( 6) =       0.000408440165
  error estimate for blocks of size 2^( 7) =       0.000410567388

      target function =      -0.951604047842
              le_mean =     -17.211668720410
             les_mean =     296.517556661868
             stat err =       0.000405815524
             autocorr =       1.242254133162
   target nu stat err =       0.000405815524
   target dn stat err =       0.001789985667
      target stat err =       0.003215938410
              std dev =       0.514926659914
             le_variance =       0.265149465090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265166105780
                                         uncertainty =       0.001202045181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265166105780
                                         uncertainty =       0.001202045181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364102307
  error estimate for blocks of size 2^( 2) =       0.000377921759
  error estimate for blocks of size 2^( 3) =       0.000390226345
  error estimate for blocks of size 2^( 4) =       0.000399448188
  error estimate for blocks of size 2^( 5) =       0.000404806356
  error estimate for blocks of size 2^( 6) =       0.000408440165
  error estimate for blocks of size 2^( 7) =       0.000410567388

      target function =      -0.951604047842
              le_mean =     -17.211668720410
             les_mean =     296.517556661868
             stat err =       0.000405815524
             autocorr =       1.242254133162
   target nu stat err =       0.000405815524
   target dn stat err =       0.001789985667
      target stat err =       0.003215938410
              std dev =       0.514926659914
             le_variance =       0.265149465090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265166105780
                                         uncertainty =       0.001202045181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265166105780
                                         uncertainty =       0.001202045181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364102307
  error estimate for blocks of size 2^( 2) =       0.000377921759
  error estimate for blocks of size 2^( 3) =       0.000390226345
  error estimate for blocks of size 2^( 4) =       0.000399448188
  error estimate for blocks of size 2^( 5) =       0.000404806356
  error estimate for blocks of size 2^( 6) =       0.000408440165
  error estimate for blocks of size 2^( 7) =       0.000410567388

      target function =      -0.951604047842
              le_mean =     -17.211668720410
             les_mean =     296.517556661868
             stat err =       0.000405815524
             autocorr =       1.242254133162
   target nu stat err =       0.000405815524
   target dn stat err =       0.001789985667
      target stat err =       0.003215938410
              std dev =       0.514926659914
             le_variance =       0.265149465090


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951604047842        initial  <--
     6.1035e+23     6.1035e+24             0.0000e+00        -0.951604047842
     2.4414e+24     2.4414e+25             0.0000e+00        -0.951604047842
     9.7656e+24     9.7656e+25             0.0000e+00        -0.951604047842

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.6627
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7751e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1949
    reference variance = 0.148801
====================================================
  Execution time = 2.8307e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0394e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8050e-01
  Total weights = 1.957832447e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2200e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268080488769
                                         uncertainty =       0.001993318411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268080488769
                                         uncertainty =       0.001993318411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366122611
  error estimate for blocks of size 2^( 2) =       0.000379793677
  error estimate for blocks of size 2^( 3) =       0.000392052208
  error estimate for blocks of size 2^( 4) =       0.000401169943
  error estimate for blocks of size 2^( 5) =       0.000407524853
  error estimate for blocks of size 2^( 6) =       0.000409602283
  error estimate for blocks of size 2^( 7) =       0.000408642673

      target function =      -0.943804654872
              le_mean =     -17.211976220236
             les_mean =     296.532626454501
             stat err =       0.000406734938
             autocorr =       1.234155426219
   target nu stat err =       0.000406734938
   target dn stat err =       0.002729330892
      target stat err =       0.004753232677
              std dev =       0.517783846201
             le_variance =       0.268100111387


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721197622024e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+24, overlap shift 6.1035e+25 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943827624326       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943827624326       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+25, overlap shift 2.4414e+26 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943827624326       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943827624326       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+25, overlap shift 9.7656e+26 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943827624326       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943827624326       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.245372 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8461e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2486
    reference variance = 0.149414
====================================================
  Execution time = 2.8064e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7860e-01
  Total weights = 1.9571e+06
  Execution time = 2.5385e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268069753647
                                         uncertainty =       0.001822274750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268069753647
                                         uncertainty =       0.001822274750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366138361
  error estimate for blocks of size 2^( 2) =       0.000380045621
  error estimate for blocks of size 2^( 3) =       0.000392780366
  error estimate for blocks of size 2^( 4) =       0.000401810863
  error estimate for blocks of size 2^( 5) =       0.000407482692
  error estimate for blocks of size 2^( 6) =       0.000409665218
  error estimate for blocks of size 2^( 7) =       0.000411191903

      target function =      -0.947059710211
              le_mean =     -17.212800183350
             les_mean =     296.559092735559
             stat err =       0.000407537669
             autocorr =       1.238925092316
   target nu stat err =       0.000407537669
   target dn stat err =       0.002215219984
      target stat err =       0.003914930614
              std dev =       0.517806119930
             le_variance =       0.268123177837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268069753647
                                         uncertainty =       0.001822274750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268069753647
                                         uncertainty =       0.001822274750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366138361
  error estimate for blocks of size 2^( 2) =       0.000380045621
  error estimate for blocks of size 2^( 3) =       0.000392780366
  error estimate for blocks of size 2^( 4) =       0.000401810863
  error estimate for blocks of size 2^( 5) =       0.000407482692
  error estimate for blocks of size 2^( 6) =       0.000409665218
  error estimate for blocks of size 2^( 7) =       0.000411191903

      target function =      -0.947059710211
              le_mean =     -17.212800183350
             les_mean =     296.559092735559
             stat err =       0.000407537669
             autocorr =       1.238925092316
   target nu stat err =       0.000407537669
   target dn stat err =       0.002215219984
      target stat err =       0.003914930614
              std dev =       0.517806119930
             le_variance =       0.268123177837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268069753647
                                         uncertainty =       0.001822274750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268069753647
                                         uncertainty =       0.001822274750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366138361
  error estimate for blocks of size 2^( 2) =       0.000380045621
  error estimate for blocks of size 2^( 3) =       0.000392780366
  error estimate for blocks of size 2^( 4) =       0.000401810863
  error estimate for blocks of size 2^( 5) =       0.000407482692
  error estimate for blocks of size 2^( 6) =       0.000409665218
  error estimate for blocks of size 2^( 7) =       0.000411191903

      target function =      -0.947059710211
              le_mean =     -17.212800183350
             les_mean =     296.559092735559
             stat err =       0.000407537669
             autocorr =       1.238925092316
   target nu stat err =       0.000407537669
   target dn stat err =       0.002215219984
      target stat err =       0.003914930614
              std dev =       0.517806119930
             le_variance =       0.268123177837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268069753647
                                         uncertainty =       0.001822274750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268069753647
                                         uncertainty =       0.001822274750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366138361
  error estimate for blocks of size 2^( 2) =       0.000380045621
  error estimate for blocks of size 2^( 3) =       0.000392780366
  error estimate for blocks of size 2^( 4) =       0.000401810863
  error estimate for blocks of size 2^( 5) =       0.000407482692
  error estimate for blocks of size 2^( 6) =       0.000409665218
  error estimate for blocks of size 2^( 7) =       0.000411191903

      target function =      -0.947059710211
              le_mean =     -17.212800183350
             les_mean =     296.559092735559
             stat err =       0.000407537669
             autocorr =       1.238925092316
   target nu stat err =       0.000407537669
   target dn stat err =       0.002215219984
      target stat err =       0.003914930614
              std dev =       0.517806119930
             le_variance =       0.268123177837


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947059710211        initial  <--
     6.1035e+24     6.1035e+25             0.0000e+00        -0.947059710211
     2.4414e+25     2.4414e+26             0.0000e+00        -0.947059710211
     9.7656e+25     9.7656e+26             0.0000e+00        -0.947059710211

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7073
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9177e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1868
    reference variance = 0.218348
====================================================
  Execution time = 2.8569e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0399e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8115e-01
  Total weights = 1.957467357e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7262e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269264799540
                                         uncertainty =       0.001700988244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269264799540
                                         uncertainty =       0.001700988244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366995827
  error estimate for blocks of size 2^( 2) =       0.000380782007
  error estimate for blocks of size 2^( 3) =       0.000393168059
  error estimate for blocks of size 2^( 4) =       0.000402314450
  error estimate for blocks of size 2^( 5) =       0.000406501379
  error estimate for blocks of size 2^( 6) =       0.000410034542
  error estimate for blocks of size 2^( 7) =       0.000412086453

      target function =      -0.942681897481
              le_mean =     -17.212350193119
             les_mean =     296.546144197295
             stat err =       0.000407734206
             autocorr =       1.234332158445
   target nu stat err =       0.000407734206
   target dn stat err =       0.002735906583
      target stat err =       0.004756933266
              std dev =       0.519018779278
             le_variance =       0.269380493243


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721235019312e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+25, overlap shift 6.1035e+26 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942704750002       residual = 8.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942704750002       residual = 8.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+26, overlap shift 2.4414e+27 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942704750002       residual = 8.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942704750002       residual = 8.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+26, overlap shift 9.7656e+27 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942704750002       residual = 8.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942704750002       residual = 8.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.246679 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7306e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2122
    reference variance = 0.271684
====================================================
  Execution time = 2.8187e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7743e-01
  Total weights = 1.9577e+06
  Execution time = 2.5399e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265268986893
                                         uncertainty =       0.001622930886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265268986893
                                         uncertainty =       0.001622930886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364192172
  error estimate for blocks of size 2^( 2) =       0.000378243190
  error estimate for blocks of size 2^( 3) =       0.000390715347
  error estimate for blocks of size 2^( 4) =       0.000399506833
  error estimate for blocks of size 2^( 5) =       0.000405933162
  error estimate for blocks of size 2^( 6) =       0.000409833950
  error estimate for blocks of size 2^( 7) =       0.000411826965

      target function =      -0.949140018864
              le_mean =     -17.211431053706
             les_mean =     296.510788927051
             stat err =       0.000406775227
             autocorr =       1.247520754507
   target nu stat err =       0.000406775227
   target dn stat err =       0.002329344796
      target stat err =       0.004116090241
              std dev =       0.515053749538
             le_variance =       0.265280364913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265268986893
                                         uncertainty =       0.001622930886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265268986893
                                         uncertainty =       0.001622930886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364192172
  error estimate for blocks of size 2^( 2) =       0.000378243190
  error estimate for blocks of size 2^( 3) =       0.000390715347
  error estimate for blocks of size 2^( 4) =       0.000399506833
  error estimate for blocks of size 2^( 5) =       0.000405933162
  error estimate for blocks of size 2^( 6) =       0.000409833950
  error estimate for blocks of size 2^( 7) =       0.000411826965

      target function =      -0.949140018864
              le_mean =     -17.211431053706
             les_mean =     296.510788927051
             stat err =       0.000406775227
             autocorr =       1.247520754507
   target nu stat err =       0.000406775227
   target dn stat err =       0.002329344796
      target stat err =       0.004116090241
              std dev =       0.515053749538
             le_variance =       0.265280364913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265268986893
                                         uncertainty =       0.001622930886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265268986893
                                         uncertainty =       0.001622930886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364192172
  error estimate for blocks of size 2^( 2) =       0.000378243190
  error estimate for blocks of size 2^( 3) =       0.000390715347
  error estimate for blocks of size 2^( 4) =       0.000399506833
  error estimate for blocks of size 2^( 5) =       0.000405933162
  error estimate for blocks of size 2^( 6) =       0.000409833950
  error estimate for blocks of size 2^( 7) =       0.000411826965

      target function =      -0.949140018864
              le_mean =     -17.211431053706
             les_mean =     296.510788927051
             stat err =       0.000406775227
             autocorr =       1.247520754507
   target nu stat err =       0.000406775227
   target dn stat err =       0.002329344796
      target stat err =       0.004116090241
              std dev =       0.515053749538
             le_variance =       0.265280364913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265268986893
                                         uncertainty =       0.001622930886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265268986893
                                         uncertainty =       0.001622930886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364192172
  error estimate for blocks of size 2^( 2) =       0.000378243190
  error estimate for blocks of size 2^( 3) =       0.000390715347
  error estimate for blocks of size 2^( 4) =       0.000399506833
  error estimate for blocks of size 2^( 5) =       0.000405933162
  error estimate for blocks of size 2^( 6) =       0.000409833950
  error estimate for blocks of size 2^( 7) =       0.000411826965

      target function =      -0.949140018864
              le_mean =     -17.211431053706
             les_mean =     296.510788927051
             stat err =       0.000406775227
             autocorr =       1.247520754507
   target nu stat err =       0.000406775227
   target dn stat err =       0.002329344796
      target stat err =       0.004116090241
              std dev =       0.515053749538
             le_variance =       0.265280364913


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949140018864        initial  <--
     6.1035e+25     6.1035e+26             0.0000e+00        -0.949140018864
     2.4414e+26     2.4414e+27             0.0000e+00        -0.949140018864
     9.7656e+26     9.7656e+27             0.0000e+00        -0.949140018864

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8227
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2321
    reference variance = 0.280073
====================================================
  Execution time = 2.8754e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0396e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7146e-01
  Total weights = 1.957776694e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7275e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.262504171737
                                         uncertainty =       0.001416150094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.262504171737
                                         uncertainty =       0.001416150094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000362259440
  error estimate for blocks of size 2^( 2) =       0.000375882288
  error estimate for blocks of size 2^( 3) =       0.000388454917
  error estimate for blocks of size 2^( 4) =       0.000398266166
  error estimate for blocks of size 2^( 5) =       0.000403515095
  error estimate for blocks of size 2^( 6) =       0.000405656769
  error estimate for blocks of size 2^( 7) =       0.000408736880

      target function =      -0.959639427476
              le_mean =     -17.211444493947
             les_mean =     296.505280783159
             stat err =       0.000404043727
             autocorr =       1.243991216972
   target nu stat err =       0.000404043727
   target dn stat err =       0.001676473875
      target stat err =       0.003070885017
              std dev =       0.512320410725
             le_variance =       0.262472203245


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721144449395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+26, overlap shift 6.1035e+27 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.959648178968       residual = 9.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.959648178968       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.959648178978       residual = 9.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+26 is 1.271604e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+27, overlap shift 2.4414e+28 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.959648178968       residual = 9.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.959648178968       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.959648178968       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+27 is 4.000272e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+27, overlap shift 9.7656e+28 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.959648178968       residual = 9.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.959648178968       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.959648178968       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.959648178968       residual = 9.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+27 is 1.000068e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.250819 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7495e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2124
    reference variance = 0.241056
====================================================
  Execution time = 2.7930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7904e-01
  Total weights = 1.9577e+06
  Execution time = 2.5307e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268401863405
                                         uncertainty =       0.002070959741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268401863405
                                         uncertainty =       0.002070959741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366335931
  error estimate for blocks of size 2^( 2) =       0.000379467969
  error estimate for blocks of size 2^( 3) =       0.000392153691
  error estimate for blocks of size 2^( 4) =       0.000401634985
  error estimate for blocks of size 2^( 5) =       0.000406839367
  error estimate for blocks of size 2^( 6) =       0.000409585223
  error estimate for blocks of size 2^( 7) =       0.000411011968

      target function =      -0.946356672136
              le_mean =     -17.211361260514
             les_mean =     296.509993210892
             stat err =       0.000407267886
             autocorr =       1.235951128787
   target nu stat err =       0.000407267886
   target dn stat err =       0.002449979969
      target stat err =       0.004297092253
              std dev =       0.518085531012
             le_variance =       0.268412617444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268401863405
                                         uncertainty =       0.002070959741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268401863405
                                         uncertainty =       0.002070959741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366335931
  error estimate for blocks of size 2^( 2) =       0.000379467969
  error estimate for blocks of size 2^( 3) =       0.000392153691
  error estimate for blocks of size 2^( 4) =       0.000401634985
  error estimate for blocks of size 2^( 5) =       0.000406839367
  error estimate for blocks of size 2^( 6) =       0.000409585223
  error estimate for blocks of size 2^( 7) =       0.000411011968

      target function =      -0.946356672136
              le_mean =     -17.211361260514
             les_mean =     296.509993210892
             stat err =       0.000407267886
             autocorr =       1.235951128786
   target nu stat err =       0.000407267886
   target dn stat err =       0.002449979969
      target stat err =       0.004297092253
              std dev =       0.518085531012
             le_variance =       0.268412617444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268401863405
                                         uncertainty =       0.002070959741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268401863405
                                         uncertainty =       0.002070959741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366335931
  error estimate for blocks of size 2^( 2) =       0.000379467969
  error estimate for blocks of size 2^( 3) =       0.000392153691
  error estimate for blocks of size 2^( 4) =       0.000401634985
  error estimate for blocks of size 2^( 5) =       0.000406839367
  error estimate for blocks of size 2^( 6) =       0.000409585223
  error estimate for blocks of size 2^( 7) =       0.000411011968

      target function =      -0.946356672136
              le_mean =     -17.211361260514
             les_mean =     296.509993210892
             stat err =       0.000407267886
             autocorr =       1.235951128786
   target nu stat err =       0.000407267886
   target dn stat err =       0.002449979969
      target stat err =       0.004297092253
              std dev =       0.518085531012
             le_variance =       0.268412617444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268401863405
                                         uncertainty =       0.002070959741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268401863405
                                         uncertainty =       0.002070959741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366335931
  error estimate for blocks of size 2^( 2) =       0.000379467969
  error estimate for blocks of size 2^( 3) =       0.000392153691
  error estimate for blocks of size 2^( 4) =       0.000401634985
  error estimate for blocks of size 2^( 5) =       0.000406839367
  error estimate for blocks of size 2^( 6) =       0.000409585223
  error estimate for blocks of size 2^( 7) =       0.000411011968

      target function =      -0.946356672136
              le_mean =     -17.211361260514
             les_mean =     296.509993210892
             stat err =       0.000407267886
             autocorr =       1.235951128786
   target nu stat err =       0.000407267886
   target dn stat err =       0.002449979969
      target stat err =       0.004297092253
              std dev =       0.518085531012
             le_variance =       0.268412617444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946356672136        initial  <--
     6.1035e+26     6.1035e+27             1.2716e-31        -0.946356672136
     2.4414e+27     2.4414e+28             4.0003e-32        -0.946356672136
     9.7656e+27     9.7656e+28             1.0001e-32        -0.946356672136

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.5566
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8065e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.1853
    reference variance = 0.285844
====================================================
  Execution time = 2.8446e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0366e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8150e-01
  Total weights = 1.957125310e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6373e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268060312817
                                         uncertainty =       0.003775428373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268060312817
                                         uncertainty =       0.003775428373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366103772
  error estimate for blocks of size 2^( 2) =       0.000379595912
  error estimate for blocks of size 2^( 3) =       0.000392634467
  error estimate for blocks of size 2^( 4) =       0.000402352849
  error estimate for blocks of size 2^( 5) =       0.000408296029
  error estimate for blocks of size 2^( 6) =       0.000413397661
  error estimate for blocks of size 2^( 7) =       0.000414426742

      target function =      -0.942031099985
              le_mean =     -17.211977081433
             les_mean =     296.533652590796
             stat err =       0.000409618320
             autocorr =       1.251844361211
   target nu stat err =       0.000409618320
   target dn stat err =       0.005268244750
      target stat err =       0.009059859100
              std dev =       0.517757203879
             le_variance =       0.268072522168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721197708143e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+27, overlap shift 6.1035e+28 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942116461653       residual = 3.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942116461653       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942116461653       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942116461665       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+27 is 3.777715e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+28, overlap shift 2.4414e+29 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942116461653       residual = 3.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942116461653       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942116461653       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+28 is 9.444287e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+28, overlap shift 9.7656e+29 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942116461653       residual = 3.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942116461653       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942116461653       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942116461651       residual = 4.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+28 is 2.361072e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.252740 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7092e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.1555
    reference variance = 0.16804
====================================================
  Execution time = 2.8306e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8163e-01
  Total weights = 1.9572e+06
  Execution time = 2.5462e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267531631049
                                         uncertainty =       0.001559125981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267531631049
                                         uncertainty =       0.001559125981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365716046
  error estimate for blocks of size 2^( 2) =       0.000379709331
  error estimate for blocks of size 2^( 3) =       0.000392100071
  error estimate for blocks of size 2^( 4) =       0.000401837037
  error estimate for blocks of size 2^( 5) =       0.000406727855
  error estimate for blocks of size 2^( 6) =       0.000409469934
  error estimate for blocks of size 2^( 7) =       0.000411294524

      target function =      -0.941901318183
              le_mean =     -17.211251780118
             les_mean =     296.508816066531
             stat err =       0.000407332337
             autocorr =       1.240537074948
   target nu stat err =       0.000407332337
   target dn stat err =       0.002718758952
      target stat err =       0.004710003819
              std dev =       0.517208866716
             le_variance =       0.267505011810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267531631049
                                         uncertainty =       0.001559125981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267531631049
                                         uncertainty =       0.001559125981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365716046
  error estimate for blocks of size 2^( 2) =       0.000379709331
  error estimate for blocks of size 2^( 3) =       0.000392100071
  error estimate for blocks of size 2^( 4) =       0.000401837037
  error estimate for blocks of size 2^( 5) =       0.000406727855
  error estimate for blocks of size 2^( 6) =       0.000409469934
  error estimate for blocks of size 2^( 7) =       0.000411294524

      target function =      -0.941901318183
              le_mean =     -17.211251780118
             les_mean =     296.508816066531
             stat err =       0.000407332337
             autocorr =       1.240537074948
   target nu stat err =       0.000407332337
   target dn stat err =       0.002718758952
      target stat err =       0.004710003819
              std dev =       0.517208866716
             le_variance =       0.267505011810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267531631049
                                         uncertainty =       0.001559125981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267531631049
                                         uncertainty =       0.001559125981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365716046
  error estimate for blocks of size 2^( 2) =       0.000379709331
  error estimate for blocks of size 2^( 3) =       0.000392100071
  error estimate for blocks of size 2^( 4) =       0.000401837037
  error estimate for blocks of size 2^( 5) =       0.000406727855
  error estimate for blocks of size 2^( 6) =       0.000409469934
  error estimate for blocks of size 2^( 7) =       0.000411294524

      target function =      -0.941901318183
              le_mean =     -17.211251780118
             les_mean =     296.508816066531
             stat err =       0.000407332337
             autocorr =       1.240537074948
   target nu stat err =       0.000407332337
   target dn stat err =       0.002718758952
      target stat err =       0.004710003819
              std dev =       0.517208866716
             le_variance =       0.267505011810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267531631049
                                         uncertainty =       0.001559125981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267531631049
                                         uncertainty =       0.001559125981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365716046
  error estimate for blocks of size 2^( 2) =       0.000379709331
  error estimate for blocks of size 2^( 3) =       0.000392100071
  error estimate for blocks of size 2^( 4) =       0.000401837037
  error estimate for blocks of size 2^( 5) =       0.000406727855
  error estimate for blocks of size 2^( 6) =       0.000409469934
  error estimate for blocks of size 2^( 7) =       0.000411294524

      target function =      -0.941901318183
              le_mean =     -17.211251780118
             les_mean =     296.508816066531
             stat err =       0.000407332337
             autocorr =       1.240537074948
   target nu stat err =       0.000407332337
   target dn stat err =       0.002718758952
      target stat err =       0.004710003819
              std dev =       0.517208866716
             le_variance =       0.267505011810


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941901318183        initial  <--
     6.1035e+27     6.1035e+28             3.7777e-32        -0.941901318183
     2.4414e+28     2.4414e+29             9.4443e-33        -0.941901318183
     9.7656e+28     9.7656e+29             2.3611e-33        -0.941901318183

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0124
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8112e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.245
    reference variance = 0.285638
====================================================
  Execution time = 3.0846e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0391e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8131e-01
  Total weights = 1.957259129e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6785e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267882914638
                                         uncertainty =       0.001591223254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267882914638
                                         uncertainty =       0.001591223254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365958992
  error estimate for blocks of size 2^( 2) =       0.000379512357
  error estimate for blocks of size 2^( 3) =       0.000392419170
  error estimate for blocks of size 2^( 4) =       0.000401505833
  error estimate for blocks of size 2^( 5) =       0.000407166861
  error estimate for blocks of size 2^( 6) =       0.000409396810
  error estimate for blocks of size 2^( 7) =       0.000411745696

      target function =      -0.942399719647
              le_mean =     -17.212352645648
             les_mean =     296.546396005980
             stat err =       0.000407453800
             autocorr =       1.239629493205
   target nu stat err =       0.000407453800
   target dn stat err =       0.002409320779
      target stat err =       0.004201284457
              std dev =       0.517552450082
             le_variance =       0.267860538585


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721235264565e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+28, overlap shift 6.1035e+29 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942417262529       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942417262529       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+29, overlap shift 2.4414e+30 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942417262529       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942417262529       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+29, overlap shift 9.7656e+30 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942417262529       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942417262529       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.254095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9533e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.0658
    reference variance = 1.09874
====================================================
  Execution time = 2.8352e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8266e-01
  Total weights = 1.9575e+06
  Execution time = 2.4788e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269605555630
                                         uncertainty =       0.001810711137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269605555630
                                         uncertainty =       0.001810711137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367128595
  error estimate for blocks of size 2^( 2) =       0.000380396666
  error estimate for blocks of size 2^( 3) =       0.000393018855
  error estimate for blocks of size 2^( 4) =       0.000402886950
  error estimate for blocks of size 2^( 5) =       0.000408638307
  error estimate for blocks of size 2^( 6) =       0.000412055842
  error estimate for blocks of size 2^( 7) =       0.000413033775

      target function =      -0.940073675001
              le_mean =     -17.212348984222
             les_mean =     296.547620765572
             stat err =       0.000409153719
             autocorr =       1.242042852074
   target nu stat err =       0.000409153719
   target dn stat err =       0.003183387859
      target stat err =       0.005487476187
              std dev =       0.519206545713
             le_variance =       0.269575437111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269605555630
                                         uncertainty =       0.001810711137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269605555630
                                         uncertainty =       0.001810711137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367128595
  error estimate for blocks of size 2^( 2) =       0.000380396666
  error estimate for blocks of size 2^( 3) =       0.000393018855
  error estimate for blocks of size 2^( 4) =       0.000402886950
  error estimate for blocks of size 2^( 5) =       0.000408638307
  error estimate for blocks of size 2^( 6) =       0.000412055842
  error estimate for blocks of size 2^( 7) =       0.000413033775

      target function =      -0.940073675001
              le_mean =     -17.212348984222
             les_mean =     296.547620765572
             stat err =       0.000409153719
             autocorr =       1.242042852074
   target nu stat err =       0.000409153719
   target dn stat err =       0.003183387859
      target stat err =       0.005487476187
              std dev =       0.519206545713
             le_variance =       0.269575437111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269605555630
                                         uncertainty =       0.001810711137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269605555630
                                         uncertainty =       0.001810711137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367128595
  error estimate for blocks of size 2^( 2) =       0.000380396666
  error estimate for blocks of size 2^( 3) =       0.000393018855
  error estimate for blocks of size 2^( 4) =       0.000402886950
  error estimate for blocks of size 2^( 5) =       0.000408638307
  error estimate for blocks of size 2^( 6) =       0.000412055842
  error estimate for blocks of size 2^( 7) =       0.000413033775

      target function =      -0.940073675001
              le_mean =     -17.212348984222
             les_mean =     296.547620765572
             stat err =       0.000409153719
             autocorr =       1.242042852074
   target nu stat err =       0.000409153719
   target dn stat err =       0.003183387859
      target stat err =       0.005487476187
              std dev =       0.519206545713
             le_variance =       0.269575437111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269605555630
                                         uncertainty =       0.001810711137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269605555630
                                         uncertainty =       0.001810711137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367128595
  error estimate for blocks of size 2^( 2) =       0.000380396666
  error estimate for blocks of size 2^( 3) =       0.000393018855
  error estimate for blocks of size 2^( 4) =       0.000402886950
  error estimate for blocks of size 2^( 5) =       0.000408638307
  error estimate for blocks of size 2^( 6) =       0.000412055842
  error estimate for blocks of size 2^( 7) =       0.000413033775

      target function =      -0.940073675001
              le_mean =     -17.212348984222
             les_mean =     296.547620765572
             stat err =       0.000409153719
             autocorr =       1.242042852074
   target nu stat err =       0.000409153719
   target dn stat err =       0.003183387859
      target stat err =       0.005487476187
              std dev =       0.519206545713
             le_variance =       0.269575437111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940073675001        initial  <--
     6.1035e+28     6.1035e+29             0.0000e+00        -0.940073675001
     2.4414e+29     2.4414e+30             0.0000e+00        -0.940073675001
     9.7656e+29     9.7656e+30             0.0000e+00        -0.940073675001

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8880
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0428e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2141
    reference variance = 0.183201
====================================================
  Execution time = 2.8571e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0393e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7987e-01
  Total weights = 1.957808426e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5647e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268337912661
                                         uncertainty =       0.001817688175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268337912661
                                         uncertainty =       0.001817688175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366264061
  error estimate for blocks of size 2^( 2) =       0.000380227141
  error estimate for blocks of size 2^( 3) =       0.000393039010
  error estimate for blocks of size 2^( 4) =       0.000402309776
  error estimate for blocks of size 2^( 5) =       0.000408037316
  error estimate for blocks of size 2^( 6) =       0.000412044910
  error estimate for blocks of size 2^( 7) =       0.000413924736

      target function =      -0.944886605880
              le_mean =     -17.212112797441
             les_mean =     296.536695921889
             stat err =       0.000409079184
             autocorr =       1.247458623505
   target nu stat err =       0.000409079184
   target dn stat err =       0.002819815531
      target stat err =       0.004920122102
              std dev =       0.517983890282
             le_variance =       0.268307310591


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721211279744e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+29, overlap shift 6.1035e+30 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944910861219       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944910861219       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944910861219       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+29 is 1.401984e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+30, overlap shift 2.4414e+31 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944910861219       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944910861219       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944910861552       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+30 is 3.504961e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+30, overlap shift 9.7656e+31 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944910861219       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944910861219       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944910861219       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+30 is 8.762402e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.255793 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7145e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.3095
    reference variance = 0.189642
====================================================
  Execution time = 2.8201e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7962e-01
  Total weights = 1.9574e+06
  Execution time = 2.4750e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267277438423
                                         uncertainty =       0.001366923231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267277438423
                                         uncertainty =       0.001366923231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365574565
  error estimate for blocks of size 2^( 2) =       0.000378991296
  error estimate for blocks of size 2^( 3) =       0.000391685824
  error estimate for blocks of size 2^( 4) =       0.000400547294
  error estimate for blocks of size 2^( 5) =       0.000406494602
  error estimate for blocks of size 2^( 6) =       0.000409018854
  error estimate for blocks of size 2^( 7) =       0.000409659958

      target function =      -0.945306444747
              le_mean =     -17.212596736195
             les_mean =     296.553108198914
             stat err =       0.000406430177
             autocorr =       1.236004210238
   target nu stat err =       0.000406430177
   target dn stat err =       0.001972546688
      target stat err =       0.003488093710
              std dev =       0.517008779331
             le_variance =       0.267298077905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267277438423
                                         uncertainty =       0.001366923231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267277438423
                                         uncertainty =       0.001366923231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365574565
  error estimate for blocks of size 2^( 2) =       0.000378991296
  error estimate for blocks of size 2^( 3) =       0.000391685824
  error estimate for blocks of size 2^( 4) =       0.000400547294
  error estimate for blocks of size 2^( 5) =       0.000406494602
  error estimate for blocks of size 2^( 6) =       0.000409018854
  error estimate for blocks of size 2^( 7) =       0.000409659958

      target function =      -0.945306444747
              le_mean =     -17.212596736195
             les_mean =     296.553108198914
             stat err =       0.000406430177
             autocorr =       1.236004210238
   target nu stat err =       0.000406430177
   target dn stat err =       0.001972546688
      target stat err =       0.003488093710
              std dev =       0.517008779331
             le_variance =       0.267298077905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267277438423
                                         uncertainty =       0.001366923231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267277438423
                                         uncertainty =       0.001366923231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365574565
  error estimate for blocks of size 2^( 2) =       0.000378991296
  error estimate for blocks of size 2^( 3) =       0.000391685824
  error estimate for blocks of size 2^( 4) =       0.000400547294
  error estimate for blocks of size 2^( 5) =       0.000406494602
  error estimate for blocks of size 2^( 6) =       0.000409018854
  error estimate for blocks of size 2^( 7) =       0.000409659958

      target function =      -0.945306444747
              le_mean =     -17.212596736195
             les_mean =     296.553108198914
             stat err =       0.000406430177
             autocorr =       1.236004210238
   target nu stat err =       0.000406430177
   target dn stat err =       0.001972546688
      target stat err =       0.003488093710
              std dev =       0.517008779331
             le_variance =       0.267298077905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267277438423
                                         uncertainty =       0.001366923231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267277438423
                                         uncertainty =       0.001366923231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365574565
  error estimate for blocks of size 2^( 2) =       0.000378991296
  error estimate for blocks of size 2^( 3) =       0.000391685824
  error estimate for blocks of size 2^( 4) =       0.000400547294
  error estimate for blocks of size 2^( 5) =       0.000406494602
  error estimate for blocks of size 2^( 6) =       0.000409018854
  error estimate for blocks of size 2^( 7) =       0.000409659958

      target function =      -0.945306444747
              le_mean =     -17.212596736195
             les_mean =     296.553108198914
             stat err =       0.000406430177
             autocorr =       1.236004210238
   target nu stat err =       0.000406430177
   target dn stat err =       0.001972546688
      target stat err =       0.003488093710
              std dev =       0.517008779331
             le_variance =       0.267298077905


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945306444747        initial  <--
     6.1035e+29     6.1035e+30             1.4020e-34        -0.945306444747
     2.4414e+30     2.4414e+31             3.5050e-35        -0.945306444747
     9.7656e+30     9.7656e+31             8.7624e-36        -0.945306444747

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7203
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7875e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2234
    reference variance = 0.187676
====================================================
  Execution time = 2.8307e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0364e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7741e-01
  Total weights = 1.957523008e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6664e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266601863363
                                         uncertainty =       0.001698713148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266601863363
                                         uncertainty =       0.001698713148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365093523
  error estimate for blocks of size 2^( 2) =       0.000378796769
  error estimate for blocks of size 2^( 3) =       0.000391769259
  error estimate for blocks of size 2^( 4) =       0.000401669158
  error estimate for blocks of size 2^( 5) =       0.000407910512
  error estimate for blocks of size 2^( 6) =       0.000412430896
  error estimate for blocks of size 2^( 7) =       0.000414264552

      target function =      -0.949136779116
              le_mean =     -17.212415929746
             les_mean =     296.544676530393
             stat err =       0.000409068779
             autocorr =       1.255406613897
   target nu stat err =       0.000409068779
   target dn stat err =       0.002302819138
      target stat err =       0.004079254110
              std dev =       0.516328473413
             le_variance =       0.266595092457


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721241592975e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+30, overlap shift 6.1035e+31 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949153512479       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949153512479       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+31, overlap shift 2.4414e+32 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949153512479       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949153512479       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+31, overlap shift 9.7656e+32 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949153512479       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949153512479       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.257134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6982e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1811
    reference variance = 0.25503
====================================================
  Execution time = 2.8059e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7708e-01
  Total weights = 1.9573e+06
  Execution time = 2.4842e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266298152053
                                         uncertainty =       0.001416246444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266298152053
                                         uncertainty =       0.001416246444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364905246
  error estimate for blocks of size 2^( 2) =       0.000378617515
  error estimate for blocks of size 2^( 3) =       0.000391384455
  error estimate for blocks of size 2^( 4) =       0.000400321650
  error estimate for blocks of size 2^( 5) =       0.000405952333
  error estimate for blocks of size 2^( 6) =       0.000408134589
  error estimate for blocks of size 2^( 7) =       0.000410551392

      target function =      -0.949744459125
              le_mean =     -17.211412697428
             les_mean =     296.509810834811
             stat err =       0.000406239991
             autocorr =       1.239381855815
   target nu stat err =       0.000406239991
   target dn stat err =       0.002210616350
      target stat err =       0.003917900493
              std dev =       0.516062204767
             le_variance =       0.266320199189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266298152053
                                         uncertainty =       0.001416246444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266298152053
                                         uncertainty =       0.001416246444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364905246
  error estimate for blocks of size 2^( 2) =       0.000378617515
  error estimate for blocks of size 2^( 3) =       0.000391384455
  error estimate for blocks of size 2^( 4) =       0.000400321650
  error estimate for blocks of size 2^( 5) =       0.000405952333
  error estimate for blocks of size 2^( 6) =       0.000408134589
  error estimate for blocks of size 2^( 7) =       0.000410551392

      target function =      -0.949744459125
              le_mean =     -17.211412697428
             les_mean =     296.509810834811
             stat err =       0.000406239991
             autocorr =       1.239381855815
   target nu stat err =       0.000406239991
   target dn stat err =       0.002210616350
      target stat err =       0.003917900493
              std dev =       0.516062204767
             le_variance =       0.266320199189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266298152053
                                         uncertainty =       0.001416246444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266298152053
                                         uncertainty =       0.001416246444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364905246
  error estimate for blocks of size 2^( 2) =       0.000378617515
  error estimate for blocks of size 2^( 3) =       0.000391384455
  error estimate for blocks of size 2^( 4) =       0.000400321650
  error estimate for blocks of size 2^( 5) =       0.000405952333
  error estimate for blocks of size 2^( 6) =       0.000408134589
  error estimate for blocks of size 2^( 7) =       0.000410551392

      target function =      -0.949744459125
              le_mean =     -17.211412697428
             les_mean =     296.509810834811
             stat err =       0.000406239991
             autocorr =       1.239381855815
   target nu stat err =       0.000406239991
   target dn stat err =       0.002210616350
      target stat err =       0.003917900493
              std dev =       0.516062204767
             le_variance =       0.266320199189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266298152053
                                         uncertainty =       0.001416246444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266298152053
                                         uncertainty =       0.001416246444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364905246
  error estimate for blocks of size 2^( 2) =       0.000378617515
  error estimate for blocks of size 2^( 3) =       0.000391384455
  error estimate for blocks of size 2^( 4) =       0.000400321650
  error estimate for blocks of size 2^( 5) =       0.000405952333
  error estimate for blocks of size 2^( 6) =       0.000408134589
  error estimate for blocks of size 2^( 7) =       0.000410551392

      target function =      -0.949744459125
              le_mean =     -17.211412697428
             les_mean =     296.509810834811
             stat err =       0.000406239991
             autocorr =       1.239381855815
   target nu stat err =       0.000406239991
   target dn stat err =       0.002210616350
      target stat err =       0.003917900493
              std dev =       0.516062204767
             le_variance =       0.266320199189


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949744459125        initial  <--
     6.1035e+30     6.1035e+31             0.0000e+00        -0.949744459125
     2.4414e+31     2.4414e+32             0.0000e+00        -0.949744459125
     9.7656e+31     9.7656e+32             0.0000e+00        -0.949744459125

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.6282
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7620e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2059
    reference variance = 0.262119
====================================================
  Execution time = 2.8472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0407e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8236e-01
  Total weights = 1.957383670e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5877e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269294846112
                                         uncertainty =       0.001708348020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269294846112
                                         uncertainty =       0.001708348020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366924922
  error estimate for blocks of size 2^( 2) =       0.000380651003
  error estimate for blocks of size 2^( 3) =       0.000392896001
  error estimate for blocks of size 2^( 4) =       0.000402603467
  error estimate for blocks of size 2^( 5) =       0.000408153123
  error estimate for blocks of size 2^( 6) =       0.000412236018
  error estimate for blocks of size 2^( 7) =       0.000411656633

      target function =      -0.940589966679
              le_mean =     -17.212432980379
             les_mean =     296.550211760860
             stat err =       0.000408662310
             autocorr =       1.240437112071
   target nu stat err =       0.000408662310
   target dn stat err =       0.002818133417
      target stat err =       0.004876051363
              std dev =       0.518918503072
             le_variance =       0.269276412830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721243298038e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+31, overlap shift 6.1035e+32 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940614191054       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940614191054       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+32, overlap shift 2.4414e+33 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940614191054       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940614191054       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+32, overlap shift 9.7656e+33 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940614191054       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940614191054       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.258430 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7068e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.1714
    reference variance = 0.497869
====================================================
  Execution time = 2.8069e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7539e-01
  Total weights = 1.9574e+06
  Execution time = 2.4837e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265526750956
                                         uncertainty =       0.001432706964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265526750956
                                         uncertainty =       0.001432706964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364390286
  error estimate for blocks of size 2^( 2) =       0.000377933101
  error estimate for blocks of size 2^( 3) =       0.000390459191
  error estimate for blocks of size 2^( 4) =       0.000399607015
  error estimate for blocks of size 2^( 5) =       0.000404941068
  error estimate for blocks of size 2^( 6) =       0.000408600908
  error estimate for blocks of size 2^( 7) =       0.000411181646

      target function =      -0.952691130278
              le_mean =     -17.212009994536
             les_mean =     296.528678431519
             stat err =       0.000406082659
             autocorr =       1.241924816446
   target nu stat err =       0.000406082659
   target dn stat err =       0.001826098944
      target stat err =       0.003286944317
              std dev =       0.515333930233
             le_variance =       0.265569059650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265526750956
                                         uncertainty =       0.001432706964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265526750956
                                         uncertainty =       0.001432706964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364390286
  error estimate for blocks of size 2^( 2) =       0.000377933101
  error estimate for blocks of size 2^( 3) =       0.000390459191
  error estimate for blocks of size 2^( 4) =       0.000399607015
  error estimate for blocks of size 2^( 5) =       0.000404941068
  error estimate for blocks of size 2^( 6) =       0.000408600908
  error estimate for blocks of size 2^( 7) =       0.000411181646

      target function =      -0.952691130278
              le_mean =     -17.212009994536
             les_mean =     296.528678431519
             stat err =       0.000406082659
             autocorr =       1.241924816450
   target nu stat err =       0.000406082659
   target dn stat err =       0.001826098944
      target stat err =       0.003286944317
              std dev =       0.515333930233
             le_variance =       0.265569059650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265526750956
                                         uncertainty =       0.001432706964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265526750956
                                         uncertainty =       0.001432706964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364390286
  error estimate for blocks of size 2^( 2) =       0.000377933101
  error estimate for blocks of size 2^( 3) =       0.000390459191
  error estimate for blocks of size 2^( 4) =       0.000399607015
  error estimate for blocks of size 2^( 5) =       0.000404941068
  error estimate for blocks of size 2^( 6) =       0.000408600908
  error estimate for blocks of size 2^( 7) =       0.000411181646

      target function =      -0.952691130278
              le_mean =     -17.212009994536
             les_mean =     296.528678431519
             stat err =       0.000406082659
             autocorr =       1.241924816450
   target nu stat err =       0.000406082659
   target dn stat err =       0.001826098944
      target stat err =       0.003286944317
              std dev =       0.515333930233
             le_variance =       0.265569059650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265526750956
                                         uncertainty =       0.001432706964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265526750956
                                         uncertainty =       0.001432706964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364390286
  error estimate for blocks of size 2^( 2) =       0.000377933101
  error estimate for blocks of size 2^( 3) =       0.000390459191
  error estimate for blocks of size 2^( 4) =       0.000399607015
  error estimate for blocks of size 2^( 5) =       0.000404941068
  error estimate for blocks of size 2^( 6) =       0.000408600908
  error estimate for blocks of size 2^( 7) =       0.000411181646

      target function =      -0.952691130278
              le_mean =     -17.212009994536
             les_mean =     296.528678431519
             stat err =       0.000406082659
             autocorr =       1.241924816450
   target nu stat err =       0.000406082659
   target dn stat err =       0.001826098944
      target stat err =       0.003286944317
              std dev =       0.515333930233
             le_variance =       0.265569059650


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.952691130278        initial  <--
     6.1035e+31     6.1035e+32             0.0000e+00        -0.952691130278
     2.4414e+32     2.4414e+33             0.0000e+00        -0.952691130278
     9.7656e+32     9.7656e+33             0.0000e+00        -0.952691130278

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.6383
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7716e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.198
    reference variance = 0.316392
====================================================
  Execution time = 3.0307e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0371e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7971e-01
  Total weights = 1.957438301e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7501e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269128351787
                                         uncertainty =       0.001603634829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269128351787
                                         uncertainty =       0.001603634829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366778909
  error estimate for blocks of size 2^( 2) =       0.000380539123
  error estimate for blocks of size 2^( 3) =       0.000393599804
  error estimate for blocks of size 2^( 4) =       0.000403101860
  error estimate for blocks of size 2^( 5) =       0.000408180907
  error estimate for blocks of size 2^( 6) =       0.000410888321
  error estimate for blocks of size 2^( 7) =       0.000411336269

      target function =      -0.945193241942
              le_mean =     -17.211578902819
             les_mean =     296.518158374202
             stat err =       0.000408376839
             autocorr =       1.239691145101
   target nu stat err =       0.000408376839
   target dn stat err =       0.002004947560
      target stat err =       0.003535771433
              std dev =       0.518712006414
             le_variance =       0.269062145598


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721157890282e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+32, overlap shift 6.1035e+33 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945205345441       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945205345441       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945205345441       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945205345441       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945205345440       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945312500000       residual = 1.36e+07           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+32 is 3.697620e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+33, overlap shift 2.4414e+34 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945205345441       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945205345441       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945205345441       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945205345441       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945205345440       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945312500000       residual = 1.36e+07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.000000000000       residual = 3.23e+16           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+33 is 9.244050e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+33, overlap shift 9.7656e+34 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945205345441       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945205345441       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945205345441       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945205345441       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945205345440       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945312500000       residual = 1.36e+07           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+33 is 2.311012e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.261501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9067e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2529
    reference variance = 0.326793
====================================================
  Execution time = 2.8860e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7969e-01
  Total weights = 1.9572e+06
  Execution time = 2.5211e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267211773206
                                         uncertainty =       0.001432234585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267211773206
                                         uncertainty =       0.001432234585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365526313
  error estimate for blocks of size 2^( 2) =       0.000379457325
  error estimate for blocks of size 2^( 3) =       0.000391959436
  error estimate for blocks of size 2^( 4) =       0.000401361786
  error estimate for blocks of size 2^( 5) =       0.000405983701
  error estimate for blocks of size 2^( 6) =       0.000410813376
  error estimate for blocks of size 2^( 7) =       0.000410965160

      target function =      -0.945198651960
              le_mean =     -17.212161224783
             les_mean =     296.538186744643
             stat err =       0.000407281006
             autocorr =       1.241512287425
   target nu stat err =       0.000407281006
   target dn stat err =       0.002166344944
      target stat err =       0.003812164697
              std dev =       0.516940539580
             le_variance =       0.267227521462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267211773206
                                         uncertainty =       0.001432234585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267211773206
                                         uncertainty =       0.001432234585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365526313
  error estimate for blocks of size 2^( 2) =       0.000379457325
  error estimate for blocks of size 2^( 3) =       0.000391959436
  error estimate for blocks of size 2^( 4) =       0.000401361786
  error estimate for blocks of size 2^( 5) =       0.000405983701
  error estimate for blocks of size 2^( 6) =       0.000410813376
  error estimate for blocks of size 2^( 7) =       0.000410965160

      target function =      -0.945198651960
              le_mean =     -17.212161224783
             les_mean =     296.538186744643
             stat err =       0.000407281006
             autocorr =       1.241512287420
   target nu stat err =       0.000407281006
   target dn stat err =       0.002166344944
      target stat err =       0.003812164697
              std dev =       0.516940539580
             le_variance =       0.267227521462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267211773206
                                         uncertainty =       0.001432234585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267211773206
                                         uncertainty =       0.001432234585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365526313
  error estimate for blocks of size 2^( 2) =       0.000379457325
  error estimate for blocks of size 2^( 3) =       0.000391959436
  error estimate for blocks of size 2^( 4) =       0.000401361786
  error estimate for blocks of size 2^( 5) =       0.000405983701
  error estimate for blocks of size 2^( 6) =       0.000410813376
  error estimate for blocks of size 2^( 7) =       0.000410965160

      target function =      -0.945198651960
              le_mean =     -17.212161224783
             les_mean =     296.538186744643
             stat err =       0.000407281006
             autocorr =       1.241512287420
   target nu stat err =       0.000407281006
   target dn stat err =       0.002166344944
      target stat err =       0.003812164697
              std dev =       0.516940539580
             le_variance =       0.267227521462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267211773206
                                         uncertainty =       0.001432234585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267211773206
                                         uncertainty =       0.001432234585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365526313
  error estimate for blocks of size 2^( 2) =       0.000379457325
  error estimate for blocks of size 2^( 3) =       0.000391959436
  error estimate for blocks of size 2^( 4) =       0.000401361786
  error estimate for blocks of size 2^( 5) =       0.000405983701
  error estimate for blocks of size 2^( 6) =       0.000410813376
  error estimate for blocks of size 2^( 7) =       0.000410965160

      target function =      -0.945198651960
              le_mean =     -17.212161224783
             les_mean =     296.538186744643
             stat err =       0.000407281006
             autocorr =       1.241512287420
   target nu stat err =       0.000407281006
   target dn stat err =       0.002166344944
      target stat err =       0.003812164697
              std dev =       0.516940539580
             le_variance =       0.267227521462


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945198651960        initial  <--
     6.1035e+32     6.1035e+33             3.6976e-37        -0.945198651960
     2.4414e+33     2.4414e+34             9.2440e-38        -0.945198651960
     9.7656e+33     9.7656e+34             2.3110e-38        -0.945198651960

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.5661
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0641e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2033
    reference variance = 0.227584
====================================================
  Execution time = 2.8340e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0432e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7546e-01
  Total weights = 1.957223017e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7814e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265353255273
                                         uncertainty =       0.001409189408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265353255273
                                         uncertainty =       0.001409189408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364316083
  error estimate for blocks of size 2^( 2) =       0.000378352742
  error estimate for blocks of size 2^( 3) =       0.000391291635
  error estimate for blocks of size 2^( 4) =       0.000400758183
  error estimate for blocks of size 2^( 5) =       0.000407122205
  error estimate for blocks of size 2^( 6) =       0.000410460096
  error estimate for blocks of size 2^( 7) =       0.000411021270

      target function =      -0.952575297359
              le_mean =     -17.211902109227
             les_mean =     296.525031717439
             stat err =       0.000407340438
             autocorr =       1.250139176576
   target nu stat err =       0.000407340438
   target dn stat err =       0.001868995533
      target stat err =       0.003359232771
              std dev =       0.515228988818
             le_variance =       0.265460910919


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721190210923e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+33, overlap shift 6.1035e+34 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952586206136       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952586206136       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+34, overlap shift 2.4414e+35 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952586206136       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952586206136       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+34, overlap shift 9.7656e+35 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952586206136       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952586206136       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.262820 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7130e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1962
    reference variance = 0.251537
====================================================
  Execution time = 2.8218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8291e-01
  Total weights = 1.9573e+06
  Execution time = 2.5165e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267845476274
                                         uncertainty =       0.001270741297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267845476274
                                         uncertainty =       0.001270741297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365912240
  error estimate for blocks of size 2^( 2) =       0.000379641616
  error estimate for blocks of size 2^( 3) =       0.000392605572
  error estimate for blocks of size 2^( 4) =       0.000401527713
  error estimate for blocks of size 2^( 5) =       0.000406584571
  error estimate for blocks of size 2^( 6) =       0.000409253590
  error estimate for blocks of size 2^( 7) =       0.000412320409

      target function =      -0.939643483726
              le_mean =     -17.211776084642
             les_mean =     296.528149777196
             stat err =       0.000407421571
             autocorr =       1.239750131498
   target nu stat err =       0.000407421571
   target dn stat err =       0.004473902167
      target stat err =       0.007661503677
              std dev =       0.517486332213
             le_variance =       0.267792104027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267845476274
                                         uncertainty =       0.001270741297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267845476274
                                         uncertainty =       0.001270741297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365912240
  error estimate for blocks of size 2^( 2) =       0.000379641616
  error estimate for blocks of size 2^( 3) =       0.000392605572
  error estimate for blocks of size 2^( 4) =       0.000401527713
  error estimate for blocks of size 2^( 5) =       0.000406584571
  error estimate for blocks of size 2^( 6) =       0.000409253590
  error estimate for blocks of size 2^( 7) =       0.000412320409

      target function =      -0.939643483726
              le_mean =     -17.211776084642
             les_mean =     296.528149777196
             stat err =       0.000407421571
             autocorr =       1.239750131498
   target nu stat err =       0.000407421571
   target dn stat err =       0.004473902167
      target stat err =       0.007661503677
              std dev =       0.517486332213
             le_variance =       0.267792104027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267845476274
                                         uncertainty =       0.001270741297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267845476274
                                         uncertainty =       0.001270741297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365912240
  error estimate for blocks of size 2^( 2) =       0.000379641616
  error estimate for blocks of size 2^( 3) =       0.000392605572
  error estimate for blocks of size 2^( 4) =       0.000401527713
  error estimate for blocks of size 2^( 5) =       0.000406584571
  error estimate for blocks of size 2^( 6) =       0.000409253590
  error estimate for blocks of size 2^( 7) =       0.000412320409

      target function =      -0.939643483726
              le_mean =     -17.211776084642
             les_mean =     296.528149777196
             stat err =       0.000407421571
             autocorr =       1.239750131498
   target nu stat err =       0.000407421571
   target dn stat err =       0.004473902167
      target stat err =       0.007661503677
              std dev =       0.517486332213
             le_variance =       0.267792104027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267845476274
                                         uncertainty =       0.001270741297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267845476274
                                         uncertainty =       0.001270741297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365912240
  error estimate for blocks of size 2^( 2) =       0.000379641616
  error estimate for blocks of size 2^( 3) =       0.000392605572
  error estimate for blocks of size 2^( 4) =       0.000401527713
  error estimate for blocks of size 2^( 5) =       0.000406584571
  error estimate for blocks of size 2^( 6) =       0.000409253590
  error estimate for blocks of size 2^( 7) =       0.000412320409

      target function =      -0.939643483726
              le_mean =     -17.211776084642
             les_mean =     296.528149777196
             stat err =       0.000407421571
             autocorr =       1.239750131498
   target nu stat err =       0.000407421571
   target dn stat err =       0.004473902167
      target stat err =       0.007661503677
              std dev =       0.517486332213
             le_variance =       0.267792104027


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939643483726        initial  <--
     6.1035e+33     6.1035e+34             0.0000e+00        -0.939643483726
     2.4414e+34     2.4414e+35             0.0000e+00        -0.939643483726
     9.7656e+34     9.7656e+35             0.0000e+00        -0.939643483726

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.9094
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8060e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1741
    reference variance = 0.132377
====================================================
  Execution time = 2.8403e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0408e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7872e-01
  Total weights = 1.957226123e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6328e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267679535806
                                         uncertainty =       0.001534555009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267679535806
                                         uncertainty =       0.001534555009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365792455
  error estimate for blocks of size 2^( 2) =       0.000379632287
  error estimate for blocks of size 2^( 3) =       0.000392673765
  error estimate for blocks of size 2^( 4) =       0.000402679030
  error estimate for blocks of size 2^( 5) =       0.000407649048
  error estimate for blocks of size 2^( 6) =       0.000409630922
  error estimate for blocks of size 2^( 7) =       0.000410317674

      target function =      -0.946878754941
              le_mean =     -17.211926432471
             les_mean =     296.529136109974
             stat err =       0.000407569169
             autocorr =       1.241461223601
   target nu stat err =       0.000407569169
   target dn stat err =       0.002311443754
      target stat err =       0.004070531208
              std dev =       0.517316928447
             le_variance =       0.267616804458


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721192643247e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+34, overlap shift 6.1035e+35 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946895288953       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946895288953       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+35, overlap shift 2.4414e+36 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946895288953       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946895288953       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+35, overlap shift 9.7656e+36 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946895288953       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946895288953       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.266163 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7048e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2108
    reference variance = 0.186362
====================================================
  Execution time = 2.8084e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7704e-01
  Total weights = 1.9575e+06
  Execution time = 2.5243e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266208990927
                                         uncertainty =       0.001461451811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266208990927
                                         uncertainty =       0.001461451811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364878887
  error estimate for blocks of size 2^( 2) =       0.000378571928
  error estimate for blocks of size 2^( 3) =       0.000391055213
  error estimate for blocks of size 2^( 4) =       0.000400561100
  error estimate for blocks of size 2^( 5) =       0.000407363998
  error estimate for blocks of size 2^( 6) =       0.000410687410
  error estimate for blocks of size 2^( 7) =       0.000413918587

      target function =      -0.949807559800
              le_mean =     -17.211624954845
             les_mean =     296.517077476535
             stat err =       0.000408132774
             autocorr =       1.251138743440
   target nu stat err =       0.000408132774
   target dn stat err =       0.002217952321
      target stat err =       0.003933216526
              std dev =       0.516024926677
             le_variance =       0.266281724952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266208990927
                                         uncertainty =       0.001461451811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266208990927
                                         uncertainty =       0.001461451811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364878887
  error estimate for blocks of size 2^( 2) =       0.000378571928
  error estimate for blocks of size 2^( 3) =       0.000391055213
  error estimate for blocks of size 2^( 4) =       0.000400561100
  error estimate for blocks of size 2^( 5) =       0.000407363998
  error estimate for blocks of size 2^( 6) =       0.000410687410
  error estimate for blocks of size 2^( 7) =       0.000413918587

      target function =      -0.949807559800
              le_mean =     -17.211624954845
             les_mean =     296.517077476535
             stat err =       0.000408132774
             autocorr =       1.251138743440
   target nu stat err =       0.000408132774
   target dn stat err =       0.002217952321
      target stat err =       0.003933216526
              std dev =       0.516024926677
             le_variance =       0.266281724952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266208990927
                                         uncertainty =       0.001461451811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266208990927
                                         uncertainty =       0.001461451811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364878887
  error estimate for blocks of size 2^( 2) =       0.000378571928
  error estimate for blocks of size 2^( 3) =       0.000391055213
  error estimate for blocks of size 2^( 4) =       0.000400561100
  error estimate for blocks of size 2^( 5) =       0.000407363998
  error estimate for blocks of size 2^( 6) =       0.000410687410
  error estimate for blocks of size 2^( 7) =       0.000413918587

      target function =      -0.949807559800
              le_mean =     -17.211624954845
             les_mean =     296.517077476535
             stat err =       0.000408132774
             autocorr =       1.251138743440
   target nu stat err =       0.000408132774
   target dn stat err =       0.002217952321
      target stat err =       0.003933216526
              std dev =       0.516024926677
             le_variance =       0.266281724952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266208990927
                                         uncertainty =       0.001461451811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266208990927
                                         uncertainty =       0.001461451811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364878887
  error estimate for blocks of size 2^( 2) =       0.000378571928
  error estimate for blocks of size 2^( 3) =       0.000391055213
  error estimate for blocks of size 2^( 4) =       0.000400561100
  error estimate for blocks of size 2^( 5) =       0.000407363998
  error estimate for blocks of size 2^( 6) =       0.000410687410
  error estimate for blocks of size 2^( 7) =       0.000413918587

      target function =      -0.949807559800
              le_mean =     -17.211624954845
             les_mean =     296.517077476535
             stat err =       0.000408132774
             autocorr =       1.251138743440
   target nu stat err =       0.000408132774
   target dn stat err =       0.002217952321
      target stat err =       0.003933216526
              std dev =       0.516024926677
             le_variance =       0.266281724952


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949807559800        initial  <--
     6.1035e+34     6.1035e+35             0.0000e+00        -0.949807559800
     2.4414e+35     2.4414e+36             0.0000e+00        -0.949807559800
     9.7656e+35     9.7656e+36             0.0000e+00        -0.949807559800

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7966
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7867e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2475
    reference variance = 0.222869
====================================================
  Execution time = 2.8183e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0377e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7740e-01
  Total weights = 1.957422301e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8790e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267805766455
                                         uncertainty =       0.001333887149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267805766455
                                         uncertainty =       0.001333887149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365907260
  error estimate for blocks of size 2^( 2) =       0.000379369485
  error estimate for blocks of size 2^( 3) =       0.000391925154
  error estimate for blocks of size 2^( 4) =       0.000400782051
  error estimate for blocks of size 2^( 5) =       0.000406828595
  error estimate for blocks of size 2^( 6) =       0.000411087775
  error estimate for blocks of size 2^( 7) =       0.000412035580

      target function =      -0.949160061207
              le_mean =     -17.212768739335
             les_mean =     296.556806188168
             stat err =       0.000407683500
             autocorr =       1.241378494000
   target nu stat err =       0.000407683500
   target dn stat err =       0.001741008077
      target stat err =       0.003124567139
              std dev =       0.517479289003
             le_variance =       0.267784814547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721276873934e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+35, overlap shift 6.1035e+36 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949169413848       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949169413848       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+36, overlap shift 2.4414e+37 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949169413848       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949169413848       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+36, overlap shift 9.7656e+37 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949169413848       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949169413848       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.269582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7075e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2221
    reference variance = 0.214569
====================================================
  Execution time = 2.8598e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8151e-01
  Total weights = 1.9575e+06
  Execution time = 2.5126e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267779685331
                                         uncertainty =       0.001593832619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267779685331
                                         uncertainty =       0.001593832619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365885409
  error estimate for blocks of size 2^( 2) =       0.000379244849
  error estimate for blocks of size 2^( 3) =       0.000392050443
  error estimate for blocks of size 2^( 4) =       0.000400961959
  error estimate for blocks of size 2^( 5) =       0.000407080711
  error estimate for blocks of size 2^( 6) =       0.000409572616
  error estimate for blocks of size 2^( 7) =       0.000409606093

      target function =      -0.942074407617
              le_mean =     -17.211877810504
             les_mean =     296.530250826374
             stat err =       0.000406805344
             autocorr =       1.236184002589
   target nu stat err =       0.000406805344
   target dn stat err =       0.002553787532
      target stat err =       0.004438271777
              std dev =       0.517448386157
             le_variance =       0.267752832337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267779685331
                                         uncertainty =       0.001593832619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267779685331
                                         uncertainty =       0.001593832619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365885409
  error estimate for blocks of size 2^( 2) =       0.000379244849
  error estimate for blocks of size 2^( 3) =       0.000392050443
  error estimate for blocks of size 2^( 4) =       0.000400961959
  error estimate for blocks of size 2^( 5) =       0.000407080711
  error estimate for blocks of size 2^( 6) =       0.000409572616
  error estimate for blocks of size 2^( 7) =       0.000409606093

      target function =      -0.942074407617
              le_mean =     -17.211877810504
             les_mean =     296.530250826374
             stat err =       0.000406805344
             autocorr =       1.236184002589
   target nu stat err =       0.000406805344
   target dn stat err =       0.002553787532
      target stat err =       0.004438271777
              std dev =       0.517448386157
             le_variance =       0.267752832337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267779685331
                                         uncertainty =       0.001593832619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267779685331
                                         uncertainty =       0.001593832619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365885409
  error estimate for blocks of size 2^( 2) =       0.000379244849
  error estimate for blocks of size 2^( 3) =       0.000392050443
  error estimate for blocks of size 2^( 4) =       0.000400961959
  error estimate for blocks of size 2^( 5) =       0.000407080711
  error estimate for blocks of size 2^( 6) =       0.000409572616
  error estimate for blocks of size 2^( 7) =       0.000409606093

      target function =      -0.942074407617
              le_mean =     -17.211877810504
             les_mean =     296.530250826374
             stat err =       0.000406805344
             autocorr =       1.236184002589
   target nu stat err =       0.000406805344
   target dn stat err =       0.002553787532
      target stat err =       0.004438271777
              std dev =       0.517448386157
             le_variance =       0.267752832337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267779685331
                                         uncertainty =       0.001593832619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267779685331
                                         uncertainty =       0.001593832619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365885409
  error estimate for blocks of size 2^( 2) =       0.000379244849
  error estimate for blocks of size 2^( 3) =       0.000392050443
  error estimate for blocks of size 2^( 4) =       0.000400961959
  error estimate for blocks of size 2^( 5) =       0.000407080711
  error estimate for blocks of size 2^( 6) =       0.000409572616
  error estimate for blocks of size 2^( 7) =       0.000409606093

      target function =      -0.942074407617
              le_mean =     -17.211877810504
             les_mean =     296.530250826374
             stat err =       0.000406805344
             autocorr =       1.236184002589
   target nu stat err =       0.000406805344
   target dn stat err =       0.002553787532
      target stat err =       0.004438271777
              std dev =       0.517448386157
             le_variance =       0.267752832337


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942074407617        initial  <--
     6.1035e+35     6.1035e+36             0.0000e+00        -0.942074407617
     2.4414e+36     2.4414e+37             0.0000e+00        -0.942074407617
     9.7656e+36     9.7656e+37             0.0000e+00        -0.942074407617

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6141
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1708e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1983
    reference variance = 0.189433
====================================================
  Execution time = 2.8269e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0381e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8102e-01
  Total weights = 1.956964954e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7227e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269355191540
                                         uncertainty =       0.001706932239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269355191540
                                         uncertainty =       0.001706932239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366933281
  error estimate for blocks of size 2^( 2) =       0.000380695722
  error estimate for blocks of size 2^( 3) =       0.000393412058
  error estimate for blocks of size 2^( 4) =       0.000402739286
  error estimate for blocks of size 2^( 5) =       0.000408763364
  error estimate for blocks of size 2^( 6) =       0.000412662838
  error estimate for blocks of size 2^( 7) =       0.000413548989

      target function =      -0.942930470094
              le_mean =     -17.211695517330
             les_mean =     296.523479680168
             stat err =       0.000409428619
             autocorr =       1.245036792606
   target nu stat err =       0.000409428619
   target dn stat err =       0.002691192464
      target stat err =       0.004678105925
              std dev =       0.518930324669
             le_variance =       0.269288681861


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721169551733e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+36, overlap shift 6.1035e+37 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942952548094       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942952548094       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+37, overlap shift 2.4414e+38 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942952548094       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942952548094       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+37, overlap shift 9.7656e+38 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942952548094       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942952548094       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.272888 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7004e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1341
    reference variance = 0.18971
====================================================
  Execution time = 2.8141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7745e-01
  Total weights = 1.9576e+06
  Execution time = 2.5209e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265436505456
                                         uncertainty =       0.001339085210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265436505456
                                         uncertainty =       0.001339085210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364291181
  error estimate for blocks of size 2^( 2) =       0.000377901908
  error estimate for blocks of size 2^( 3) =       0.000390116722
  error estimate for blocks of size 2^( 4) =       0.000399188022
  error estimate for blocks of size 2^( 5) =       0.000405295024
  error estimate for blocks of size 2^( 6) =       0.000408915458
  error estimate for blocks of size 2^( 7) =       0.000410294589

      target function =      -0.949099771539
              le_mean =     -17.211750138216
             les_mean =     296.521791086660
             stat err =       0.000405923274
             autocorr =       1.241625405227
   target nu stat err =       0.000405923274
   target dn stat err =       0.002262596893
      target stat err =       0.004003896612
              std dev =       0.515193771072
             le_variance =       0.265424621751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265436505456
                                         uncertainty =       0.001339085210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265436505456
                                         uncertainty =       0.001339085210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364291181
  error estimate for blocks of size 2^( 2) =       0.000377901908
  error estimate for blocks of size 2^( 3) =       0.000390116722
  error estimate for blocks of size 2^( 4) =       0.000399188022
  error estimate for blocks of size 2^( 5) =       0.000405295024
  error estimate for blocks of size 2^( 6) =       0.000408915458
  error estimate for blocks of size 2^( 7) =       0.000410294589

      target function =      -0.949099771539
              le_mean =     -17.211750138216
             les_mean =     296.521791086660
             stat err =       0.000405923274
             autocorr =       1.241625405227
   target nu stat err =       0.000405923274
   target dn stat err =       0.002262596893
      target stat err =       0.004003896612
              std dev =       0.515193771072
             le_variance =       0.265424621751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265436505456
                                         uncertainty =       0.001339085210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265436505456
                                         uncertainty =       0.001339085210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364291181
  error estimate for blocks of size 2^( 2) =       0.000377901908
  error estimate for blocks of size 2^( 3) =       0.000390116722
  error estimate for blocks of size 2^( 4) =       0.000399188022
  error estimate for blocks of size 2^( 5) =       0.000405295024
  error estimate for blocks of size 2^( 6) =       0.000408915458
  error estimate for blocks of size 2^( 7) =       0.000410294589

      target function =      -0.949099771539
              le_mean =     -17.211750138216
             les_mean =     296.521791086660
             stat err =       0.000405923274
             autocorr =       1.241625405227
   target nu stat err =       0.000405923274
   target dn stat err =       0.002262596893
      target stat err =       0.004003896612
              std dev =       0.515193771072
             le_variance =       0.265424621751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265436505456
                                         uncertainty =       0.001339085210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265436505456
                                         uncertainty =       0.001339085210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364291181
  error estimate for blocks of size 2^( 2) =       0.000377901908
  error estimate for blocks of size 2^( 3) =       0.000390116722
  error estimate for blocks of size 2^( 4) =       0.000399188022
  error estimate for blocks of size 2^( 5) =       0.000405295024
  error estimate for blocks of size 2^( 6) =       0.000408915458
  error estimate for blocks of size 2^( 7) =       0.000410294589

      target function =      -0.949099771539
              le_mean =     -17.211750138216
             les_mean =     296.521791086660
             stat err =       0.000405923274
             autocorr =       1.241625405227
   target nu stat err =       0.000405923274
   target dn stat err =       0.002262596893
      target stat err =       0.004003896612
              std dev =       0.515193771072
             le_variance =       0.265424621751


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949099771539        initial  <--
     6.1035e+36     6.1035e+37             0.0000e+00        -0.949099771539
     2.4414e+37     2.4414e+38             0.0000e+00        -0.949099771539
     9.7656e+37     9.7656e+38             0.0000e+00        -0.949099771539

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8437
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7868e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.1718
    reference variance = 0.202037
====================================================
  Execution time = 2.8423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0404e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7930e-01
  Total weights = 1.957416635e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6751e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268436471113
                                         uncertainty =       0.001477411114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268436471113
                                         uncertainty =       0.001477411114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366346389
  error estimate for blocks of size 2^( 2) =       0.000380326550
  error estimate for blocks of size 2^( 3) =       0.000392254046
  error estimate for blocks of size 2^( 4) =       0.000400993953
  error estimate for blocks of size 2^( 5) =       0.000407197204
  error estimate for blocks of size 2^( 6) =       0.000410348198
  error estimate for blocks of size 2^( 7) =       0.000411658047

      target function =      -0.945861656367
              le_mean =     -17.212646914822
             les_mean =     296.554513350968
             stat err =       0.000407549350
             autocorr =       1.237589397202
   target nu stat err =       0.000407549350
   target dn stat err =       0.001960666397
      target stat err =       0.003472797969
              std dev =       0.518100321302
             le_variance =       0.268427942933


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721264691482e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+37, overlap shift 6.1035e+38 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945873324584       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945873324584       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+38, overlap shift 2.4414e+39 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945873324584       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945873324584       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+38, overlap shift 9.7656e+39 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945873324584       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945873324584       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.276271 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7110e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2616
    reference variance = 0.161931
====================================================
  Execution time = 2.8311e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7791e-01
  Total weights = 1.9574e+06
  Execution time = 2.5233e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267783275399
                                         uncertainty =       0.001661940007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267783275399
                                         uncertainty =       0.001661940007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365933355
  error estimate for blocks of size 2^( 2) =       0.000379426844
  error estimate for blocks of size 2^( 3) =       0.000392491983
  error estimate for blocks of size 2^( 4) =       0.000401074877
  error estimate for blocks of size 2^( 5) =       0.000407117341
  error estimate for blocks of size 2^( 6) =       0.000408832775
  error estimate for blocks of size 2^( 7) =       0.000412734238

      target function =      -0.948290680649
              le_mean =     -17.212202275522
             les_mean =     296.537815093493
             stat err =       0.000407439808
             autocorr =       1.239718043607
   target nu stat err =       0.000407439808
   target dn stat err =       0.001948757507
      target stat err =       0.003466996724
              std dev =       0.517516193785
             le_variance =       0.267823010829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267783275399
                                         uncertainty =       0.001661940007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267783275399
                                         uncertainty =       0.001661940007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365933355
  error estimate for blocks of size 2^( 2) =       0.000379426844
  error estimate for blocks of size 2^( 3) =       0.000392491983
  error estimate for blocks of size 2^( 4) =       0.000401074877
  error estimate for blocks of size 2^( 5) =       0.000407117341
  error estimate for blocks of size 2^( 6) =       0.000408832775
  error estimate for blocks of size 2^( 7) =       0.000412734238

      target function =      -0.948290680649
              le_mean =     -17.212202275522
             les_mean =     296.537815093493
             stat err =       0.000407439808
             autocorr =       1.239718043607
   target nu stat err =       0.000407439808
   target dn stat err =       0.001948757507
      target stat err =       0.003466996724
              std dev =       0.517516193785
             le_variance =       0.267823010829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267783275399
                                         uncertainty =       0.001661940007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267783275399
                                         uncertainty =       0.001661940007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365933355
  error estimate for blocks of size 2^( 2) =       0.000379426844
  error estimate for blocks of size 2^( 3) =       0.000392491983
  error estimate for blocks of size 2^( 4) =       0.000401074877
  error estimate for blocks of size 2^( 5) =       0.000407117341
  error estimate for blocks of size 2^( 6) =       0.000408832775
  error estimate for blocks of size 2^( 7) =       0.000412734238

      target function =      -0.948290680649
              le_mean =     -17.212202275522
             les_mean =     296.537815093493
             stat err =       0.000407439808
             autocorr =       1.239718043607
   target nu stat err =       0.000407439808
   target dn stat err =       0.001948757507
      target stat err =       0.003466996724
              std dev =       0.517516193785
             le_variance =       0.267823010829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267783275399
                                         uncertainty =       0.001661940007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267783275399
                                         uncertainty =       0.001661940007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365933355
  error estimate for blocks of size 2^( 2) =       0.000379426844
  error estimate for blocks of size 2^( 3) =       0.000392491983
  error estimate for blocks of size 2^( 4) =       0.000401074877
  error estimate for blocks of size 2^( 5) =       0.000407117341
  error estimate for blocks of size 2^( 6) =       0.000408832775
  error estimate for blocks of size 2^( 7) =       0.000412734238

      target function =      -0.948290680649
              le_mean =     -17.212202275522
             les_mean =     296.537815093493
             stat err =       0.000407439808
             autocorr =       1.239718043607
   target nu stat err =       0.000407439808
   target dn stat err =       0.001948757507
      target stat err =       0.003466996724
              std dev =       0.517516193785
             le_variance =       0.267823010829


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948290680649        initial  <--
     6.1035e+37     6.1035e+38             0.0000e+00        -0.948290680649
     2.4414e+38     2.4414e+39             0.0000e+00        -0.948290680649
     9.7656e+38     9.7656e+39             0.0000e+00        -0.948290680649

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0272
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8157e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.1989
    reference variance = 0.249302
====================================================
  Execution time = 2.8228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0408e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8134e-01
  Total weights = 1.957369785e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7961e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268792636303
                                         uncertainty =       0.001631402030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268792636303
                                         uncertainty =       0.001631402030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366605062
  error estimate for blocks of size 2^( 2) =       0.000380626298
  error estimate for blocks of size 2^( 3) =       0.000393033891
  error estimate for blocks of size 2^( 4) =       0.000402274090
  error estimate for blocks of size 2^( 5) =       0.000408904891
  error estimate for blocks of size 2^( 6) =       0.000412093441
  error estimate for blocks of size 2^( 7) =       0.000413422064

      target function =      -0.942344467628
              le_mean =     -17.212659650144
             les_mean =     296.556987927827
             stat err =       0.000409173621
             autocorr =       1.245713988324
   target nu stat err =       0.000409173621
   target dn stat err =       0.002484058082
      target stat err =       0.004330215214
              std dev =       0.518466145971
             le_variance =       0.268807144518


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721265965014e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+38, overlap shift 6.1035e+39 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942363300863       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942363300863       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+39, overlap shift 2.4414e+40 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942363300863       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942363300863       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+39, overlap shift 9.7656e+40 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942363300863       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942363300863       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.279673 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7037e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.0987
    reference variance = 0.476537
====================================================
  Execution time = 2.8282e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7725e-01
  Total weights = 1.9575e+06
  Execution time = 2.5231e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265992277326
                                         uncertainty =       0.001748615037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265992277326
                                         uncertainty =       0.001748615037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364651090
  error estimate for blocks of size 2^( 2) =       0.000378502131
  error estimate for blocks of size 2^( 3) =       0.000391541933
  error estimate for blocks of size 2^( 4) =       0.000400862559
  error estimate for blocks of size 2^( 5) =       0.000406076050
  error estimate for blocks of size 2^( 6) =       0.000408923230
  error estimate for blocks of size 2^( 7) =       0.000410767876

      target function =      -0.949449291615
              le_mean =     -17.211638446952
             les_mean =     296.517746728193
             stat err =       0.000406657429
             autocorr =       1.243662069090
   target nu stat err =       0.000406657429
   target dn stat err =       0.002323185095
      target stat err =       0.004109799263
              std dev =       0.515702768022
             le_variance =       0.265949344946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265992277326
                                         uncertainty =       0.001748615037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265992277326
                                         uncertainty =       0.001748615037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364651090
  error estimate for blocks of size 2^( 2) =       0.000378502131
  error estimate for blocks of size 2^( 3) =       0.000391541933
  error estimate for blocks of size 2^( 4) =       0.000400862559
  error estimate for blocks of size 2^( 5) =       0.000406076050
  error estimate for blocks of size 2^( 6) =       0.000408923230
  error estimate for blocks of size 2^( 7) =       0.000410767876

      target function =      -0.949449291615
              le_mean =     -17.211638446952
             les_mean =     296.517746728193
             stat err =       0.000406657429
             autocorr =       1.243662069090
   target nu stat err =       0.000406657429
   target dn stat err =       0.002323185095
      target stat err =       0.004109799263
              std dev =       0.515702768022
             le_variance =       0.265949344946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265992277326
                                         uncertainty =       0.001748615037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265992277326
                                         uncertainty =       0.001748615037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364651090
  error estimate for blocks of size 2^( 2) =       0.000378502131
  error estimate for blocks of size 2^( 3) =       0.000391541933
  error estimate for blocks of size 2^( 4) =       0.000400862559
  error estimate for blocks of size 2^( 5) =       0.000406076050
  error estimate for blocks of size 2^( 6) =       0.000408923230
  error estimate for blocks of size 2^( 7) =       0.000410767876

      target function =      -0.949449291615
              le_mean =     -17.211638446952
             les_mean =     296.517746728193
             stat err =       0.000406657429
             autocorr =       1.243662069090
   target nu stat err =       0.000406657429
   target dn stat err =       0.002323185095
      target stat err =       0.004109799263
              std dev =       0.515702768022
             le_variance =       0.265949344946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265992277326
                                         uncertainty =       0.001748615037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265992277326
                                         uncertainty =       0.001748615037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364651090
  error estimate for blocks of size 2^( 2) =       0.000378502131
  error estimate for blocks of size 2^( 3) =       0.000391541933
  error estimate for blocks of size 2^( 4) =       0.000400862559
  error estimate for blocks of size 2^( 5) =       0.000406076050
  error estimate for blocks of size 2^( 6) =       0.000408923230
  error estimate for blocks of size 2^( 7) =       0.000410767876

      target function =      -0.949449291615
              le_mean =     -17.211638446952
             les_mean =     296.517746728193
             stat err =       0.000406657429
             autocorr =       1.243662069090
   target nu stat err =       0.000406657429
   target dn stat err =       0.002323185095
      target stat err =       0.004109799263
              std dev =       0.515702768022
             le_variance =       0.265949344946


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949449291615        initial  <--
     6.1035e+38     6.1035e+39             0.0000e+00        -0.949449291615
     2.4414e+39     2.4414e+40             0.0000e+00        -0.949449291615
     9.7656e+39     9.7656e+40             0.0000e+00        -0.949449291615

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.9950
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8049e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.1813
    reference variance = 0.413703
====================================================
  Execution time = 2.8214e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0400e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7905e-01
  Total weights = 1.957503934e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7028e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268109605710
                                         uncertainty =       0.001452275213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268109605710
                                         uncertainty =       0.001452275213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366171120
  error estimate for blocks of size 2^( 2) =       0.000380071044
  error estimate for blocks of size 2^( 3) =       0.000392584857
  error estimate for blocks of size 2^( 4) =       0.000401254845
  error estimate for blocks of size 2^( 5) =       0.000406489844
  error estimate for blocks of size 2^( 6) =       0.000408760470
  error estimate for blocks of size 2^( 7) =       0.000410814912

      target function =      -0.946318188803
              le_mean =     -17.212164080105
             les_mean =     296.537638536873
             stat err =       0.000406830018
             autocorr =       1.234405372167
   target nu stat err =       0.000406830018
   target dn stat err =       0.001963806647
      target stat err =       0.003477857274
              std dev =       0.517852448966
             le_variance =       0.268171158900


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721216408010e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+39, overlap shift 6.1035e+40 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946330082089       residual = 6.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946330082089       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946330082089       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946330082089       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946330082089       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946330082045       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920625889492       residual = 5.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+39 is 2.337663e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+40, overlap shift 2.4414e+41 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946330082089       residual = 6.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946330082089       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946330082089       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946330082089       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945312500000       residual = 9.45e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946330080179       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 3.98e+23           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+40 is 6.384978e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+40, overlap shift 9.7656e+41 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946330082089       residual = 6.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946330082089       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946330082089       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946330082089       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946330082089       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946330082045       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920625889492       residual = 5.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+40 is 1.461040e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.285947 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6933e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.222
    reference variance = 0.150657
====================================================
  Execution time = 3.0192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8194e-01
  Total weights = 1.9571e+06
  Execution time = 2.5061e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268796130341
                                         uncertainty =       0.001523496574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268796130341
                                         uncertainty =       0.001523496574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366563957
  error estimate for blocks of size 2^( 2) =       0.000379957243
  error estimate for blocks of size 2^( 3) =       0.000392842738
  error estimate for blocks of size 2^( 4) =       0.000401584880
  error estimate for blocks of size 2^( 5) =       0.000408001601
  error estimate for blocks of size 2^( 6) =       0.000410555524
  error estimate for blocks of size 2^( 7) =       0.000413066891

      target function =      -0.941326067579
              le_mean =     -17.212008406210
             les_mean =     296.535176694058
             stat err =       0.000408302224
             autocorr =       1.240691970546
   target nu stat err =       0.000408302224
   target dn stat err =       0.002890533514
      target stat err =       0.005001992998
              std dev =       0.518408013190
             le_variance =       0.268746868140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268796130341
                                         uncertainty =       0.001523496574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268796130341
                                         uncertainty =       0.001523496574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366563957
  error estimate for blocks of size 2^( 2) =       0.000379957243
  error estimate for blocks of size 2^( 3) =       0.000392842738
  error estimate for blocks of size 2^( 4) =       0.000401584880
  error estimate for blocks of size 2^( 5) =       0.000408001601
  error estimate for blocks of size 2^( 6) =       0.000410555524
  error estimate for blocks of size 2^( 7) =       0.000413066891

      target function =      -0.941326067579
              le_mean =     -17.212008406210
             les_mean =     296.535176694058
             stat err =       0.000408302224
             autocorr =       1.240691970546
   target nu stat err =       0.000408302224
   target dn stat err =       0.002890533514
      target stat err =       0.005001992998
              std dev =       0.518408013190
             le_variance =       0.268746868140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268796130341
                                         uncertainty =       0.001523496574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268796130341
                                         uncertainty =       0.001523496574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366563957
  error estimate for blocks of size 2^( 2) =       0.000379957243
  error estimate for blocks of size 2^( 3) =       0.000392842738
  error estimate for blocks of size 2^( 4) =       0.000401584880
  error estimate for blocks of size 2^( 5) =       0.000408001601
  error estimate for blocks of size 2^( 6) =       0.000410555524
  error estimate for blocks of size 2^( 7) =       0.000413066891

      target function =      -0.941326067579
              le_mean =     -17.212008406210
             les_mean =     296.535176694058
             stat err =       0.000408302224
             autocorr =       1.240691970546
   target nu stat err =       0.000408302224
   target dn stat err =       0.002890533514
      target stat err =       0.005001992998
              std dev =       0.518408013190
             le_variance =       0.268746868140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268796130341
                                         uncertainty =       0.001523496574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268796130341
                                         uncertainty =       0.001523496574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366563957
  error estimate for blocks of size 2^( 2) =       0.000379957243
  error estimate for blocks of size 2^( 3) =       0.000392842738
  error estimate for blocks of size 2^( 4) =       0.000401584880
  error estimate for blocks of size 2^( 5) =       0.000408001601
  error estimate for blocks of size 2^( 6) =       0.000410555524
  error estimate for blocks of size 2^( 7) =       0.000413066891

      target function =      -0.941326067579
              le_mean =     -17.212008406210
             les_mean =     296.535176694058
             stat err =       0.000408302224
             autocorr =       1.240691970546
   target nu stat err =       0.000408302224
   target dn stat err =       0.002890533514
      target stat err =       0.005001992998
              std dev =       0.518408013190
             le_variance =       0.268746868140


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941326067579        initial  <--
     6.1035e+39     6.1035e+40             2.3377e-44        -0.941326067579
     2.4414e+40     2.4414e+41             6.3850e-45        -0.941326067579
     9.7656e+40     9.7656e+41             1.4610e-45        -0.941326067579

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8999
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9854e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2722
    reference variance = 0.261856
====================================================
  Execution time = 2.8114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0407e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7963e-01
  Total weights = 1.957473794e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9028e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267462008670
                                         uncertainty =       0.001872134941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267462008670
                                         uncertainty =       0.001872134941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365651287
  error estimate for blocks of size 2^( 2) =       0.000379271139
  error estimate for blocks of size 2^( 3) =       0.000391901128
  error estimate for blocks of size 2^( 4) =       0.000400675621
  error estimate for blocks of size 2^( 5) =       0.000406867206
  error estimate for blocks of size 2^( 6) =       0.000410375209
  error estimate for blocks of size 2^( 7) =       0.000410523244

      target function =      -0.945309039483
              le_mean =     -17.212093675892
             les_mean =     296.535797110543
             stat err =       0.000407110320
             autocorr =       1.239624100536
   target nu stat err =       0.000407110320
   target dn stat err =       0.002389525863
      target stat err =       0.004191004044
              std dev =       0.517117282488
             le_variance =       0.267410283848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721209367589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+40, overlap shift 6.1035e+41 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945326683211       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945326683211       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945326683211       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945326683211       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945326683211       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945326519362       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.890950132860       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+40 is 2.639479e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+41, overlap shift 2.4414e+42 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945326683211       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945326683211       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945326683211       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945326683211       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945326683211       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 5.70e+06           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+41 is 7.041626e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+41, overlap shift 9.7656e+42 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945326683211       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945326683211       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945326683211       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945326683211       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.000000000000       residual = 2.19e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 3.07e+06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 6.51e+10           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =       0.000000000000       residual = 1.55e+24           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+41 is 1.798229e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.292211 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7032e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2295
    reference variance = 0.167467
====================================================
  Execution time = 2.7964e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7929e-01
  Total weights = 1.9572e+06
  Execution time = 2.5106e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266877538619
                                         uncertainty =       0.001492789323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266877538619
                                         uncertainty =       0.001492789323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365239215
  error estimate for blocks of size 2^( 2) =       0.000379078846
  error estimate for blocks of size 2^( 3) =       0.000391321359
  error estimate for blocks of size 2^( 4) =       0.000400783277
  error estimate for blocks of size 2^( 5) =       0.000405878838
  error estimate for blocks of size 2^( 6) =       0.000409169409
  error estimate for blocks of size 2^( 7) =       0.000409860288

      target function =      -0.945889458062
              le_mean =     -17.212188684019
             les_mean =     296.538728214670
             stat err =       0.000406422953
             autocorr =       1.238230942854
   target nu stat err =       0.000406422953
   target dn stat err =       0.002544804058
      target stat err =       0.004461049630
              std dev =       0.516534515771
             le_variance =       0.266807905983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266877538619
                                         uncertainty =       0.001492789323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266877538619
                                         uncertainty =       0.001492789323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365239215
  error estimate for blocks of size 2^( 2) =       0.000379078846
  error estimate for blocks of size 2^( 3) =       0.000391321359
  error estimate for blocks of size 2^( 4) =       0.000400783277
  error estimate for blocks of size 2^( 5) =       0.000405878838
  error estimate for blocks of size 2^( 6) =       0.000409169409
  error estimate for blocks of size 2^( 7) =       0.000409860288

      target function =      -0.945889458062
              le_mean =     -17.212188684019
             les_mean =     296.538728214670
             stat err =       0.000406422953
             autocorr =       1.238230942854
   target nu stat err =       0.000406422953
   target dn stat err =       0.002544804058
      target stat err =       0.004461049630
              std dev =       0.516534515771
             le_variance =       0.266807905983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266877538619
                                         uncertainty =       0.001492789323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266877538619
                                         uncertainty =       0.001492789323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365239215
  error estimate for blocks of size 2^( 2) =       0.000379078846
  error estimate for blocks of size 2^( 3) =       0.000391321359
  error estimate for blocks of size 2^( 4) =       0.000400783277
  error estimate for blocks of size 2^( 5) =       0.000405878838
  error estimate for blocks of size 2^( 6) =       0.000409169409
  error estimate for blocks of size 2^( 7) =       0.000409860288

      target function =      -0.945889458062
              le_mean =     -17.212188684019
             les_mean =     296.538728214670
             stat err =       0.000406422953
             autocorr =       1.238230942854
   target nu stat err =       0.000406422953
   target dn stat err =       0.002544804058
      target stat err =       0.004461049630
              std dev =       0.516534515771
             le_variance =       0.266807905983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266877538619
                                         uncertainty =       0.001492789323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266877538619
                                         uncertainty =       0.001492789323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365239215
  error estimate for blocks of size 2^( 2) =       0.000379078846
  error estimate for blocks of size 2^( 3) =       0.000391321359
  error estimate for blocks of size 2^( 4) =       0.000400783277
  error estimate for blocks of size 2^( 5) =       0.000405878838
  error estimate for blocks of size 2^( 6) =       0.000409169409
  error estimate for blocks of size 2^( 7) =       0.000409860288

      target function =      -0.945889458062
              le_mean =     -17.212188684019
             les_mean =     296.538728214670
             stat err =       0.000406422953
             autocorr =       1.238230942854
   target nu stat err =       0.000406422953
   target dn stat err =       0.002544804058
      target stat err =       0.004461049630
              std dev =       0.516534515771
             le_variance =       0.266807905983


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945889458062        initial  <--
     6.1035e+40     6.1035e+41             2.6395e-45        -0.945889458062
     2.4414e+41     2.4414e+42             7.0416e-46        -0.945889458062
     9.7656e+41     9.7656e+42             1.7982e-46        -0.945889458062

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.6866
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7737e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.1854
    reference variance = 0.143863
====================================================
  Execution time = 2.8201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0387e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7983e-01
  Total weights = 1.957299844e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6540e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269420502996
                                         uncertainty =       0.002415324775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269420502996
                                         uncertainty =       0.002415324775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367029442
  error estimate for blocks of size 2^( 2) =       0.000380729067
  error estimate for blocks of size 2^( 3) =       0.000393387831
  error estimate for blocks of size 2^( 4) =       0.000402523455
  error estimate for blocks of size 2^( 5) =       0.000407977406
  error estimate for blocks of size 2^( 6) =       0.000411371086
  error estimate for blocks of size 2^( 7) =       0.000412171438

      target function =      -0.944957284089
              le_mean =     -17.212062267875
             les_mean =     296.534917056835
             stat err =       0.000408510846
             autocorr =       1.238811925409
   target nu stat err =       0.000408510846
   target dn stat err =       0.002759444360
      target stat err =       0.004817313632
              std dev =       0.519066319323
             le_variance =       0.269429843855


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721206226788e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+41, overlap shift 6.1035e+42 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944980850353       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944980850353       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+42, overlap shift 2.4414e+43 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944980850353       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944980850353       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+42, overlap shift 9.7656e+43 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944980850353       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944980850353       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.293525 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6864e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2192
    reference variance = 0.095634
====================================================
  Execution time = 2.8027e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7576e-01
  Total weights = 1.9575e+06
  Execution time = 2.5018e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266290539262
                                         uncertainty =       0.001448456350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266290539262
                                         uncertainty =       0.001448456350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364877340
  error estimate for blocks of size 2^( 2) =       0.000378686126
  error estimate for blocks of size 2^( 3) =       0.000391830876
  error estimate for blocks of size 2^( 4) =       0.000401255405
  error estimate for blocks of size 2^( 5) =       0.000406905912
  error estimate for blocks of size 2^( 6) =       0.000410040498
  error estimate for blocks of size 2^( 7) =       0.000411585648

      target function =      -0.952050810508
              le_mean =     -17.211837775592
             les_mean =     296.523118501957
             stat err =       0.000407446866
             autocorr =       1.246947522379
   target nu stat err =       0.000407446866
   target dn stat err =       0.001740030804
      target stat err =       0.003135667485
              std dev =       0.516022739025
             le_variance =       0.266279467191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266290539262
                                         uncertainty =       0.001448456350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266290539262
                                         uncertainty =       0.001448456350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364877340
  error estimate for blocks of size 2^( 2) =       0.000378686126
  error estimate for blocks of size 2^( 3) =       0.000391830876
  error estimate for blocks of size 2^( 4) =       0.000401255405
  error estimate for blocks of size 2^( 5) =       0.000406905912
  error estimate for blocks of size 2^( 6) =       0.000410040498
  error estimate for blocks of size 2^( 7) =       0.000411585648

      target function =      -0.952050810508
              le_mean =     -17.211837775592
             les_mean =     296.523118501957
             stat err =       0.000407446866
             autocorr =       1.246947522379
   target nu stat err =       0.000407446866
   target dn stat err =       0.001740030804
      target stat err =       0.003135667485
              std dev =       0.516022739025
             le_variance =       0.266279467191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266290539262
                                         uncertainty =       0.001448456350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266290539262
                                         uncertainty =       0.001448456350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364877340
  error estimate for blocks of size 2^( 2) =       0.000378686126
  error estimate for blocks of size 2^( 3) =       0.000391830876
  error estimate for blocks of size 2^( 4) =       0.000401255405
  error estimate for blocks of size 2^( 5) =       0.000406905912
  error estimate for blocks of size 2^( 6) =       0.000410040498
  error estimate for blocks of size 2^( 7) =       0.000411585648

      target function =      -0.952050810508
              le_mean =     -17.211837775592
             les_mean =     296.523118501957
             stat err =       0.000407446866
             autocorr =       1.246947522379
   target nu stat err =       0.000407446866
   target dn stat err =       0.001740030804
      target stat err =       0.003135667485
              std dev =       0.516022739025
             le_variance =       0.266279467191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266290539262
                                         uncertainty =       0.001448456350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266290539262
                                         uncertainty =       0.001448456350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364877340
  error estimate for blocks of size 2^( 2) =       0.000378686126
  error estimate for blocks of size 2^( 3) =       0.000391830876
  error estimate for blocks of size 2^( 4) =       0.000401255405
  error estimate for blocks of size 2^( 5) =       0.000406905912
  error estimate for blocks of size 2^( 6) =       0.000410040498
  error estimate for blocks of size 2^( 7) =       0.000411585648

      target function =      -0.952050810508
              le_mean =     -17.211837775592
             les_mean =     296.523118501957
             stat err =       0.000407446866
             autocorr =       1.246947522379
   target nu stat err =       0.000407446866
   target dn stat err =       0.001740030804
      target stat err =       0.003135667485
              std dev =       0.516022739025
             le_variance =       0.266279467191


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.952050810508        initial  <--
     6.1035e+41     6.1035e+42             0.0000e+00        -0.952050810508
     2.4414e+42     2.4414e+43             0.0000e+00        -0.952050810508
     9.7656e+42     9.7656e+43             0.0000e+00        -0.952050810508

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7032
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7577e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2214
    reference variance = 0.244367
====================================================
  Execution time = 2.8023e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0379e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7553e-01
  Total weights = 1.957567884e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6066e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264338528139
                                         uncertainty =       0.001506481355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264338528139
                                         uncertainty =       0.001506481355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363581161
  error estimate for blocks of size 2^( 2) =       0.000377492487
  error estimate for blocks of size 2^( 3) =       0.000390270972
  error estimate for blocks of size 2^( 4) =       0.000398982266
  error estimate for blocks of size 2^( 5) =       0.000404212239
  error estimate for blocks of size 2^( 6) =       0.000407528630
  error estimate for blocks of size 2^( 7) =       0.000410024966

      target function =      -0.952429061841
              le_mean =     -17.212633121688
             les_mean =     296.550268303951
             stat err =       0.000405187025
             autocorr =       1.241962021810
   target nu stat err =       0.000405187025
   target dn stat err =       0.001986775210
      target stat err =       0.003563826027
              std dev =       0.514189636074
             le_variance =       0.264390981846


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721263312169e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+42, overlap shift 6.1035e+43 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952441365624       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952441365624       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952441365624       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952148437500       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.000000000000       residual = 6.59e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+42 is 1.743043e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+43, overlap shift 2.4414e+44 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952441365624       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952441365624       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952441365624       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953125000000       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+43 is 4.357607e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+43, overlap shift 9.7656e+44 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952441365624       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952441365624       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952441365624       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953125000000       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 3.59e+07           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+43 is 1.089402e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.295825 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6640e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.172
    reference variance = 0.173563
====================================================
  Execution time = 2.8086e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8232e-01
  Total weights = 1.9575e+06
  Execution time = 2.4980e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270153907013
                                         uncertainty =       0.002499038208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270153907013
                                         uncertainty =       0.002499038208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367494993
  error estimate for blocks of size 2^( 2) =       0.000381397632
  error estimate for blocks of size 2^( 3) =       0.000394048764
  error estimate for blocks of size 2^( 4) =       0.000403009855
  error estimate for blocks of size 2^( 5) =       0.000408204607
  error estimate for blocks of size 2^( 6) =       0.000411153609
  error estimate for blocks of size 2^( 7) =       0.000415354113

      target function =      -0.940678316167
              le_mean =     -17.211709763310
             les_mean =     296.525276920184
             stat err =       0.000409430546
             autocorr =       1.241245333799
   target nu stat err =       0.000409430546
   target dn stat err =       0.003426949742
      target stat err =       0.005900228402
              std dev =       0.519724718353
             le_variance =       0.270113782867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270153907013
                                         uncertainty =       0.002499038208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270153907013
                                         uncertainty =       0.002499038208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367494993
  error estimate for blocks of size 2^( 2) =       0.000381397632
  error estimate for blocks of size 2^( 3) =       0.000394048764
  error estimate for blocks of size 2^( 4) =       0.000403009855
  error estimate for blocks of size 2^( 5) =       0.000408204607
  error estimate for blocks of size 2^( 6) =       0.000411153609
  error estimate for blocks of size 2^( 7) =       0.000415354113

      target function =      -0.940678316167
              le_mean =     -17.211709763310
             les_mean =     296.525276920184
             stat err =       0.000409430546
             autocorr =       1.241245333799
   target nu stat err =       0.000409430546
   target dn stat err =       0.003426949742
      target stat err =       0.005900228402
              std dev =       0.519724718353
             le_variance =       0.270113782867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270153907013
                                         uncertainty =       0.002499038208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270153907013
                                         uncertainty =       0.002499038208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367494993
  error estimate for blocks of size 2^( 2) =       0.000381397632
  error estimate for blocks of size 2^( 3) =       0.000394048764
  error estimate for blocks of size 2^( 4) =       0.000403009855
  error estimate for blocks of size 2^( 5) =       0.000408204607
  error estimate for blocks of size 2^( 6) =       0.000411153609
  error estimate for blocks of size 2^( 7) =       0.000415354113

      target function =      -0.940678316167
              le_mean =     -17.211709763310
             les_mean =     296.525276920184
             stat err =       0.000409430546
             autocorr =       1.241245333799
   target nu stat err =       0.000409430546
   target dn stat err =       0.003426949742
      target stat err =       0.005900228402
              std dev =       0.519724718353
             le_variance =       0.270113782867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270153907013
                                         uncertainty =       0.002499038208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270153907013
                                         uncertainty =       0.002499038208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367494993
  error estimate for blocks of size 2^( 2) =       0.000381397632
  error estimate for blocks of size 2^( 3) =       0.000394048764
  error estimate for blocks of size 2^( 4) =       0.000403009855
  error estimate for blocks of size 2^( 5) =       0.000408204607
  error estimate for blocks of size 2^( 6) =       0.000411153609
  error estimate for blocks of size 2^( 7) =       0.000415354113

      target function =      -0.940678316167
              le_mean =     -17.211709763310
             les_mean =     296.525276920184
             stat err =       0.000409430546
             autocorr =       1.241245333799
   target nu stat err =       0.000409430546
   target dn stat err =       0.003426949742
      target stat err =       0.005900228402
              std dev =       0.519724718353
             le_variance =       0.270113782867


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940678316167        initial  <--
     6.1035e+42     6.1035e+43             1.7430e-47        -0.940678316167
     2.4414e+43     2.4414e+44             4.3576e-48        -0.940678316167
     9.7656e+43     9.7656e+44             1.0894e-48        -0.940678316167

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7609
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7408e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2196
    reference variance = 0.195327
====================================================
  Execution time = 2.8233e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0381e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7829e-01
  Total weights = 1.957687383e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6376e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267439295962
                                         uncertainty =       0.001646804953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267439295962
                                         uncertainty =       0.001646804953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365664692
  error estimate for blocks of size 2^( 2) =       0.000379589761
  error estimate for blocks of size 2^( 3) =       0.000392081388
  error estimate for blocks of size 2^( 4) =       0.000401816582
  error estimate for blocks of size 2^( 5) =       0.000407608776
  error estimate for blocks of size 2^( 6) =       0.000410452566
  error estimate for blocks of size 2^( 7) =       0.000411829330

      target function =      -0.947616950465
              le_mean =     -17.212455444584
             les_mean =     296.546913545219
             stat err =       0.000407926814
             autocorr =       1.244510176354
   target nu stat err =       0.000407926814
   target dn stat err =       0.001902249483
      target stat err =       0.003385290488
              std dev =       0.517136240029
             le_variance =       0.267429890751


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721245544458e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+43, overlap shift 6.1035e+44 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947627994191       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947627994191       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+44, overlap shift 2.4414e+45 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947627994191       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947627994191       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+44, overlap shift 9.7656e+45 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947627994191       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947627994191       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.297121 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6879e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2845
    reference variance = 0.121847
====================================================
  Execution time = 3.0119e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7829e-01
  Total weights = 1.9574e+06
  Execution time = 2.4975e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266672671420
                                         uncertainty =       0.001477057838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266672671420
                                         uncertainty =       0.001477057838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365119343
  error estimate for blocks of size 2^( 2) =       0.000378738876
  error estimate for blocks of size 2^( 3) =       0.000391777432
  error estimate for blocks of size 2^( 4) =       0.000401026433
  error estimate for blocks of size 2^( 5) =       0.000407284255
  error estimate for blocks of size 2^( 6) =       0.000408842919
  error estimate for blocks of size 2^( 7) =       0.000410151559

      target function =      -0.947630656306
              le_mean =     -17.212078261240
             les_mean =     296.533925956678
             stat err =       0.000406826292
             autocorr =       1.241504627003
   target nu stat err =       0.000406826292
   target dn stat err =       0.002291734803
      target stat err =       0.004044229288
              std dev =       0.516364987711
             le_variance =       0.266632800534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266672671420
                                         uncertainty =       0.001477057838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266672671420
                                         uncertainty =       0.001477057838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365119343
  error estimate for blocks of size 2^( 2) =       0.000378738876
  error estimate for blocks of size 2^( 3) =       0.000391777432
  error estimate for blocks of size 2^( 4) =       0.000401026433
  error estimate for blocks of size 2^( 5) =       0.000407284255
  error estimate for blocks of size 2^( 6) =       0.000408842919
  error estimate for blocks of size 2^( 7) =       0.000410151559

      target function =      -0.947630656306
              le_mean =     -17.212078261240
             les_mean =     296.533925956678
             stat err =       0.000406826292
             autocorr =       1.241504627007
   target nu stat err =       0.000406826292
   target dn stat err =       0.002291734803
      target stat err =       0.004044229288
              std dev =       0.516364987711
             le_variance =       0.266632800534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266672671420
                                         uncertainty =       0.001477057838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266672671420
                                         uncertainty =       0.001477057838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365119343
  error estimate for blocks of size 2^( 2) =       0.000378738876
  error estimate for blocks of size 2^( 3) =       0.000391777432
  error estimate for blocks of size 2^( 4) =       0.000401026433
  error estimate for blocks of size 2^( 5) =       0.000407284255
  error estimate for blocks of size 2^( 6) =       0.000408842919
  error estimate for blocks of size 2^( 7) =       0.000410151559

      target function =      -0.947630656306
              le_mean =     -17.212078261240
             les_mean =     296.533925956678
             stat err =       0.000406826292
             autocorr =       1.241504627007
   target nu stat err =       0.000406826292
   target dn stat err =       0.002291734803
      target stat err =       0.004044229288
              std dev =       0.516364987711
             le_variance =       0.266632800534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266672671420
                                         uncertainty =       0.001477057838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266672671420
                                         uncertainty =       0.001477057838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365119343
  error estimate for blocks of size 2^( 2) =       0.000378738876
  error estimate for blocks of size 2^( 3) =       0.000391777432
  error estimate for blocks of size 2^( 4) =       0.000401026433
  error estimate for blocks of size 2^( 5) =       0.000407284255
  error estimate for blocks of size 2^( 6) =       0.000408842919
  error estimate for blocks of size 2^( 7) =       0.000410151559

      target function =      -0.947630656306
              le_mean =     -17.212078261240
             les_mean =     296.533925956678
             stat err =       0.000406826292
             autocorr =       1.241504627007
   target nu stat err =       0.000406826292
   target dn stat err =       0.002291734803
      target stat err =       0.004044229288
              std dev =       0.516364987711
             le_variance =       0.266632800534


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947630656306        initial  <--
     6.1035e+43     6.1035e+44             0.0000e+00        -0.947630656306
     2.4414e+44     2.4414e+45             0.0000e+00        -0.947630656306
     9.7656e+44     9.7656e+45             0.0000e+00        -0.947630656306

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7834
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9669e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2246
    reference variance = 0.260894
====================================================
  Execution time = 2.8213e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0395e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7752e-01
  Total weights = 1.957646009e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7254e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266547582380
                                         uncertainty =       0.002187682395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266547582380
                                         uncertainty =       0.002187682395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365052101
  error estimate for blocks of size 2^( 2) =       0.000378730201
  error estimate for blocks of size 2^( 3) =       0.000391382613
  error estimate for blocks of size 2^( 4) =       0.000399876532
  error estimate for blocks of size 2^( 5) =       0.000405235098
  error estimate for blocks of size 2^( 6) =       0.000407669777
  error estimate for blocks of size 2^( 7) =       0.000410662626

      target function =      -0.948929686950
              le_mean =     -17.212208323903
             les_mean =     296.537637267077
             stat err =       0.000405861008
             autocorr =       1.236075379547
   target nu stat err =       0.000405861008
   target dn stat err =       0.003701500937
      target stat err =       0.006482630699
              std dev =       0.516269891829
             le_variance =       0.266534601209


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721220832390e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+44, overlap shift 6.1035e+45 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948973171513       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948973171513       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+45, overlap shift 2.4414e+46 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948973171513       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948973171513       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+45, overlap shift 9.7656e+46 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948973171513       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948973171513       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.298465 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6947e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2283
    reference variance = 0.177237
====================================================
  Execution time = 2.7983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7663e-01
  Total weights = 1.9573e+06
  Execution time = 2.5078e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266564526737
                                         uncertainty =       0.001532523144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266564526737
                                         uncertainty =       0.001532523144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365044679
  error estimate for blocks of size 2^( 2) =       0.000378711515
  error estimate for blocks of size 2^( 3) =       0.000391677494
  error estimate for blocks of size 2^( 4) =       0.000400568626
  error estimate for blocks of size 2^( 5) =       0.000406242389
  error estimate for blocks of size 2^( 6) =       0.000407950105
  error estimate for blocks of size 2^( 7) =       0.000409972702

      target function =      -0.950515744391
              le_mean =     -17.212323862709
             les_mean =     296.540720619861
             stat err =       0.000406183455
             autocorr =       1.238090564971
   target nu stat err =       0.000406183455
   target dn stat err =       0.001976012482
      target stat err =       0.003529728733
              std dev =       0.516259396294
             le_variance =       0.266523764262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266564526737
                                         uncertainty =       0.001532523144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266564526737
                                         uncertainty =       0.001532523144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365044679
  error estimate for blocks of size 2^( 2) =       0.000378711515
  error estimate for blocks of size 2^( 3) =       0.000391677494
  error estimate for blocks of size 2^( 4) =       0.000400568626
  error estimate for blocks of size 2^( 5) =       0.000406242389
  error estimate for blocks of size 2^( 6) =       0.000407950105
  error estimate for blocks of size 2^( 7) =       0.000409972702

      target function =      -0.950515744391
              le_mean =     -17.212323862709
             les_mean =     296.540720619861
             stat err =       0.000406183455
             autocorr =       1.238090564971
   target nu stat err =       0.000406183455
   target dn stat err =       0.001976012482
      target stat err =       0.003529728733
              std dev =       0.516259396294
             le_variance =       0.266523764262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266564526737
                                         uncertainty =       0.001532523144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266564526737
                                         uncertainty =       0.001532523144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365044679
  error estimate for blocks of size 2^( 2) =       0.000378711515
  error estimate for blocks of size 2^( 3) =       0.000391677494
  error estimate for blocks of size 2^( 4) =       0.000400568626
  error estimate for blocks of size 2^( 5) =       0.000406242389
  error estimate for blocks of size 2^( 6) =       0.000407950105
  error estimate for blocks of size 2^( 7) =       0.000409972702

      target function =      -0.950515744391
              le_mean =     -17.212323862709
             les_mean =     296.540720619861
             stat err =       0.000406183455
             autocorr =       1.238090564971
   target nu stat err =       0.000406183455
   target dn stat err =       0.001976012482
      target stat err =       0.003529728733
              std dev =       0.516259396294
             le_variance =       0.266523764262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266564526737
                                         uncertainty =       0.001532523144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266564526737
                                         uncertainty =       0.001532523144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365044679
  error estimate for blocks of size 2^( 2) =       0.000378711515
  error estimate for blocks of size 2^( 3) =       0.000391677494
  error estimate for blocks of size 2^( 4) =       0.000400568626
  error estimate for blocks of size 2^( 5) =       0.000406242389
  error estimate for blocks of size 2^( 6) =       0.000407950105
  error estimate for blocks of size 2^( 7) =       0.000409972702

      target function =      -0.950515744391
              le_mean =     -17.212323862709
             les_mean =     296.540720619861
             stat err =       0.000406183455
             autocorr =       1.238090564971
   target nu stat err =       0.000406183455
   target dn stat err =       0.001976012482
      target stat err =       0.003529728733
              std dev =       0.516259396294
             le_variance =       0.266523764262


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950515744391        initial  <--
     6.1035e+44     6.1035e+45             0.0000e+00        -0.950515744391
     2.4414e+45     2.4414e+46             0.0000e+00        -0.950515744391
     9.7656e+45     9.7656e+46             0.0000e+00        -0.950515744391

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.6658
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7620e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2756
    reference variance = 0.143412
====================================================
  Execution time = 2.8118e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0388e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7689e-01
  Total weights = 1.957118162e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6708e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266352092273
                                         uncertainty =       0.001522991284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266352092273
                                         uncertainty =       0.001522991284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364887778
  error estimate for blocks of size 2^( 2) =       0.000378850751
  error estimate for blocks of size 2^( 3) =       0.000391241299
  error estimate for blocks of size 2^( 4) =       0.000401230373
  error estimate for blocks of size 2^( 5) =       0.000406948215
  error estimate for blocks of size 2^( 6) =       0.000409824037
  error estimate for blocks of size 2^( 7) =       0.000409752502

      target function =      -0.950048356372
              le_mean =     -17.212256762702
             les_mean =     296.538673597262
             stat err =       0.000406938782
             autocorr =       1.243768427135
   target nu stat err =       0.000406938782
   target dn stat err =       0.002694608750
      target stat err =       0.004758415051
              std dev =       0.516037500349
             le_variance =       0.266294701767


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721225676270e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+45, overlap shift 6.1035e+46 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950071083979       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950071083979       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+46, overlap shift 2.4414e+47 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950071083979       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950071083979       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+46, overlap shift 9.7656e+47 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950071083979       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950071083979       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.299792 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6798e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1822
    reference variance = 0.227322
====================================================
  Execution time = 2.8182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8229e-01
  Total weights = 1.9575e+06
  Execution time = 2.5045e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269608730624
                                         uncertainty =       0.002370205621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269608730624
                                         uncertainty =       0.002370205621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367144145
  error estimate for blocks of size 2^( 2) =       0.000381025110
  error estimate for blocks of size 2^( 3) =       0.000393651365
  error estimate for blocks of size 2^( 4) =       0.000402369485
  error estimate for blocks of size 2^( 5) =       0.000407726272
  error estimate for blocks of size 2^( 6) =       0.000410098084
  error estimate for blocks of size 2^( 7) =       0.000413850620

      target function =      -0.940699616765
              le_mean =     -17.212550933462
             les_mean =     296.554198030626
             stat err =       0.000408511115
             autocorr =       1.238039620704
   target nu stat err =       0.000408511115
   target dn stat err =       0.003431734086
      target stat err =       0.005917997137
              std dev =       0.519228536030
             le_variance =       0.269598272628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269608730624
                                         uncertainty =       0.002370205621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269608730624
                                         uncertainty =       0.002370205621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367144145
  error estimate for blocks of size 2^( 2) =       0.000381025110
  error estimate for blocks of size 2^( 3) =       0.000393651365
  error estimate for blocks of size 2^( 4) =       0.000402369485
  error estimate for blocks of size 2^( 5) =       0.000407726272
  error estimate for blocks of size 2^( 6) =       0.000410098084
  error estimate for blocks of size 2^( 7) =       0.000413850620

      target function =      -0.940699616765
              le_mean =     -17.212550933462
             les_mean =     296.554198030626
             stat err =       0.000408511115
             autocorr =       1.238039620704
   target nu stat err =       0.000408511115
   target dn stat err =       0.003431734086
      target stat err =       0.005917997137
              std dev =       0.519228536030
             le_variance =       0.269598272628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269608730624
                                         uncertainty =       0.002370205621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269608730624
                                         uncertainty =       0.002370205621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367144145
  error estimate for blocks of size 2^( 2) =       0.000381025110
  error estimate for blocks of size 2^( 3) =       0.000393651365
  error estimate for blocks of size 2^( 4) =       0.000402369485
  error estimate for blocks of size 2^( 5) =       0.000407726272
  error estimate for blocks of size 2^( 6) =       0.000410098084
  error estimate for blocks of size 2^( 7) =       0.000413850620

      target function =      -0.940699616765
              le_mean =     -17.212550933462
             les_mean =     296.554198030626
             stat err =       0.000408511115
             autocorr =       1.238039620704
   target nu stat err =       0.000408511115
   target dn stat err =       0.003431734086
      target stat err =       0.005917997137
              std dev =       0.519228536030
             le_variance =       0.269598272628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269608730624
                                         uncertainty =       0.002370205621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269608730624
                                         uncertainty =       0.002370205621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367144145
  error estimate for blocks of size 2^( 2) =       0.000381025110
  error estimate for blocks of size 2^( 3) =       0.000393651365
  error estimate for blocks of size 2^( 4) =       0.000402369485
  error estimate for blocks of size 2^( 5) =       0.000407726272
  error estimate for blocks of size 2^( 6) =       0.000410098084
  error estimate for blocks of size 2^( 7) =       0.000413850620

      target function =      -0.940699616765
              le_mean =     -17.212550933462
             les_mean =     296.554198030626
             stat err =       0.000408511115
             autocorr =       1.238039620704
   target nu stat err =       0.000408511115
   target dn stat err =       0.003431734086
      target stat err =       0.005917997137
              std dev =       0.519228536030
             le_variance =       0.269598272628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940699616765        initial  <--
     6.1035e+45     6.1035e+46             0.0000e+00        -0.940699616765
     2.4414e+46     2.4414e+47             0.0000e+00        -0.940699616765
     9.7656e+46     9.7656e+47             0.0000e+00        -0.940699616765

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8550
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7659e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.1505
    reference variance = 0.255921
====================================================
  Execution time = 2.8177e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0370e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7741e-01
  Total weights = 1.957634216e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7143e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265164466654
                                         uncertainty =       0.001362168979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265164466654
                                         uncertainty =       0.001362168979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364136614
  error estimate for blocks of size 2^( 2) =       0.000378192518
  error estimate for blocks of size 2^( 3) =       0.000391134169
  error estimate for blocks of size 2^( 4) =       0.000400792969
  error estimate for blocks of size 2^( 5) =       0.000406623705
  error estimate for blocks of size 2^( 6) =       0.000408792015
  error estimate for blocks of size 2^( 7) =       0.000409666773

      target function =      -0.949175517714
              le_mean =     -17.211368431034
             les_mean =     296.508614899777
             stat err =       0.000406468866
             autocorr =       1.246022465874
   target nu stat err =       0.000406468866
   target dn stat err =       0.002215935588
      target stat err =       0.003922114061
              std dev =       0.514975177181
             le_variance =       0.265199433113


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721136843103e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+46, overlap shift 6.1035e+47 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949190597294       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949190597294       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949190597294       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949190597294       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949190597292       residual = 8.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+46 is 3.385187e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+47, overlap shift 2.4414e+48 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949190597294       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949190597294       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949190597294       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949190597294       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949190597292       residual = 8.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+47 is 8.462967e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+47, overlap shift 9.7656e+48 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949190597294       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949190597294       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949190597294       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949190597294       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949190597292       residual = 8.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+47 is 2.115742e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.302259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6901e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.1676
    reference variance = 0.261055
====================================================
  Execution time = 2.8124e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7558e-01
  Total weights = 1.9572e+06
  Execution time = 2.4953e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265632297937
                                         uncertainty =       0.001413889229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265632297937
                                         uncertainty =       0.001413889229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364477652
  error estimate for blocks of size 2^( 2) =       0.000377997101
  error estimate for blocks of size 2^( 3) =       0.000391106237
  error estimate for blocks of size 2^( 4) =       0.000400132800
  error estimate for blocks of size 2^( 5) =       0.000405566655
  error estimate for blocks of size 2^( 6) =       0.000408335346
  error estimate for blocks of size 2^( 7) =       0.000408476634

      target function =      -0.952369279816
              le_mean =     -17.211737732029
             les_mean =     296.519494304346
             stat err =       0.000405627859
             autocorr =       1.238550560867
   target nu stat err =       0.000405627859
   target dn stat err =       0.001707312459
      target stat err =       0.003080692913
              std dev =       0.515457485849
             le_variance =       0.265696419718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265632297937
                                         uncertainty =       0.001413889229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265632297937
                                         uncertainty =       0.001413889229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364477652
  error estimate for blocks of size 2^( 2) =       0.000377997101
  error estimate for blocks of size 2^( 3) =       0.000391106237
  error estimate for blocks of size 2^( 4) =       0.000400132800
  error estimate for blocks of size 2^( 5) =       0.000405566655
  error estimate for blocks of size 2^( 6) =       0.000408335346
  error estimate for blocks of size 2^( 7) =       0.000408476634

      target function =      -0.952369279816
              le_mean =     -17.211737732029
             les_mean =     296.519494304346
             stat err =       0.000405627859
             autocorr =       1.238550560867
   target nu stat err =       0.000405627859
   target dn stat err =       0.001707312459
      target stat err =       0.003080692913
              std dev =       0.515457485849
             le_variance =       0.265696419718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265632297937
                                         uncertainty =       0.001413889229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265632297937
                                         uncertainty =       0.001413889229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364477652
  error estimate for blocks of size 2^( 2) =       0.000377997101
  error estimate for blocks of size 2^( 3) =       0.000391106237
  error estimate for blocks of size 2^( 4) =       0.000400132800
  error estimate for blocks of size 2^( 5) =       0.000405566655
  error estimate for blocks of size 2^( 6) =       0.000408335346
  error estimate for blocks of size 2^( 7) =       0.000408476634

      target function =      -0.952369279816
              le_mean =     -17.211737732029
             les_mean =     296.519494304346
             stat err =       0.000405627859
             autocorr =       1.238550560867
   target nu stat err =       0.000405627859
   target dn stat err =       0.001707312459
      target stat err =       0.003080692913
              std dev =       0.515457485849
             le_variance =       0.265696419718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265632297937
                                         uncertainty =       0.001413889229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265632297937
                                         uncertainty =       0.001413889229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364477652
  error estimate for blocks of size 2^( 2) =       0.000377997101
  error estimate for blocks of size 2^( 3) =       0.000391106237
  error estimate for blocks of size 2^( 4) =       0.000400132800
  error estimate for blocks of size 2^( 5) =       0.000405566655
  error estimate for blocks of size 2^( 6) =       0.000408335346
  error estimate for blocks of size 2^( 7) =       0.000408476634

      target function =      -0.952369279816
              le_mean =     -17.211737732029
             les_mean =     296.519494304346
             stat err =       0.000405627859
             autocorr =       1.238550560867
   target nu stat err =       0.000405627859
   target dn stat err =       0.001707312459
      target stat err =       0.003080692913
              std dev =       0.515457485849
             le_variance =       0.265696419718


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.952369279816        initial  <--
     6.1035e+46     6.1035e+47             3.3852e-51        -0.952369279816
     2.4414e+47     2.4414e+48             8.4630e-52        -0.952369279816
     9.7656e+47     9.7656e+48             2.1157e-52        -0.952369279816

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7837
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.2383
    reference variance = 0.267556
====================================================
  Execution time = 2.8192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0392e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7631e-01
  Total weights = 1.956932248e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.6770e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266014738944
                                         uncertainty =       0.001179522967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266014738944
                                         uncertainty =       0.001179522967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364678228
  error estimate for blocks of size 2^( 2) =       0.000378683891
  error estimate for blocks of size 2^( 3) =       0.000391707291
  error estimate for blocks of size 2^( 4) =       0.000401366649
  error estimate for blocks of size 2^( 5) =       0.000406036915
  error estimate for blocks of size 2^( 6) =       0.000408724178
  error estimate for blocks of size 2^( 7) =       0.000409089581

      target function =      -0.951074803740
              le_mean =     -17.212148852656
             les_mean =     296.534379678133
             stat err =       0.000406304330
             autocorr =       1.241318504229
   target nu stat err =       0.000406304330
   target dn stat err =       0.001858057326
      target stat err =       0.003331461524
              std dev =       0.515741148177
             le_variance =       0.265988931923


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721214885266e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+47, overlap shift 6.1035e+48 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951085336002       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951085336002       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+48, overlap shift 2.4414e+49 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951085336002       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951085336002       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+48, overlap shift 9.7656e+49 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951085336002       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951085336002       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.303582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7879e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1552
    reference variance = 0.187419
====================================================
  Execution time = 2.8427e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8211e-01
  Total weights = 1.9574e+06
  Execution time = 2.5032e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269137764580
                                         uncertainty =       0.002337616063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269137764580
                                         uncertainty =       0.002337616063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366821156
  error estimate for blocks of size 2^( 2) =       0.000380605421
  error estimate for blocks of size 2^( 3) =       0.000393133807
  error estimate for blocks of size 2^( 4) =       0.000402441509
  error estimate for blocks of size 2^( 5) =       0.000408693659
  error estimate for blocks of size 2^( 6) =       0.000410662979
  error estimate for blocks of size 2^( 7) =       0.000415270797

      target function =      -0.941028336115
              le_mean =     -17.212326003466
             les_mean =     296.546274094397
             stat err =       0.000409267236
             autocorr =       1.244816131594
   target nu stat err =       0.000409267236
   target dn stat err =       0.002973461452
      target stat err =       0.005142579192
              std dev =       0.518771753324
             le_variance =       0.269124132047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269137764580
                                         uncertainty =       0.002337616063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269137764580
                                         uncertainty =       0.002337616063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366821156
  error estimate for blocks of size 2^( 2) =       0.000380605421
  error estimate for blocks of size 2^( 3) =       0.000393133807
  error estimate for blocks of size 2^( 4) =       0.000402441509
  error estimate for blocks of size 2^( 5) =       0.000408693659
  error estimate for blocks of size 2^( 6) =       0.000410662979
  error estimate for blocks of size 2^( 7) =       0.000415270797

      target function =      -0.941028336115
              le_mean =     -17.212326003466
             les_mean =     296.546274094397
             stat err =       0.000409267236
             autocorr =       1.244816131594
   target nu stat err =       0.000409267236
   target dn stat err =       0.002973461452
      target stat err =       0.005142579192
              std dev =       0.518771753324
             le_variance =       0.269124132047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269137764580
                                         uncertainty =       0.002337616063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269137764580
                                         uncertainty =       0.002337616063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366821156
  error estimate for blocks of size 2^( 2) =       0.000380605421
  error estimate for blocks of size 2^( 3) =       0.000393133807
  error estimate for blocks of size 2^( 4) =       0.000402441509
  error estimate for blocks of size 2^( 5) =       0.000408693659
  error estimate for blocks of size 2^( 6) =       0.000410662979
  error estimate for blocks of size 2^( 7) =       0.000415270797

      target function =      -0.941028336115
              le_mean =     -17.212326003466
             les_mean =     296.546274094397
             stat err =       0.000409267236
             autocorr =       1.244816131594
   target nu stat err =       0.000409267236
   target dn stat err =       0.002973461452
      target stat err =       0.005142579192
              std dev =       0.518771753324
             le_variance =       0.269124132047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269137764580
                                         uncertainty =       0.002337616063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269137764580
                                         uncertainty =       0.002337616063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366821156
  error estimate for blocks of size 2^( 2) =       0.000380605421
  error estimate for blocks of size 2^( 3) =       0.000393133807
  error estimate for blocks of size 2^( 4) =       0.000402441509
  error estimate for blocks of size 2^( 5) =       0.000408693659
  error estimate for blocks of size 2^( 6) =       0.000410662979
  error estimate for blocks of size 2^( 7) =       0.000415270797

      target function =      -0.941028336115
              le_mean =     -17.212326003466
             les_mean =     296.546274094397
             stat err =       0.000409267236
             autocorr =       1.244816131594
   target nu stat err =       0.000409267236
   target dn stat err =       0.002973461452
      target stat err =       0.005142579192
              std dev =       0.518771753324
             le_variance =       0.269124132047


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941028336115        initial  <--
     6.1035e+47     6.1035e+48             0.0000e+00        -0.941028336115
     2.4414e+48     2.4414e+49             0.0000e+00        -0.941028336115
     9.7656e+48     9.7656e+49             0.0000e+00        -0.941028336115

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0022
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8890e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2107
    reference variance = 0.191582
====================================================
  Execution time = 2.8448e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0391e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7724e-01
  Total weights = 1.957448940e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6986e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265699621979
                                         uncertainty =       0.001399292337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265699621979
                                         uncertainty =       0.001399292337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364505771
  error estimate for blocks of size 2^( 2) =       0.000378219759
  error estimate for blocks of size 2^( 3) =       0.000391088140
  error estimate for blocks of size 2^( 4) =       0.000399747250
  error estimate for blocks of size 2^( 5) =       0.000405235358
  error estimate for blocks of size 2^( 6) =       0.000407447042
  error estimate for blocks of size 2^( 7) =       0.000411201159

      target function =      -0.949452909519
              le_mean =     -17.212058553327
             les_mean =     296.532197260559
             stat err =       0.000405907702
             autocorr =       1.240068762417
   target nu stat err =       0.000405907702
   target dn stat err =       0.002517023995
      target stat err =       0.004445277251
              std dev =       0.515497252543
             le_variance =       0.265737417379


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721205855333e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+48, overlap shift 6.1035e+49 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949472668504       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949472668504       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+49, overlap shift 2.4414e+50 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949472668504       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949472668504       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+49, overlap shift 9.7656e+50 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949472668504       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949472668504       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.304911 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7155e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2164
    reference variance = 0.33015
====================================================
  Execution time = 2.8118e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8121e-01
  Total weights = 1.9571e+06
  Execution time = 2.5002e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266496004151
                                         uncertainty =       0.001302995942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266496004151
                                         uncertainty =       0.001302995942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364987557
  error estimate for blocks of size 2^( 2) =       0.000378973520
  error estimate for blocks of size 2^( 3) =       0.000391232201
  error estimate for blocks of size 2^( 4) =       0.000400534073
  error estimate for blocks of size 2^( 5) =       0.000406218057
  error estimate for blocks of size 2^( 6) =       0.000409910865
  error estimate for blocks of size 2^( 7) =       0.000412359441

      target function =      -0.942535132057
              le_mean =     -17.212797944670
             les_mean =     296.561620383160
             stat err =       0.000407255609
             autocorr =       1.245024882079
   target nu stat err =       0.000407255609
   target dn stat err =       0.003693948811
      target stat err =       0.006390823006
              std dev =       0.516178611722
             le_variance =       0.266440359199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266496004151
                                         uncertainty =       0.001302995942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266496004151
                                         uncertainty =       0.001302995942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364987557
  error estimate for blocks of size 2^( 2) =       0.000378973520
  error estimate for blocks of size 2^( 3) =       0.000391232201
  error estimate for blocks of size 2^( 4) =       0.000400534073
  error estimate for blocks of size 2^( 5) =       0.000406218057
  error estimate for blocks of size 2^( 6) =       0.000409910865
  error estimate for blocks of size 2^( 7) =       0.000412359441

      target function =      -0.942535132057
              le_mean =     -17.212797944670
             les_mean =     296.561620383160
             stat err =       0.000407255609
             autocorr =       1.245024882079
   target nu stat err =       0.000407255609
   target dn stat err =       0.003693948811
      target stat err =       0.006390823006
              std dev =       0.516178611722
             le_variance =       0.266440359199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266496004151
                                         uncertainty =       0.001302995942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266496004151
                                         uncertainty =       0.001302995942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364987557
  error estimate for blocks of size 2^( 2) =       0.000378973520
  error estimate for blocks of size 2^( 3) =       0.000391232201
  error estimate for blocks of size 2^( 4) =       0.000400534073
  error estimate for blocks of size 2^( 5) =       0.000406218057
  error estimate for blocks of size 2^( 6) =       0.000409910865
  error estimate for blocks of size 2^( 7) =       0.000412359441

      target function =      -0.942535132057
              le_mean =     -17.212797944670
             les_mean =     296.561620383160
             stat err =       0.000407255609
             autocorr =       1.245024882079
   target nu stat err =       0.000407255609
   target dn stat err =       0.003693948811
      target stat err =       0.006390823006
              std dev =       0.516178611722
             le_variance =       0.266440359199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266496004151
                                         uncertainty =       0.001302995942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266496004151
                                         uncertainty =       0.001302995942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364987557
  error estimate for blocks of size 2^( 2) =       0.000378973520
  error estimate for blocks of size 2^( 3) =       0.000391232201
  error estimate for blocks of size 2^( 4) =       0.000400534073
  error estimate for blocks of size 2^( 5) =       0.000406218057
  error estimate for blocks of size 2^( 6) =       0.000409910865
  error estimate for blocks of size 2^( 7) =       0.000412359441

      target function =      -0.942535132057
              le_mean =     -17.212797944670
             les_mean =     296.561620383160
             stat err =       0.000407255609
             autocorr =       1.245024882079
   target nu stat err =       0.000407255609
   target dn stat err =       0.003693948811
      target stat err =       0.006390823006
              std dev =       0.516178611722
             le_variance =       0.266440359199


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942535132057        initial  <--
     6.1035e+48     6.1035e+49             0.0000e+00        -0.942535132057
     2.4414e+49     2.4414e+50             0.0000e+00        -0.942535132057
     9.7656e+49     9.7656e+50             0.0000e+00        -0.942535132057

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.6753
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7837e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2079
    reference variance = 0.218408
====================================================
  Execution time = 2.8231e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0409e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8063e-01
  Total weights = 1.957453796e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7536e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267824059545
                                         uncertainty =       0.001633081471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267824059545
                                         uncertainty =       0.001633081471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365930655
  error estimate for blocks of size 2^( 2) =       0.000379753095
  error estimate for blocks of size 2^( 3) =       0.000392229809
  error estimate for blocks of size 2^( 4) =       0.000400981142
  error estimate for blocks of size 2^( 5) =       0.000406061101
  error estimate for blocks of size 2^( 6) =       0.000409619127
  error estimate for blocks of size 2^( 7) =       0.000411150710

      target function =      -0.943548322730
              le_mean =     -17.212124188269
             les_mean =     296.537853822247
             stat err =       0.000406953020
             autocorr =       1.236775759957
   target nu stat err =       0.000406953020
   target dn stat err =       0.003739056880
      target stat err =       0.006473144076
              std dev =       0.517512375414
             le_variance =       0.267819058707


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721212418827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+49, overlap shift 6.1035e+50 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943591504474       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943591504474       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943591504474       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943591504471       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943591504472       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 8.83e+07           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+49 is 2.705047e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+50, overlap shift 2.4414e+51 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943591504474       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943591504474       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943591504474       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.54e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 1.32e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+50 is 5.939688e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+50, overlap shift 9.7656e+51 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943591504474       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943591504474       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943591504474       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.54e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 1.32e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+50 is 1.484922e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.307539 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6995e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1637
    reference variance = 0.230675
====================================================
  Execution time = 2.7937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7965e-01
  Total weights = 1.9575e+06
  Execution time = 2.5113e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268810211176
                                         uncertainty =       0.001392078223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268810211176
                                         uncertainty =       0.001392078223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366579890
  error estimate for blocks of size 2^( 2) =       0.000380178662
  error estimate for blocks of size 2^( 3) =       0.000392783030
  error estimate for blocks of size 2^( 4) =       0.000402373564
  error estimate for blocks of size 2^( 5) =       0.000407959821
  error estimate for blocks of size 2^( 6) =       0.000411077488
  error estimate for blocks of size 2^( 7) =       0.000413944152

      target function =      -0.945258981509
              le_mean =     -17.212622934382
             les_mean =     296.554036724626
             stat err =       0.000408838756
             autocorr =       1.243846659846
   target nu stat err =       0.000408838756
   target dn stat err =       0.001994087760
      target stat err =       0.003525230812
              std dev =       0.518430546431
             le_variance =       0.268770231472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268810211176
                                         uncertainty =       0.001392078223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268810211176
                                         uncertainty =       0.001392078223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366579890
  error estimate for blocks of size 2^( 2) =       0.000380178662
  error estimate for blocks of size 2^( 3) =       0.000392783030
  error estimate for blocks of size 2^( 4) =       0.000402373564
  error estimate for blocks of size 2^( 5) =       0.000407959821
  error estimate for blocks of size 2^( 6) =       0.000411077488
  error estimate for blocks of size 2^( 7) =       0.000413944152

      target function =      -0.945258981509
              le_mean =     -17.212622934382
             les_mean =     296.554036724626
             stat err =       0.000408838756
             autocorr =       1.243846659847
   target nu stat err =       0.000408838756
   target dn stat err =       0.001994087760
      target stat err =       0.003525230812
              std dev =       0.518430546431
             le_variance =       0.268770231472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268810211176
                                         uncertainty =       0.001392078223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268810211176
                                         uncertainty =       0.001392078223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366579890
  error estimate for blocks of size 2^( 2) =       0.000380178662
  error estimate for blocks of size 2^( 3) =       0.000392783030
  error estimate for blocks of size 2^( 4) =       0.000402373564
  error estimate for blocks of size 2^( 5) =       0.000407959821
  error estimate for blocks of size 2^( 6) =       0.000411077488
  error estimate for blocks of size 2^( 7) =       0.000413944152

      target function =      -0.945258981509
              le_mean =     -17.212622934382
             les_mean =     296.554036724626
             stat err =       0.000408838756
             autocorr =       1.243846659847
   target nu stat err =       0.000408838756
   target dn stat err =       0.001994087760
      target stat err =       0.003525230812
              std dev =       0.518430546431
             le_variance =       0.268770231472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268810211176
                                         uncertainty =       0.001392078223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268810211176
                                         uncertainty =       0.001392078223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366579890
  error estimate for blocks of size 2^( 2) =       0.000380178662
  error estimate for blocks of size 2^( 3) =       0.000392783030
  error estimate for blocks of size 2^( 4) =       0.000402373564
  error estimate for blocks of size 2^( 5) =       0.000407959821
  error estimate for blocks of size 2^( 6) =       0.000411077488
  error estimate for blocks of size 2^( 7) =       0.000413944152

      target function =      -0.945258981509
              le_mean =     -17.212622934382
             les_mean =     296.554036724626
             stat err =       0.000408838756
             autocorr =       1.243846659847
   target nu stat err =       0.000408838756
   target dn stat err =       0.001994087760
      target stat err =       0.003525230812
              std dev =       0.518430546431
             le_variance =       0.268770231472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945258981509        initial  <--
     6.1035e+49     6.1035e+50             2.7050e-54        -0.945258981509
     2.4414e+50     2.4414e+51             5.9397e-55        -0.945258981509
     9.7656e+50     9.7656e+51             1.4849e-55        -0.945258981509

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.5452
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7550e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2486
    reference variance = 0.266028
====================================================
  Execution time = 2.8397e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0406e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8066e-01
  Total weights = 1.957716557e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7762e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268812051258
                                         uncertainty =       0.001927586370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268812051258
                                         uncertainty =       0.001927586370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366577497
  error estimate for blocks of size 2^( 2) =       0.000380190324
  error estimate for blocks of size 2^( 3) =       0.000392716374
  error estimate for blocks of size 2^( 4) =       0.000402883553
  error estimate for blocks of size 2^( 5) =       0.000409368590
  error estimate for blocks of size 2^( 6) =       0.000412207431
  error estimate for blocks of size 2^( 7) =       0.000413035816

      target function =      -0.943532082147
              le_mean =     -17.211690270408
             les_mean =     296.522946620311
             stat err =       0.000409373848
             autocorr =       1.247120984995
   target nu stat err =       0.000409373848
   target dn stat err =       0.002901190492
      target stat err =       0.005040521749
              std dev =       0.518427162323
             le_variance =       0.268766722634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721169027041e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+50, overlap shift 6.1035e+51 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943557994088       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943557994088       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+51, overlap shift 2.4414e+52 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943557994088       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943557994088       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+51, overlap shift 9.7656e+52 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943557994088       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943557994088       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.308897 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7182e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2794
    reference variance = 0.295577
====================================================
  Execution time = 2.8086e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8068e-01
  Total weights = 1.9575e+06
  Execution time = 2.5029e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268750261702
                                         uncertainty =       0.001893758317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268750261702
                                         uncertainty =       0.001893758317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366552211
  error estimate for blocks of size 2^( 2) =       0.000380291867
  error estimate for blocks of size 2^( 3) =       0.000393169336
  error estimate for blocks of size 2^( 4) =       0.000402765799
  error estimate for blocks of size 2^( 5) =       0.000408555044
  error estimate for blocks of size 2^( 6) =       0.000411703329
  error estimate for blocks of size 2^( 7) =       0.000416646808

      target function =      -0.943507680248
              le_mean =     -17.211717374973
             les_mean =     296.523896541007
             stat err =       0.000409917745
             autocorr =       1.250609577185
   target nu stat err =       0.000409917745
   target dn stat err =       0.002557710311
      target stat err =       0.004457814248
              std dev =       0.518391402629
             le_variance =       0.268729646320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268750261702
                                         uncertainty =       0.001893758317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268750261702
                                         uncertainty =       0.001893758317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366552211
  error estimate for blocks of size 2^( 2) =       0.000380291867
  error estimate for blocks of size 2^( 3) =       0.000393169336
  error estimate for blocks of size 2^( 4) =       0.000402765799
  error estimate for blocks of size 2^( 5) =       0.000408555044
  error estimate for blocks of size 2^( 6) =       0.000411703329
  error estimate for blocks of size 2^( 7) =       0.000416646808

      target function =      -0.943507680248
              le_mean =     -17.211717374973
             les_mean =     296.523896541007
             stat err =       0.000409917745
             autocorr =       1.250609577185
   target nu stat err =       0.000409917745
   target dn stat err =       0.002557710311
      target stat err =       0.004457814248
              std dev =       0.518391402629
             le_variance =       0.268729646320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268750261702
                                         uncertainty =       0.001893758317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268750261702
                                         uncertainty =       0.001893758317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366552211
  error estimate for blocks of size 2^( 2) =       0.000380291867
  error estimate for blocks of size 2^( 3) =       0.000393169336
  error estimate for blocks of size 2^( 4) =       0.000402765799
  error estimate for blocks of size 2^( 5) =       0.000408555044
  error estimate for blocks of size 2^( 6) =       0.000411703329
  error estimate for blocks of size 2^( 7) =       0.000416646808

      target function =      -0.943507680248
              le_mean =     -17.211717374973
             les_mean =     296.523896541007
             stat err =       0.000409917745
             autocorr =       1.250609577185
   target nu stat err =       0.000409917745
   target dn stat err =       0.002557710311
      target stat err =       0.004457814248
              std dev =       0.518391402629
             le_variance =       0.268729646320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268750261702
                                         uncertainty =       0.001893758317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268750261702
                                         uncertainty =       0.001893758317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366552211
  error estimate for blocks of size 2^( 2) =       0.000380291867
  error estimate for blocks of size 2^( 3) =       0.000393169336
  error estimate for blocks of size 2^( 4) =       0.000402765799
  error estimate for blocks of size 2^( 5) =       0.000408555044
  error estimate for blocks of size 2^( 6) =       0.000411703329
  error estimate for blocks of size 2^( 7) =       0.000416646808

      target function =      -0.943507680248
              le_mean =     -17.211717374973
             les_mean =     296.523896541007
             stat err =       0.000409917745
             autocorr =       1.250609577185
   target nu stat err =       0.000409917745
   target dn stat err =       0.002557710311
      target stat err =       0.004457814248
              std dev =       0.518391402629
             le_variance =       0.268729646320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943507680248        initial  <--
     6.1035e+50     6.1035e+51             0.0000e+00        -0.943507680248
     2.4414e+51     2.4414e+52             0.0000e+00        -0.943507680248
     9.7656e+51     9.7656e+52             0.0000e+00        -0.943507680248

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.6615
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7850e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.1326
    reference variance = 0.129954
====================================================
  Execution time = 3.0356e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0400e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8607e-01
  Total weights = 1.957394124e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8440e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270219209115
                                         uncertainty =       0.002077604696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270219209115
                                         uncertainty =       0.002077604696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367582477
  error estimate for blocks of size 2^( 2) =       0.000381428466
  error estimate for blocks of size 2^( 3) =       0.000394198162
  error estimate for blocks of size 2^( 4) =       0.000403319488
  error estimate for blocks of size 2^( 5) =       0.000408657325
  error estimate for blocks of size 2^( 6) =       0.000411073865
  error estimate for blocks of size 2^( 7) =       0.000413721213

      target function =      -0.934296053215
              le_mean =     -17.211869467968
             les_mean =     296.534521572395
             stat err =       0.000409192973
             autocorr =       1.239215205841
   target nu stat err =       0.000409192973
   target dn stat err =       0.004173702449
      target stat err =       0.007073168582
              std dev =       0.519848441424
             le_variance =       0.270242402051


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721186946797e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+51, overlap shift 6.1035e+52 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934348330033       residual = 7.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934348330033       residual = 7.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+52, overlap shift 2.4414e+53 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934348330033       residual = 7.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934348330033       residual = 7.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+52, overlap shift 9.7656e+53 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934348330033       residual = 7.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934348330033       residual = 7.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.310206 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9208e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2419
    reference variance = 0.327337
====================================================
  Execution time = 2.8017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7439e-01
  Total weights = 1.9573e+06
  Execution time = 2.5190e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265868730300
                                         uncertainty =       0.001566916952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265868730300
                                         uncertainty =       0.001566916952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364595158
  error estimate for blocks of size 2^( 2) =       0.000378343793
  error estimate for blocks of size 2^( 3) =       0.000391726691
  error estimate for blocks of size 2^( 4) =       0.000400948299
  error estimate for blocks of size 2^( 5) =       0.000407585316
  error estimate for blocks of size 2^( 6) =       0.000410795689
  error estimate for blocks of size 2^( 7) =       0.000413284001

      target function =      -0.954431683141
              le_mean =     -17.212433987840
             les_mean =     296.542278161273
             stat err =       0.000408153326
             autocorr =       1.253212985566
   target nu stat err =       0.000408153326
   target dn stat err =       0.001725107620
      target stat err =       0.003129354204
              std dev =       0.515623666979
             le_variance =       0.265867765949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265868730300
                                         uncertainty =       0.001566916952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265868730300
                                         uncertainty =       0.001566916952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364595158
  error estimate for blocks of size 2^( 2) =       0.000378343793
  error estimate for blocks of size 2^( 3) =       0.000391726691
  error estimate for blocks of size 2^( 4) =       0.000400948299
  error estimate for blocks of size 2^( 5) =       0.000407585316
  error estimate for blocks of size 2^( 6) =       0.000410795689
  error estimate for blocks of size 2^( 7) =       0.000413284001

      target function =      -0.954431683141
              le_mean =     -17.212433987840
             les_mean =     296.542278161273
             stat err =       0.000408153326
             autocorr =       1.253212985566
   target nu stat err =       0.000408153326
   target dn stat err =       0.001725107620
      target stat err =       0.003129354204
              std dev =       0.515623666979
             le_variance =       0.265867765949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265868730300
                                         uncertainty =       0.001566916952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265868730300
                                         uncertainty =       0.001566916952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364595158
  error estimate for blocks of size 2^( 2) =       0.000378343793
  error estimate for blocks of size 2^( 3) =       0.000391726691
  error estimate for blocks of size 2^( 4) =       0.000400948299
  error estimate for blocks of size 2^( 5) =       0.000407585316
  error estimate for blocks of size 2^( 6) =       0.000410795689
  error estimate for blocks of size 2^( 7) =       0.000413284001

      target function =      -0.954431683141
              le_mean =     -17.212433987840
             les_mean =     296.542278161273
             stat err =       0.000408153326
             autocorr =       1.253212985566
   target nu stat err =       0.000408153326
   target dn stat err =       0.001725107620
      target stat err =       0.003129354204
              std dev =       0.515623666979
             le_variance =       0.265867765949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265868730300
                                         uncertainty =       0.001566916952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265868730300
                                         uncertainty =       0.001566916952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364595158
  error estimate for blocks of size 2^( 2) =       0.000378343793
  error estimate for blocks of size 2^( 3) =       0.000391726691
  error estimate for blocks of size 2^( 4) =       0.000400948299
  error estimate for blocks of size 2^( 5) =       0.000407585316
  error estimate for blocks of size 2^( 6) =       0.000410795689
  error estimate for blocks of size 2^( 7) =       0.000413284001

      target function =      -0.954431683141
              le_mean =     -17.212433987840
             les_mean =     296.542278161273
             stat err =       0.000408153326
             autocorr =       1.253212985566
   target nu stat err =       0.000408153326
   target dn stat err =       0.001725107620
      target stat err =       0.003129354204
              std dev =       0.515623666979
             le_variance =       0.265867765949


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.954431683141        initial  <--
     6.1035e+51     6.1035e+52             0.0000e+00        -0.954431683141
     2.4414e+52     2.4414e+53             0.0000e+00        -0.954431683141
     9.7656e+52     9.7656e+53             0.0000e+00        -0.954431683141

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.6944
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9909e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2511
    reference variance = 0.168888
====================================================
  Execution time = 2.8423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0388e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8438e-01
  Total weights = 1.957152246e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6469e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269803983930
                                         uncertainty =       0.001482066191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269803983930
                                         uncertainty =       0.001482066191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367404350
  error estimate for blocks of size 2^( 2) =       0.000381148306
  error estimate for blocks of size 2^( 3) =       0.000393662157
  error estimate for blocks of size 2^( 4) =       0.000402765659
  error estimate for blocks of size 2^( 5) =       0.000407398474
  error estimate for blocks of size 2^( 6) =       0.000410338748
  error estimate for blocks of size 2^( 7) =       0.000413187990

      target function =      -0.937195144683
              le_mean =     -17.211690037800
             les_mean =     296.526653647162
             stat err =       0.000408422718
             autocorr =       1.235751633355
   target nu stat err =       0.000408422718
   target dn stat err =       0.002699916979
      target stat err =       0.004636351461
              std dev =       0.519596528625
             le_variance =       0.269980552560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721169003780e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+52, overlap shift 6.1035e+53 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937217221792       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937217221792       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+53, overlap shift 2.4414e+54 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937217221792       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937217221792       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+53, overlap shift 9.7656e+54 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937217221792       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937217221792       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.311544 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7079e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.1963
    reference variance = 0.273655
====================================================
  Execution time = 2.8121e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8563e-01
  Total weights = 1.9573e+06
  Execution time = 2.5020e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269858177313
                                         uncertainty =       0.001485341283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269858177313
                                         uncertainty =       0.001485341283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367375445
  error estimate for blocks of size 2^( 2) =       0.000381045620
  error estimate for blocks of size 2^( 3) =       0.000393807875
  error estimate for blocks of size 2^( 4) =       0.000402828064
  error estimate for blocks of size 2^( 5) =       0.000408199178
  error estimate for blocks of size 2^( 6) =       0.000410934265
  error estimate for blocks of size 2^( 7) =       0.000412887156

      target function =      -0.935036051864
              le_mean =     -17.212109454790
             les_mean =     296.542345316712
             stat err =       0.000408712166
             autocorr =       1.237698545663
   target nu stat err =       0.000408712166
   target dn stat err =       0.003484997381
      target stat err =       0.005931822314
              std dev =       0.519555648987
             le_variance =       0.269938072394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269858177313
                                         uncertainty =       0.001485341283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269858177313
                                         uncertainty =       0.001485341283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367375445
  error estimate for blocks of size 2^( 2) =       0.000381045620
  error estimate for blocks of size 2^( 3) =       0.000393807875
  error estimate for blocks of size 2^( 4) =       0.000402828064
  error estimate for blocks of size 2^( 5) =       0.000408199178
  error estimate for blocks of size 2^( 6) =       0.000410934265
  error estimate for blocks of size 2^( 7) =       0.000412887156

      target function =      -0.935036051864
              le_mean =     -17.212109454790
             les_mean =     296.542345316712
             stat err =       0.000408712166
             autocorr =       1.237698545663
   target nu stat err =       0.000408712166
   target dn stat err =       0.003484997381
      target stat err =       0.005931822314
              std dev =       0.519555648987
             le_variance =       0.269938072394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269858177313
                                         uncertainty =       0.001485341283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269858177313
                                         uncertainty =       0.001485341283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367375445
  error estimate for blocks of size 2^( 2) =       0.000381045620
  error estimate for blocks of size 2^( 3) =       0.000393807875
  error estimate for blocks of size 2^( 4) =       0.000402828064
  error estimate for blocks of size 2^( 5) =       0.000408199178
  error estimate for blocks of size 2^( 6) =       0.000410934265
  error estimate for blocks of size 2^( 7) =       0.000412887156

      target function =      -0.935036051864
              le_mean =     -17.212109454790
             les_mean =     296.542345316712
             stat err =       0.000408712166
             autocorr =       1.237698545663
   target nu stat err =       0.000408712166
   target dn stat err =       0.003484997381
      target stat err =       0.005931822314
              std dev =       0.519555648987
             le_variance =       0.269938072394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269858177313
                                         uncertainty =       0.001485341283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269858177313
                                         uncertainty =       0.001485341283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367375445
  error estimate for blocks of size 2^( 2) =       0.000381045620
  error estimate for blocks of size 2^( 3) =       0.000393807875
  error estimate for blocks of size 2^( 4) =       0.000402828064
  error estimate for blocks of size 2^( 5) =       0.000408199178
  error estimate for blocks of size 2^( 6) =       0.000410934265
  error estimate for blocks of size 2^( 7) =       0.000412887156

      target function =      -0.935036051864
              le_mean =     -17.212109454790
             les_mean =     296.542345316712
             stat err =       0.000408712166
             autocorr =       1.237698545663
   target nu stat err =       0.000408712166
   target dn stat err =       0.003484997381
      target stat err =       0.005931822314
              std dev =       0.519555648987
             le_variance =       0.269938072394


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935036051864        initial  <--
     6.1035e+52     6.1035e+53             0.0000e+00        -0.935036051864
     2.4414e+53     2.4414e+54             0.0000e+00        -0.935036051864
     9.7656e+53     9.7656e+54             0.0000e+00        -0.935036051864

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7358
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7821e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2631
    reference variance = 0.167008
====================================================
  Execution time = 2.8012e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0392e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8182e-01
  Total weights = 1.957191156e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7357e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269143492227
                                         uncertainty =       0.001803777303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269143492227
                                         uncertainty =       0.001803777303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366805475
  error estimate for blocks of size 2^( 2) =       0.000380425229
  error estimate for blocks of size 2^( 3) =       0.000393142128
  error estimate for blocks of size 2^( 4) =       0.000402436162
  error estimate for blocks of size 2^( 5) =       0.000409973301
  error estimate for blocks of size 2^( 6) =       0.000413045313
  error estimate for blocks of size 2^( 7) =       0.000415231545

      target function =      -0.941528838027
              le_mean =     -17.212460187139
             les_mean =     296.550601840363
             stat err =       0.000410171580
             autocorr =       1.250430373601
   target nu stat err =       0.000410171580
   target dn stat err =       0.002531425442
      target stat err =       0.004401451705
              std dev =       0.518749576638
             le_variance =       0.269101123262


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721246018714e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+53, overlap shift 6.1035e+54 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941548423645       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941548423645       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.52e+01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+53 is 2.104861e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+54, overlap shift 2.4414e+55 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941548423645       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941548423645       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.52e+01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+54 is 5.262152e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+54, overlap shift 9.7656e+55 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941548423645       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941548423645       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.52e+01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+54 is 1.315538e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.313185 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6759e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.1488
    reference variance = 0.257216
====================================================
  Execution time = 2.8343e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7690e-01
  Total weights = 1.9575e+06
  Execution time = 2.5124e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266425090685
                                         uncertainty =       0.001442626332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266425090685
                                         uncertainty =       0.001442626332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364949231
  error estimate for blocks of size 2^( 2) =       0.000378598751
  error estimate for blocks of size 2^( 3) =       0.000390993010
  error estimate for blocks of size 2^( 4) =       0.000400230590
  error estimate for blocks of size 2^( 5) =       0.000406966369
  error estimate for blocks of size 2^( 6) =       0.000411188620
  error estimate for blocks of size 2^( 7) =       0.000412979669

      target function =      -0.950032810135
              le_mean =     -17.212575566309
             les_mean =     296.549658790550
             stat err =       0.000407841312
             autocorr =       1.248870840436
   target nu stat err =       0.000407841312
   target dn stat err =       0.001824549785
      target stat err =       0.003270781152
              std dev =       0.516124409234
             le_variance =       0.266384405808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266425090685
                                         uncertainty =       0.001442626332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266425090685
                                         uncertainty =       0.001442626332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364949231
  error estimate for blocks of size 2^( 2) =       0.000378598751
  error estimate for blocks of size 2^( 3) =       0.000390993010
  error estimate for blocks of size 2^( 4) =       0.000400230590
  error estimate for blocks of size 2^( 5) =       0.000406966369
  error estimate for blocks of size 2^( 6) =       0.000411188620
  error estimate for blocks of size 2^( 7) =       0.000412979669

      target function =      -0.950032810135
              le_mean =     -17.212575566309
             les_mean =     296.549658790550
             stat err =       0.000407841312
             autocorr =       1.248870840437
   target nu stat err =       0.000407841312
   target dn stat err =       0.001824549785
      target stat err =       0.003270781152
              std dev =       0.516124409234
             le_variance =       0.266384405808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266425090685
                                         uncertainty =       0.001442626332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266425090685
                                         uncertainty =       0.001442626332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364949231
  error estimate for blocks of size 2^( 2) =       0.000378598751
  error estimate for blocks of size 2^( 3) =       0.000390993010
  error estimate for blocks of size 2^( 4) =       0.000400230590
  error estimate for blocks of size 2^( 5) =       0.000406966369
  error estimate for blocks of size 2^( 6) =       0.000411188620
  error estimate for blocks of size 2^( 7) =       0.000412979669

      target function =      -0.950032810135
              le_mean =     -17.212575566309
             les_mean =     296.549658790550
             stat err =       0.000407841312
             autocorr =       1.248870840437
   target nu stat err =       0.000407841312
   target dn stat err =       0.001824549785
      target stat err =       0.003270781152
              std dev =       0.516124409234
             le_variance =       0.266384405808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266425090685
                                         uncertainty =       0.001442626332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266425090685
                                         uncertainty =       0.001442626332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364949231
  error estimate for blocks of size 2^( 2) =       0.000378598751
  error estimate for blocks of size 2^( 3) =       0.000390993010
  error estimate for blocks of size 2^( 4) =       0.000400230590
  error estimate for blocks of size 2^( 5) =       0.000406966369
  error estimate for blocks of size 2^( 6) =       0.000411188620
  error estimate for blocks of size 2^( 7) =       0.000412979669

      target function =      -0.950032810135
              le_mean =     -17.212575566309
             les_mean =     296.549658790550
             stat err =       0.000407841312
             autocorr =       1.248870840437
   target nu stat err =       0.000407841312
   target dn stat err =       0.001824549785
      target stat err =       0.003270781152
              std dev =       0.516124409234
             le_variance =       0.266384405808


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950032810135        initial  <--
     6.1035e+53     6.1035e+54             2.1049e-58        -0.950032810135
     2.4414e+54     2.4414e+55             5.2622e-59        -0.950032810135
     9.7656e+54     9.7656e+55             1.3155e-59        -0.950032810135

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0132
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7780e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2751
    reference variance = 1.10306
====================================================
  Execution time = 2.8178e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0390e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7619e-01
  Total weights = 1.957675602e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6791e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264673680642
                                         uncertainty =       0.001479495847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264673680642
                                         uncertainty =       0.001479495847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363728867
  error estimate for blocks of size 2^( 2) =       0.000377711940
  error estimate for blocks of size 2^( 3) =       0.000390312285
  error estimate for blocks of size 2^( 4) =       0.000400183950
  error estimate for blocks of size 2^( 5) =       0.000405690609
  error estimate for blocks of size 2^( 6) =       0.000409159165
  error estimate for blocks of size 2^( 7) =       0.000410097538

      target function =      -0.951277378160
              le_mean =     -17.212119243015
             les_mean =     296.533240811683
             stat err =       0.000406282815
             autocorr =       1.247674698088
   target nu stat err =       0.000406282815
   target dn stat err =       0.002390478348
      target stat err =       0.004244837775
              std dev =       0.514398526421
             le_variance =       0.264605843984


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721211924301e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+54, overlap shift 6.1035e+55 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951295149932       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951295149932       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+55, overlap shift 2.4414e+56 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951295149932       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951295149932       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+55, overlap shift 9.7656e+56 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951295149932       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951295149932       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.314514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6866e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2163
    reference variance = 0.155311
====================================================
  Execution time = 2.8430e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7891e-01
  Total weights = 1.9571e+06
  Execution time = 2.5169e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267465434919
                                         uncertainty =       0.001446074199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267465434919
                                         uncertainty =       0.001446074199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365676650
  error estimate for blocks of size 2^( 2) =       0.000379708662
  error estimate for blocks of size 2^( 3) =       0.000392589591
  error estimate for blocks of size 2^( 4) =       0.000402117977
  error estimate for blocks of size 2^( 5) =       0.000407786202
  error estimate for blocks of size 2^( 6) =       0.000409855245
  error estimate for blocks of size 2^( 7) =       0.000414012299

      target function =      -0.946575595061
              le_mean =     -17.211519446900
             les_mean =     296.515309697920
             stat err =       0.000408442931
             autocorr =       1.247579721744
   target nu stat err =       0.000408442931
   target dn stat err =       0.002326465750
      target stat err =       0.004090598644
              std dev =       0.517153152586
             le_variance =       0.267447383230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267465434919
                                         uncertainty =       0.001446074199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267465434919
                                         uncertainty =       0.001446074199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365676650
  error estimate for blocks of size 2^( 2) =       0.000379708662
  error estimate for blocks of size 2^( 3) =       0.000392589591
  error estimate for blocks of size 2^( 4) =       0.000402117977
  error estimate for blocks of size 2^( 5) =       0.000407786202
  error estimate for blocks of size 2^( 6) =       0.000409855245
  error estimate for blocks of size 2^( 7) =       0.000414012299

      target function =      -0.946575595061
              le_mean =     -17.211519446900
             les_mean =     296.515309697920
             stat err =       0.000408442931
             autocorr =       1.247579721744
   target nu stat err =       0.000408442931
   target dn stat err =       0.002326465750
      target stat err =       0.004090598644
              std dev =       0.517153152586
             le_variance =       0.267447383230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267465434919
                                         uncertainty =       0.001446074199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267465434919
                                         uncertainty =       0.001446074199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365676650
  error estimate for blocks of size 2^( 2) =       0.000379708662
  error estimate for blocks of size 2^( 3) =       0.000392589591
  error estimate for blocks of size 2^( 4) =       0.000402117977
  error estimate for blocks of size 2^( 5) =       0.000407786202
  error estimate for blocks of size 2^( 6) =       0.000409855245
  error estimate for blocks of size 2^( 7) =       0.000414012299

      target function =      -0.946575595061
              le_mean =     -17.211519446900
             les_mean =     296.515309697920
             stat err =       0.000408442931
             autocorr =       1.247579721744
   target nu stat err =       0.000408442931
   target dn stat err =       0.002326465750
      target stat err =       0.004090598644
              std dev =       0.517153152586
             le_variance =       0.267447383230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267465434919
                                         uncertainty =       0.001446074199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267465434919
                                         uncertainty =       0.001446074199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365676650
  error estimate for blocks of size 2^( 2) =       0.000379708662
  error estimate for blocks of size 2^( 3) =       0.000392589591
  error estimate for blocks of size 2^( 4) =       0.000402117977
  error estimate for blocks of size 2^( 5) =       0.000407786202
  error estimate for blocks of size 2^( 6) =       0.000409855245
  error estimate for blocks of size 2^( 7) =       0.000414012299

      target function =      -0.946575595061
              le_mean =     -17.211519446900
             les_mean =     296.515309697920
             stat err =       0.000408442931
             autocorr =       1.247579721744
   target nu stat err =       0.000408442931
   target dn stat err =       0.002326465750
      target stat err =       0.004090598644
              std dev =       0.517153152586
             le_variance =       0.267447383230


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946575595061        initial  <--
     6.1035e+54     6.1035e+55             0.0000e+00        -0.946575595061
     2.4414e+55     2.4414e+56             0.0000e+00        -0.946575595061
     9.7656e+55     9.7656e+56             0.0000e+00        -0.946575595061

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.1374
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8010e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1961
    reference variance = 0.20493
====================================================
  Execution time = 3.0748e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0407e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7778e-01
  Total weights = 1.957222500e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6441e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267569685856
                                         uncertainty =       0.001763068680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267569685856
                                         uncertainty =       0.001763068680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365711606
  error estimate for blocks of size 2^( 2) =       0.000379261606
  error estimate for blocks of size 2^( 3) =       0.000391558710
  error estimate for blocks of size 2^( 4) =       0.000401200954
  error estimate for blocks of size 2^( 5) =       0.000406197770
  error estimate for blocks of size 2^( 6) =       0.000408912604
  error estimate for blocks of size 2^( 7) =       0.000412878340

      target function =      -0.948517005393
              le_mean =     -17.212159216286
             les_mean =     296.536202565251
             stat err =       0.000407297417
             autocorr =       1.240354497919
   target nu stat err =       0.000407297417
   target dn stat err =       0.002045720985
      target stat err =       0.003633033546
              std dev =       0.517202587908
             le_variance =       0.267498516939


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721215921629e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+55, overlap shift 6.1035e+56 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948529953897       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948529953897       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948529953897       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+55 is 2.261516e-60

solving harmonic davidson linear method for identity shift 2.4414e+56, overlap shift 2.4414e+57 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948529953897       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948529953897       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948529953897       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+56 is 5.653791e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+56, overlap shift 9.7656e+57 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948529953897       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948529953897       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948529953897       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+56 is 1.413448e-61

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.316190 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9401e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.0744
    reference variance = 0.300229
====================================================
  Execution time = 2.8427e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7637e-01
  Total weights = 1.9573e+06
  Execution time = 2.5085e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265286504632
                                         uncertainty =       0.001418368433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265286504632
                                         uncertainty =       0.001418368433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364236700
  error estimate for blocks of size 2^( 2) =       0.000378373175
  error estimate for blocks of size 2^( 3) =       0.000391012643
  error estimate for blocks of size 2^( 4) =       0.000400456640
  error estimate for blocks of size 2^( 5) =       0.000406269065
  error estimate for blocks of size 2^( 6) =       0.000409746466
  error estimate for blocks of size 2^( 7) =       0.000412139755

      target function =      -0.950994354788
              le_mean =     -17.211622049302
             les_mean =     296.516298631198
             stat err =       0.000407152982
             autocorr =       1.249533298462
   target nu stat err =       0.000407152982
   target dn stat err =       0.001975361368
      target stat err =       0.003527684874
              std dev =       0.515116722845
             le_variance =       0.265345238155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265286504632
                                         uncertainty =       0.001418368433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265286504632
                                         uncertainty =       0.001418368433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364236700
  error estimate for blocks of size 2^( 2) =       0.000378373175
  error estimate for blocks of size 2^( 3) =       0.000391012643
  error estimate for blocks of size 2^( 4) =       0.000400456640
  error estimate for blocks of size 2^( 5) =       0.000406269065
  error estimate for blocks of size 2^( 6) =       0.000409746466
  error estimate for blocks of size 2^( 7) =       0.000412139755

      target function =      -0.950994354788
              le_mean =     -17.211622049302
             les_mean =     296.516298631198
             stat err =       0.000407152982
             autocorr =       1.249533298462
   target nu stat err =       0.000407152982
   target dn stat err =       0.001975361368
      target stat err =       0.003527684874
              std dev =       0.515116722845
             le_variance =       0.265345238155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265286504632
                                         uncertainty =       0.001418368433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265286504632
                                         uncertainty =       0.001418368433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364236700
  error estimate for blocks of size 2^( 2) =       0.000378373175
  error estimate for blocks of size 2^( 3) =       0.000391012643
  error estimate for blocks of size 2^( 4) =       0.000400456640
  error estimate for blocks of size 2^( 5) =       0.000406269065
  error estimate for blocks of size 2^( 6) =       0.000409746466
  error estimate for blocks of size 2^( 7) =       0.000412139755

      target function =      -0.950994354788
              le_mean =     -17.211622049302
             les_mean =     296.516298631198
             stat err =       0.000407152982
             autocorr =       1.249533298462
   target nu stat err =       0.000407152982
   target dn stat err =       0.001975361368
      target stat err =       0.003527684874
              std dev =       0.515116722845
             le_variance =       0.265345238155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265286504632
                                         uncertainty =       0.001418368433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265286504632
                                         uncertainty =       0.001418368433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364236700
  error estimate for blocks of size 2^( 2) =       0.000378373175
  error estimate for blocks of size 2^( 3) =       0.000391012643
  error estimate for blocks of size 2^( 4) =       0.000400456640
  error estimate for blocks of size 2^( 5) =       0.000406269065
  error estimate for blocks of size 2^( 6) =       0.000409746466
  error estimate for blocks of size 2^( 7) =       0.000412139755

      target function =      -0.950994354788
              le_mean =     -17.211622049302
             les_mean =     296.516298631198
             stat err =       0.000407152982
             autocorr =       1.249533298462
   target nu stat err =       0.000407152982
   target dn stat err =       0.001975361368
      target stat err =       0.003527684874
              std dev =       0.515116722845
             le_variance =       0.265345238155


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950994354788        initial  <--
     6.1035e+55     6.1035e+56             2.2615e-60        -0.950994354788
     2.4414e+56     2.4414e+57             5.6538e-61        -0.950994354788
     9.7656e+56     9.7656e+57             1.4134e-61        -0.950994354788

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0808
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0493e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2614
    reference variance = 0.203994
====================================================
  Execution time = 2.8076e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0369e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7846e-01
  Total weights = 1.957128468e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8995e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267832789818
                                         uncertainty =       0.001754406989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267832789818
                                         uncertainty =       0.001754406989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365922940
  error estimate for blocks of size 2^( 2) =       0.000379651896
  error estimate for blocks of size 2^( 3) =       0.000392401683
  error estimate for blocks of size 2^( 4) =       0.000402552462
  error estimate for blocks of size 2^( 5) =       0.000408692688
  error estimate for blocks of size 2^( 6) =       0.000412124409
  error estimate for blocks of size 2^( 7) =       0.000412274158

      target function =      -0.947344810834
              le_mean =     -17.211451661384
             les_mean =     296.512532826957
             stat err =       0.000408910929
             autocorr =       1.248757654654
   target nu stat err =       0.000408910929
   target dn stat err =       0.002352121369
      target stat err =       0.004140443124
              std dev =       0.517501464613
             le_variance =       0.267807765877


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721145166138e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+56, overlap shift 6.1035e+57 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947361642826       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947361642826       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947361642826       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.58e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+56 is 2.929572e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+57, overlap shift 2.4414e+58 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947361642826       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947361642826       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947361642826       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+57 is 7.323929e-62

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+57, overlap shift 9.7656e+58 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947361642826       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947361642826       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947361642826       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.58e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+57 is 1.830982e-62

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.318113 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6987e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.1984
    reference variance = 0.344896
====================================================
  Execution time = 2.7975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7604e-01
  Total weights = 1.9574e+06
  Execution time = 2.5261e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265631530328
                                         uncertainty =       0.001508444553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265631530328
                                         uncertainty =       0.001508444553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364436691
  error estimate for blocks of size 2^( 2) =       0.000378797346
  error estimate for blocks of size 2^( 3) =       0.000391653188
  error estimate for blocks of size 2^( 4) =       0.000401303711
  error estimate for blocks of size 2^( 5) =       0.000407104353
  error estimate for blocks of size 2^( 6) =       0.000411040795
  error estimate for blocks of size 2^( 7) =       0.000415406465

      target function =      -0.951572180541
              le_mean =     -17.211282617681
             les_mean =     296.504289079566
             stat err =       0.000408713831
             autocorr =       1.257750449727
   target nu stat err =       0.000408713831
   target dn stat err =       0.001865940554
      target stat err =       0.003343695898
              std dev =       0.515399556826
             le_variance =       0.265636703176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265631530328
                                         uncertainty =       0.001508444553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265631530328
                                         uncertainty =       0.001508444553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364436691
  error estimate for blocks of size 2^( 2) =       0.000378797346
  error estimate for blocks of size 2^( 3) =       0.000391653188
  error estimate for blocks of size 2^( 4) =       0.000401303711
  error estimate for blocks of size 2^( 5) =       0.000407104353
  error estimate for blocks of size 2^( 6) =       0.000411040795
  error estimate for blocks of size 2^( 7) =       0.000415406465

      target function =      -0.951572180541
              le_mean =     -17.211282617681
             les_mean =     296.504289079566
             stat err =       0.000408713831
             autocorr =       1.257750449727
   target nu stat err =       0.000408713831
   target dn stat err =       0.001865940554
      target stat err =       0.003343695898
              std dev =       0.515399556826
             le_variance =       0.265636703176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265631530328
                                         uncertainty =       0.001508444553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265631530328
                                         uncertainty =       0.001508444553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364436691
  error estimate for blocks of size 2^( 2) =       0.000378797346
  error estimate for blocks of size 2^( 3) =       0.000391653188
  error estimate for blocks of size 2^( 4) =       0.000401303711
  error estimate for blocks of size 2^( 5) =       0.000407104353
  error estimate for blocks of size 2^( 6) =       0.000411040795
  error estimate for blocks of size 2^( 7) =       0.000415406465

      target function =      -0.951572180541
              le_mean =     -17.211282617681
             les_mean =     296.504289079566
             stat err =       0.000408713831
             autocorr =       1.257750449727
   target nu stat err =       0.000408713831
   target dn stat err =       0.001865940554
      target stat err =       0.003343695898
              std dev =       0.515399556826
             le_variance =       0.265636703176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265631530328
                                         uncertainty =       0.001508444553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265631530328
                                         uncertainty =       0.001508444553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364436691
  error estimate for blocks of size 2^( 2) =       0.000378797346
  error estimate for blocks of size 2^( 3) =       0.000391653188
  error estimate for blocks of size 2^( 4) =       0.000401303711
  error estimate for blocks of size 2^( 5) =       0.000407104353
  error estimate for blocks of size 2^( 6) =       0.000411040795
  error estimate for blocks of size 2^( 7) =       0.000415406465

      target function =      -0.951572180541
              le_mean =     -17.211282617681
             les_mean =     296.504289079566
             stat err =       0.000408713831
             autocorr =       1.257750449727
   target nu stat err =       0.000408713831
   target dn stat err =       0.001865940554
      target stat err =       0.003343695898
              std dev =       0.515399556826
             le_variance =       0.265636703176


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951572180541        initial  <--
     6.1035e+56     6.1035e+57             2.9296e-61        -0.951572180541
     2.4414e+57     2.4414e+58             7.3239e-62        -0.951572180541
     9.7656e+57     9.7656e+58             1.8310e-62        -0.951572180541

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.6711
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7666e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1912
    reference variance = 0.288417
====================================================
  Execution time = 2.8384e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0392e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8186e-01
  Total weights = 1.957272982e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7010e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269314982782
                                         uncertainty =       0.001907674156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269314982782
                                         uncertainty =       0.001907674156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366972822
  error estimate for blocks of size 2^( 2) =       0.000380536337
  error estimate for blocks of size 2^( 3) =       0.000392982970
  error estimate for blocks of size 2^( 4) =       0.000401590795
  error estimate for blocks of size 2^( 5) =       0.000406422165
  error estimate for blocks of size 2^( 6) =       0.000409673767
  error estimate for blocks of size 2^( 7) =       0.000412316821

      target function =      -0.941437575306
              le_mean =     -17.212568637517
             les_mean =     296.554383646756
             stat err =       0.000407500887
             autocorr =       1.233074490777
   target nu stat err =       0.000407500887
   target dn stat err =       0.002735372713
      target stat err =       0.004745570077
              std dev =       0.518986246001
             le_variance =       0.269346723538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721256863752e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+57, overlap shift 6.1035e+58 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941460369315       residual = 9.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941460369315       residual = 9.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+58, overlap shift 2.4414e+59 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941460369315       residual = 9.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941460369315       residual = 9.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+58, overlap shift 9.7656e+59 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941460369315       residual = 9.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941460369315       residual = 9.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.319441 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7094e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1448
    reference variance = 0.322651
====================================================
  Execution time = 2.8081e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8441e-01
  Total weights = 1.9577e+06
  Execution time = 2.5148e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270974181166
                                         uncertainty =       0.003141737293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270974181166
                                         uncertainty =       0.003141737293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368041463
  error estimate for blocks of size 2^( 2) =       0.000381541202
  error estimate for blocks of size 2^( 3) =       0.000394337070
  error estimate for blocks of size 2^( 4) =       0.000403994281
  error estimate for blocks of size 2^( 5) =       0.000409703840
  error estimate for blocks of size 2^( 6) =       0.000412678875
  error estimate for blocks of size 2^( 7) =       0.000416287566

      target function =      -0.937078695972
              le_mean =     -17.212228912741
             les_mean =     296.545237712310
             stat err =       0.000410666141
             autocorr =       1.245042842688
   target nu stat err =       0.000410666141
   target dn stat err =       0.004161474636
      target stat err =       0.007099720333
              std dev =       0.520497556633
             le_variance =       0.270917706461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270974181166
                                         uncertainty =       0.003141737293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270974181166
                                         uncertainty =       0.003141737293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368041463
  error estimate for blocks of size 2^( 2) =       0.000381541202
  error estimate for blocks of size 2^( 3) =       0.000394337070
  error estimate for blocks of size 2^( 4) =       0.000403994281
  error estimate for blocks of size 2^( 5) =       0.000409703840
  error estimate for blocks of size 2^( 6) =       0.000412678875
  error estimate for blocks of size 2^( 7) =       0.000416287566

      target function =      -0.937078695972
              le_mean =     -17.212228912741
             les_mean =     296.545237712310
             stat err =       0.000410666141
             autocorr =       1.245042842687
   target nu stat err =       0.000410666141
   target dn stat err =       0.004161474636
      target stat err =       0.007099720333
              std dev =       0.520497556633
             le_variance =       0.270917706461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270974181166
                                         uncertainty =       0.003141737293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270974181166
                                         uncertainty =       0.003141737293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368041463
  error estimate for blocks of size 2^( 2) =       0.000381541202
  error estimate for blocks of size 2^( 3) =       0.000394337070
  error estimate for blocks of size 2^( 4) =       0.000403994281
  error estimate for blocks of size 2^( 5) =       0.000409703840
  error estimate for blocks of size 2^( 6) =       0.000412678875
  error estimate for blocks of size 2^( 7) =       0.000416287566

      target function =      -0.937078695972
              le_mean =     -17.212228912741
             les_mean =     296.545237712310
             stat err =       0.000410666141
             autocorr =       1.245042842687
   target nu stat err =       0.000410666141
   target dn stat err =       0.004161474636
      target stat err =       0.007099720333
              std dev =       0.520497556633
             le_variance =       0.270917706461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270974181166
                                         uncertainty =       0.003141737293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270974181166
                                         uncertainty =       0.003141737293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368041463
  error estimate for blocks of size 2^( 2) =       0.000381541202
  error estimate for blocks of size 2^( 3) =       0.000394337070
  error estimate for blocks of size 2^( 4) =       0.000403994281
  error estimate for blocks of size 2^( 5) =       0.000409703840
  error estimate for blocks of size 2^( 6) =       0.000412678875
  error estimate for blocks of size 2^( 7) =       0.000416287566

      target function =      -0.937078695972
              le_mean =     -17.212228912741
             les_mean =     296.545237712310
             stat err =       0.000410666141
             autocorr =       1.245042842687
   target nu stat err =       0.000410666141
   target dn stat err =       0.004161474636
      target stat err =       0.007099720333
              std dev =       0.520497556633
             le_variance =       0.270917706461


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937078695972        initial  <--
     6.1035e+57     6.1035e+58             0.0000e+00        -0.937078695972
     2.4414e+58     2.4414e+59             0.0000e+00        -0.937078695972
     9.7656e+58     9.7656e+59             0.0000e+00        -0.937078695972

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7782
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7879e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.0719
    reference variance = 0.21829
====================================================
  Execution time = 2.8118e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0390e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7741e-01
  Total weights = 1.957302249e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9447e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267713827909
                                         uncertainty =       0.001457217601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267713827909
                                         uncertainty =       0.001457217601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365818934
  error estimate for blocks of size 2^( 2) =       0.000379545436
  error estimate for blocks of size 2^( 3) =       0.000392435907
  error estimate for blocks of size 2^( 4) =       0.000401651308
  error estimate for blocks of size 2^( 5) =       0.000406552833
  error estimate for blocks of size 2^( 6) =       0.000408849566
  error estimate for blocks of size 2^( 7) =       0.000411401894

      target function =      -0.949164799021
              le_mean =     -17.212206634257
             les_mean =     296.537462911473
             stat err =       0.000407113900
             autocorr =       1.238509956621
   target nu stat err =       0.000407113900
   target dn stat err =       0.001861972389
      target stat err =       0.003325774267
              std dev =       0.517354375418
             le_variance =       0.267655549764


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721220663426e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+58, overlap shift 6.1035e+59 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949175424490       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949175424490       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+59, overlap shift 2.4414e+60 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949175424490       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949175424490       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+59, overlap shift 9.7656e+60 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949175424490       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949175424490       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.320769 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7071e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.1593
    reference variance = 0.273026
====================================================
  Execution time = 2.7961e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8448e-01
  Total weights = 1.9572e+06
  Execution time = 2.7090e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270402158015
                                         uncertainty =       0.001926785042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270402158015
                                         uncertainty =       0.001926785042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367741026
  error estimate for blocks of size 2^( 2) =       0.000381669364
  error estimate for blocks of size 2^( 3) =       0.000393925426
  error estimate for blocks of size 2^( 4) =       0.000403381892
  error estimate for blocks of size 2^( 5) =       0.000409200231
  error estimate for blocks of size 2^( 6) =       0.000412612374
  error estimate for blocks of size 2^( 7) =       0.000414811994

      target function =      -0.936986504002
              le_mean =     -17.212187667012
             les_mean =     296.543886616832
             stat err =       0.000410001623
             autocorr =       1.243045380850
   target nu stat err =       0.000410001623
   target dn stat err =       0.003172284949
      target stat err =       0.005431673587
              std dev =       0.520072667866
             le_variance =       0.270475579861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270402158015
                                         uncertainty =       0.001926785042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270402158015
                                         uncertainty =       0.001926785042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367741026
  error estimate for blocks of size 2^( 2) =       0.000381669364
  error estimate for blocks of size 2^( 3) =       0.000393925426
  error estimate for blocks of size 2^( 4) =       0.000403381892
  error estimate for blocks of size 2^( 5) =       0.000409200231
  error estimate for blocks of size 2^( 6) =       0.000412612374
  error estimate for blocks of size 2^( 7) =       0.000414811994

      target function =      -0.936986504002
              le_mean =     -17.212187667012
             les_mean =     296.543886616832
             stat err =       0.000410001623
             autocorr =       1.243045380851
   target nu stat err =       0.000410001623
   target dn stat err =       0.003172284949
      target stat err =       0.005431673587
              std dev =       0.520072667866
             le_variance =       0.270475579861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270402158015
                                         uncertainty =       0.001926785042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270402158015
                                         uncertainty =       0.001926785042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367741026
  error estimate for blocks of size 2^( 2) =       0.000381669364
  error estimate for blocks of size 2^( 3) =       0.000393925426
  error estimate for blocks of size 2^( 4) =       0.000403381892
  error estimate for blocks of size 2^( 5) =       0.000409200231
  error estimate for blocks of size 2^( 6) =       0.000412612374
  error estimate for blocks of size 2^( 7) =       0.000414811994

      target function =      -0.936986504002
              le_mean =     -17.212187667012
             les_mean =     296.543886616832
             stat err =       0.000410001623
             autocorr =       1.243045380851
   target nu stat err =       0.000410001623
   target dn stat err =       0.003172284949
      target stat err =       0.005431673587
              std dev =       0.520072667866
             le_variance =       0.270475579861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270402158015
                                         uncertainty =       0.001926785042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270402158015
                                         uncertainty =       0.001926785042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367741026
  error estimate for blocks of size 2^( 2) =       0.000381669364
  error estimate for blocks of size 2^( 3) =       0.000393925426
  error estimate for blocks of size 2^( 4) =       0.000403381892
  error estimate for blocks of size 2^( 5) =       0.000409200231
  error estimate for blocks of size 2^( 6) =       0.000412612374
  error estimate for blocks of size 2^( 7) =       0.000414811994

      target function =      -0.936986504002
              le_mean =     -17.212187667012
             les_mean =     296.543886616832
             stat err =       0.000410001623
             autocorr =       1.243045380851
   target nu stat err =       0.000410001623
   target dn stat err =       0.003172284949
      target stat err =       0.005431673587
              std dev =       0.520072667866
             le_variance =       0.270475579861


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936986504002        initial  <--
     6.1035e+58     6.1035e+59             0.0000e+00        -0.936986504002
     2.4414e+59     2.4414e+60             0.0000e+00        -0.936986504002
     9.7656e+59     9.7656e+60             0.0000e+00        -0.936986504002

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2547
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9335e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.1681
    reference variance = 0.181386
====================================================
  Execution time = 2.8169e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0398e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8359e-01
  Total weights = 1.957385684e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6205e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269149426224
                                         uncertainty =       0.001468477867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269149426224
                                         uncertainty =       0.001468477867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366891885
  error estimate for blocks of size 2^( 2) =       0.000380563976
  error estimate for blocks of size 2^( 3) =       0.000392692587
  error estimate for blocks of size 2^( 4) =       0.000402999697
  error estimate for blocks of size 2^( 5) =       0.000408931002
  error estimate for blocks of size 2^( 6) =       0.000411328341
  error estimate for blocks of size 2^( 7) =       0.000412248599

      target function =      -0.938504208108
              le_mean =     -17.212251667180
             les_mean =     296.545198280200
             stat err =       0.000408876910
             autocorr =       1.241963864045
   target nu stat err =       0.000408876910
   target dn stat err =       0.002806806850
      target stat err =       0.004834008637
              std dev =       0.518871780799
             le_variance =       0.269227924909


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721225166718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+59, overlap shift 6.1035e+60 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938528033212       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938528033212       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+60, overlap shift 2.4414e+61 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938528033212       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938528033212       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+60, overlap shift 9.7656e+61 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938528033212       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938528033212       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.322095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6798e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.1446
    reference variance = 0.365532
====================================================
  Execution time = 2.8167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8208e-01
  Total weights = 1.9574e+06
  Execution time = 2.4941e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318672599
                                         uncertainty =       0.001457957189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318672599
                                         uncertainty =       0.001457957189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365623376
  error estimate for blocks of size 2^( 2) =       0.000379141054
  error estimate for blocks of size 2^( 3) =       0.000391828688
  error estimate for blocks of size 2^( 4) =       0.000401293212
  error estimate for blocks of size 2^( 5) =       0.000407351568
  error estimate for blocks of size 2^( 6) =       0.000409131292
  error estimate for blocks of size 2^( 7) =       0.000411893358

      target function =      -0.941111057584
              le_mean =     -17.211615797952
             les_mean =     296.521797485354
             stat err =       0.000407417357
             autocorr =       1.241684177061
   target nu stat err =       0.000407417357
   target dn stat err =       0.002922345331
      target stat err =       0.005049490428
              std dev =       0.517077809764
             le_variance =       0.267369461351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318672599
                                         uncertainty =       0.001457957189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318672599
                                         uncertainty =       0.001457957189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365623376
  error estimate for blocks of size 2^( 2) =       0.000379141054
  error estimate for blocks of size 2^( 3) =       0.000391828688
  error estimate for blocks of size 2^( 4) =       0.000401293212
  error estimate for blocks of size 2^( 5) =       0.000407351568
  error estimate for blocks of size 2^( 6) =       0.000409131292
  error estimate for blocks of size 2^( 7) =       0.000411893358

      target function =      -0.941111057584
              le_mean =     -17.211615797952
             les_mean =     296.521797485354
             stat err =       0.000407417357
             autocorr =       1.241684177063
   target nu stat err =       0.000407417357
   target dn stat err =       0.002922345331
      target stat err =       0.005049490428
              std dev =       0.517077809764
             le_variance =       0.267369461351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318672599
                                         uncertainty =       0.001457957189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318672599
                                         uncertainty =       0.001457957189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365623376
  error estimate for blocks of size 2^( 2) =       0.000379141054
  error estimate for blocks of size 2^( 3) =       0.000391828688
  error estimate for blocks of size 2^( 4) =       0.000401293212
  error estimate for blocks of size 2^( 5) =       0.000407351568
  error estimate for blocks of size 2^( 6) =       0.000409131292
  error estimate for blocks of size 2^( 7) =       0.000411893358

      target function =      -0.941111057584
              le_mean =     -17.211615797952
             les_mean =     296.521797485354
             stat err =       0.000407417357
             autocorr =       1.241684177063
   target nu stat err =       0.000407417357
   target dn stat err =       0.002922345331
      target stat err =       0.005049490428
              std dev =       0.517077809764
             le_variance =       0.267369461351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318672599
                                         uncertainty =       0.001457957189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318672599
                                         uncertainty =       0.001457957189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365623376
  error estimate for blocks of size 2^( 2) =       0.000379141054
  error estimate for blocks of size 2^( 3) =       0.000391828688
  error estimate for blocks of size 2^( 4) =       0.000401293212
  error estimate for blocks of size 2^( 5) =       0.000407351568
  error estimate for blocks of size 2^( 6) =       0.000409131292
  error estimate for blocks of size 2^( 7) =       0.000411893358

      target function =      -0.941111057584
              le_mean =     -17.211615797952
             les_mean =     296.521797485354
             stat err =       0.000407417357
             autocorr =       1.241684177063
   target nu stat err =       0.000407417357
   target dn stat err =       0.002922345331
      target stat err =       0.005049490428
              std dev =       0.517077809764
             le_variance =       0.267369461351


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941111057584        initial  <--
     6.1035e+59     6.1035e+60             0.0000e+00        -0.941111057584
     2.4414e+60     2.4414e+61             0.0000e+00        -0.941111057584
     9.7656e+60     9.7656e+61             0.0000e+00        -0.941111057584

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.6820
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7487e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2766
    reference variance = 0.23014
====================================================
  Execution time = 2.8151e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0418e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7939e-01
  Total weights = 1.957286919e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9013e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268476471903
                                         uncertainty =       0.001632745546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268476471903
                                         uncertainty =       0.001632745546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366340566
  error estimate for blocks of size 2^( 2) =       0.000380330138
  error estimate for blocks of size 2^( 3) =       0.000392964105
  error estimate for blocks of size 2^( 4) =       0.000402591507
  error estimate for blocks of size 2^( 5) =       0.000407927203
  error estimate for blocks of size 2^( 6) =       0.000410687872
  error estimate for blocks of size 2^( 7) =       0.000413168847

      target function =      -0.945715329345
              le_mean =     -17.212018370544
             les_mean =     296.532969690112
             stat err =       0.000408593857
             autocorr =       1.243980699384
   target nu stat err =       0.000408593857
   target dn stat err =       0.002557436695
      target stat err =       0.004480140570
              std dev =       0.518092086251
             le_variance =       0.268419409836


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721201837054e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+60, overlap shift 6.1035e+61 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945735518384       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945735518384       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+61, overlap shift 2.4414e+62 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945735518384       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945735518384       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+61, overlap shift 9.7656e+62 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945735518384       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945735518384       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.323416 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7061e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.189
    reference variance = 0.152724
====================================================
  Execution time = 2.7901e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7782e-01
  Total weights = 1.9575e+06
  Execution time = 2.4860e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266873290886
                                         uncertainty =       0.001275822149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266873290886
                                         uncertainty =       0.001275822149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365268104
  error estimate for blocks of size 2^( 2) =       0.000379193001
  error estimate for blocks of size 2^( 3) =       0.000392242100
  error estimate for blocks of size 2^( 4) =       0.000402069279
  error estimate for blocks of size 2^( 5) =       0.000408032454
  error estimate for blocks of size 2^( 6) =       0.000410092780
  error estimate for blocks of size 2^( 7) =       0.000412474706

      target function =      -0.948461403675
              le_mean =     -17.211558970673
             les_mean =     296.515582708158
             stat err =       0.000408167305
             autocorr =       1.248685093276
   target nu stat err =       0.000408167305
   target dn stat err =       0.002082983278
      target stat err =       0.003692057675
              std dev =       0.516575371364
             le_variance =       0.266850114300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266873290886
                                         uncertainty =       0.001275822149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266873290886
                                         uncertainty =       0.001275822149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365268104
  error estimate for blocks of size 2^( 2) =       0.000379193001
  error estimate for blocks of size 2^( 3) =       0.000392242100
  error estimate for blocks of size 2^( 4) =       0.000402069279
  error estimate for blocks of size 2^( 5) =       0.000408032454
  error estimate for blocks of size 2^( 6) =       0.000410092780
  error estimate for blocks of size 2^( 7) =       0.000412474706

      target function =      -0.948461403675
              le_mean =     -17.211558970673
             les_mean =     296.515582708158
             stat err =       0.000408167305
             autocorr =       1.248685093274
   target nu stat err =       0.000408167305
   target dn stat err =       0.002082983278
      target stat err =       0.003692057675
              std dev =       0.516575371364
             le_variance =       0.266850114300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266873290886
                                         uncertainty =       0.001275822149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266873290886
                                         uncertainty =       0.001275822149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365268104
  error estimate for blocks of size 2^( 2) =       0.000379193001
  error estimate for blocks of size 2^( 3) =       0.000392242100
  error estimate for blocks of size 2^( 4) =       0.000402069279
  error estimate for blocks of size 2^( 5) =       0.000408032454
  error estimate for blocks of size 2^( 6) =       0.000410092780
  error estimate for blocks of size 2^( 7) =       0.000412474706

      target function =      -0.948461403675
              le_mean =     -17.211558970673
             les_mean =     296.515582708158
             stat err =       0.000408167305
             autocorr =       1.248685093274
   target nu stat err =       0.000408167305
   target dn stat err =       0.002082983278
      target stat err =       0.003692057675
              std dev =       0.516575371364
             le_variance =       0.266850114300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266873290886
                                         uncertainty =       0.001275822149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266873290886
                                         uncertainty =       0.001275822149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365268104
  error estimate for blocks of size 2^( 2) =       0.000379193001
  error estimate for blocks of size 2^( 3) =       0.000392242100
  error estimate for blocks of size 2^( 4) =       0.000402069279
  error estimate for blocks of size 2^( 5) =       0.000408032454
  error estimate for blocks of size 2^( 6) =       0.000410092780
  error estimate for blocks of size 2^( 7) =       0.000412474706

      target function =      -0.948461403675
              le_mean =     -17.211558970673
             les_mean =     296.515582708158
             stat err =       0.000408167305
             autocorr =       1.248685093274
   target nu stat err =       0.000408167305
   target dn stat err =       0.002082983278
      target stat err =       0.003692057675
              std dev =       0.516575371364
             le_variance =       0.266850114300


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948461403675        initial  <--
     6.1035e+60     6.1035e+61             0.0000e+00        -0.948461403675
     2.4414e+61     2.4414e+62             0.0000e+00        -0.948461403675
     9.7656e+61     9.7656e+62             0.0000e+00        -0.948461403675

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.4449
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7512e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.1254
    reference variance = 0.299155
====================================================
  Execution time = 2.8206e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0362e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7916e-01
  Total weights = 1.957391777e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7598e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267769835657
                                         uncertainty =       0.001741208619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267769835657
                                         uncertainty =       0.001741208619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365835965
  error estimate for blocks of size 2^( 2) =       0.000379614851
  error estimate for blocks of size 2^( 3) =       0.000392343745
  error estimate for blocks of size 2^( 4) =       0.000402526128
  error estimate for blocks of size 2^( 5) =       0.000408616182
  error estimate for blocks of size 2^( 6) =       0.000411098461
  error estimate for blocks of size 2^( 7) =       0.000411900629

      target function =      -0.946116167477
              le_mean =     -17.212170780061
             les_mean =     296.537980943115
             stat err =       0.000408535350
             autocorr =       1.247057521009
   target nu stat err =       0.000408535350
   target dn stat err =       0.002573853541
      target stat err =       0.004513185614
              std dev =       0.517378461635
             le_variance =       0.267680472564


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721217078006e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+61, overlap shift 6.1035e+62 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946136513879       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946136513879       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+62, overlap shift 2.4414e+63 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946136513879       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946136513879       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+62, overlap shift 9.7656e+63 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946136513879       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946136513879       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.324740 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6975e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2715
    reference variance = 0.334282
====================================================
  Execution time = 2.8242e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8499e-01
  Total weights = 1.9573e+06
  Execution time = 2.4901e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269275408781
                                         uncertainty =       0.001490071430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269275408781
                                         uncertainty =       0.001490071430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366918023
  error estimate for blocks of size 2^( 2) =       0.000380563475
  error estimate for blocks of size 2^( 3) =       0.000392919612
  error estimate for blocks of size 2^( 4) =       0.000402304181
  error estimate for blocks of size 2^( 5) =       0.000408117442
  error estimate for blocks of size 2^( 6) =       0.000411170930
  error estimate for blocks of size 2^( 7) =       0.000413472082

      target function =      -0.936177799329
              le_mean =     -17.211075443089
             les_mean =     296.506107494900
             stat err =       0.000408766159
             autocorr =       1.241114298891
   target nu stat err =       0.000408766159
   target dn stat err =       0.003609125275
      target stat err =       0.006142537802
              std dev =       0.518908746306
             le_variance =       0.269266286993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269275408781
                                         uncertainty =       0.001490071430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269275408781
                                         uncertainty =       0.001490071430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366918023
  error estimate for blocks of size 2^( 2) =       0.000380563475
  error estimate for blocks of size 2^( 3) =       0.000392919612
  error estimate for blocks of size 2^( 4) =       0.000402304181
  error estimate for blocks of size 2^( 5) =       0.000408117442
  error estimate for blocks of size 2^( 6) =       0.000411170930
  error estimate for blocks of size 2^( 7) =       0.000413472082

      target function =      -0.936177799329
              le_mean =     -17.211075443089
             les_mean =     296.506107494900
             stat err =       0.000408766159
             autocorr =       1.241114298891
   target nu stat err =       0.000408766159
   target dn stat err =       0.003609125275
      target stat err =       0.006142537802
              std dev =       0.518908746306
             le_variance =       0.269266286993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269275408781
                                         uncertainty =       0.001490071430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269275408781
                                         uncertainty =       0.001490071430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366918023
  error estimate for blocks of size 2^( 2) =       0.000380563475
  error estimate for blocks of size 2^( 3) =       0.000392919612
  error estimate for blocks of size 2^( 4) =       0.000402304181
  error estimate for blocks of size 2^( 5) =       0.000408117442
  error estimate for blocks of size 2^( 6) =       0.000411170930
  error estimate for blocks of size 2^( 7) =       0.000413472082

      target function =      -0.936177799329
              le_mean =     -17.211075443089
             les_mean =     296.506107494900
             stat err =       0.000408766159
             autocorr =       1.241114298891
   target nu stat err =       0.000408766159
   target dn stat err =       0.003609125275
      target stat err =       0.006142537802
              std dev =       0.518908746306
             le_variance =       0.269266286993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269275408781
                                         uncertainty =       0.001490071430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269275408781
                                         uncertainty =       0.001490071430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366918023
  error estimate for blocks of size 2^( 2) =       0.000380563475
  error estimate for blocks of size 2^( 3) =       0.000392919612
  error estimate for blocks of size 2^( 4) =       0.000402304181
  error estimate for blocks of size 2^( 5) =       0.000408117442
  error estimate for blocks of size 2^( 6) =       0.000411170930
  error estimate for blocks of size 2^( 7) =       0.000413472082

      target function =      -0.936177799329
              le_mean =     -17.211075443089
             les_mean =     296.506107494900
             stat err =       0.000408766159
             autocorr =       1.241114298891
   target nu stat err =       0.000408766159
   target dn stat err =       0.003609125275
      target stat err =       0.006142537802
              std dev =       0.518908746306
             le_variance =       0.269266286993


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936177799329        initial  <--
     6.1035e+61     6.1035e+62             0.0000e+00        -0.936177799329
     2.4414e+62     2.4414e+63             0.0000e+00        -0.936177799329
     9.7656e+62     9.7656e+63             0.0000e+00        -0.936177799329

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8108
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7792e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.1404
    reference variance = 0.381559
====================================================
  Execution time = 2.8146e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0379e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8380e-01
  Total weights = 1.957291454e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8107e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269301225167
                                         uncertainty =       0.002364162084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269301225167
                                         uncertainty =       0.002364162084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367044886
  error estimate for blocks of size 2^( 2) =       0.000380932483
  error estimate for blocks of size 2^( 3) =       0.000393490074
  error estimate for blocks of size 2^( 4) =       0.000402828447
  error estimate for blocks of size 2^( 5) =       0.000407709312
  error estimate for blocks of size 2^( 6) =       0.000411811987
  error estimate for blocks of size 2^( 7) =       0.000413978659

      target function =      -0.938129367211
              le_mean =     -17.211540979447
             les_mean =     296.520946850965
             stat err =       0.000409082101
             autocorr =       1.242174474511
   target nu stat err =       0.000409082101
   target dn stat err =       0.004887166893
      target stat err =       0.008332663884
              std dev =       0.519088160887
             le_variance =       0.269452518773


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721154097945e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+62, overlap shift 6.1035e+63 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938201744975       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938201744975       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+63, overlap shift 2.4414e+64 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938201744975       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938201744975       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+63, overlap shift 9.7656e+64 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938201744975       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938201744975       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.326061 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6966e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.226
    reference variance = 0.206912
====================================================
  Execution time = 3.0519e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8204e-01
  Total weights = 1.9577e+06
  Execution time = 2.4967e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271405963594
                                         uncertainty =       0.002408880677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271405963594
                                         uncertainty =       0.002408880677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368328789
  error estimate for blocks of size 2^( 2) =       0.000382202920
  error estimate for blocks of size 2^( 3) =       0.000394848701
  error estimate for blocks of size 2^( 4) =       0.000403757454
  error estimate for blocks of size 2^( 5) =       0.000408794231
  error estimate for blocks of size 2^( 6) =       0.000413148158
  error estimate for blocks of size 2^( 7) =       0.000415757688

      target function =      -0.941166092720
              le_mean =     -17.211899069345
             les_mean =     296.531507274403
             stat err =       0.000410364383
             autocorr =       1.241274942931
   target nu stat err =       0.000410364383
   target dn stat err =       0.003069259684
      target stat err =       0.005302297864
              std dev =       0.520903902866
             le_variance =       0.271340876021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271405963594
                                         uncertainty =       0.002408880677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271405963594
                                         uncertainty =       0.002408880677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368328789
  error estimate for blocks of size 2^( 2) =       0.000382202920
  error estimate for blocks of size 2^( 3) =       0.000394848701
  error estimate for blocks of size 2^( 4) =       0.000403757454
  error estimate for blocks of size 2^( 5) =       0.000408794231
  error estimate for blocks of size 2^( 6) =       0.000413148158
  error estimate for blocks of size 2^( 7) =       0.000415757688

      target function =      -0.941166092720
              le_mean =     -17.211899069345
             les_mean =     296.531507274403
             stat err =       0.000410364383
             autocorr =       1.241274942931
   target nu stat err =       0.000410364383
   target dn stat err =       0.003069259684
      target stat err =       0.005302297864
              std dev =       0.520903902866
             le_variance =       0.271340876021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271405963594
                                         uncertainty =       0.002408880677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271405963594
                                         uncertainty =       0.002408880677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368328789
  error estimate for blocks of size 2^( 2) =       0.000382202920
  error estimate for blocks of size 2^( 3) =       0.000394848701
  error estimate for blocks of size 2^( 4) =       0.000403757454
  error estimate for blocks of size 2^( 5) =       0.000408794231
  error estimate for blocks of size 2^( 6) =       0.000413148158
  error estimate for blocks of size 2^( 7) =       0.000415757688

      target function =      -0.941166092720
              le_mean =     -17.211899069345
             les_mean =     296.531507274403
             stat err =       0.000410364383
             autocorr =       1.241274942931
   target nu stat err =       0.000410364383
   target dn stat err =       0.003069259684
      target stat err =       0.005302297864
              std dev =       0.520903902866
             le_variance =       0.271340876021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271405963594
                                         uncertainty =       0.002408880677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271405963594
                                         uncertainty =       0.002408880677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368328789
  error estimate for blocks of size 2^( 2) =       0.000382202920
  error estimate for blocks of size 2^( 3) =       0.000394848701
  error estimate for blocks of size 2^( 4) =       0.000403757454
  error estimate for blocks of size 2^( 5) =       0.000408794231
  error estimate for blocks of size 2^( 6) =       0.000413148158
  error estimate for blocks of size 2^( 7) =       0.000415757688

      target function =      -0.941166092720
              le_mean =     -17.211899069345
             les_mean =     296.531507274403
             stat err =       0.000410364383
             autocorr =       1.241274942931
   target nu stat err =       0.000410364383
   target dn stat err =       0.003069259684
      target stat err =       0.005302297864
              std dev =       0.520903902866
             le_variance =       0.271340876021


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941166092720        initial  <--
     6.1035e+62     6.1035e+63             0.0000e+00        -0.941166092720
     2.4414e+63     2.4414e+64             0.0000e+00        -0.941166092720
     9.7656e+63     9.7656e+64             0.0000e+00        -0.941166092720

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1555
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0128e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.1989
    reference variance = 0.204978
====================================================
  Execution time = 2.8994e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0406e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8145e-01
  Total weights = 1.957413560e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8860e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266983391089
                                         uncertainty =       0.001519479951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266983391089
                                         uncertainty =       0.001519479951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365337481
  error estimate for blocks of size 2^( 2) =       0.000379297828
  error estimate for blocks of size 2^( 3) =       0.000391787678
  error estimate for blocks of size 2^( 4) =       0.000400946666
  error estimate for blocks of size 2^( 5) =       0.000406413479
  error estimate for blocks of size 2^( 6) =       0.000410322209
  error estimate for blocks of size 2^( 7) =       0.000410943139

      target function =      -0.942142786774
              le_mean =     -17.212413923724
             les_mean =     296.548641276222
             stat err =       0.000407156373
             autocorr =       1.242035513956
   target nu stat err =       0.000407156373
   target dn stat err =       0.003548457905
      target stat err =       0.006132902026
              std dev =       0.516673487335
             le_variance =       0.266951492515


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721241392372e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+63, overlap shift 6.1035e+64 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942181470212       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942181470212       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+64, overlap shift 2.4414e+65 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942181470212       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942181470212       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+64, overlap shift 9.7656e+65 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942181470212       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942181470212       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.327382 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7888e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2313
    reference variance = 0.205522
====================================================
  Execution time = 2.8707e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8196e-01
  Total weights = 1.9574e+06
  Execution time = 2.5057e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269270393272
                                         uncertainty =       0.002205035160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269270393272
                                         uncertainty =       0.002205035160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366932746
  error estimate for blocks of size 2^( 2) =       0.000380783565
  error estimate for blocks of size 2^( 3) =       0.000393281707
  error estimate for blocks of size 2^( 4) =       0.000402577617
  error estimate for blocks of size 2^( 5) =       0.000407897481
  error estimate for blocks of size 2^( 6) =       0.000410552108
  error estimate for blocks of size 2^( 7) =       0.000412467367

      target function =      -0.941311242478
              le_mean =     -17.211823625366
             les_mean =     296.528827715103
             stat err =       0.000408373643
             autocorr =       1.238632490447
   target nu stat err =       0.000408373643
   target dn stat err =       0.003056003375
      target stat err =       0.005280181012
              std dev =       0.518929568122
             le_variance =       0.269287896671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269270393272
                                         uncertainty =       0.002205035160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269270393272
                                         uncertainty =       0.002205035160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366932746
  error estimate for blocks of size 2^( 2) =       0.000380783565
  error estimate for blocks of size 2^( 3) =       0.000393281707
  error estimate for blocks of size 2^( 4) =       0.000402577617
  error estimate for blocks of size 2^( 5) =       0.000407897481
  error estimate for blocks of size 2^( 6) =       0.000410552108
  error estimate for blocks of size 2^( 7) =       0.000412467367

      target function =      -0.941311242478
              le_mean =     -17.211823625366
             les_mean =     296.528827715103
             stat err =       0.000408373643
             autocorr =       1.238632490447
   target nu stat err =       0.000408373643
   target dn stat err =       0.003056003375
      target stat err =       0.005280181012
              std dev =       0.518929568122
             le_variance =       0.269287896671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269270393272
                                         uncertainty =       0.002205035160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269270393272
                                         uncertainty =       0.002205035160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366932746
  error estimate for blocks of size 2^( 2) =       0.000380783565
  error estimate for blocks of size 2^( 3) =       0.000393281707
  error estimate for blocks of size 2^( 4) =       0.000402577617
  error estimate for blocks of size 2^( 5) =       0.000407897481
  error estimate for blocks of size 2^( 6) =       0.000410552108
  error estimate for blocks of size 2^( 7) =       0.000412467367

      target function =      -0.941311242478
              le_mean =     -17.211823625366
             les_mean =     296.528827715103
             stat err =       0.000408373643
             autocorr =       1.238632490447
   target nu stat err =       0.000408373643
   target dn stat err =       0.003056003375
      target stat err =       0.005280181012
              std dev =       0.518929568122
             le_variance =       0.269287896671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269270393272
                                         uncertainty =       0.002205035160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269270393272
                                         uncertainty =       0.002205035160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366932746
  error estimate for blocks of size 2^( 2) =       0.000380783565
  error estimate for blocks of size 2^( 3) =       0.000393281707
  error estimate for blocks of size 2^( 4) =       0.000402577617
  error estimate for blocks of size 2^( 5) =       0.000407897481
  error estimate for blocks of size 2^( 6) =       0.000410552108
  error estimate for blocks of size 2^( 7) =       0.000412467367

      target function =      -0.941311242478
              le_mean =     -17.211823625366
             les_mean =     296.528827715103
             stat err =       0.000408373643
             autocorr =       1.238632490447
   target nu stat err =       0.000408373643
   target dn stat err =       0.003056003375
      target stat err =       0.005280181012
              std dev =       0.518929568122
             le_variance =       0.269287896671


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941311242478        initial  <--
     6.1035e+63     6.1035e+64             0.0000e+00        -0.941311242478
     2.4414e+64     2.4414e+65             0.0000e+00        -0.941311242478
     9.7656e+64     9.7656e+65             0.0000e+00        -0.941311242478

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.3901
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9285e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.1595
    reference variance = 0.211837
====================================================
  Execution time = 2.9053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0396e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8049e-01
  Total weights = 1.957431908e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6818e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267961543206
                                         uncertainty =       0.001568045943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267961543206
                                         uncertainty =       0.001568045943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365995214
  error estimate for blocks of size 2^( 2) =       0.000379354361
  error estimate for blocks of size 2^( 3) =       0.000391882799
  error estimate for blocks of size 2^( 4) =       0.000400720986
  error estimate for blocks of size 2^( 5) =       0.000406290279
  error estimate for blocks of size 2^( 6) =       0.000407674067
  error estimate for blocks of size 2^( 7) =       0.000408991248

      target function =      -0.943832534330
              le_mean =     -17.211887645306
             les_mean =     296.529564529798
             stat err =       0.000405919145
             autocorr =       1.230065555532
   target nu stat err =       0.000405919145
   target dn stat err =       0.002605227261
      target stat err =       0.004541715953
              std dev =       0.517603676744
             le_variance =       0.267913566179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721188764531e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+64, overlap shift 6.1035e+65 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943853318043       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943853318043       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+65, overlap shift 2.4414e+66 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943853318043       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943853318043       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+65, overlap shift 9.7656e+66 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943853318043       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943853318043       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.328724 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7744e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.1791
    reference variance = 0.205373
====================================================
  Execution time = 2.8792e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7525e-01
  Total weights = 1.9576e+06
  Execution time = 2.4993e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265700936776
                                         uncertainty =       0.001369888048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265700936776
                                         uncertainty =       0.001369888048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364501459
  error estimate for blocks of size 2^( 2) =       0.000378273449
  error estimate for blocks of size 2^( 3) =       0.000390960265
  error estimate for blocks of size 2^( 4) =       0.000400054019
  error estimate for blocks of size 2^( 5) =       0.000405938243
  error estimate for blocks of size 2^( 6) =       0.000410142429
  error estimate for blocks of size 2^( 7) =       0.000411390495

      target function =      -0.952949741443
              le_mean =     -17.211407449348
             les_mean =     296.507797358867
             stat err =       0.000406881297
             autocorr =       1.246054137723
   target nu stat err =       0.000406881297
   target dn stat err =       0.001784418843
      target stat err =       0.003214139798
              std dev =       0.515491154373
             le_variance =       0.265731130237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265700936776
                                         uncertainty =       0.001369888048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265700936776
                                         uncertainty =       0.001369888048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364501459
  error estimate for blocks of size 2^( 2) =       0.000378273449
  error estimate for blocks of size 2^( 3) =       0.000390960265
  error estimate for blocks of size 2^( 4) =       0.000400054019
  error estimate for blocks of size 2^( 5) =       0.000405938243
  error estimate for blocks of size 2^( 6) =       0.000410142429
  error estimate for blocks of size 2^( 7) =       0.000411390495

      target function =      -0.952949741443
              le_mean =     -17.211407449348
             les_mean =     296.507797358867
             stat err =       0.000406881297
             autocorr =       1.246054137716
   target nu stat err =       0.000406881297
   target dn stat err =       0.001784418843
      target stat err =       0.003214139798
              std dev =       0.515491154373
             le_variance =       0.265731130237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265700936776
                                         uncertainty =       0.001369888048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265700936776
                                         uncertainty =       0.001369888048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364501459
  error estimate for blocks of size 2^( 2) =       0.000378273449
  error estimate for blocks of size 2^( 3) =       0.000390960265
  error estimate for blocks of size 2^( 4) =       0.000400054019
  error estimate for blocks of size 2^( 5) =       0.000405938243
  error estimate for blocks of size 2^( 6) =       0.000410142429
  error estimate for blocks of size 2^( 7) =       0.000411390495

      target function =      -0.952949741443
              le_mean =     -17.211407449348
             les_mean =     296.507797358867
             stat err =       0.000406881297
             autocorr =       1.246054137716
   target nu stat err =       0.000406881297
   target dn stat err =       0.001784418843
      target stat err =       0.003214139798
              std dev =       0.515491154373
             le_variance =       0.265731130237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265700936776
                                         uncertainty =       0.001369888048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265700936776
                                         uncertainty =       0.001369888048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364501459
  error estimate for blocks of size 2^( 2) =       0.000378273449
  error estimate for blocks of size 2^( 3) =       0.000390960265
  error estimate for blocks of size 2^( 4) =       0.000400054019
  error estimate for blocks of size 2^( 5) =       0.000405938243
  error estimate for blocks of size 2^( 6) =       0.000410142429
  error estimate for blocks of size 2^( 7) =       0.000411390495

      target function =      -0.952949741443
              le_mean =     -17.211407449348
             les_mean =     296.507797358867
             stat err =       0.000406881297
             autocorr =       1.246054137716
   target nu stat err =       0.000406881297
   target dn stat err =       0.001784418843
      target stat err =       0.003214139798
              std dev =       0.515491154373
             le_variance =       0.265731130237


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.952949741443        initial  <--
     6.1035e+64     6.1035e+65             0.0000e+00        -0.952949741443
     2.4414e+65     2.4414e+66             0.0000e+00        -0.952949741443
     9.7656e+65     9.7656e+66             0.0000e+00        -0.952949741443

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.4406
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9192e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2377
    reference variance = 0.113632
====================================================
  Execution time = 2.8821e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0404e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7805e-01
  Total weights = 1.957323009e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9135e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266849252625
                                         uncertainty =       0.001567681642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266849252625
                                         uncertainty =       0.001567681642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365283267
  error estimate for blocks of size 2^( 2) =       0.000378859521
  error estimate for blocks of size 2^( 3) =       0.000391797362
  error estimate for blocks of size 2^( 4) =       0.000401556134
  error estimate for blocks of size 2^( 5) =       0.000407975431
  error estimate for blocks of size 2^( 6) =       0.000411310594
  error estimate for blocks of size 2^( 7) =       0.000412927843

      target function =      -0.948061721410
              le_mean =     -17.211762855481
             les_mean =     296.522826958550
             stat err =       0.000408442500
             autocorr =       1.250265640217
   target nu stat err =       0.000408442500
   target dn stat err =       0.002185015620
      target stat err =       0.003864097362
              std dev =       0.516596815281
             le_variance =       0.266872269558


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721176285548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+65, overlap shift 6.1035e+66 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948076313719       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948076313719       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+66, overlap shift 2.4414e+67 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948076313719       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948076313719       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+66, overlap shift 9.7656e+67 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948076313719       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948076313719       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.330033 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7744e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.126
    reference variance = 0.186477
====================================================
  Execution time = 2.9079e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7485e-01
  Total weights = 1.9574e+06
  Execution time = 2.5148e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264697408391
                                         uncertainty =       0.001467249603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264697408391
                                         uncertainty =       0.001467249603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363801051
  error estimate for blocks of size 2^( 2) =       0.000377427577
  error estimate for blocks of size 2^( 3) =       0.000389747528
  error estimate for blocks of size 2^( 4) =       0.000399542809
  error estimate for blocks of size 2^( 5) =       0.000405845003
  error estimate for blocks of size 2^( 6) =       0.000408429031
  error estimate for blocks of size 2^( 7) =       0.000410623086

      target function =      -0.953653703582
              le_mean =     -17.211714617121
             les_mean =     296.517965436284
             stat err =       0.000406109982
             autocorr =       1.246118749224
   target nu stat err =       0.000406109982
   target dn stat err =       0.001826229878
      target stat err =       0.003291776619
              std dev =       0.514500612080
             le_variance =       0.264710879831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264697408391
                                         uncertainty =       0.001467249603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264697408391
                                         uncertainty =       0.001467249603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363801051
  error estimate for blocks of size 2^( 2) =       0.000377427577
  error estimate for blocks of size 2^( 3) =       0.000389747528
  error estimate for blocks of size 2^( 4) =       0.000399542809
  error estimate for blocks of size 2^( 5) =       0.000405845003
  error estimate for blocks of size 2^( 6) =       0.000408429031
  error estimate for blocks of size 2^( 7) =       0.000410623086

      target function =      -0.953653703582
              le_mean =     -17.211714617121
             les_mean =     296.517965436284
             stat err =       0.000406109982
             autocorr =       1.246118749224
   target nu stat err =       0.000406109982
   target dn stat err =       0.001826229878
      target stat err =       0.003291776619
              std dev =       0.514500612080
             le_variance =       0.264710879831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264697408391
                                         uncertainty =       0.001467249603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264697408391
                                         uncertainty =       0.001467249603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363801051
  error estimate for blocks of size 2^( 2) =       0.000377427577
  error estimate for blocks of size 2^( 3) =       0.000389747528
  error estimate for blocks of size 2^( 4) =       0.000399542809
  error estimate for blocks of size 2^( 5) =       0.000405845003
  error estimate for blocks of size 2^( 6) =       0.000408429031
  error estimate for blocks of size 2^( 7) =       0.000410623086

      target function =      -0.953653703582
              le_mean =     -17.211714617121
             les_mean =     296.517965436284
             stat err =       0.000406109982
             autocorr =       1.246118749224
   target nu stat err =       0.000406109982
   target dn stat err =       0.001826229878
      target stat err =       0.003291776619
              std dev =       0.514500612080
             le_variance =       0.264710879831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264697408391
                                         uncertainty =       0.001467249603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264697408391
                                         uncertainty =       0.001467249603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363801051
  error estimate for blocks of size 2^( 2) =       0.000377427577
  error estimate for blocks of size 2^( 3) =       0.000389747528
  error estimate for blocks of size 2^( 4) =       0.000399542809
  error estimate for blocks of size 2^( 5) =       0.000405845003
  error estimate for blocks of size 2^( 6) =       0.000408429031
  error estimate for blocks of size 2^( 7) =       0.000410623086

      target function =      -0.953653703582
              le_mean =     -17.211714617121
             les_mean =     296.517965436284
             stat err =       0.000406109982
             autocorr =       1.246118749224
   target nu stat err =       0.000406109982
   target dn stat err =       0.001826229878
      target stat err =       0.003291776619
              std dev =       0.514500612080
             le_variance =       0.264710879831


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.953653703582        initial  <--
     6.1035e+65     6.1035e+66             0.0000e+00        -0.953653703582
     2.4414e+66     2.4414e+67             0.0000e+00        -0.953653703582
     9.7656e+66     9.7656e+67             0.0000e+00        -0.953653703582

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.8082
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9559e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.1976
    reference variance = 0.877704
====================================================
  Execution time = 2.9124e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0393e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7834e-01
  Total weights = 1.957557344e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7944e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266422086784
                                         uncertainty =       0.001743382782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266422086784
                                         uncertainty =       0.001743382782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364949674
  error estimate for blocks of size 2^( 2) =       0.000378233174
  error estimate for blocks of size 2^( 3) =       0.000390920156
  error estimate for blocks of size 2^( 4) =       0.000400341307
  error estimate for blocks of size 2^( 5) =       0.000405997349
  error estimate for blocks of size 2^( 6) =       0.000409380218
  error estimate for blocks of size 2^( 7) =       0.000411854591

      target function =      -0.947554769954
              le_mean =     -17.211456485858
             les_mean =     296.512576243390
             stat err =       0.000406893366
             autocorr =       1.243069067582
   target nu stat err =       0.000406893366
   target dn stat err =       0.002486966537
      target stat err =       0.004371612532
              std dev =       0.516125035703
             le_variance =       0.266385052480


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721145648586e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+66, overlap shift 6.1035e+67 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947573903001       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947573903001       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+67, overlap shift 2.4414e+68 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947573903001       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947573903001       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+67, overlap shift 9.7656e+68 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947573903001       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947573903001       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.331386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1015e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2382
    reference variance = 0.444308
====================================================
  Execution time = 2.8674e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7830e-01
  Total weights = 1.9575e+06
  Execution time = 2.4855e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267615867545
                                         uncertainty =       0.001390353909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267615867545
                                         uncertainty =       0.001390353909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365765046
  error estimate for blocks of size 2^( 2) =       0.000379558820
  error estimate for blocks of size 2^( 3) =       0.000392039222
  error estimate for blocks of size 2^( 4) =       0.000400992675
  error estimate for blocks of size 2^( 5) =       0.000406307568
  error estimate for blocks of size 2^( 6) =       0.000409890436
  error estimate for blocks of size 2^( 7) =       0.000411684057

      target function =      -0.947580003713
              le_mean =     -17.212958800095
             les_mean =     296.564252830951
             stat err =       0.000407218684
             autocorr =       1.239512735395
   target nu stat err =       0.000407218684
   target dn stat err =       0.001838355731
      target stat err =       0.003279858705
              std dev =       0.517278164388
             le_variance =       0.267576699352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267615867545
                                         uncertainty =       0.001390353909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267615867545
                                         uncertainty =       0.001390353909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365765046
  error estimate for blocks of size 2^( 2) =       0.000379558820
  error estimate for blocks of size 2^( 3) =       0.000392039222
  error estimate for blocks of size 2^( 4) =       0.000400992675
  error estimate for blocks of size 2^( 5) =       0.000406307568
  error estimate for blocks of size 2^( 6) =       0.000409890436
  error estimate for blocks of size 2^( 7) =       0.000411684057

      target function =      -0.947580003713
              le_mean =     -17.212958800095
             les_mean =     296.564252830951
             stat err =       0.000407218684
             autocorr =       1.239512735395
   target nu stat err =       0.000407218684
   target dn stat err =       0.001838355731
      target stat err =       0.003279858705
              std dev =       0.517278164388
             le_variance =       0.267576699352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267615867545
                                         uncertainty =       0.001390353909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267615867545
                                         uncertainty =       0.001390353909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365765046
  error estimate for blocks of size 2^( 2) =       0.000379558820
  error estimate for blocks of size 2^( 3) =       0.000392039222
  error estimate for blocks of size 2^( 4) =       0.000400992675
  error estimate for blocks of size 2^( 5) =       0.000406307568
  error estimate for blocks of size 2^( 6) =       0.000409890436
  error estimate for blocks of size 2^( 7) =       0.000411684057

      target function =      -0.947580003713
              le_mean =     -17.212958800095
             les_mean =     296.564252830951
             stat err =       0.000407218684
             autocorr =       1.239512735395
   target nu stat err =       0.000407218684
   target dn stat err =       0.001838355731
      target stat err =       0.003279858705
              std dev =       0.517278164388
             le_variance =       0.267576699352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267615867545
                                         uncertainty =       0.001390353909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267615867545
                                         uncertainty =       0.001390353909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365765046
  error estimate for blocks of size 2^( 2) =       0.000379558820
  error estimate for blocks of size 2^( 3) =       0.000392039222
  error estimate for blocks of size 2^( 4) =       0.000400992675
  error estimate for blocks of size 2^( 5) =       0.000406307568
  error estimate for blocks of size 2^( 6) =       0.000409890436
  error estimate for blocks of size 2^( 7) =       0.000411684057

      target function =      -0.947580003713
              le_mean =     -17.212958800095
             les_mean =     296.564252830951
             stat err =       0.000407218684
             autocorr =       1.239512735395
   target nu stat err =       0.000407218684
   target dn stat err =       0.001838355731
      target stat err =       0.003279858705
              std dev =       0.517278164388
             le_variance =       0.267576699352


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947580003713        initial  <--
     6.1035e+66     6.1035e+67             0.0000e+00        -0.947580003713
     2.4414e+67     2.4414e+68             0.0000e+00        -0.947580003713
     9.7656e+67     9.7656e+68             0.0000e+00        -0.947580003713

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.2596
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2282e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.0759
    reference variance = 0.161019
====================================================
  Execution time = 2.8599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0362e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7644e-01
  Total weights = 1.957200637e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0921e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265232566192
                                         uncertainty =       0.001235658671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265232566192
                                         uncertainty =       0.001235658671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364143884
  error estimate for blocks of size 2^( 2) =       0.000378300611
  error estimate for blocks of size 2^( 3) =       0.000391048156
  error estimate for blocks of size 2^( 4) =       0.000400076776
  error estimate for blocks of size 2^( 5) =       0.000406386313
  error estimate for blocks of size 2^( 6) =       0.000408639409
  error estimate for blocks of size 2^( 7) =       0.000409432557

      target function =      -0.950867324532
              le_mean =     -17.211794227956
             les_mean =     296.522295650596
             stat err =       0.000406133764
             autocorr =       1.243919146575
   target nu stat err =       0.000406133764
   target dn stat err =       0.001977855963
      target stat err =       0.003531796504
              std dev =       0.514985458307
             le_variance =       0.265210022268


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721179422796e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+67, overlap shift 6.1035e+68 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950879387262       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950879387262       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.60e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.61e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+67 is 1.605582e-72

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+68, overlap shift 2.4414e+69 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950879387262       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950879387262       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.60e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.58e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+68 is 4.013956e-73

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+68, overlap shift 9.7656e+69 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950879387262       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950879387262       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.60e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.61e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+68 is 1.003489e-73

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.333439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7700e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2395
    reference variance = 0.452435
====================================================
  Execution time = 2.8480e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8087e-01
  Total weights = 1.9575e+06
  Execution time = 2.4894e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268026899898
                                         uncertainty =       0.001626935589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268026899898
                                         uncertainty =       0.001626935589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366108657
  error estimate for blocks of size 2^( 2) =       0.000380291957
  error estimate for blocks of size 2^( 3) =       0.000393251755
  error estimate for blocks of size 2^( 4) =       0.000402399142
  error estimate for blocks of size 2^( 5) =       0.000407962398
  error estimate for blocks of size 2^( 6) =       0.000411193664
  error estimate for blocks of size 2^( 7) =       0.000411564514

      target function =      -0.943160017600
              le_mean =     -17.212292394071
             les_mean =     296.543880248473
             stat err =       0.000408279929
             autocorr =       1.243643959239
   target nu stat err =       0.000408279929
   target dn stat err =       0.002463358417
      target stat err =       0.004299194148
              std dev =       0.517764112501
             le_variance =       0.268079676194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268026899898
                                         uncertainty =       0.001626935589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268026899898
                                         uncertainty =       0.001626935589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366108657
  error estimate for blocks of size 2^( 2) =       0.000380291957
  error estimate for blocks of size 2^( 3) =       0.000393251755
  error estimate for blocks of size 2^( 4) =       0.000402399142
  error estimate for blocks of size 2^( 5) =       0.000407962398
  error estimate for blocks of size 2^( 6) =       0.000411193664
  error estimate for blocks of size 2^( 7) =       0.000411564514

      target function =      -0.943160017600
              le_mean =     -17.212292394071
             les_mean =     296.543880248473
             stat err =       0.000408279929
             autocorr =       1.243643959239
   target nu stat err =       0.000408279929
   target dn stat err =       0.002463358417
      target stat err =       0.004299194148
              std dev =       0.517764112501
             le_variance =       0.268079676194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268026899898
                                         uncertainty =       0.001626935589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268026899898
                                         uncertainty =       0.001626935589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366108657
  error estimate for blocks of size 2^( 2) =       0.000380291957
  error estimate for blocks of size 2^( 3) =       0.000393251755
  error estimate for blocks of size 2^( 4) =       0.000402399142
  error estimate for blocks of size 2^( 5) =       0.000407962398
  error estimate for blocks of size 2^( 6) =       0.000411193664
  error estimate for blocks of size 2^( 7) =       0.000411564514

      target function =      -0.943160017600
              le_mean =     -17.212292394071
             les_mean =     296.543880248473
             stat err =       0.000408279929
             autocorr =       1.243643959239
   target nu stat err =       0.000408279929
   target dn stat err =       0.002463358417
      target stat err =       0.004299194148
              std dev =       0.517764112501
             le_variance =       0.268079676194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268026899898
                                         uncertainty =       0.001626935589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268026899898
                                         uncertainty =       0.001626935589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366108657
  error estimate for blocks of size 2^( 2) =       0.000380291957
  error estimate for blocks of size 2^( 3) =       0.000393251755
  error estimate for blocks of size 2^( 4) =       0.000402399142
  error estimate for blocks of size 2^( 5) =       0.000407962398
  error estimate for blocks of size 2^( 6) =       0.000411193664
  error estimate for blocks of size 2^( 7) =       0.000411564514

      target function =      -0.943160017600
              le_mean =     -17.212292394071
             les_mean =     296.543880248473
             stat err =       0.000408279929
             autocorr =       1.243643959239
   target nu stat err =       0.000408279929
   target dn stat err =       0.002463358417
      target stat err =       0.004299194148
              std dev =       0.517764112501
             le_variance =       0.268079676194


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943160017600        initial  <--
     6.1035e+67     6.1035e+68             1.6056e-72        -0.943160017600
     2.4414e+68     2.4414e+69             4.0140e-73        -0.943160017600
     9.7656e+68     9.7656e+69             1.0035e-73        -0.943160017600

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0597
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8769e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.228
    reference variance = 0.301631
====================================================
  Execution time = 2.8622e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0372e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8234e-01
  Total weights = 1.957903218e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7187e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269779498940
                                         uncertainty =       0.001636796615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269779498940
                                         uncertainty =       0.001636796615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367217574
  error estimate for blocks of size 2^( 2) =       0.000380898698
  error estimate for blocks of size 2^( 3) =       0.000393833738
  error estimate for blocks of size 2^( 4) =       0.000402996114
  error estimate for blocks of size 2^( 5) =       0.000408665355
  error estimate for blocks of size 2^( 6) =       0.000410823433
  error estimate for blocks of size 2^( 7) =       0.000412805492

      target function =      -0.940632674916
              le_mean =     -17.212306083860
             les_mean =     296.545825501181
             stat err =       0.000408822599
             autocorr =       1.239432485708
   target nu stat err =       0.000408822599
   target dn stat err =       0.002458066322
      target stat err =       0.004267902160
              std dev =       0.519332382484
             le_variance =       0.269706123497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721230608386e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+68, overlap shift 6.1035e+69 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940650892393       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940650892393       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.52e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.52e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+68 is 2.204249e-73

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+69, overlap shift 2.4414e+70 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940650892393       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940650892393       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.52e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.52e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+69 is 5.510622e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+69, overlap shift 9.7656e+70 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940650892393       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940650892393       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940650892393       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+69 is 1.642668e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.335374 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7350e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2178
    reference variance = 0.167285
====================================================
  Execution time = 2.8320e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8032e-01
  Total weights = 1.9575e+06
  Execution time = 2.4910e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267579215044
                                         uncertainty =       0.002608085951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267579215044
                                         uncertainty =       0.002608085951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365732950
  error estimate for blocks of size 2^( 2) =       0.000379666083
  error estimate for blocks of size 2^( 3) =       0.000392359218
  error estimate for blocks of size 2^( 4) =       0.000401946768
  error estimate for blocks of size 2^( 5) =       0.000406503610
  error estimate for blocks of size 2^( 6) =       0.000409783748
  error estimate for blocks of size 2^( 7) =       0.000412745959

      target function =      -0.944063458167
              le_mean =     -17.211884007360
             les_mean =     296.529274346287
             stat err =       0.000407745021
             autocorr =       1.242937108495
   target nu stat err =       0.000407745021
   target dn stat err =       0.004849033893
      target stat err =       0.008378009338
              std dev =       0.517232774181
             le_variance =       0.267529742687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267579215044
                                         uncertainty =       0.002608085951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267579215044
                                         uncertainty =       0.002608085951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365732950
  error estimate for blocks of size 2^( 2) =       0.000379666083
  error estimate for blocks of size 2^( 3) =       0.000392359218
  error estimate for blocks of size 2^( 4) =       0.000401946768
  error estimate for blocks of size 2^( 5) =       0.000406503610
  error estimate for blocks of size 2^( 6) =       0.000409783748
  error estimate for blocks of size 2^( 7) =       0.000412745959

      target function =      -0.944063458167
              le_mean =     -17.211884007360
             les_mean =     296.529274346287
             stat err =       0.000407745021
             autocorr =       1.242937108495
   target nu stat err =       0.000407745021
   target dn stat err =       0.004849033893
      target stat err =       0.008378009338
              std dev =       0.517232774181
             le_variance =       0.267529742687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267579215044
                                         uncertainty =       0.002608085951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267579215044
                                         uncertainty =       0.002608085951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365732950
  error estimate for blocks of size 2^( 2) =       0.000379666083
  error estimate for blocks of size 2^( 3) =       0.000392359218
  error estimate for blocks of size 2^( 4) =       0.000401946768
  error estimate for blocks of size 2^( 5) =       0.000406503610
  error estimate for blocks of size 2^( 6) =       0.000409783748
  error estimate for blocks of size 2^( 7) =       0.000412745959

      target function =      -0.944063458167
              le_mean =     -17.211884007360
             les_mean =     296.529274346287
             stat err =       0.000407745021
             autocorr =       1.242937108495
   target nu stat err =       0.000407745021
   target dn stat err =       0.004849033893
      target stat err =       0.008378009338
              std dev =       0.517232774181
             le_variance =       0.267529742687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267579215044
                                         uncertainty =       0.002608085951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267579215044
                                         uncertainty =       0.002608085951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365732950
  error estimate for blocks of size 2^( 2) =       0.000379666083
  error estimate for blocks of size 2^( 3) =       0.000392359218
  error estimate for blocks of size 2^( 4) =       0.000401946768
  error estimate for blocks of size 2^( 5) =       0.000406503610
  error estimate for blocks of size 2^( 6) =       0.000409783748
  error estimate for blocks of size 2^( 7) =       0.000412745959

      target function =      -0.944063458167
              le_mean =     -17.211884007360
             les_mean =     296.529274346287
             stat err =       0.000407745021
             autocorr =       1.242937108495
   target nu stat err =       0.000407745021
   target dn stat err =       0.004849033893
      target stat err =       0.008378009338
              std dev =       0.517232774181
             le_variance =       0.267529742687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944063458167        initial  <--
     6.1035e+68     6.1035e+69             2.2042e-73        -0.944063458167
     2.4414e+69     2.4414e+70             5.5106e-74        -0.944063458167
     9.7656e+69     9.7656e+70             1.6427e-74        -0.944063458167

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8982
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8257e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1967
    reference variance = 0.265587
====================================================
  Execution time = 2.8497e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0396e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8126e-01
  Total weights = 1.957487876e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6521e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267405238261
                                         uncertainty =       0.001356067981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267405238261
                                         uncertainty =       0.001356067981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365653385
  error estimate for blocks of size 2^( 2) =       0.000379575311
  error estimate for blocks of size 2^( 3) =       0.000392305813
  error estimate for blocks of size 2^( 4) =       0.000401783511
  error estimate for blocks of size 2^( 5) =       0.000406512693
  error estimate for blocks of size 2^( 6) =       0.000410051089
  error estimate for blocks of size 2^( 7) =       0.000413636197

      target function =      -0.942502800842
              le_mean =     -17.212252734300
             les_mean =     296.542900870850
             stat err =       0.000407995872
             autocorr =       1.245008573182
   target nu stat err =       0.000407995872
   target dn stat err =       0.002194440352
      target stat err =       0.003839088491
              std dev =       0.517120250158
             le_variance =       0.267413353123


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721225273430e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+69, overlap shift 6.1035e+70 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942517375183       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942517375183       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942517375183       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+69 is 1.753436e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+70, overlap shift 2.4414e+71 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942517375183       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942517375183       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.53e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.51e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+70 is 4.383589e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+70, overlap shift 9.7656e+71 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942517375183       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942517375183       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.53e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942517375181       residual = 5.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+70 is 1.143066e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.337299 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7158e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1857
    reference variance = 0.228908
====================================================
  Execution time = 2.8183e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7680e-01
  Total weights = 1.9575e+06
  Execution time = 2.4937e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266167407608
                                         uncertainty =       0.001453913554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266167407608
                                         uncertainty =       0.001453913554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364760247
  error estimate for blocks of size 2^( 2) =       0.000378438024
  error estimate for blocks of size 2^( 3) =       0.000391094450
  error estimate for blocks of size 2^( 4) =       0.000400218451
  error estimate for blocks of size 2^( 5) =       0.000405898635
  error estimate for blocks of size 2^( 6) =       0.000407350776
  error estimate for blocks of size 2^( 7) =       0.000409509399

      target function =      -0.950230764298
              le_mean =     -17.211613623874
             les_mean =     296.516446455510
             stat err =       0.000405744315
             autocorr =       1.237342374924
   target nu stat err =       0.000405744315
   target dn stat err =       0.001985994595
      target stat err =       0.003539658286
              std dev =       0.515857141284
             le_variance =       0.266108590214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266167407608
                                         uncertainty =       0.001453913554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266167407608
                                         uncertainty =       0.001453913554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364760247
  error estimate for blocks of size 2^( 2) =       0.000378438024
  error estimate for blocks of size 2^( 3) =       0.000391094450
  error estimate for blocks of size 2^( 4) =       0.000400218451
  error estimate for blocks of size 2^( 5) =       0.000405898635
  error estimate for blocks of size 2^( 6) =       0.000407350776
  error estimate for blocks of size 2^( 7) =       0.000409509399

      target function =      -0.950230764298
              le_mean =     -17.211613623874
             les_mean =     296.516446455510
             stat err =       0.000405744315
             autocorr =       1.237342374924
   target nu stat err =       0.000405744315
   target dn stat err =       0.001985994595
      target stat err =       0.003539658286
              std dev =       0.515857141284
             le_variance =       0.266108590214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266167407608
                                         uncertainty =       0.001453913554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266167407608
                                         uncertainty =       0.001453913554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364760247
  error estimate for blocks of size 2^( 2) =       0.000378438024
  error estimate for blocks of size 2^( 3) =       0.000391094450
  error estimate for blocks of size 2^( 4) =       0.000400218451
  error estimate for blocks of size 2^( 5) =       0.000405898635
  error estimate for blocks of size 2^( 6) =       0.000407350776
  error estimate for blocks of size 2^( 7) =       0.000409509399

      target function =      -0.950230764298
              le_mean =     -17.211613623874
             les_mean =     296.516446455510
             stat err =       0.000405744315
             autocorr =       1.237342374924
   target nu stat err =       0.000405744315
   target dn stat err =       0.001985994595
      target stat err =       0.003539658286
              std dev =       0.515857141284
             le_variance =       0.266108590214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266167407608
                                         uncertainty =       0.001453913554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266167407608
                                         uncertainty =       0.001453913554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364760247
  error estimate for blocks of size 2^( 2) =       0.000378438024
  error estimate for blocks of size 2^( 3) =       0.000391094450
  error estimate for blocks of size 2^( 4) =       0.000400218451
  error estimate for blocks of size 2^( 5) =       0.000405898635
  error estimate for blocks of size 2^( 6) =       0.000407350776
  error estimate for blocks of size 2^( 7) =       0.000409509399

      target function =      -0.950230764298
              le_mean =     -17.211613623874
             les_mean =     296.516446455510
             stat err =       0.000405744315
             autocorr =       1.237342374924
   target nu stat err =       0.000405744315
   target dn stat err =       0.001985994595
      target stat err =       0.003539658286
              std dev =       0.515857141284
             le_variance =       0.266108590214


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950230764298        initial  <--
     6.1035e+69     6.1035e+70             1.7534e-74        -0.950230764298
     2.4414e+70     2.4414e+71             4.3836e-75        -0.950230764298
     9.7656e+70     9.7656e+71             1.1431e-75        -0.950230764298

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7605
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7931e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2181
    reference variance = 0.228192
====================================================
  Execution time = 3.0469e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0394e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7790e-01
  Total weights = 1.957506707e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6240e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266772381551
                                         uncertainty =       0.002292945107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266772381551
                                         uncertainty =       0.002292945107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365197197
  error estimate for blocks of size 2^( 2) =       0.000378896773
  error estimate for blocks of size 2^( 3) =       0.000391295251
  error estimate for blocks of size 2^( 4) =       0.000401260434
  error estimate for blocks of size 2^( 5) =       0.000407129924
  error estimate for blocks of size 2^( 6) =       0.000411903218
  error estimate for blocks of size 2^( 7) =       0.000413411478

      target function =      -0.948289053277
              le_mean =     -17.211957827137
             les_mean =     296.529395180895
             stat err =       0.000408426263
             autocorr =       1.250755584578
   target nu stat err =       0.000408426263
   target dn stat err =       0.003101101432
      target stat err =       0.005436947040
              std dev =       0.516475092763
             le_variance =       0.266746521445


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721195782714e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+70, overlap shift 6.1035e+71 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948318940785       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948318940785       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948318940785       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+70 is 2.742583e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+71, overlap shift 2.4414e+72 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948318940785       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948318940785       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948318940785       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+71 is 6.856457e-76

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+71, overlap shift 9.7656e+72 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948318940785       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948318940785       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948318940785       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.59e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+71 is 1.714114e-76

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.339093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9102e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2389
    reference variance = 0.277778
====================================================
  Execution time = 2.8521e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8126e-01
  Total weights = 1.9574e+06
  Execution time = 2.4917e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268534494647
                                         uncertainty =       0.001690372727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268534494647
                                         uncertainty =       0.001690372727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366498510
  error estimate for blocks of size 2^( 2) =       0.000379976512
  error estimate for blocks of size 2^( 3) =       0.000392249135
  error estimate for blocks of size 2^( 4) =       0.000401110045
  error estimate for blocks of size 2^( 5) =       0.000406741776
  error estimate for blocks of size 2^( 6) =       0.000409444307
  error estimate for blocks of size 2^( 7) =       0.000410099873

      target function =      -0.942480886398
              le_mean =     -17.212318002650
             les_mean =     296.545151939614
             stat err =       0.000406849000
             autocorr =       1.232315978854
   target nu stat err =       0.000406849000
   target dn stat err =       0.002927889623
      target stat err =       0.005080179403
              std dev =       0.518315456140
             le_variance =       0.268650912074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268534494647
                                         uncertainty =       0.001690372727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268534494647
                                         uncertainty =       0.001690372727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366498510
  error estimate for blocks of size 2^( 2) =       0.000379976512
  error estimate for blocks of size 2^( 3) =       0.000392249135
  error estimate for blocks of size 2^( 4) =       0.000401110045
  error estimate for blocks of size 2^( 5) =       0.000406741776
  error estimate for blocks of size 2^( 6) =       0.000409444307
  error estimate for blocks of size 2^( 7) =       0.000410099873

      target function =      -0.942480886398
              le_mean =     -17.212318002650
             les_mean =     296.545151939614
             stat err =       0.000406849000
             autocorr =       1.232315978854
   target nu stat err =       0.000406849000
   target dn stat err =       0.002927889623
      target stat err =       0.005080179403
              std dev =       0.518315456140
             le_variance =       0.268650912074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268534494647
                                         uncertainty =       0.001690372727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268534494647
                                         uncertainty =       0.001690372727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366498510
  error estimate for blocks of size 2^( 2) =       0.000379976512
  error estimate for blocks of size 2^( 3) =       0.000392249135
  error estimate for blocks of size 2^( 4) =       0.000401110045
  error estimate for blocks of size 2^( 5) =       0.000406741776
  error estimate for blocks of size 2^( 6) =       0.000409444307
  error estimate for blocks of size 2^( 7) =       0.000410099873

      target function =      -0.942480886398
              le_mean =     -17.212318002650
             les_mean =     296.545151939614
             stat err =       0.000406849000
             autocorr =       1.232315978854
   target nu stat err =       0.000406849000
   target dn stat err =       0.002927889623
      target stat err =       0.005080179403
              std dev =       0.518315456140
             le_variance =       0.268650912074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268534494647
                                         uncertainty =       0.001690372727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268534494647
                                         uncertainty =       0.001690372727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366498510
  error estimate for blocks of size 2^( 2) =       0.000379976512
  error estimate for blocks of size 2^( 3) =       0.000392249135
  error estimate for blocks of size 2^( 4) =       0.000401110045
  error estimate for blocks of size 2^( 5) =       0.000406741776
  error estimate for blocks of size 2^( 6) =       0.000409444307
  error estimate for blocks of size 2^( 7) =       0.000410099873

      target function =      -0.942480886398
              le_mean =     -17.212318002650
             les_mean =     296.545151939614
             stat err =       0.000406849000
             autocorr =       1.232315978854
   target nu stat err =       0.000406849000
   target dn stat err =       0.002927889623
      target stat err =       0.005080179403
              std dev =       0.518315456140
             le_variance =       0.268650912074


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942480886398        initial  <--
     6.1035e+70     6.1035e+71             2.7426e-75        -0.942480886398
     2.4414e+71     2.4414e+72             6.8565e-76        -0.942480886398
     9.7656e+71     9.7656e+72             1.7141e-76        -0.942480886398

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.1178
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0227e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.1732
    reference variance = 0.187075
====================================================
  Execution time = 2.8555e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0369e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7680e-01
  Total weights = 1.957306474e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6792e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266191582365
                                         uncertainty =       0.001251340318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266191582365
                                         uncertainty =       0.001251340318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364820536
  error estimate for blocks of size 2^( 2) =       0.000378384555
  error estimate for blocks of size 2^( 3) =       0.000391426074
  error estimate for blocks of size 2^( 4) =       0.000400785179
  error estimate for blocks of size 2^( 5) =       0.000405818374
  error estimate for blocks of size 2^( 6) =       0.000408548691
  error estimate for blocks of size 2^( 7) =       0.000410862020

      target function =      -0.950200136567
              le_mean =     -17.212873899206
             les_mean =     296.559827435201
             stat err =       0.000406503566
             autocorr =       1.241567013241
   target nu stat err =       0.000406503566
   target dn stat err =       0.001861956774
      target stat err =       0.003336875029
              std dev =       0.515942404517
             le_variance =       0.266196564779


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721287389921e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+71, overlap shift 6.1035e+72 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950210825102       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950210825102       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+71 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+72, overlap shift 2.4414e+73 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950210825102       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950210825102       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+72, overlap shift 9.7656e+73 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950210825102       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950210825102       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.340445 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7243e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.194
    reference variance = 0.214101
====================================================
  Execution time = 2.8332e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8000e-01
  Total weights = 1.9573e+06
  Execution time = 2.5029e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268334058593
                                         uncertainty =       0.001418830085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268334058593
                                         uncertainty =       0.001418830085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366296919
  error estimate for blocks of size 2^( 2) =       0.000380135442
  error estimate for blocks of size 2^( 3) =       0.000392742669
  error estimate for blocks of size 2^( 4) =       0.000402640905
  error estimate for blocks of size 2^( 5) =       0.000408409359
  error estimate for blocks of size 2^( 6) =       0.000411875811
  error estimate for blocks of size 2^( 7) =       0.000414366519

      target function =      -0.944669542741
              le_mean =     -17.212119620517
             les_mean =     296.537064321682
             stat err =       0.000409323148
             autocorr =       1.248722914812
   target nu stat err =       0.000409323148
   target dn stat err =       0.001889793725
      target stat err =       0.003342226117
              std dev =       0.518030358371
             le_variance =       0.268355452194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268334058593
                                         uncertainty =       0.001418830085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268334058593
                                         uncertainty =       0.001418830085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366296919
  error estimate for blocks of size 2^( 2) =       0.000380135442
  error estimate for blocks of size 2^( 3) =       0.000392742669
  error estimate for blocks of size 2^( 4) =       0.000402640905
  error estimate for blocks of size 2^( 5) =       0.000408409359
  error estimate for blocks of size 2^( 6) =       0.000411875811
  error estimate for blocks of size 2^( 7) =       0.000414366519

      target function =      -0.944669542741
              le_mean =     -17.212119620517
             les_mean =     296.537064321682
             stat err =       0.000409323148
             autocorr =       1.248722914812
   target nu stat err =       0.000409323148
   target dn stat err =       0.001889793725
      target stat err =       0.003342226117
              std dev =       0.518030358371
             le_variance =       0.268355452194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268334058593
                                         uncertainty =       0.001418830085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268334058593
                                         uncertainty =       0.001418830085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366296919
  error estimate for blocks of size 2^( 2) =       0.000380135442
  error estimate for blocks of size 2^( 3) =       0.000392742669
  error estimate for blocks of size 2^( 4) =       0.000402640905
  error estimate for blocks of size 2^( 5) =       0.000408409359
  error estimate for blocks of size 2^( 6) =       0.000411875811
  error estimate for blocks of size 2^( 7) =       0.000414366519

      target function =      -0.944669542741
              le_mean =     -17.212119620517
             les_mean =     296.537064321682
             stat err =       0.000409323148
             autocorr =       1.248722914812
   target nu stat err =       0.000409323148
   target dn stat err =       0.001889793725
      target stat err =       0.003342226117
              std dev =       0.518030358371
             le_variance =       0.268355452194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268334058593
                                         uncertainty =       0.001418830085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268334058593
                                         uncertainty =       0.001418830085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366296919
  error estimate for blocks of size 2^( 2) =       0.000380135442
  error estimate for blocks of size 2^( 3) =       0.000392742669
  error estimate for blocks of size 2^( 4) =       0.000402640905
  error estimate for blocks of size 2^( 5) =       0.000408409359
  error estimate for blocks of size 2^( 6) =       0.000411875811
  error estimate for blocks of size 2^( 7) =       0.000414366519

      target function =      -0.944669542741
              le_mean =     -17.212119620517
             les_mean =     296.537064321682
             stat err =       0.000409323148
             autocorr =       1.248722914812
   target nu stat err =       0.000409323148
   target dn stat err =       0.001889793725
      target stat err =       0.003342226117
              std dev =       0.518030358371
             le_variance =       0.268355452194


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944669542741        initial  <--
     6.1035e+71     6.1035e+72             0.0000e+00        -0.944669542741
     2.4414e+72     2.4414e+73             0.0000e+00        -0.944669542741
     9.7656e+72     9.7656e+73             0.0000e+00        -0.944669542741

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.9608
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8211e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2436
    reference variance = 0.298024
====================================================
  Execution time = 2.8509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0396e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8194e-01
  Total weights = 1.957443467e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7815e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268181660445
                                         uncertainty =       0.001594533540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268181660445
                                         uncertainty =       0.001594533540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366142172
  error estimate for blocks of size 2^( 2) =       0.000380020300
  error estimate for blocks of size 2^( 3) =       0.000392791101
  error estimate for blocks of size 2^( 4) =       0.000401838840
  error estimate for blocks of size 2^( 5) =       0.000406706996
  error estimate for blocks of size 2^( 6) =       0.000408876609
  error estimate for blocks of size 2^( 7) =       0.000409868680

      target function =      -0.941318440425
              le_mean =     -17.212371533354
             les_mean =     296.547675831923
             stat err =       0.000406822781
             autocorr =       1.234556648742
   target nu stat err =       0.000406822781
   target dn stat err =       0.002466194792
      target stat err =       0.004287653605
              std dev =       0.517811509723
             le_variance =       0.268128759602


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721237153335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+72, overlap shift 6.1035e+73 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941336943118       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941336943118       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+73, overlap shift 2.4414e+74 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941336943118       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941336943118       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+73, overlap shift 9.7656e+74 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941336943118       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941336943118       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.341750 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7299e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2147
    reference variance = 0.208108
====================================================
  Execution time = 2.8537e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7937e-01
  Total weights = 1.9573e+06
  Execution time = 2.5015e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267132770363
                                         uncertainty =       0.001316908402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267132770363
                                         uncertainty =       0.001316908402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365436478
  error estimate for blocks of size 2^( 2) =       0.000379325211
  error estimate for blocks of size 2^( 3) =       0.000392201210
  error estimate for blocks of size 2^( 4) =       0.000400960802
  error estimate for blocks of size 2^( 5) =       0.000406488827
  error estimate for blocks of size 2^( 6) =       0.000409456959
  error estimate for blocks of size 2^( 7) =       0.000410838312

      target function =      -0.945712711872
              le_mean =     -17.211936817309
             les_mean =     296.530142049443
             stat err =       0.000406936225
             autocorr =       1.240020626047
   target nu stat err =       0.000406936225
   target dn stat err =       0.004420629453
      target stat err =       0.007671068650
              std dev =       0.516813492859
             le_variance =       0.267096186401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267132770363
                                         uncertainty =       0.001316908402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267132770363
                                         uncertainty =       0.001316908402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365436478
  error estimate for blocks of size 2^( 2) =       0.000379325211
  error estimate for blocks of size 2^( 3) =       0.000392201210
  error estimate for blocks of size 2^( 4) =       0.000400960802
  error estimate for blocks of size 2^( 5) =       0.000406488827
  error estimate for blocks of size 2^( 6) =       0.000409456959
  error estimate for blocks of size 2^( 7) =       0.000410838312

      target function =      -0.945712711872
              le_mean =     -17.211936817309
             les_mean =     296.530142049443
             stat err =       0.000406936225
             autocorr =       1.240020626047
   target nu stat err =       0.000406936225
   target dn stat err =       0.004420629453
      target stat err =       0.007671068650
              std dev =       0.516813492859
             le_variance =       0.267096186401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267132770363
                                         uncertainty =       0.001316908402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267132770363
                                         uncertainty =       0.001316908402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365436478
  error estimate for blocks of size 2^( 2) =       0.000379325211
  error estimate for blocks of size 2^( 3) =       0.000392201210
  error estimate for blocks of size 2^( 4) =       0.000400960802
  error estimate for blocks of size 2^( 5) =       0.000406488827
  error estimate for blocks of size 2^( 6) =       0.000409456959
  error estimate for blocks of size 2^( 7) =       0.000410838312

      target function =      -0.945712711872
              le_mean =     -17.211936817309
             les_mean =     296.530142049443
             stat err =       0.000406936225
             autocorr =       1.240020626047
   target nu stat err =       0.000406936225
   target dn stat err =       0.004420629453
      target stat err =       0.007671068650
              std dev =       0.516813492859
             le_variance =       0.267096186401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267132770363
                                         uncertainty =       0.001316908402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267132770363
                                         uncertainty =       0.001316908402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365436478
  error estimate for blocks of size 2^( 2) =       0.000379325211
  error estimate for blocks of size 2^( 3) =       0.000392201210
  error estimate for blocks of size 2^( 4) =       0.000400960802
  error estimate for blocks of size 2^( 5) =       0.000406488827
  error estimate for blocks of size 2^( 6) =       0.000409456959
  error estimate for blocks of size 2^( 7) =       0.000410838312

      target function =      -0.945712711872
              le_mean =     -17.211936817309
             les_mean =     296.530142049443
             stat err =       0.000406936225
             autocorr =       1.240020626047
   target nu stat err =       0.000406936225
   target dn stat err =       0.004420629453
      target stat err =       0.007671068650
              std dev =       0.516813492859
             le_variance =       0.267096186401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945712711872        initial  <--
     6.1035e+72     6.1035e+73             0.0000e+00        -0.945712711872
     2.4414e+73     2.4414e+74             0.0000e+00        -0.945712711872
     9.7656e+73     9.7656e+74             0.0000e+00        -0.945712711872

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.2007
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8506e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2285
    reference variance = 0.36084
====================================================
  Execution time = 2.8501e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0384e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8330e-01
  Total weights = 1.957461132e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8599e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270646660722
                                         uncertainty =       0.002303715232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270646660722
                                         uncertainty =       0.002303715232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367855201
  error estimate for blocks of size 2^( 2) =       0.000381950678
  error estimate for blocks of size 2^( 3) =       0.000394882392
  error estimate for blocks of size 2^( 4) =       0.000403955699
  error estimate for blocks of size 2^( 5) =       0.000409621418
  error estimate for blocks of size 2^( 6) =       0.000414409096
  error estimate for blocks of size 2^( 7) =       0.000416408645

      target function =      -0.939040008348
              le_mean =     -17.211330612302
             les_mean =     296.513197429157
             stat err =       0.000411098715
             autocorr =       1.248930973744
   target nu stat err =       0.000411098715
   target dn stat err =       0.003413539985
      target stat err =       0.005853312197
              std dev =       0.520234137587
             le_variance =       0.270643557911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721133061230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+73, overlap shift 6.1035e+74 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939075361679       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939075361679       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+74, overlap shift 2.4414e+75 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939075361679       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939075361679       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+74 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+74, overlap shift 9.7656e+75 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939075361679       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939075361679       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+74 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.343043 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7370e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.1524
    reference variance = 0.164183
====================================================
  Execution time = 2.8429e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7893e-01
  Total weights = 1.9574e+06
  Execution time = 2.5038e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268061896503
                                         uncertainty =       0.001575583166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268061896503
                                         uncertainty =       0.001575583166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366080012
  error estimate for blocks of size 2^( 2) =       0.000380050712
  error estimate for blocks of size 2^( 3) =       0.000393157565
  error estimate for blocks of size 2^( 4) =       0.000402800769
  error estimate for blocks of size 2^( 5) =       0.000408692524
  error estimate for blocks of size 2^( 6) =       0.000411563784
  error estimate for blocks of size 2^( 7) =       0.000413619208

      target function =      -0.946540624902
              le_mean =     -17.211549270667
             les_mean =     296.516358366450
             stat err =       0.000409169072
             autocorr =       1.249262095496
   target nu stat err =       0.000409169072
   target dn stat err =       0.002003477706
      target stat err =       0.003543254066
              std dev =       0.517723601384
             le_variance =       0.268037727430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268061896503
                                         uncertainty =       0.001575583166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268061896503
                                         uncertainty =       0.001575583166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366080012
  error estimate for blocks of size 2^( 2) =       0.000380050712
  error estimate for blocks of size 2^( 3) =       0.000393157565
  error estimate for blocks of size 2^( 4) =       0.000402800769
  error estimate for blocks of size 2^( 5) =       0.000408692524
  error estimate for blocks of size 2^( 6) =       0.000411563784
  error estimate for blocks of size 2^( 7) =       0.000413619208

      target function =      -0.946540624902
              le_mean =     -17.211549270667
             les_mean =     296.516358366450
             stat err =       0.000409169072
             autocorr =       1.249262095495
   target nu stat err =       0.000409169072
   target dn stat err =       0.002003477706
      target stat err =       0.003543254066
              std dev =       0.517723601384
             le_variance =       0.268037727430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268061896503
                                         uncertainty =       0.001575583166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268061896503
                                         uncertainty =       0.001575583166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366080012
  error estimate for blocks of size 2^( 2) =       0.000380050712
  error estimate for blocks of size 2^( 3) =       0.000393157565
  error estimate for blocks of size 2^( 4) =       0.000402800769
  error estimate for blocks of size 2^( 5) =       0.000408692524
  error estimate for blocks of size 2^( 6) =       0.000411563784
  error estimate for blocks of size 2^( 7) =       0.000413619208

      target function =      -0.946540624902
              le_mean =     -17.211549270667
             les_mean =     296.516358366450
             stat err =       0.000409169072
             autocorr =       1.249262095495
   target nu stat err =       0.000409169072
   target dn stat err =       0.002003477706
      target stat err =       0.003543254066
              std dev =       0.517723601384
             le_variance =       0.268037727430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268061896503
                                         uncertainty =       0.001575583166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268061896503
                                         uncertainty =       0.001575583166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366080012
  error estimate for blocks of size 2^( 2) =       0.000380050712
  error estimate for blocks of size 2^( 3) =       0.000393157565
  error estimate for blocks of size 2^( 4) =       0.000402800769
  error estimate for blocks of size 2^( 5) =       0.000408692524
  error estimate for blocks of size 2^( 6) =       0.000411563784
  error estimate for blocks of size 2^( 7) =       0.000413619208

      target function =      -0.946540624902
              le_mean =     -17.211549270667
             les_mean =     296.516358366450
             stat err =       0.000409169072
             autocorr =       1.249262095495
   target nu stat err =       0.000409169072
   target dn stat err =       0.002003477706
      target stat err =       0.003543254066
              std dev =       0.517723601384
             le_variance =       0.268037727430


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946540624902        initial  <--
     6.1035e+73     6.1035e+74             0.0000e+00        -0.946540624902
     2.4414e+74     2.4414e+75             0.0000e+00        -0.946540624902
     9.7656e+74     9.7656e+75             0.0000e+00        -0.946540624902

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0189
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8395e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.1892
    reference variance = 0.166867
====================================================
  Execution time = 3.0597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0423e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8324e-01
  Total weights = 1.957469458e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7363e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270461202016
                                         uncertainty =       0.001718083576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270461202016
                                         uncertainty =       0.001718083576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367748890
  error estimate for blocks of size 2^( 2) =       0.000381174888
  error estimate for blocks of size 2^( 3) =       0.000394049021
  error estimate for blocks of size 2^( 4) =       0.000403698344
  error estimate for blocks of size 2^( 5) =       0.000408374410
  error estimate for blocks of size 2^( 6) =       0.000410068697
  error estimate for blocks of size 2^( 7) =       0.000411815617

      target function =      -0.939104566621
              le_mean =     -17.212221544002
             les_mean =     296.543809703697
             stat err =       0.000408489267
             autocorr =       1.233839188821
   target nu stat err =       0.000408489267
   target dn stat err =       0.002802241074
      target stat err =       0.004832044710
              std dev =       0.520083788395
             le_variance =       0.270487146952


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721222154400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+74, overlap shift 6.1035e+75 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939128334361       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939128334361       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+74 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+75, overlap shift 2.4414e+76 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939128334361       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939128334361       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+75 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+75, overlap shift 9.7656e+76 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939128334361       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939128334361       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+75 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.344347 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9341e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2124
    reference variance = 0.438482
====================================================
  Execution time = 2.8129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7954e-01
  Total weights = 1.9574e+06
  Execution time = 2.5443e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267510079708
                                         uncertainty =       0.001514590729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267510079708
                                         uncertainty =       0.001514590729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365724738
  error estimate for blocks of size 2^( 2) =       0.000379262843
  error estimate for blocks of size 2^( 3) =       0.000392189324
  error estimate for blocks of size 2^( 4) =       0.000401270117
  error estimate for blocks of size 2^( 5) =       0.000406105694
  error estimate for blocks of size 2^( 6) =       0.000410116272
  error estimate for blocks of size 2^( 7) =       0.000412912461

      target function =      -0.945478202947
              le_mean =     -17.211714038672
             les_mean =     296.522638777486
             stat err =       0.000407601136
             autocorr =       1.242115828542
   target nu stat err =       0.000407601136
   target dn stat err =       0.002402536465
      target stat err =       0.004211662362
              std dev =       0.517221160392
             le_variance =       0.267517728758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267510079708
                                         uncertainty =       0.001514590729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267510079708
                                         uncertainty =       0.001514590729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365724738
  error estimate for blocks of size 2^( 2) =       0.000379262843
  error estimate for blocks of size 2^( 3) =       0.000392189324
  error estimate for blocks of size 2^( 4) =       0.000401270117
  error estimate for blocks of size 2^( 5) =       0.000406105694
  error estimate for blocks of size 2^( 6) =       0.000410116272
  error estimate for blocks of size 2^( 7) =       0.000412912461

      target function =      -0.945478202947
              le_mean =     -17.211714038672
             les_mean =     296.522638777486
             stat err =       0.000407601136
             autocorr =       1.242115828543
   target nu stat err =       0.000407601136
   target dn stat err =       0.002402536465
      target stat err =       0.004211662362
              std dev =       0.517221160392
             le_variance =       0.267517728758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267510079708
                                         uncertainty =       0.001514590729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267510079708
                                         uncertainty =       0.001514590729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365724738
  error estimate for blocks of size 2^( 2) =       0.000379262843
  error estimate for blocks of size 2^( 3) =       0.000392189324
  error estimate for blocks of size 2^( 4) =       0.000401270117
  error estimate for blocks of size 2^( 5) =       0.000406105694
  error estimate for blocks of size 2^( 6) =       0.000410116272
  error estimate for blocks of size 2^( 7) =       0.000412912461

      target function =      -0.945478202947
              le_mean =     -17.211714038672
             les_mean =     296.522638777486
             stat err =       0.000407601136
             autocorr =       1.242115828543
   target nu stat err =       0.000407601136
   target dn stat err =       0.002402536465
      target stat err =       0.004211662362
              std dev =       0.517221160392
             le_variance =       0.267517728758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267510079708
                                         uncertainty =       0.001514590729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267510079708
                                         uncertainty =       0.001514590729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365724738
  error estimate for blocks of size 2^( 2) =       0.000379262843
  error estimate for blocks of size 2^( 3) =       0.000392189324
  error estimate for blocks of size 2^( 4) =       0.000401270117
  error estimate for blocks of size 2^( 5) =       0.000406105694
  error estimate for blocks of size 2^( 6) =       0.000410116272
  error estimate for blocks of size 2^( 7) =       0.000412912461

      target function =      -0.945478202947
              le_mean =     -17.211714038672
             les_mean =     296.522638777486
             stat err =       0.000407601136
             autocorr =       1.242115828543
   target nu stat err =       0.000407601136
   target dn stat err =       0.002402536465
      target stat err =       0.004211662362
              std dev =       0.517221160392
             le_variance =       0.267517728758


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945478202947        initial  <--
     6.1035e+74     6.1035e+75             0.0000e+00        -0.945478202947
     2.4414e+75     2.4414e+76             0.0000e+00        -0.945478202947
     9.7656e+75     9.7656e+76             0.0000e+00        -0.945478202947

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8225
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0171e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2132
    reference variance = 0.180743
====================================================
  Execution time = 2.8745e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0390e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7799e-01
  Total weights = 1.957494754e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7164e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266177074988
                                         uncertainty =       0.001390891514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266177074988
                                         uncertainty =       0.001390891514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364850572
  error estimate for blocks of size 2^( 2) =       0.000378872329
  error estimate for blocks of size 2^( 3) =       0.000391455322
  error estimate for blocks of size 2^( 4) =       0.000400765450
  error estimate for blocks of size 2^( 5) =       0.000405200647
  error estimate for blocks of size 2^( 6) =       0.000408680528
  error estimate for blocks of size 2^( 7) =       0.000410070470

      target function =      -0.948158424081
              le_mean =     -17.211413512204
             les_mean =     296.510747697050
             stat err =       0.000406179274
             autocorr =       1.239382773288
   target nu stat err =       0.000406179274
   target dn stat err =       0.002680326867
      target stat err =       0.004707345021
              std dev =       0.515984882071
             le_variance =       0.266240398526


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721141351220e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+75, overlap shift 6.1035e+76 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948180634215       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948180634215       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+75 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+76, overlap shift 2.4414e+77 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948180634215       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948180634215       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+76 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+76, overlap shift 9.7656e+77 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948180634215       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948180634215       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+76 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.345656 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7472e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.3589
    reference variance = 0.372389
====================================================
  Execution time = 2.8202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8061e-01
  Total weights = 1.9574e+06
  Execution time = 2.5470e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267332676798
                                         uncertainty =       0.001907390053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267332676798
                                         uncertainty =       0.001907390053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365560474
  error estimate for blocks of size 2^( 2) =       0.000379408164
  error estimate for blocks of size 2^( 3) =       0.000391985456
  error estimate for blocks of size 2^( 4) =       0.000401368048
  error estimate for blocks of size 2^( 5) =       0.000406514931
  error estimate for blocks of size 2^( 6) =       0.000409342494
  error estimate for blocks of size 2^( 7) =       0.000410796259

      target function =      -0.943600847234
              le_mean =     -17.212308710160
             les_mean =     296.544184367987
             stat err =       0.000407005433
             autocorr =       1.239601089228
   target nu stat err =       0.000407005433
   target dn stat err =       0.002537851040
      target stat err =       0.004429199406
              std dev =       0.516988851893
             le_variance =       0.267277472981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267332676798
                                         uncertainty =       0.001907390053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267332676798
                                         uncertainty =       0.001907390053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365560474
  error estimate for blocks of size 2^( 2) =       0.000379408164
  error estimate for blocks of size 2^( 3) =       0.000391985456
  error estimate for blocks of size 2^( 4) =       0.000401368048
  error estimate for blocks of size 2^( 5) =       0.000406514931
  error estimate for blocks of size 2^( 6) =       0.000409342494
  error estimate for blocks of size 2^( 7) =       0.000410796259

      target function =      -0.943600847234
              le_mean =     -17.212308710160
             les_mean =     296.544184367987
             stat err =       0.000407005433
             autocorr =       1.239601089228
   target nu stat err =       0.000407005433
   target dn stat err =       0.002537851040
      target stat err =       0.004429199406
              std dev =       0.516988851893
             le_variance =       0.267277472981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267332676798
                                         uncertainty =       0.001907390053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267332676798
                                         uncertainty =       0.001907390053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365560474
  error estimate for blocks of size 2^( 2) =       0.000379408164
  error estimate for blocks of size 2^( 3) =       0.000391985456
  error estimate for blocks of size 2^( 4) =       0.000401368048
  error estimate for blocks of size 2^( 5) =       0.000406514931
  error estimate for blocks of size 2^( 6) =       0.000409342494
  error estimate for blocks of size 2^( 7) =       0.000410796259

      target function =      -0.943600847234
              le_mean =     -17.212308710160
             les_mean =     296.544184367987
             stat err =       0.000407005433
             autocorr =       1.239601089228
   target nu stat err =       0.000407005433
   target dn stat err =       0.002537851040
      target stat err =       0.004429199406
              std dev =       0.516988851893
             le_variance =       0.267277472981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267332676798
                                         uncertainty =       0.001907390053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267332676798
                                         uncertainty =       0.001907390053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365560474
  error estimate for blocks of size 2^( 2) =       0.000379408164
  error estimate for blocks of size 2^( 3) =       0.000391985456
  error estimate for blocks of size 2^( 4) =       0.000401368048
  error estimate for blocks of size 2^( 5) =       0.000406514931
  error estimate for blocks of size 2^( 6) =       0.000409342494
  error estimate for blocks of size 2^( 7) =       0.000410796259

      target function =      -0.943600847234
              le_mean =     -17.212308710160
             les_mean =     296.544184367987
             stat err =       0.000407005433
             autocorr =       1.239601089228
   target nu stat err =       0.000407005433
   target dn stat err =       0.002537851040
      target stat err =       0.004429199406
              std dev =       0.516988851893
             le_variance =       0.267277472981


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943600847234        initial  <--
     6.1035e+75     6.1035e+76             0.0000e+00        -0.943600847234
     2.4414e+76     2.4414e+77             0.0000e+00        -0.943600847234
     9.7656e+76     9.7656e+77             0.0000e+00        -0.943600847234

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8950
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8374e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2418
    reference variance = 0.436077
====================================================
  Execution time = 2.8320e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0401e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8112e-01
  Total weights = 1.957307230e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8702e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268825792976
                                         uncertainty =       0.001620928588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268825792976
                                         uncertainty =       0.001620928588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366612086
  error estimate for blocks of size 2^( 2) =       0.000380438295
  error estimate for blocks of size 2^( 3) =       0.000392973987
  error estimate for blocks of size 2^( 4) =       0.000402345747
  error estimate for blocks of size 2^( 5) =       0.000407088604
  error estimate for blocks of size 2^( 6) =       0.000410459872
  error estimate for blocks of size 2^( 7) =       0.000412776356

      target function =      -0.942770851615
              le_mean =     -17.211381518759
             les_mean =     296.512775802534
             stat err =       0.000408167645
             autocorr =       1.239548700349
   target nu stat err =       0.000408167645
   target dn stat err =       0.002204033938
      target stat err =       0.003850975501
              std dev =       0.518476079438
             le_variance =       0.268817444949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721138151876e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+76, overlap shift 6.1035e+77 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942785531832       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942785531832       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+76 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+77, overlap shift 2.4414e+78 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942785531832       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942785531832       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+77 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+77, overlap shift 9.7656e+78 and omega -1.7730e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942785531832       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942785531832       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+77 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              20.347024 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7199e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2209
    reference variance = 0.133145
====================================================
  Execution time = 2.8179e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8219e-01
  Total weights = 1.9575e+06
  Execution time = 2.5441e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268371563472
                                         uncertainty =       0.001490504325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268371563472
                                         uncertainty =       0.001490504325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366280043
  error estimate for blocks of size 2^( 2) =       0.000379862795
  error estimate for blocks of size 2^( 3) =       0.000392667868
  error estimate for blocks of size 2^( 4) =       0.000401936163
  error estimate for blocks of size 2^( 5) =       0.000406874579
  error estimate for blocks of size 2^( 6) =       0.000408959934
  error estimate for blocks of size 2^( 7) =       0.000412079826

      target function =      -0.940912668949
              le_mean =     -17.211901244296
             les_mean =     296.531736430820
             stat err =       0.000407462625
             autocorr =       1.237510932090
   target nu stat err =       0.000407462625
   target dn stat err =       0.002469844932
      target stat err =       0.004286469480
              std dev =       0.518006493030
             le_variance =       0.268330726821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268371563472
                                         uncertainty =       0.001490504325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268371563472
                                         uncertainty =       0.001490504325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366280043
  error estimate for blocks of size 2^( 2) =       0.000379862795
  error estimate for blocks of size 2^( 3) =       0.000392667868
  error estimate for blocks of size 2^( 4) =       0.000401936163
  error estimate for blocks of size 2^( 5) =       0.000406874579
  error estimate for blocks of size 2^( 6) =       0.000408959934
  error estimate for blocks of size 2^( 7) =       0.000412079826

      target function =      -0.940912668949
              le_mean =     -17.211901244296
             les_mean =     296.531736430820
             stat err =       0.000407462625
             autocorr =       1.237510932090
   target nu stat err =       0.000407462625
   target dn stat err =       0.002469844932
      target stat err =       0.004286469480
              std dev =       0.518006493030
             le_variance =       0.268330726821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268371563472
                                         uncertainty =       0.001490504325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268371563472
                                         uncertainty =       0.001490504325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366280043
  error estimate for blocks of size 2^( 2) =       0.000379862795
  error estimate for blocks of size 2^( 3) =       0.000392667868
  error estimate for blocks of size 2^( 4) =       0.000401936163
  error estimate for blocks of size 2^( 5) =       0.000406874579
  error estimate for blocks of size 2^( 6) =       0.000408959934
  error estimate for blocks of size 2^( 7) =       0.000412079826

      target function =      -0.940912668949
              le_mean =     -17.211901244296
             les_mean =     296.531736430820
             stat err =       0.000407462625
             autocorr =       1.237510932090
   target nu stat err =       0.000407462625
   target dn stat err =       0.002469844932
      target stat err =       0.004286469480
              std dev =       0.518006493030
             le_variance =       0.268330726821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268371563472
                                         uncertainty =       0.001490504325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268371563472
                                         uncertainty =       0.001490504325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366280043
  error estimate for blocks of size 2^( 2) =       0.000379862795
  error estimate for blocks of size 2^( 3) =       0.000392667868
  error estimate for blocks of size 2^( 4) =       0.000401936163
  error estimate for blocks of size 2^( 5) =       0.000406874579
  error estimate for blocks of size 2^( 6) =       0.000408959934
  error estimate for blocks of size 2^( 7) =       0.000412079826

      target function =      -0.940912668949
              le_mean =     -17.211901244296
             les_mean =     296.531736430820
             stat err =       0.000407462625
             autocorr =       1.237510932090
   target nu stat err =       0.000407462625
   target dn stat err =       0.002469844932
      target stat err =       0.004286469480
              std dev =       0.518006493030
             le_variance =       0.268330726821


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940912668949        initial  <--
     6.1035e+76     6.1035e+77             0.0000e+00        -0.940912668949
     2.4414e+77     2.4414e+78             0.0000e+00        -0.940912668949
     9.7656e+77     9.7656e+78             0.0000e+00        -0.940912668949

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8620
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.044049e-01 1 1  ON 0
  uu_1                 4.988172e-02 1 1  ON 1
  uu_2                -3.713955e-02 1 1  ON 2
  uu_3                -8.925708e-02 1 1  ON 3
  uu_4                -1.214676e-01 1 1  ON 4
  uu_5                -1.310164e-01 1 1  ON 5
  uu_6                -1.134123e-01 1 1  ON 6
  uu_7                -5.305414e-02 1 1  ON 7
  uu_8                 6.790966e-02 1 1  ON 8
  uu_9                 1.227838e-01 1 1  ON 9
  ud_0                 3.008594e-01 1 1  ON 10
  ud_1                 7.519903e-02 1 1  ON 11
  ud_2                -2.260582e-02 1 1  ON 12
  ud_3                -7.408309e-02 1 1  ON 13
  ud_4                -1.109131e-01 1 1  ON 14
  ud_5                -1.323341e-01 1 1  ON 15
  ud_6                -1.288013e-01 1 1  ON 16
  ud_7                -8.874487e-02 1 1  ON 17
  ud_8                -5.449381e-03 1 1  ON 18
  ud_9                 8.696731e-02 1 1  ON 19
  eO_0                -6.913675e-01 1 1  ON 20
  eO_1                -4.145343e-01 1 1  ON 21
  eO_2                -4.648905e-02 1 1  ON 22
  eO_3                 1.762133e-01 1 1  ON 23
  eO_4                 2.543433e-01 1 1  ON 24
  eO_5                 2.838626e-01 1 1  ON 25
  eO_6                 2.507133e-01 1 1  ON 26
  eO_7                 1.287993e-01 1 1  ON 27
  eO_8                 2.881319e-02 1 1  ON 28
  eO_9                 1.878885e-02 1 1  ON 29
 eH1_0                -1.994338e-01 1 1  ON 30
 eH1_1                -9.607910e-02 1 1  ON 31
 eH1_2                -4.633839e-02 1 1  ON 32
 eH1_3                -1.582884e-02 1 1  ON 33
 eH1_4                 1.718275e-02 1 1  ON 34
 eH1_5                 2.178434e-02 1 1  ON 35
 eH1_6                 7.136811e-02 1 1  ON 36
 eH1_7                 1.074390e-01 1 1  ON 37
 eH1_8                 9.877943e-02 1 1  ON 38
 eH1_9                 2.573741e-02 1 1  ON 39
 eH2_0                -1.994286e-01 1 1  ON 40
 eH2_1                -9.549583e-02 1 1  ON 41
 eH2_2                -4.597774e-02 1 1  ON 42
 eH2_3                -1.558998e-02 1 1  ON 43
 eH2_4                 1.672829e-02 1 1  ON 44
 eH2_5                 1.989118e-02 1 1  ON 45
 eH2_6                 7.051387e-02 1 1  ON 46
 eH2_7                 1.077254e-01 1 1  ON 47
 eH2_8                 1.012759e-01 1 1  ON 48
 eH2_9                 2.801404e-02 1 1  ON 49
ci_001                -4.167675e-02 3 1  ON 50
ci_002                -3.106842e-02 3 1  ON 51
ci_003                -2.590538e-02 3 1  ON 52
ci_004                 2.323290e-02 3 1  ON 53
ci_005                 2.357501e-02 3 1  ON 54
ci_006                -2.037306e-02 3 1  ON 55
ci_007                -2.033928e-02 3 1  ON 56
ci_008                -8.626093e-03 3 1  ON 57
ci_009                -1.515174e-02 3 1  ON 58
ci_010                -9.992095e-03 3 1  ON 59
ci_011                -1.062331e-02 3 1  ON 60
ci_012                -1.048230e-02 3 1  ON 61
ci_013                -1.965355e-02 3 1  ON 62
ci_014                 1.279743e-02 3 1  ON 63
ci_015                 1.247330e-02 3 1  ON 64
ci_016                 1.656524e-02 3 1  ON 65
ci_017                 1.680074e-02 3 1  ON 66
ci_018                 1.019204e-02 3 1  ON 67
ci_019                 1.022633e-02 3 1  ON 68
ci_020                 1.657113e-02 3 1  ON 69
ci_021                 1.630058e-02 3 1  ON 70
ci_022                 9.118008e-03 3 1  ON 71
ci_023                 8.970016e-03 3 1  ON 72
ci_024                 9.525539e-03 3 1  ON 73
ci_025                 9.507856e-03 3 1  ON 74
ci_026                 1.093620e-02 3 1  ON 75
ci_027                 1.083914e-02 3 1  ON 76
ci_028                -1.492236e-02 3 1  ON 77
ci_029                -1.549468e-02 3 1  ON 78
ci_030                -9.015633e-03 3 1  ON 79
ci_031                -9.013499e-03 3 1  ON 80
ci_032                -1.505408e-02 3 1  ON 81
ci_033                 6.493638e-03 3 1  ON 82
ci_034                 6.287912e-03 3 1  ON 83
ci_035                -4.802661e-03 3 1  ON 84
ci_036                -1.209838e-02 3 1  ON 85
ci_037                -1.261900e-02 3 1  ON 86
ci_038                 1.593972e-03 3 1  ON 87
ci_039                 1.666218e-03 3 1  ON 88
ci_040                -2.832428e-03 3 1  ON 89
ci_041                 8.471458e-03 3 1  ON 90
ci_042                 8.502116e-03 3 1  ON 91
ci_043                -3.829354e-03 3 1  ON 92
ci_044                -4.411380e-03 3 1  ON 93
ci_045                -2.917640e-03 3 1  ON 94
ci_046                 5.850016e-03 3 1  ON 95
ci_047                 5.913926e-03 3 1  ON 96
ci_048                -1.327414e-02 3 1  ON 97
ci_049                -1.356132e-02 3 1  ON 98
ci_050                 3.367178e-03 3 1  ON 99
ci_051                 3.292132e-03 3 1  ON 100
ci_052                -2.511628e-03 3 1  ON 101
ci_053                -2.567104e-03 3 1  ON 102
ci_054                -2.551872e-03 3 1  ON 103
ci_055                -2.591186e-03 3 1  ON 104
ci_056                 5.110884e-03 3 1  ON 105
ci_057                 5.100229e-03 3 1  ON 106
ci_058                -1.763475e-03 3 1  ON 107
ci_059                -2.023357e-03 3 1  ON 108
ci_060                 5.598441e-03 3 1  ON 109
ci_061                 5.390359e-03 3 1  ON 110
ci_062                -3.961621e-03 3 1  ON 111
ci_063                -4.104261e-03 3 1  ON 112
ci_064                -3.324938e-03 3 1  ON 113
ci_065                -4.231096e-03 3 1  ON 114
ci_066                 4.486492e-03 3 1  ON 115
ci_067                 4.352206e-03 3 1  ON 116
ci_068                -5.028858e-03 3 1  ON 117
ci_069                -4.831817e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8070e+01 secs
  Total Execution time = 7.8784e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
