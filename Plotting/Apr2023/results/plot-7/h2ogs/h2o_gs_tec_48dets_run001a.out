Rank =    0  Free Memory = 55346 MB
Rank =    1  Free Memory = 55339 MB
Rank =    2  Free Memory = 55339 MB
Rank =    3  Free Memory = 55339 MB
Rank =    4  Free Memory = 55338 MB
Rank =    5  Free Memory = 55338 MB
Rank =    6  Free Memory = 55338 MB
Rank =    7  Free Memory = 55338 MB
Rank =    8  Free Memory = 55338 MB
Rank =    9  Free Memory = 55338 MB
Rank =   10  Free Memory = 55338 MB
Rank =   11  Free Memory = 55338 MB
Rank =   12  Free Memory = 55338 MB
Rank =   13  Free Memory = 55338 MB
Rank =   14  Free Memory = 55338 MB
Rank =   15  Free Memory = 55327 MB
Rank =   16  Free Memory = 55322 MB
Rank =   17  Free Memory = 55319 MB
Rank =   18  Free Memory = 55319 MB
Rank =   19  Free Memory = 55319 MB
Rank =   20  Free Memory = 55319 MB
Rank =   21  Free Memory = 55319 MB
Rank =   22  Free Memory = 55319 MB
Rank =   23  Free Memory = 55319 MB
Rank =   24  Free Memory = 56275 MB
Rank =   25  Free Memory = 56275 MB
Rank =   26  Free Memory = 56275 MB
Rank =   27  Free Memory = 56275 MB
Rank =   28  Free Memory = 56275 MB
Rank =   29  Free Memory = 56275 MB
Rank =   30  Free Memory = 56275 MB
Rank =   31  Free Memory = 56275 MB
Rank =   32  Free Memory = 56275 MB
Rank =   33  Free Memory = 56275 MB
Rank =   34  Free Memory = 56275 MB
Rank =   35  Free Memory = 56275 MB
Rank =   36  Free Memory = 56275 MB
Rank =   37  Free Memory = 56275 MB
Rank =   38  Free Memory = 56275 MB
Rank =   39  Free Memory = 56275 MB
Rank =   40  Free Memory = 56275 MB
Rank =   41  Free Memory = 56275 MB
Rank =   42  Free Memory = 56275 MB
Rank =   43  Free Memory = 56275 MB
Rank =   44  Free Memory = 56275 MB
Rank =   45  Free Memory = 56275 MB
Rank =   46  Free Memory = 56275 MB
Rank =   47  Free Memory = 56275 MB
Rank =   48  Free Memory = 55600 MB
Rank =   49  Free Memory = 55600 MB
Rank =   50  Free Memory = 55600 MB
Rank =   51  Free Memory = 55600 MB
Rank =   52  Free Memory = 55600 MB
Rank =   53  Free Memory = 55600 MB
Rank =   54  Free Memory = 55600 MB
Rank =   55  Free Memory = 55600 MB
Rank =   56  Free Memory = 55600 MB
Rank =   57  Free Memory = 55600 MB
Rank =   58  Free Memory = 55600 MB
Rank =   59  Free Memory = 55599 MB
Rank =   60  Free Memory = 55599 MB
Rank =   61  Free Memory = 55599 MB
Rank =   62  Free Memory = 55599 MB
Rank =   63  Free Memory = 55599 MB
Rank =   64  Free Memory = 55599 MB
Rank =   65  Free Memory = 55599 MB
Rank =   66  Free Memory = 55599 MB
Rank =   67  Free Memory = 55599 MB
Rank =   68  Free Memory = 55599 MB
Rank =   69  Free Memory = 55599 MB
Rank =   70  Free Memory = 55599 MB
Rank =   71  Free Memory = 55599 MB
Rank =   72  Free Memory = 52205 MB
Rank =   73  Free Memory = 52205 MB
Rank =   74  Free Memory = 52205 MB
Rank =   75  Free Memory = 52205 MB
Rank =   76  Free Memory = 52205 MB
Rank =   77  Free Memory = 52205 MB
Rank =   78  Free Memory = 52205 MB
Rank =   79  Free Memory = 52205 MB
Rank =   80  Free Memory = 52205 MB
Rank =   81  Free Memory = 52205 MB
Rank =   82  Free Memory = 52204 MB
Rank =   83  Free Memory = 52204 MB
Rank =   84  Free Memory = 52204 MB
Rank =   85  Free Memory = 52204 MB
Rank =   86  Free Memory = 52204 MB
Rank =   87  Free Memory = 52204 MB
Rank =   88  Free Memory = 52204 MB
Rank =   89  Free Memory = 52204 MB
Rank =   90  Free Memory = 52204 MB
Rank =   91  Free Memory = 52199 MB
Rank =   92  Free Memory = 52198 MB
Rank =   93  Free Memory = 52198 MB
Rank =   94  Free Memory = 52198 MB
Rank =   95  Free Memory = 52198 MB
  Input file(s): opt_h2o_gs_tec_48dets_run001a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 96
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 96
  MPI ranks per node        = 24
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tec_48dets_run001a.xml

  Project = H2O
  date    = 2023-05-02 17:50:10 PDT
  host    = n0059.savio2

 Random Number
 -------------
  Offset for the random number seeds based on time: 962

  Range of prime numbers to use as seeds over processors and threads = 7589-8501


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.920054e-01    1         1  ON     0
     uu_1                 3.590195e-02    1         1  ON     1
     uu_2                -4.559320e-02    1         1  ON     2
     uu_3                -9.369633e-02    1         1  ON     3
     uu_4                -1.254424e-01    1         1  ON     4
     uu_5                -1.327025e-01    1         1  ON     5
     uu_6                -1.091659e-01    1         1  ON     6
     uu_7                -3.320891e-02    1         1  ON     7
     uu_8                 1.030981e-01    1         1  ON     8
     uu_9                 1.188130e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.150780e-01    1         1  ON     0
     ud_1                 7.590189e-02    1         1  ON     1
     ud_2                -7.338664e-03    1         1  ON     2
     ud_3                -5.544926e-02    1         1  ON     3
     ud_4                -1.064782e-01    1         1  ON     4
     ud_5                -1.490405e-01    1         1  ON     5
     ud_6                -1.574171e-01    1         1  ON     6
     ud_7                -1.077761e-01    1         1  ON     7
     ud_8                 9.772284e-03    1         1  ON     8
     ud_9                 9.249491e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.811694e-01    1         1  ON     0
     eO_1                -4.031104e-01    1         1  ON     1
     eO_2                -6.148616e-02    1         1  ON     2
     eO_3                 1.622033e-01    1         1  ON     3
     eO_4                 2.643764e-01    1         1  ON     4
     eO_5                 3.070668e-01    1         1  ON     5
     eO_6                 2.482256e-01    1         1  ON     6
     eO_7                 1.081366e-01    1         1  ON     7
     eO_8                 2.727328e-02    1         1  ON     8
     eO_9                 1.812982e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.758229e-01    1         1  ON     0
     eH1_1                -9.847470e-02    1         1  ON     1
     eH1_2                -6.212571e-02    1         1  ON     2
     eH1_3                -2.890051e-02    1         1  ON     3
     eH1_4                 1.766763e-02    1         1  ON     4
     eH1_5                 3.105966e-02    1         1  ON     5
     eH1_6                 7.793809e-02    1         1  ON     6
     eH1_7                 1.115220e-01    1         1  ON     7
     eH1_8                 8.853209e-02    1         1  ON     8
     eH1_9                 2.358450e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.775251e-01    1         1  ON     0
     eH2_1                -1.001865e-01    1         1  ON     1
     eH2_2                -6.424989e-02    1         1  ON     2
     eH2_3                -3.037191e-02    1         1  ON     3
     eH2_4                 1.621523e-02    1         1  ON     4
     eH2_5                 3.146665e-02    1         1  ON     5
     eH2_6                 8.031567e-02    1         1  ON     6
     eH2_7                 1.152651e-01    1         1  ON     7
     eH2_8                 9.158550e-02    1         1  ON     8
     eH2_9                 2.561491e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 48 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.922455e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 19 unique up determinants.
Found 19 unique down determinants.
Number of terms in pairs array: 18
Number of terms in pairs array: 18
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.5060e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 97
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1956
    reference variance = 0.431388
====================================================
  Execution time = 2.7719e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0457e+04
  VMC Eavg = -1.7199e+01
  VMC Evar = 3.9553e-01
  Total weights = 1.963409071e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2602e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376192988863
                                         uncertainty =       0.003094291715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376192988863
                                         uncertainty =       0.003094291715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433668065
  error estimate for blocks of size 2^( 2) =       0.000445841500
  error estimate for blocks of size 2^( 3) =       0.000456837927
  error estimate for blocks of size 2^( 4) =       0.000464401693
  error estimate for blocks of size 2^( 5) =       0.000468373900
  error estimate for blocks of size 2^( 6) =       0.000470313403
  error estimate for blocks of size 2^( 7) =       0.000471104391

      target function =      -0.794213870114
              le_mean =     -17.199283428773
             les_mean =     296.210881585976
             stat err =       0.000468548347
             autocorr =       1.167330773719
   target nu stat err =       0.000468548347
   target dn stat err =       0.003931734291
      target stat err =       0.003813524858
              std dev =       0.613309072233
             le_variance =       0.376148018084


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.719928342877e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.794231517823       residual = 1.48e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.813235616512       residual = 3.19e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.817269020407       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.818651047712       residual = 3.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.819063550564       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.819263297296       residual = 8.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.819416837857       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.819567151316       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.819706828589       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.819785003279       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.819827250884       residual = 7.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.819840440420       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.819849176462       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.819855262332       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.819857096623       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.819862638527       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.819866007991       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.819869596670       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.819872896253       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.819875948936       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.819877123024       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.819879358300       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.819880381665       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.819881803027       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.819882153548       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.819882399139       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.819882644036       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.819883370135       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.819883456300       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.819883628148       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.819883944228       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.819883946766       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.819883824577       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.819883916473       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.819883961729       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.819884039122       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.819884223299       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.819884185120       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.819884161623       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.819884548875       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.819884549542       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.819884623359       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.819884634866       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.819884584755       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.819884626864       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.819884554973       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.819884529581       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.819884535888       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.819884523607       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.819884558444       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.819884566744       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.819884563641       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         51 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e-01 is 6.705204e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.794231517823       residual = 1.48e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.799787492721       residual = 3.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.800903227143       residual = 9.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.801286496042       residual = 2.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.801401167929       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.801455503472       residual = 8.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.801497882986       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.801541255114       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.801579290930       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.801600166866       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.801610842654       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.801614481911       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.801615874942       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.801618188426       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.801618901145       residual = 8.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.801620402793       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.801621272377       residual = 9.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.801622194006       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.801623024926       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.801623763543       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.801624028089       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.801624570947       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.801624803329       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.801625124468       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.801625167300       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.801625201937       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.801625274979       residual = 8.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.801625414987       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.801625403390       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.801625446398       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.801625524247       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.801625507437       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.801625476695       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.801625486013       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.801625509332       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.801625517611       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.801625558202       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.801625549025       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.801625562128       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.801625639242       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.801625627553       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.801625632635       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.801625638754       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.801625624299       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.801625625987       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.801625614958       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.801625606892       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.801625612898       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.801625611551       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.801625617053       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         49 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 1.957051e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.794231517823       residual = 1.48e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.795680177929       residual = 3.02e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.795965666231       residual = 9.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.796063920412       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.796093307833       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.796107165120       residual = 7.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.796118006816       residual = 5.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.796129239535       residual = 3.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.796138908766       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.796144194108       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.796146850299       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.796147777038       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.796148113234       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.796148715359       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.796148900297       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.796149284452       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.796149500723       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.796149732728       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.796149938884       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.796150119671       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.796150184486       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.796150317723       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.796150373568       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.796150450579       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.796150459289       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.796150465816       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.796150485006       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.796150515587       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.796150511369       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.796150523156       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.796150541202       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.796150536321       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.796150528302       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.796150530451       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.796150536781       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.796150537605       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.796150548361       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.796150545452       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.796150553138       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.796150567169       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.796150563824       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.796150565251       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.796150566498       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.796150562921       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.796150562986       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.796150560504       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.796150558596       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.796150560445       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.796150560159       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.796150561235       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         49 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 5.101465e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201978 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6192e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0   1.928203e-01                 1 1 ON  0
uu_1   3.673330e-02                 1 1 ON  1
uu_2   -4.534012e-02                1 1 ON  2
uu_3   -9.384335e-02                1 1 ON  3
uu_4   -1.256174e-01                1 1 ON  4
uu_5   -1.328998e-01                1 1 ON  5
uu_6   -1.094102e-01                1 1 ON  6
uu_7   -3.395527e-02                1 1 ON  7
uu_8   1.025251e-01                 1 1 ON  8
uu_9   1.189087e-01                 1 1 ON  9
ud_0   3.144966e-01                 1 1 ON  10
ud_1   7.631300e-02                 1 1 ON  11
ud_2   -8.104427e-03                1 1 ON  12
ud_3   -5.650685e-02                1 1 ON  13
ud_4   -1.067284e-01                1 1 ON  14
ud_5   -1.481453e-01                1 1 ON  15
ud_6   -1.561161e-01                1 1 ON  16
ud_7   -1.072554e-01                1 1 ON  17
ud_8   9.330340e-03                 1 1 ON  18
ud_9   9.237105e-02                 1 1 ON  19
eO_0   -6.820136e-01                1 1 ON  20
eO_1   -4.039935e-01                1 1 ON  21
eO_2   -6.019930e-02                1 1 ON  22
eO_3   1.635430e-01                 1 1 ON  23
eO_4   2.639954e-01                 1 1 ON  24
eO_5   3.060972e-01                 1 1 ON  25
eO_6   2.483048e-01                 1 1 ON  26
eO_7   1.084889e-01                 1 1 ON  27
eO_8   2.728605e-02                 1 1 ON  28
eO_9   1.813695e-02                 1 1 ON  29
eH1_0  -1.777217e-01                1 1 ON  30
eH1_1  -9.864621e-02                1 1 ON  31
eH1_2  -6.123452e-02                1 1 ON  32
eH1_3  -2.812901e-02                1 1 ON  33
eH1_4  1.790481e-02                 1 1 ON  34
eH1_5  3.108382e-02                 1 1 ON  35
eH1_6  7.801323e-02                 1 1 ON  36
eH1_7  1.114716e-01                 1 1 ON  37
eH1_8  8.862572e-02                 1 1 ON  38
eH1_9  2.361306e-02                 1 1 ON  39
eH2_0  -1.794821e-01                1 1 ON  40
eH2_1  -1.004441e-01                1 1 ON  41
eH2_2  -6.343962e-02                1 1 ON  42
eH2_3  -2.961238e-02                1 1 ON  43
eH2_4  1.638666e-02                 1 1 ON  44
eH2_5  3.141552e-02                 1 1 ON  45
eH2_6  8.031944e-02                 1 1 ON  46
eH2_7  1.154771e-01                 1 1 ON  47
eH2_8  9.188714e-02                 1 1 ON  48
eH2_9  2.562284e-02                 1 1 ON  49
ci_001 -6.493131e-02                3 1 ON  50
ci_002 -5.051270e-02                3 1 ON  51
ci_003 -3.612673e-02                3 1 ON  52
ci_004 3.572932e-02                 3 1 ON  53
ci_005 3.581871e-02                 3 1 ON  54
ci_006 -3.458501e-02                3 1 ON  55
ci_007 -3.452863e-02                3 1 ON  56
ci_008 -2.981542e-02                3 1 ON  57
ci_009 -2.845265e-02                3 1 ON  58
ci_010 -2.779733e-02                3 1 ON  59
ci_011 -2.746870e-02                3 1 ON  60
ci_012 -2.749567e-02                3 1 ON  61
ci_013 -2.650344e-02                3 1 ON  62
ci_014 2.587128e-02                 3 1 ON  63
ci_015 2.579814e-02                 3 1 ON  64
ci_016 2.498415e-02                 3 1 ON  65
ci_017 2.500173e-02                 3 1 ON  66
ci_018 2.406618e-02                 3 1 ON  67
ci_019 2.404456e-02                 3 1 ON  68
ci_020 2.433049e-02                 3 1 ON  69
ci_021 2.434337e-02                 3 1 ON  70
ci_022 2.129769e-02                 3 1 ON  71
ci_023 2.135277e-02                 3 1 ON  72
ci_024 2.106365e-02                 3 1 ON  73
ci_025 2.108486e-02                 3 1 ON  74
ci_026 2.106565e-02                 3 1 ON  75
ci_027 2.109431e-02                 3 1 ON  76
ci_028 -2.094303e-02                3 1 ON  77
ci_029 -2.076225e-02                3 1 ON  78
ci_030 -1.900703e-02                3 1 ON  79
ci_031 -1.899408e-02                3 1 ON  80
ci_032 -1.847473e-02                3 1 ON  81
ci_033 1.768431e-02                 3 1 ON  82
ci_034 1.776481e-02                 3 1 ON  83
ci_035 -1.723637e-02                3 1 ON  84
ci_036 -1.784198e-02                3 1 ON  85
ci_037 -1.783531e-02                3 1 ON  86
ci_038 1.648934e-02                 3 1 ON  87
ci_039 1.649316e-02                 3 1 ON  88
ci_040 -1.579194e-02                3 1 ON  89
ci_041 1.608300e-02                 3 1 ON  90
ci_042 1.610267e-02                 3 1 ON  91
ci_043 -1.540506e-02                3 1 ON  92
ci_044 -1.539701e-02                3 1 ON  93
ci_045 -1.491366e-02                3 1 ON  94
ci_046 1.450269e-02                 3 1 ON  95
ci_047 1.441154e-02                 3 1 ON  96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1566
    reference variance = 0.207659
====================================================
  Execution time = 2.6716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7201e+01
  VMC Evar = 3.8231e-01
  Total weights = 1.9638e+06
  Execution time = 2.4110e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0235797
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.381716362646
                                         uncertainty =       0.004173502533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.381716362646
                                         uncertainty =       0.004173502533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000436817104
  error estimate for blocks of size 2^( 2) =       0.000449171764
  error estimate for blocks of size 2^( 3) =       0.000459615673
  error estimate for blocks of size 2^( 4) =       0.000467635893
  error estimate for blocks of size 2^( 5) =       0.000472015211
  error estimate for blocks of size 2^( 6) =       0.000474127911
  error estimate for blocks of size 2^( 7) =       0.000475532587

      target function =      -0.768578500818
              le_mean =     -17.201121718586
             les_mean =     296.301569217209
             stat err =       0.000472327900
             autocorr =       1.169197637711
   target nu stat err =       0.000472327900
   target dn stat err =       0.013347169437
      target stat err =       0.012038454886
              std dev =       0.617762556897
             le_variance =       0.381630576703

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00134276
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362780048003
                                         uncertainty =       0.022345233486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362780048003
                                         uncertainty =       0.022345233486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425804957
  error estimate for blocks of size 2^( 2) =       0.000437479386
  error estimate for blocks of size 2^( 3) =       0.000447417475
  error estimate for blocks of size 2^( 4) =       0.000455188609
  error estimate for blocks of size 2^( 5) =       0.000459096649
  error estimate for blocks of size 2^( 6) =       0.000461230579
  error estimate for blocks of size 2^( 7) =       0.000462547433

      target function =      -0.152616856639
              le_mean =     -17.201694854821
             les_mean =     298.574765438726
             stat err =       0.000459515817
             autocorr =       1.164607289029
   target nu stat err =       0.000459515817
   target dn stat err =       1.921206543021
      target stat err =       0.094407994986
              std dev =       0.602188780309
             le_variance =       0.362631327131

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0232844
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350617243045
                                         uncertainty =       0.002480974892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350617243045
                                         uncertainty =       0.002480974892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418644854
  error estimate for blocks of size 2^( 2) =       0.000430763276
  error estimate for blocks of size 2^( 3) =       0.000441163724
  error estimate for blocks of size 2^( 4) =       0.000449169658
  error estimate for blocks of size 2^( 5) =       0.000453749876
  error estimate for blocks of size 2^( 6) =       0.000456231821
  error estimate for blocks of size 2^( 7) =       0.000457592937

      target function =      -0.784936822882
              le_mean =     -17.201113319899
             les_mean =     296.283311838432
             stat err =       0.000454186073
             autocorr =       1.176999048713
   target nu stat err =       0.000454186073
   target dn stat err =       0.018187106124
      target stat err =       0.017103757705
              std dev =       0.592062703177
             le_variance =       0.350538244493

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.074915
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375412003198
                                         uncertainty =       0.003262591154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375412003198
                                         uncertainty =       0.003262591154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433195748
  error estimate for blocks of size 2^( 2) =       0.000445535200
  error estimate for blocks of size 2^( 3) =       0.000455986058
  error estimate for blocks of size 2^( 4) =       0.000464038444
  error estimate for blocks of size 2^( 5) =       0.000468478916
  error estimate for blocks of size 2^( 6) =       0.000470686038
  error estimate for blocks of size 2^( 7) =       0.000471960125

      target function =      -0.789183604896
              le_mean =     -17.201053531083
             les_mean =     296.277089429926
             stat err =       0.000468790881
             autocorr =       1.171089101085
   target nu stat err =       0.000468790881
   target dn stat err =       0.007207761973
      target stat err =       0.006868354492
              std dev =       0.612641104407
             le_variance =       0.375329122809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.768578500818        initial
     2.5000e-01     2.5000e+00             6.7052e-03        -0.152616856639
     1.0000e+00     1.0000e+01             1.9571e-03        -0.784936822882
     4.0000e+00     4.0000e+01             5.1015e-04        -0.789183604896  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 3.8840e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
  uu_0                 1.922163e-01 1 1  ON 0
  uu_1                 3.611778e-02 1 1  ON 1
  uu_2                -4.552911e-02 1 1  ON 2
  uu_3                -9.373702e-02 1 1  ON 3
  uu_4                -1.254895e-01 1 1  ON 4
  uu_5                -1.327545e-01 1 1  ON 5
  uu_6                -1.092283e-01 1 1  ON 6
  uu_7                -3.339933e-02 1 1  ON 7
  uu_8                 1.029538e-01 1 1  ON 8
  uu_9                 1.188370e-01 1 1  ON 9
  ud_0                 3.149276e-01 1 1  ON 10
  ud_1                 7.601472e-02 1 1  ON 11
  ud_2                -7.536777e-03 1 1  ON 12
  ud_3                -5.572520e-02 1 1  ON 13
  ud_4                -1.065441e-01 1 1  ON 14
  ud_5                -1.488086e-01 1 1  ON 15
  ud_6                -1.570820e-01 1 1  ON 16
  ud_7                -1.076451e-01 1 1  ON 17
  ud_8                 9.659422e-03 1 1  ON 18
  ud_9                 9.246382e-02 1 1  ON 19
  eO_0                -6.813941e-01 1 1  ON 20
  eO_1                -4.033469e-01 1 1  ON 21
  eO_2                -6.114868e-02 1 1  ON 22
  eO_3                 1.625569e-01 1 1  ON 23
  eO_4                 2.642806e-01 1 1  ON 24
  eO_5                 3.068195e-01 1 1  ON 25
  eO_6                 2.482454e-01 1 1  ON 26
  eO_7                 1.082251e-01 1 1  ON 27
  eO_8                 2.727648e-02 1 1  ON 28
  eO_9                 1.813162e-02 1 1  ON 29
 eH1_0                -1.763187e-01 1 1  ON 30
 eH1_1                -9.852021e-02 1 1  ON 31
 eH1_2                -6.189282e-02 1 1  ON 32
 eH1_3                -2.869896e-02 1 1  ON 33
 eH1_4                 1.773022e-02 1 1  ON 34
 eH1_5                 3.106694e-02 1 1  ON 35
 eH1_6                 7.795699e-02 1 1  ON 36
 eH1_7                 1.115094e-01 1 1  ON 37
 eH1_8                 8.855579e-02 1 1  ON 38
 eH1_9                 2.359168e-02 1 1  ON 39
 eH2_0                -1.780352e-01 1 1  ON 40
 eH2_1                -1.002538e-01 1 1  ON 41
 eH2_2                -6.403745e-02 1 1  ON 42
 eH2_3                -3.017268e-02 1 1  ON 43
 eH2_4                 1.626104e-02 1 1  ON 44
 eH2_5                 3.145488e-02 1 1  ON 45
 eH2_6                 8.031605e-02 1 1  ON 46
 eH2_7                 1.153187e-01 1 1  ON 47
 eH2_8                 9.166149e-02 1 1  ON 48
 eH2_9                 2.561688e-02 1 1  ON 49
ci_001                -6.602549e-02 3 1  ON 50
ci_002                -5.143413e-02 3 1  ON 51
ci_003                -3.664978e-02 3 1  ON 52
ci_004                 3.628616e-02 3 1  ON 53
ci_005                 3.630955e-02 3 1  ON 54
ci_006                -3.523911e-02 3 1  ON 55
ci_007                -3.522428e-02 3 1  ON 56
ci_008                -3.108441e-02 3 1  ON 57
ci_009                -2.924609e-02 3 1  ON 58
ci_010                -2.872776e-02 3 1  ON 59
ci_011                -2.837728e-02 3 1  ON 60
ci_012                -2.838462e-02 3 1  ON 61
ci_013                -2.684741e-02 3 1  ON 62
ci_014                 2.649599e-02 3 1  ON 63
ci_015                 2.647694e-02 3 1  ON 64
ci_016                 2.543425e-02 3 1  ON 65
ci_017                 2.543902e-02 3 1  ON 66
ci_018                 2.483672e-02 3 1  ON 67
ci_019                 2.483089e-02 3 1  ON 68
ci_020                 2.462204e-02 3 1  ON 69
ci_021                 2.462543e-02 3 1  ON 70
ci_022                 2.186971e-02 3 1  ON 71
ci_023                 2.188395e-02 3 1  ON 72
ci_024                 2.171854e-02 3 1  ON 73
ci_025                 2.172418e-02 3 1  ON 74
ci_026                 2.157167e-02 3 1  ON 75
ci_027                 2.157888e-02 3 1  ON 76
ci_028                -2.115916e-02 3 1  ON 77
ci_029                -2.111208e-02 3 1  ON 78
ci_030                -1.981909e-02 3 1  ON 79
ci_031                -1.981562e-02 3 1  ON 80
ci_032                -1.864627e-02 3 1  ON 81
ci_033                 1.825662e-02 3 1  ON 82
ci_034                 1.827753e-02 3 1  ON 83
ci_035                -1.796575e-02 3 1  ON 84
ci_036                -1.808086e-02 3 1  ON 85
ci_037                -1.807908e-02 3 1  ON 86
ci_038                 1.738304e-02 3 1  ON 87
ci_039                 1.738397e-02 3 1  ON 88
ci_040                -1.656049e-02 3 1  ON 89
ci_041                 1.653028e-02 3 1  ON 90
ci_042                 1.653562e-02 3 1  ON 91
ci_043                -1.605947e-02 3 1  ON 92
ci_044                -1.592862e-02 3 1  ON 93
ci_045                -1.559396e-02 3 1  ON 94
ci_046                 1.492937e-02 3 1  ON 95
ci_047                 1.490553e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5039e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7176e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.0417
    reference variance = 0.248525
====================================================
  Execution time = 2.7198e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0463e+04
  VMC Eavg = -1.7199e+01
  VMC Evar = 3.9185e-01
  Total weights = 1.963525419e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4871e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.374360272264
                                         uncertainty =       0.003146148263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.374360272264
                                         uncertainty =       0.003146148263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000432639178
  error estimate for blocks of size 2^( 2) =       0.000445247402
  error estimate for blocks of size 2^( 3) =       0.000455713660
  error estimate for blocks of size 2^( 4) =       0.000463801500
  error estimate for blocks of size 2^( 5) =       0.000467971392
  error estimate for blocks of size 2^( 6) =       0.000469642375
  error estimate for blocks of size 2^( 7) =       0.000471233955

      target function =      -0.797771203628
              le_mean =     -17.199460400227
             les_mean =     296.213284835572
             stat err =       0.000468162306
             autocorr =       1.170957673347
   target nu stat err =       0.000468162306
   target dn stat err =       0.004239635744
      target stat err =       0.004143406445
              std dev =       0.611853982610
             le_variance =       0.374365296035


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.719946040023e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.797791959467       residual = 1.46e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.803306645575       residual = 2.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.804390248005       residual = 9.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.804761549656       residual = 2.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.804877227910       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.804929036439       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.804974130304       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.805012208349       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.805047106737       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.805067712719       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.805077688788       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.805082227416       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.805084507585       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.805086104417       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.805087446814       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.805089063104       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.805090184336       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.805091780848       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.805092840623       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.805092906164       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.805092924208       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.805093292906       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.805093725736       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.805093989278       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.805094211330       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.805094230942       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.805094268919       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.805094329064       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.805094445054       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.805094426522       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.805094430133       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.805094484789       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.805094565178       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.805094628129       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.805094603423       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.805094598850       residual = 9.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.805094587982       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.805094622652       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.805094672701       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.805094696697       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.805094674386       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.805094692260       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.805094706388       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.805094703090       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.805094704794       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.805094701959       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.805094700118       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.805094692810       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.805094695400       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.805094692137       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.805094697317       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.805094701574       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         51 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 1.762454e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.797791959467       residual = 1.46e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.799230459075       residual = 2.82e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.799507736926       residual = 9.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.799602944411       residual = 2.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.799632609168       residual = 9.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.799645850684       residual = 8.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.799657372737       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.799667186692       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.799676077214       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.799681321250       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.799683795670       residual = 7.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.799684940714       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.799685539163       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.799685940205       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.799686281729       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.799686694385       residual = 9.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.799686978841       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.799687384259       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.799687639986       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.799687646040       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.799687650586       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.799687742917       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.799687851422       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.799687916034       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.799687965999       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.799687966190       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.799687972805       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.799687989848       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.799688017696       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.799688010632       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.799688011362       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.799688027073       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.799688044866       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.799688060168       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.799688053403       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.799688051774       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.799688050120       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.799688058359       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.799688069020       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.799688074989       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.799688070149       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.799688073837       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.799688077404       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.799688076074       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.799688076530       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.799688076019       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.799688075386       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.799688073777       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.799688074177       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.799688073590       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.799688075198       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         50 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 4.607687e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.797791959467       residual = 1.46e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.798155494339       residual = 2.81e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.798225203012       residual = 9.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.798249153995       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.798256616065       residual = 9.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.798259944628       residual = 8.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.798262840165       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.798265312001       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.798267544370       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.798268860849       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.798269477887       residual = 7.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.798269764843       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.798269916133       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.798270016420       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.798270102159       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.798270205855       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.798270277219       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.798270378939       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.798270442191       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.798270443038       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.798270444203       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.798270467288       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.798270494428       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.798270510484       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.798270522588       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.798270522355       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.798270523832       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.798270528280       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.798270535101       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.798270533170       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.798270533378       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.798270537418       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.798270541723       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.798270545507       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.798270543802       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.798270543353       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.798270543017       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.798270545041       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.798270547594       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.798270549079       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.798270547907       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.798270548788       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.798270549674       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.798270549330       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.798270549437       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.798270549311       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.798270549146       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.798270548766       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.798270548846       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.798270548718       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.798270549142       residual = 7.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         50 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.6000e+01 is 1.165100e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.347352 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5838e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 1.924324e-01 1 1  ON 0
  uu_1                 3.633431e-02 1 1  ON 1
  uu_2                -4.546241e-02 1 1  ON 2
  uu_3                -9.376742e-02 1 1  ON 3
  uu_4                -1.255142e-01 1 1  ON 4
  uu_5                -1.328075e-01 1 1  ON 5
  uu_6                -1.093256e-01 1 1  ON 6
  uu_7                -3.359676e-02 1 1  ON 7
  uu_8                 1.027945e-01 1 1  ON 8
  uu_9                 1.188649e-01 1 1  ON 9
  ud_0                 3.147737e-01 1 1  ON 10
  ud_1                 7.612088e-02 1 1  ON 11
  ud_2                -7.743071e-03 1 1  ON 12
  ud_3                -5.602011e-02 1 1  ON 13
  ud_4                -1.066354e-01 1 1  ON 14
  ud_5                -1.486114e-01 1 1  ON 15
  ud_6                -1.567537e-01 1 1  ON 16
  ud_7                -1.074885e-01 1 1  ON 17
  ud_8                 9.561548e-03 1 1  ON 18
  ud_9                 9.247409e-02 1 1  ON 19
  eO_0                -6.816641e-01 1 1  ON 20
  eO_1                -4.036168e-01 1 1  ON 21
  eO_2                -6.083948e-02 1 1  ON 22
  eO_3                 1.628973e-01 1 1  ON 23
  eO_4                 2.642698e-01 1 1  ON 24
  eO_5                 3.066178e-01 1 1  ON 25
  eO_6                 2.482659e-01 1 1  ON 26
  eO_7                 1.082971e-01 1 1  ON 27
  eO_8                 2.728350e-02 1 1  ON 28
  eO_9                 1.813371e-02 1 1  ON 29
 eH1_0                -1.767771e-01 1 1  ON 30
 eH1_1                -9.852667e-02 1 1  ON 31
 eH1_2                -6.163632e-02 1 1  ON 32
 eH1_3                -2.844703e-02 1 1  ON 33
 eH1_4                 1.778295e-02 1 1  ON 34
 eH1_5                 3.097946e-02 1 1  ON 35
 eH1_6                 7.795170e-02 1 1  ON 36
 eH1_7                 1.114657e-01 1 1  ON 37
 eH1_8                 8.858841e-02 1 1  ON 38
 eH1_9                 2.359868e-02 1 1  ON 39
 eH2_0                -1.784960e-01 1 1  ON 40
 eH2_1                -1.002807e-01 1 1  ON 41
 eH2_2                -6.379835e-02 1 1  ON 42
 eH2_3                -2.996175e-02 1 1  ON 43
 eH2_4                 1.631928e-02 1 1  ON 44
 eH2_5                 3.145718e-02 1 1  ON 45
 eH2_6                 8.024182e-02 1 1  ON 46
 eH2_7                 1.152985e-01 1 1  ON 47
 eH2_8                 9.172676e-02 1 1  ON 48
 eH2_9                 2.562346e-02 1 1  ON 49
ci_001                -6.566278e-02 3 1  ON 50
ci_002                -5.108161e-02 3 1  ON 51
ci_003                -3.650303e-02 3 1  ON 52
ci_004                 3.610202e-02 3 1  ON 53
ci_005                 3.613170e-02 3 1  ON 54
ci_006                -3.499281e-02 3 1  ON 55
ci_007                -3.498119e-02 3 1  ON 56
ci_008                -3.064953e-02 3 1  ON 57
ci_009                -2.899859e-02 3 1  ON 58
ci_010                -2.838895e-02 3 1  ON 59
ci_011                -2.807244e-02 3 1  ON 60
ci_012                -2.806683e-02 3 1  ON 61
ci_013                -2.673840e-02 3 1  ON 62
ci_014                 2.625834e-02 3 1  ON 63
ci_015                 2.625271e-02 3 1  ON 64
ci_016                 2.527419e-02 3 1  ON 65
ci_017                 2.526699e-02 3 1  ON 66
ci_018                 2.456334e-02 3 1  ON 67
ci_019                 2.455086e-02 3 1  ON 68
ci_020                 2.451292e-02 3 1  ON 69
ci_021                 2.450237e-02 3 1  ON 70
ci_022                 2.168117e-02 3 1  ON 71
ci_023                 2.167337e-02 3 1  ON 72
ci_024                 2.148957e-02 3 1  ON 73
ci_025                 2.149613e-02 3 1  ON 74
ci_026                 2.139148e-02 3 1  ON 75
ci_027                 2.140145e-02 3 1  ON 76
ci_028                -2.107231e-02 3 1  ON 77
ci_029                -2.099495e-02 3 1  ON 78
ci_030                -1.951930e-02 3 1  ON 79
ci_031                -1.950569e-02 3 1  ON 80
ci_032                -1.858654e-02 3 1  ON 81
ci_033                 1.807254e-02 3 1  ON 82
ci_034                 1.810445e-02 3 1  ON 83
ci_035                -1.772606e-02 3 1  ON 84
ci_036                -1.797501e-02 3 1  ON 85
ci_037                -1.799455e-02 3 1  ON 86
ci_038                 1.708690e-02 3 1  ON 87
ci_039                 1.707106e-02 3 1  ON 88
ci_040                -1.629493e-02 3 1  ON 89
ci_041                 1.636640e-02 3 1  ON 90
ci_042                 1.637733e-02 3 1  ON 91
ci_043                -1.582962e-02 3 1  ON 92
ci_044                -1.573481e-02 3 1  ON 93
ci_045                -1.534791e-02 3 1  ON 94
ci_046                 1.477070e-02 3 1  ON 95
ci_047                 1.475239e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2059
    reference variance = 0.254998
====================================================
  Execution time = 2.6802e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7200e+01
  VMC Evar = 3.8029e-01
  Total weights = 1.9637e+06
  Execution time = 2.3955e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370753889724
                                         uncertainty =       0.002555402266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370753889724
                                         uncertainty =       0.002555402266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430629218
  error estimate for blocks of size 2^( 2) =       0.000443366661
  error estimate for blocks of size 2^( 3) =       0.000453860396
  error estimate for blocks of size 2^( 4) =       0.000461283223
  error estimate for blocks of size 2^( 5) =       0.000465962370
  error estimate for blocks of size 2^( 6) =       0.000467888784
  error estimate for blocks of size 2^( 7) =       0.000470102028

      target function =      -0.802695137338
              le_mean =     -17.199894787784
             les_mean =     296.223208461897
             stat err =       0.000466309101
             autocorr =       1.172575447643
   target nu stat err =       0.000466309101
   target dn stat err =       0.003575371790
      target stat err =       0.003552350205
              std dev =       0.609011425031
             le_variance =       0.370894915819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356704447101
                                         uncertainty =       0.002427723554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356704447101
                                         uncertainty =       0.002427723554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422432750
  error estimate for blocks of size 2^( 2) =       0.000435044619
  error estimate for blocks of size 2^( 3) =       0.000445497157
  error estimate for blocks of size 2^( 4) =       0.000452891258
  error estimate for blocks of size 2^( 5) =       0.000457534397
  error estimate for blocks of size 2^( 6) =       0.000459418537
  error estimate for blocks of size 2^( 7) =       0.000461571273

      target function =      -0.784480111538
              le_mean =     -17.199955027360
             les_mean =     296.243508032236
             stat err =       0.000457853866
             autocorr =       1.174731487787
   target nu stat err =       0.000457853866
   target dn stat err =       0.025810489788
      target stat err =       0.024207531413
              std dev =       0.597419683184
             le_variance =       0.356910277856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363013197129
                                         uncertainty =       0.002479141520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363013197129
                                         uncertainty =       0.002479141520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426128570
  error estimate for blocks of size 2^( 2) =       0.000438803329
  error estimate for blocks of size 2^( 3) =       0.000449278529
  error estimate for blocks of size 2^( 4) =       0.000456688414
  error estimate for blocks of size 2^( 5) =       0.000461363131
  error estimate for blocks of size 2^( 6) =       0.000463279739
  error estimate for blocks of size 2^( 7) =       0.000465469390

      target function =      -0.812857530701
              le_mean =     -17.199896013283
             les_mean =     296.213022681764
             stat err =       0.000461700168
             autocorr =       1.173920699349
   target nu stat err =       0.000461700168
   target dn stat err =       0.002932088076
      target stat err =       0.003003576408
              std dev =       0.602646444936
             le_variance =       0.363182737595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369724776727
                                         uncertainty =       0.002544242062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369724776727
                                         uncertainty =       0.002544242062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430033218
  error estimate for blocks of size 2^( 2) =       0.000442762974
  error estimate for blocks of size 2^( 3) =       0.000453254658
  error estimate for blocks of size 2^( 4) =       0.000460675683
  error estimate for blocks of size 2^( 5) =       0.000465355454
  error estimate for blocks of size 2^( 6) =       0.000467282269
  error estimate for blocks of size 2^( 7) =       0.000469499918

      target function =      -0.804929241693
              le_mean =     -17.199890692440
             les_mean =     296.220798934397
             stat err =       0.000465703331
             autocorr =       1.172774949393
   target nu stat err =       0.000465703331
   target dn stat err =       0.003153485040
      target stat err =       0.003161736209
              std dev =       0.608168539227
             le_variance =       0.369868972105


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.802695137338        initial
     1.0000e+00     1.0000e+01             1.7625e-03        -0.784480111538
     4.0000e+00     4.0000e+01             4.6077e-04        -0.812857530701  <--
     1.6000e+01     1.6000e+02             1.1651e-04        -0.804929241693

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 3.8884e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 1.924324e-01 1 1  ON 0
  uu_1                 3.633431e-02 1 1  ON 1
  uu_2                -4.546241e-02 1 1  ON 2
  uu_3                -9.376742e-02 1 1  ON 3
  uu_4                -1.255142e-01 1 1  ON 4
  uu_5                -1.328075e-01 1 1  ON 5
  uu_6                -1.093256e-01 1 1  ON 6
  uu_7                -3.359676e-02 1 1  ON 7
  uu_8                 1.027945e-01 1 1  ON 8
  uu_9                 1.188649e-01 1 1  ON 9
  ud_0                 3.147737e-01 1 1  ON 10
  ud_1                 7.612088e-02 1 1  ON 11
  ud_2                -7.743071e-03 1 1  ON 12
  ud_3                -5.602011e-02 1 1  ON 13
  ud_4                -1.066354e-01 1 1  ON 14
  ud_5                -1.486114e-01 1 1  ON 15
  ud_6                -1.567537e-01 1 1  ON 16
  ud_7                -1.074885e-01 1 1  ON 17
  ud_8                 9.561548e-03 1 1  ON 18
  ud_9                 9.247409e-02 1 1  ON 19
  eO_0                -6.816641e-01 1 1  ON 20
  eO_1                -4.036168e-01 1 1  ON 21
  eO_2                -6.083948e-02 1 1  ON 22
  eO_3                 1.628973e-01 1 1  ON 23
  eO_4                 2.642698e-01 1 1  ON 24
  eO_5                 3.066178e-01 1 1  ON 25
  eO_6                 2.482659e-01 1 1  ON 26
  eO_7                 1.082971e-01 1 1  ON 27
  eO_8                 2.728350e-02 1 1  ON 28
  eO_9                 1.813371e-02 1 1  ON 29
 eH1_0                -1.767771e-01 1 1  ON 30
 eH1_1                -9.852667e-02 1 1  ON 31
 eH1_2                -6.163632e-02 1 1  ON 32
 eH1_3                -2.844703e-02 1 1  ON 33
 eH1_4                 1.778295e-02 1 1  ON 34
 eH1_5                 3.097946e-02 1 1  ON 35
 eH1_6                 7.795170e-02 1 1  ON 36
 eH1_7                 1.114657e-01 1 1  ON 37
 eH1_8                 8.858841e-02 1 1  ON 38
 eH1_9                 2.359868e-02 1 1  ON 39
 eH2_0                -1.784960e-01 1 1  ON 40
 eH2_1                -1.002807e-01 1 1  ON 41
 eH2_2                -6.379835e-02 1 1  ON 42
 eH2_3                -2.996175e-02 1 1  ON 43
 eH2_4                 1.631928e-02 1 1  ON 44
 eH2_5                 3.145718e-02 1 1  ON 45
 eH2_6                 8.024182e-02 1 1  ON 46
 eH2_7                 1.152985e-01 1 1  ON 47
 eH2_8                 9.172676e-02 1 1  ON 48
 eH2_9                 2.562346e-02 1 1  ON 49
ci_001                -6.566278e-02 3 1  ON 50
ci_002                -5.108161e-02 3 1  ON 51
ci_003                -3.650303e-02 3 1  ON 52
ci_004                 3.610202e-02 3 1  ON 53
ci_005                 3.613170e-02 3 1  ON 54
ci_006                -3.499281e-02 3 1  ON 55
ci_007                -3.498119e-02 3 1  ON 56
ci_008                -3.064953e-02 3 1  ON 57
ci_009                -2.899859e-02 3 1  ON 58
ci_010                -2.838895e-02 3 1  ON 59
ci_011                -2.807244e-02 3 1  ON 60
ci_012                -2.806683e-02 3 1  ON 61
ci_013                -2.673840e-02 3 1  ON 62
ci_014                 2.625834e-02 3 1  ON 63
ci_015                 2.625271e-02 3 1  ON 64
ci_016                 2.527419e-02 3 1  ON 65
ci_017                 2.526699e-02 3 1  ON 66
ci_018                 2.456334e-02 3 1  ON 67
ci_019                 2.455086e-02 3 1  ON 68
ci_020                 2.451292e-02 3 1  ON 69
ci_021                 2.450237e-02 3 1  ON 70
ci_022                 2.168117e-02 3 1  ON 71
ci_023                 2.167337e-02 3 1  ON 72
ci_024                 2.148957e-02 3 1  ON 73
ci_025                 2.149613e-02 3 1  ON 74
ci_026                 2.139148e-02 3 1  ON 75
ci_027                 2.140145e-02 3 1  ON 76
ci_028                -2.107231e-02 3 1  ON 77
ci_029                -2.099495e-02 3 1  ON 78
ci_030                -1.951930e-02 3 1  ON 79
ci_031                -1.950569e-02 3 1  ON 80
ci_032                -1.858654e-02 3 1  ON 81
ci_033                 1.807254e-02 3 1  ON 82
ci_034                 1.810445e-02 3 1  ON 83
ci_035                -1.772606e-02 3 1  ON 84
ci_036                -1.797501e-02 3 1  ON 85
ci_037                -1.799455e-02 3 1  ON 86
ci_038                 1.708690e-02 3 1  ON 87
ci_039                 1.707106e-02 3 1  ON 88
ci_040                -1.629493e-02 3 1  ON 89
ci_041                 1.636640e-02 3 1  ON 90
ci_042                 1.637733e-02 3 1  ON 91
ci_043                -1.582962e-02 3 1  ON 92
ci_044                -1.573481e-02 3 1  ON 93
ci_045                -1.534791e-02 3 1  ON 94
ci_046                 1.477070e-02 3 1  ON 95
ci_047                 1.475239e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4728e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7150e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1171
    reference variance = 0.240329
====================================================
  Execution time = 2.7358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0486e+04
  VMC Eavg = -1.7200e+01
  VMC Evar = 3.8953e-01
  Total weights = 1.963467127e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2612e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370329569585
                                         uncertainty =       0.003069900864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370329569585
                                         uncertainty =       0.003069900864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430265742
  error estimate for blocks of size 2^( 2) =       0.000442766259
  error estimate for blocks of size 2^( 3) =       0.000453387193
  error estimate for blocks of size 2^( 4) =       0.000460095654
  error estimate for blocks of size 2^( 5) =       0.000463506635
  error estimate for blocks of size 2^( 6) =       0.000465529411
  error estimate for blocks of size 2^( 7) =       0.000465692579

      target function =      -0.800030429726
              le_mean =     -17.200222630406
             les_mean =     296.237191349857
             stat err =       0.000463706069
             autocorr =       1.161480767089
   target nu stat err =       0.000463706069
   target dn stat err =       0.006856094917
      target stat err =       0.006706720719
              std dev =       0.608497383996
             le_variance =       0.370269066330


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720022263041e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.800086100740       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.805346604369       residual = 3.13e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.806441254338       residual = 9.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.806818272625       residual = 2.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.806932580993       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.806981036924       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.807028747075       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.807065946755       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.807096915813       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.807119245437       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.807130115271       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.807134395823       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.807136296602       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.807137733955       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.807139083560       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.807140341413       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.807141518994       residual = 8.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.807142246591       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.807143274060       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.807143929043       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.807143960460       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.807144256361       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.807144737883       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.807144936953       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.807144978860       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.807145039308       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.807145380554       residual = 9.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.807145528280       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.807145557503       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.807145549500       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.807145620946       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.807145519399       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.807145567528       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.807145596159       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.807145581986       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.807145612353       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.807145609340       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.807145603533       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.807145598453       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.807145618869       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.807145637669       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.807145638947       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.807145634618       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.807145651981       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.807145660087       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.807145661084       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.807145646037       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.807145645858       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.807145645325       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.807145651098       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.807145650023       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.807145650755       residual = 1.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         51 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 1.763086e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.800086100740       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.801457894192       residual = 3.09e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.801738464920       residual = 9.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.801835494036       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.801864693205       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.801877033262       residual = 7.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.801889283948       residual = 4.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.801898897137       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.801906786196       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.801912461387       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.801915166742       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.801916217502       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.801916709926       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.801917097356       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.801917447872       residual = 9.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.801917765461       residual = 8.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.801918060805       residual = 8.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.801918242007       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.801918500377       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.801918654392       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.801918661849       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.801918737332       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.801918858627       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.801918901335       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.801918910209       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.801918925612       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.801919008742       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.801919040917       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.801919046677       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.801919044106       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.801919061267       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.801919037440       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.801919048275       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.801919054695       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.801919051491       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.801919060518       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.801919058274       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.801919055406       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.801919055696       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.801919060326       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.801919064227       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.801919064866       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.801919063550       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.801919068016       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.801919069639       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.801919069072       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.801919065833       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.801919065960       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.801919065945       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.801919067152       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.801919066985       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         50 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 4.613168e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.800086100740       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.800432752422       residual = 3.08e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.800503321535       residual = 9.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.800527753635       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.800535091575       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.800538190475       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.800541273151       residual = 4.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.800543696110       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.800545676967       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.800547101084       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.800547776164       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.800548037821       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.800548162736       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.800548260665       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.800548349037       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.800548428584       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.800548502461       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.800548547701       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.800548612344       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.800548650191       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.800548652061       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.800548671025       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.800548701382       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.800548711592       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.800548713711       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.800548717598       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.800548738218       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.800548745955       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.800548747299       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.800548746618       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.800548750865       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.800548745012       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.800548747635       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.800548749205       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.800548748449       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.800548750760       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.800548750100       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.800548749309       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.800548749505       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.800548750610       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.800548751533       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.800548751715       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.800548751376       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.800548752494       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.800548752872       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.800548752684       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.800548751909       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.800548751949       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.800548751951       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.6000e+01 is 1.166818e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.485631 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5765e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 1.926430e-01 1 1  ON 0
  uu_1                 3.653946e-02 1 1  ON 1
  uu_2                -4.540390e-02 1 1  ON 2
  uu_3                -9.380370e-02 1 1  ON 3
  uu_4                -1.255378e-01 1 1  ON 4
  uu_5                -1.328567e-01 1 1  ON 5
  uu_6                -1.094328e-01 1 1  ON 6
  uu_7                -3.377712e-02 1 1  ON 7
  uu_8                 1.026486e-01 1 1  ON 8
  uu_9                 1.188997e-01 1 1  ON 9
  ud_0                 3.146292e-01 1 1  ON 10
  ud_1                 7.622061e-02 1 1  ON 11
  ud_2                -7.956233e-03 1 1  ON 12
  ud_3                -5.630538e-02 1 1  ON 13
  ud_4                -1.067020e-01 1 1  ON 14
  ud_5                -1.483694e-01 1 1  ON 15
  ud_6                -1.564142e-01 1 1  ON 16
  ud_7                -1.073330e-01 1 1  ON 17
  ud_8                 9.422640e-03 1 1  ON 18
  ud_9                 9.245754e-02 1 1  ON 19
  eO_0                -6.818909e-01 1 1  ON 20
  eO_1                -4.038461e-01 1 1  ON 21
  eO_2                -6.051813e-02 1 1  ON 22
  eO_3                 1.632058e-01 1 1  ON 23
  eO_4                 2.641752e-01 1 1  ON 24
  eO_5                 3.064274e-01 1 1  ON 25
  eO_6                 2.482938e-01 1 1  ON 26
  eO_7                 1.083660e-01 1 1  ON 27
  eO_8                 2.729368e-02 1 1  ON 28
  eO_9                 1.813649e-02 1 1  ON 29
 eH1_0                -1.772384e-01 1 1  ON 30
 eH1_1                -9.853543e-02 1 1  ON 31
 eH1_2                -6.140296e-02 1 1  ON 32
 eH1_3                -2.824140e-02 1 1  ON 33
 eH1_4                 1.784715e-02 1 1  ON 34
 eH1_5                 3.097504e-02 1 1  ON 35
 eH1_6                 7.792785e-02 1 1  ON 36
 eH1_7                 1.114322e-01 1 1  ON 37
 eH1_8                 8.860602e-02 1 1  ON 38
 eH1_9                 2.360704e-02 1 1  ON 39
 eH2_0                -1.789249e-01 1 1  ON 40
 eH2_1                -1.002736e-01 1 1  ON 41
 eH2_2                -6.353040e-02 1 1  ON 42
 eH2_3                -2.974422e-02 1 1  ON 43
 eH2_4                 1.635897e-02 1 1  ON 44
 eH2_5                 3.137917e-02 1 1  ON 45
 eH2_6                 8.021570e-02 1 1  ON 46
 eH2_7                 1.152690e-01 1 1  ON 47
 eH2_8                 9.174938e-02 1 1  ON 48
 eH2_9                 2.563105e-02 1 1  ON 49
ci_001                -6.529933e-02 3 1  ON 50
ci_002                -5.071078e-02 3 1  ON 51
ci_003                -3.633489e-02 3 1  ON 52
ci_004                 3.592457e-02 3 1  ON 53
ci_005                 3.594696e-02 3 1  ON 54
ci_006                -3.473785e-02 3 1  ON 55
ci_007                -3.472061e-02 3 1  ON 56
ci_008                -3.024184e-02 3 1  ON 57
ci_009                -2.875237e-02 3 1  ON 58
ci_010                -2.805844e-02 3 1  ON 59
ci_011                -2.777828e-02 3 1  ON 60
ci_012                -2.772844e-02 3 1  ON 61
ci_013                -2.663630e-02 3 1  ON 62
ci_014                 2.603550e-02 3 1  ON 63
ci_015                 2.598541e-02 3 1  ON 64
ci_016                 2.513184e-02 3 1  ON 65
ci_017                 2.510908e-02 3 1  ON 66
ci_018                 2.430459e-02 3 1  ON 67
ci_019                 2.428746e-02 3 1  ON 68
ci_020                 2.436265e-02 3 1  ON 69
ci_021                 2.437940e-02 3 1  ON 70
ci_022                 2.149459e-02 3 1  ON 71
ci_023                 2.144129e-02 3 1  ON 72
ci_024                 2.129083e-02 3 1  ON 73
ci_025                 2.128313e-02 3 1  ON 74
ci_026                 2.122528e-02 3 1  ON 75
ci_027                 2.122643e-02 3 1  ON 76
ci_028                -2.096888e-02 3 1  ON 77
ci_029                -2.090688e-02 3 1  ON 78
ci_030                -1.922936e-02 3 1  ON 79
ci_031                -1.922081e-02 3 1  ON 80
ci_032                -1.854021e-02 3 1  ON 81
ci_033                 1.787302e-02 3 1  ON 82
ci_034                 1.794516e-02 3 1  ON 83
ci_035                -1.747890e-02 3 1  ON 84
ci_036                -1.789999e-02 3 1  ON 85
ci_037                -1.792187e-02 3 1  ON 86
ci_038                 1.679244e-02 3 1  ON 87
ci_039                 1.677078e-02 3 1  ON 88
ci_040                -1.604267e-02 3 1  ON 89
ci_041                 1.621493e-02 3 1  ON 90
ci_042                 1.622925e-02 3 1  ON 91
ci_043                -1.560620e-02 3 1  ON 92
ci_044                -1.550263e-02 3 1  ON 93
ci_045                -1.511690e-02 3 1  ON 94
ci_046                 1.461503e-02 3 1  ON 95
ci_047                 1.460049e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1979
    reference variance = 0.264806
====================================================
  Execution time = 2.7326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7201e+01
  VMC Evar = 3.8577e-01
  Total weights = 1.9637e+06
  Execution time = 2.3936e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.373149557201
                                         uncertainty =       0.002640613157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.373149557201
                                         uncertainty =       0.002640613157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431909790
  error estimate for blocks of size 2^( 2) =       0.000443846979
  error estimate for blocks of size 2^( 3) =       0.000454395475
  error estimate for blocks of size 2^( 4) =       0.000461826206
  error estimate for blocks of size 2^( 5) =       0.000466624093
  error estimate for blocks of size 2^( 6) =       0.000469293370
  error estimate for blocks of size 2^( 7) =       0.000471060439

      target function =      -0.798450126366
              le_mean =     -17.200497765324
             les_mean =     296.248335155512
             stat err =       0.000467201027
             autocorr =       1.170095964525
   target nu stat err =       0.000467201027
   target dn stat err =       0.004026026322
      target stat err =       0.003951366142
              std dev =       0.610822455527
             le_variance =       0.373104072176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359567940843
                                         uncertainty =       0.002469973910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359567940843
                                         uncertainty =       0.002469973910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423974181
  error estimate for blocks of size 2^( 2) =       0.000435826376
  error estimate for blocks of size 2^( 3) =       0.000446349958
  error estimate for blocks of size 2^( 4) =       0.000453789918
  error estimate for blocks of size 2^( 5) =       0.000458602306
  error estimate for blocks of size 2^( 6) =       0.000461222400
  error estimate for blocks of size 2^( 7) =       0.000462975727

      target function =      -0.733089800618
              le_mean =     -17.200565211721
             les_mean =     296.321014669633
             stat err =       0.000459147588
             autocorr =       1.172804959488
   target nu stat err =       0.000459147588
   target dn stat err =       0.051356164945
      target stat err =       0.042193398311
              std dev =       0.599599630585
             le_variance =       0.359519716998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365672735292
                                         uncertainty =       0.002533866091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365672735292
                                         uncertainty =       0.002533866091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427559525
  error estimate for blocks of size 2^( 2) =       0.000439449176
  error estimate for blocks of size 2^( 3) =       0.000449977018
  error estimate for blocks of size 2^( 4) =       0.000457411430
  error estimate for blocks of size 2^( 5) =       0.000462215060
  error estimate for blocks of size 2^( 6) =       0.000464865317
  error estimate for blocks of size 2^( 7) =       0.000466623940

      target function =      -0.807062580910
              le_mean =     -17.200515630216
             les_mean =     296.240180405585
             stat err =       0.000462778937
             autocorr =       1.171531571584
   target nu stat err =       0.000462778937
   target dn stat err =       0.003766554262
      target stat err =       0.003780772998
              std dev =       0.604670153299
             le_variance =       0.365625994291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372167903013
                                         uncertainty =       0.002625458306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372167903013
                                         uncertainty =       0.002625458306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431341136
  error estimate for blocks of size 2^( 2) =       0.000443271963
  error estimate for blocks of size 2^( 3) =       0.000453817334
  error estimate for blocks of size 2^( 4) =       0.000461248280
  error estimate for blocks of size 2^( 5) =       0.000466047105
  error estimate for blocks of size 2^( 6) =       0.000468714121
  error estimate for blocks of size 2^( 7) =       0.000470478911

      target function =      -0.799810071528
              le_mean =     -17.200497409819
             les_mean =     296.246926096412
             stat err =       0.000466622104
             autocorr =       1.170277515835
   target nu stat err =       0.000466622104
   target dn stat err =       0.003915538640
      target stat err =       0.003858057195
              std dev =       0.610018244072
             le_variance =       0.372122258101


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.798450126366        initial
     1.0000e+00     1.0000e+01             1.7631e-03        -0.733089800618
     4.0000e+00     4.0000e+01             4.6132e-04        -0.807062580910  <--
     1.6000e+01     1.6000e+02             1.1668e-04        -0.799810071528

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 3.9420e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 1.926430e-01 1 1  ON 0
  uu_1                 3.653946e-02 1 1  ON 1
  uu_2                -4.540390e-02 1 1  ON 2
  uu_3                -9.380370e-02 1 1  ON 3
  uu_4                -1.255378e-01 1 1  ON 4
  uu_5                -1.328567e-01 1 1  ON 5
  uu_6                -1.094328e-01 1 1  ON 6
  uu_7                -3.377712e-02 1 1  ON 7
  uu_8                 1.026486e-01 1 1  ON 8
  uu_9                 1.188997e-01 1 1  ON 9
  ud_0                 3.146292e-01 1 1  ON 10
  ud_1                 7.622061e-02 1 1  ON 11
  ud_2                -7.956233e-03 1 1  ON 12
  ud_3                -5.630538e-02 1 1  ON 13
  ud_4                -1.067020e-01 1 1  ON 14
  ud_5                -1.483694e-01 1 1  ON 15
  ud_6                -1.564142e-01 1 1  ON 16
  ud_7                -1.073330e-01 1 1  ON 17
  ud_8                 9.422640e-03 1 1  ON 18
  ud_9                 9.245754e-02 1 1  ON 19
  eO_0                -6.818909e-01 1 1  ON 20
  eO_1                -4.038461e-01 1 1  ON 21
  eO_2                -6.051813e-02 1 1  ON 22
  eO_3                 1.632058e-01 1 1  ON 23
  eO_4                 2.641752e-01 1 1  ON 24
  eO_5                 3.064274e-01 1 1  ON 25
  eO_6                 2.482938e-01 1 1  ON 26
  eO_7                 1.083660e-01 1 1  ON 27
  eO_8                 2.729368e-02 1 1  ON 28
  eO_9                 1.813649e-02 1 1  ON 29
 eH1_0                -1.772384e-01 1 1  ON 30
 eH1_1                -9.853543e-02 1 1  ON 31
 eH1_2                -6.140296e-02 1 1  ON 32
 eH1_3                -2.824140e-02 1 1  ON 33
 eH1_4                 1.784715e-02 1 1  ON 34
 eH1_5                 3.097504e-02 1 1  ON 35
 eH1_6                 7.792785e-02 1 1  ON 36
 eH1_7                 1.114322e-01 1 1  ON 37
 eH1_8                 8.860602e-02 1 1  ON 38
 eH1_9                 2.360704e-02 1 1  ON 39
 eH2_0                -1.789249e-01 1 1  ON 40
 eH2_1                -1.002736e-01 1 1  ON 41
 eH2_2                -6.353040e-02 1 1  ON 42
 eH2_3                -2.974422e-02 1 1  ON 43
 eH2_4                 1.635897e-02 1 1  ON 44
 eH2_5                 3.137917e-02 1 1  ON 45
 eH2_6                 8.021570e-02 1 1  ON 46
 eH2_7                 1.152690e-01 1 1  ON 47
 eH2_8                 9.174938e-02 1 1  ON 48
 eH2_9                 2.563105e-02 1 1  ON 49
ci_001                -6.529933e-02 3 1  ON 50
ci_002                -5.071078e-02 3 1  ON 51
ci_003                -3.633489e-02 3 1  ON 52
ci_004                 3.592457e-02 3 1  ON 53
ci_005                 3.594696e-02 3 1  ON 54
ci_006                -3.473785e-02 3 1  ON 55
ci_007                -3.472061e-02 3 1  ON 56
ci_008                -3.024184e-02 3 1  ON 57
ci_009                -2.875237e-02 3 1  ON 58
ci_010                -2.805844e-02 3 1  ON 59
ci_011                -2.777828e-02 3 1  ON 60
ci_012                -2.772844e-02 3 1  ON 61
ci_013                -2.663630e-02 3 1  ON 62
ci_014                 2.603550e-02 3 1  ON 63
ci_015                 2.598541e-02 3 1  ON 64
ci_016                 2.513184e-02 3 1  ON 65
ci_017                 2.510908e-02 3 1  ON 66
ci_018                 2.430459e-02 3 1  ON 67
ci_019                 2.428746e-02 3 1  ON 68
ci_020                 2.436265e-02 3 1  ON 69
ci_021                 2.437940e-02 3 1  ON 70
ci_022                 2.149459e-02 3 1  ON 71
ci_023                 2.144129e-02 3 1  ON 72
ci_024                 2.129083e-02 3 1  ON 73
ci_025                 2.128313e-02 3 1  ON 74
ci_026                 2.122528e-02 3 1  ON 75
ci_027                 2.122643e-02 3 1  ON 76
ci_028                -2.096888e-02 3 1  ON 77
ci_029                -2.090688e-02 3 1  ON 78
ci_030                -1.922936e-02 3 1  ON 79
ci_031                -1.922081e-02 3 1  ON 80
ci_032                -1.854021e-02 3 1  ON 81
ci_033                 1.787302e-02 3 1  ON 82
ci_034                 1.794516e-02 3 1  ON 83
ci_035                -1.747890e-02 3 1  ON 84
ci_036                -1.789999e-02 3 1  ON 85
ci_037                -1.792187e-02 3 1  ON 86
ci_038                 1.679244e-02 3 1  ON 87
ci_039                 1.677078e-02 3 1  ON 88
ci_040                -1.604267e-02 3 1  ON 89
ci_041                 1.621493e-02 3 1  ON 90
ci_042                 1.622925e-02 3 1  ON 91
ci_043                -1.560620e-02 3 1  ON 92
ci_044                -1.550263e-02 3 1  ON 93
ci_045                -1.511690e-02 3 1  ON 94
ci_046                 1.461503e-02 3 1  ON 95
ci_047                 1.460049e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5191e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7152e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.232
    reference variance = 0.32624
====================================================
  Execution time = 2.7114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0447e+04
  VMC Eavg = -1.7201e+01
  VMC Evar = 3.8806e-01
  Total weights = 1.963753099e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2715e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.368996636004
                                         uncertainty =       0.003353696098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.368996636004
                                         uncertainty =       0.003353696098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000429512015
  error estimate for blocks of size 2^( 2) =       0.000441787276
  error estimate for blocks of size 2^( 3) =       0.000452482288
  error estimate for blocks of size 2^( 4) =       0.000459774989
  error estimate for blocks of size 2^( 5) =       0.000463393837
  error estimate for blocks of size 2^( 6) =       0.000465054504
  error estimate for blocks of size 2^( 7) =       0.000467120564

      target function =      -0.801512974271
              le_mean =     -17.200548405470
             les_mean =     296.246929792696
             stat err =       0.000463835974
             autocorr =       1.166213922392
   target nu stat err =       0.000463835974
   target dn stat err =       0.004856284971
      target stat err =       0.004786979856
              std dev =       0.607431435480
             le_variance =       0.368972948810


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720054840547e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.801540995912       residual = 1.43e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.806848481370       residual = 2.65e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.807850433288       residual = 8.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.808190989551       residual = 2.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.808302874293       residual = 9.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.808348252072       residual = 7.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.808388251793       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.808423411347       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.808457667935       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.808477132249       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.808489045381       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.808492175474       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.808494583681       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.808496899434       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.808497650289       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.808498333470       residual = 7.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.808498932819       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.808499307436       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.808500084034       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.808500604872       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.808500667399       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.808501186276       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.808501558654       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.808501916833       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.808502011205       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.808502175492       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.808502301923       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.808502595918       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.808502600244       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.808502626344       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.808502671386       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.808502640246       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.808502717245       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.808502724899       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.808502720850       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.808502701674       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.808502716359       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.808502676647       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.808502679646       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.808502681356       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.808502683166       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.808502696020       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.808502694547       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.808502685887       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.808502680179       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.808502683599       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.808502676965       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.808502673688       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.808502676549       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.808502668694       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.808502674508       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         50 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 1.806389e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.801540995912       residual = 1.43e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.802926068137       residual = 2.62e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.803182783657       residual = 8.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.803270127087       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.803298865600       residual = 8.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.803310472671       residual = 7.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.803320719089       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.803329811605       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.803338557628       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.803343521547       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.803346525647       residual = 7.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.803347298277       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.803347909214       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.803348486769       residual = 8.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.803348677954       residual = 8.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.803348852659       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.803349002684       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.803349091662       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.803349286969       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.803349416267       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.803349432436       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.803349562809       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.803349659429       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.803349745727       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.803349765748       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.803349803893       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.803349832005       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.803349905477       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.803349903749       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.803349909670       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.803349920041       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.803349914968       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.803349932390       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.803349932469       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.803349931044       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.803349927109       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.803349930423       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.803349920137       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.803349920944       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.803349921712       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.803349921694       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.803349924940       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.803349924616       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.803349922232       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.803349920971       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.803349921672       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.803349920391       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.803349919351       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 4.711142e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.801540995912       residual = 1.43e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.801891071353       residual = 2.61e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.801955632772       residual = 8.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.801977607166       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.801984839356       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.801987757708       residual = 7.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.801990334479       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.801992626669       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.801994823948       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.801996070846       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.801996823155       residual = 7.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.801997015599       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.801997168859       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.801997313072       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.801997361091       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.801997405012       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.801997442504       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.801997464424       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.801997513307       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.801997545565       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.801997549659       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.801997582290       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.801997606650       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.801997627988       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.801997632767       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.801997642119       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.801997648940       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.801997667268       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.801997666666       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.801997668104       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.801997670648       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.801997669560       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.801997673783       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.801997673693       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.801997673307       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.801997672380       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.801997673186       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.801997670605       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.801997670803       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.801997671014       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.801997670991       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.801997671804       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.801997671718       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.801997671115       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.801997670807       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.801997670971       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.801997670675       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.801997670409       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.6000e+01 is 1.190558e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.611774 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5519e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 1.928220e-01 1 1  ON 0
  uu_1                 3.673431e-02 1 1  ON 1
  uu_2                -4.534379e-02 1 1  ON 2
  uu_3                -9.383660e-02 1 1  ON 3
  uu_4                -1.255828e-01 1 1  ON 4
  uu_5                -1.329110e-01 1 1  ON 5
  uu_6                -1.095176e-01 1 1  ON 6
  uu_7                -3.391648e-02 1 1  ON 7
  uu_8                 1.024963e-01 1 1  ON 8
  uu_9                 1.189368e-01 1 1  ON 9
  ud_0                 3.145075e-01 1 1  ON 10
  ud_1                 7.634227e-02 1 1  ON 11
  ud_2                -8.141042e-03 1 1  ON 12
  ud_3                -5.656132e-02 1 1  ON 13
  ud_4                -1.067492e-01 1 1  ON 14
  ud_5                -1.481478e-01 1 1  ON 15
  ud_6                -1.561072e-01 1 1  ON 16
  ud_7                -1.072453e-01 1 1  ON 17
  ud_8                 9.270867e-03 1 1  ON 18
  ud_9                 9.244155e-02 1 1  ON 19
  eO_0                -6.821179e-01 1 1  ON 20
  eO_1                -4.040906e-01 1 1  ON 21
  eO_2                -6.019464e-02 1 1  ON 22
  eO_3                 1.635309e-01 1 1  ON 23
  eO_4                 2.640676e-01 1 1  ON 24
  eO_5                 3.062344e-01 1 1  ON 25
  eO_6                 2.483512e-01 1 1  ON 26
  eO_7                 1.084206e-01 1 1  ON 27
  eO_8                 2.729883e-02 1 1  ON 28
  eO_9                 1.814155e-02 1 1  ON 29
 eH1_0                -1.777095e-01 1 1  ON 30
 eH1_1                -9.860889e-02 1 1  ON 31
 eH1_2                -6.120644e-02 1 1  ON 32
 eH1_3                -2.805875e-02 1 1  ON 33
 eH1_4                 1.788062e-02 1 1  ON 34
 eH1_5                 3.103316e-02 1 1  ON 35
 eH1_6                 7.795477e-02 1 1  ON 36
 eH1_7                 1.114299e-01 1 1  ON 37
 eH1_8                 8.864371e-02 1 1  ON 38
 eH1_9                 2.361564e-02 1 1  ON 39
 eH2_0                -1.793218e-01 1 1  ON 40
 eH2_1                -1.002711e-01 1 1  ON 41
 eH2_2                -6.327563e-02 1 1  ON 42
 eH2_3                -2.955736e-02 1 1  ON 43
 eH2_4                 1.639382e-02 1 1  ON 44
 eH2_5                 3.129241e-02 1 1  ON 45
 eH2_6                 8.017553e-02 1 1  ON 46
 eH2_7                 1.152650e-01 1 1  ON 47
 eH2_8                 9.179291e-02 1 1  ON 48
 eH2_9                 2.563282e-02 1 1  ON 49
ci_001                -6.493691e-02 3 1  ON 50
ci_002                -5.037541e-02 3 1  ON 51
ci_003                -3.620417e-02 3 1  ON 52
ci_004                 3.577400e-02 3 1  ON 53
ci_005                 3.579829e-02 3 1  ON 54
ci_006                -3.448940e-02 3 1  ON 55
ci_007                -3.448572e-02 3 1  ON 56
ci_008                -2.980259e-02 3 1  ON 57
ci_009                -2.851304e-02 3 1  ON 58
ci_010                -2.776456e-02 3 1  ON 59
ci_011                -2.747950e-02 3 1  ON 60
ci_012                -2.739312e-02 3 1  ON 61
ci_013                -2.651359e-02 3 1  ON 62
ci_014                 2.583288e-02 3 1  ON 63
ci_015                 2.579635e-02 3 1  ON 64
ci_016                 2.499662e-02 3 1  ON 65
ci_017                 2.497127e-02 3 1  ON 66
ci_018                 2.404153e-02 3 1  ON 67
ci_019                 2.402735e-02 3 1  ON 68
ci_020                 2.422916e-02 3 1  ON 69
ci_021                 2.427910e-02 3 1  ON 70
ci_022                 2.131852e-02 3 1  ON 71
ci_023                 2.122162e-02 3 1  ON 72
ci_024                 2.108746e-02 3 1  ON 73
ci_025                 2.106577e-02 3 1  ON 74
ci_026                 2.102468e-02 3 1  ON 75
ci_027                 2.104721e-02 3 1  ON 76
ci_028                -2.087347e-02 3 1  ON 77
ci_029                -2.081826e-02 3 1  ON 78
ci_030                -1.891982e-02 3 1  ON 79
ci_031                -1.896251e-02 3 1  ON 80
ci_032                -1.849466e-02 3 1  ON 81
ci_033                 1.767158e-02 3 1  ON 82
ci_034                 1.778614e-02 3 1  ON 83
ci_035                -1.724194e-02 3 1  ON 84
ci_036                -1.781537e-02 3 1  ON 85
ci_037                -1.784192e-02 3 1  ON 86
ci_038                 1.649081e-02 3 1  ON 87
ci_039                 1.648317e-02 3 1  ON 88
ci_040                -1.577813e-02 3 1  ON 89
ci_041                 1.608728e-02 3 1  ON 90
ci_042                 1.607982e-02 3 1  ON 91
ci_043                -1.538913e-02 3 1  ON 92
ci_044                -1.533594e-02 3 1  ON 93
ci_045                -1.487964e-02 3 1  ON 94
ci_046                 1.445424e-02 3 1  ON 95
ci_047                 1.445581e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1281
    reference variance = 0.468775
====================================================
  Execution time = 2.9358e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7201e+01
  VMC Evar = 3.7919e-01
  Total weights = 1.9635e+06
  Execution time = 2.4198e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366459976711
                                         uncertainty =       0.003028223951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366459976711
                                         uncertainty =       0.003028223951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428039352
  error estimate for blocks of size 2^( 2) =       0.000440465544
  error estimate for blocks of size 2^( 3) =       0.000450918290
  error estimate for blocks of size 2^( 4) =       0.000457782800
  error estimate for blocks of size 2^( 5) =       0.000461425921
  error estimate for blocks of size 2^( 6) =       0.000462187388
  error estimate for blocks of size 2^( 7) =       0.000463475560

      target function =      -0.805759463801
              le_mean =     -17.200615457549
             les_mean =     296.244931595795
             stat err =       0.000461217917
             autocorr =       1.161034015759
   target nu stat err =       0.000461217917
   target dn stat err =       0.004335532242
      target stat err =       0.004326347000
              std dev =       0.605348742774
             le_variance =       0.366447100378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353867210705
                                         uncertainty =       0.002956455228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353867210705
                                         uncertainty =       0.002956455228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420620461
  error estimate for blocks of size 2^( 2) =       0.000432931427
  error estimate for blocks of size 2^( 3) =       0.000443345969
  error estimate for blocks of size 2^( 4) =       0.000450226861
  error estimate for blocks of size 2^( 5) =       0.000453888200
  error estimate for blocks of size 2^( 6) =       0.000454764580
  error estimate for blocks of size 2^( 7) =       0.000456017435

      target function =      -0.819002182676
              le_mean =     -17.200681823061
             les_mean =     296.234050925839
             stat err =       0.000453724269
             autocorr =       1.163598702773
   target nu stat err =       0.000453724269
   target dn stat err =       0.004292351060
      target stat err =       0.004423973627
              std dev =       0.594856678585
             le_variance =       0.353854468057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359624146138
                                         uncertainty =       0.002984450702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359624146138
                                         uncertainty =       0.002984450702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424028260
  error estimate for blocks of size 2^( 2) =       0.000436391201
  error estimate for blocks of size 2^( 3) =       0.000446816319
  error estimate for blocks of size 2^( 4) =       0.000453686614
  error estimate for blocks of size 2^( 5) =       0.000457341628
  error estimate for blocks of size 2^( 6) =       0.000458140315
  error estimate for blocks of size 2^( 7) =       0.000459420318

      target function =      -0.810022729972
              le_mean =     -17.200625513136
             les_mean =     296.240976293716
             stat err =       0.000457147219
             autocorr =       1.162311569263
   target nu stat err =       0.000457147219
   target dn stat err =       0.005570643826
      target stat err =       0.005598191046
              std dev =       0.599676110358
             le_variance =       0.359611437334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365586592780
                                         uncertainty =       0.003022894191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365586592780
                                         uncertainty =       0.003022894191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427528985
  error estimate for blocks of size 2^( 2) =       0.000439946225
  error estimate for blocks of size 2^( 3) =       0.000450392445
  error estimate for blocks of size 2^( 4) =       0.000457261866
  error estimate for blocks of size 2^( 5) =       0.000460921205
  error estimate for blocks of size 2^( 6) =       0.000461693821
  error estimate for blocks of size 2^( 7) =       0.000462981455

      target function =      -0.649951853983
              le_mean =     -17.200610563611
             les_mean =     296.411241875390
             stat err =       0.000460714587
             autocorr =       1.161268907959
   target nu stat err =       0.000460714587
   target dn stat err =       0.168163714209
      target stat err =       0.111420473515
              std dev =       0.604626962307
             le_variance =       0.365573763548


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.805759463801        initial
     1.0000e+00     1.0000e+01             1.8064e-03        -0.819002182676  <--
     4.0000e+00     4.0000e+01             4.7111e-04        -0.810022729972
     1.6000e+01     1.6000e+02             1.1906e-04        -0.649951853983

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.1497e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 1.933349e-01 1 1  ON 0
  uu_1                 3.728840e-02 1 1  ON 1
  uu_2                -4.516840e-02 1 1  ON 2
  uu_3                -9.392367e-02 1 1  ON 3
  uu_4                -1.257066e-01 1 1  ON 4
  uu_5                -1.330643e-01 1 1  ON 5
  uu_6                -1.097610e-01 1 1  ON 6
  uu_7                -3.432215e-02 1 1  ON 7
  uu_8                 1.020425e-01 1 1  ON 8
  uu_9                 1.190478e-01 1 1  ON 9
  ud_0                 3.141601e-01 1 1  ON 10
  ud_1                 7.666837e-02 1 1  ON 11
  ud_2                -8.668197e-03 1 1  ON 12
  ud_3                -5.728435e-02 1 1  ON 13
  ud_4                -1.068804e-01 1 1  ON 14
  ud_5                -1.475145e-01 1 1  ON 15
  ud_6                -1.552281e-01 1 1  ON 16
  ud_7                -1.069830e-01 1 1  ON 17
  ud_8                 8.827854e-03 1 1  ON 18
  ud_9                 9.239308e-02 1 1  ON 19
  eO_0                -6.827495e-01 1 1  ON 20
  eO_1                -4.047647e-01 1 1  ON 21
  eO_2                -5.928798e-02 1 1  ON 22
  eO_3                 1.644375e-01 1 1  ON 23
  eO_4                 2.637513e-01 1 1  ON 24
  eO_5                 3.056704e-01 1 1  ON 25
  eO_6                 2.485231e-01 1 1  ON 26
  eO_7                 1.085864e-01 1 1  ON 27
  eO_8                 2.731486e-02 1 1  ON 28
  eO_9                 1.815684e-02 1 1  ON 29
 eH1_0                -1.790448e-01 1 1  ON 30
 eH1_1                -9.881627e-02 1 1  ON 31
 eH1_2                -6.065328e-02 1 1  ON 32
 eH1_3                -2.754466e-02 1 1  ON 33
 eH1_4                 1.797222e-02 1 1  ON 34
 eH1_5                 3.119392e-02 1 1  ON 35
 eH1_6                 7.803393e-02 1 1  ON 36
 eH1_7                 1.114248e-01 1 1  ON 37
 eH1_8                 8.875765e-02 1 1  ON 38
 eH1_9                 2.364186e-02 1 1  ON 39
 eH2_0                -1.804408e-01 1 1  ON 40
 eH2_1                -1.002601e-01 1 1  ON 41
 eH2_2                -6.255397e-02 1 1  ON 42
 eH2_3                -2.902735e-02 1 1  ON 43
 eH2_4                 1.648914e-02 1 1  ON 44
 eH2_5                 3.103751e-02 1 1  ON 45
 eH2_6                 8.005640e-02 1 1  ON 46
 eH2_7                 1.152535e-01 1 1  ON 47
 eH2_8                 9.192333e-02 1 1  ON 48
 eH2_9                 2.563836e-02 1 1  ON 49
ci_001                -6.390863e-02 3 1  ON 50
ci_002                -4.942792e-02 3 1  ON 51
ci_003                -3.583074e-02 3 1  ON 52
ci_004                 3.534603e-02 3 1  ON 53
ci_005                 3.537612e-02 3 1  ON 54
ci_006                -3.378763e-02 3 1  ON 55
ci_007                -3.382217e-02 3 1  ON 56
ci_008                -2.857675e-02 3 1  ON 57
ci_009                -2.784056e-02 3 1  ON 58
ci_010                -2.693643e-02 3 1  ON 59
ci_011                -2.663849e-02 3 1  ON 60
ci_012                -2.644955e-02 3 1  ON 61
ci_013                -2.616407e-02 3 1  ON 62
ci_014                 2.526310e-02 3 1  ON 63
ci_015                 2.526458e-02 3 1  ON 64
ci_016                 2.461610e-02 3 1  ON 65
ci_017                 2.458353e-02 3 1  ON 66
ci_018                 2.330437e-02 3 1  ON 67
ci_019                 2.329825e-02 3 1  ON 68
ci_020                 2.384866e-02 3 1  ON 69
ci_021                 2.399309e-02 3 1  ON 70
ci_022                 2.082323e-02 3 1  ON 71
ci_023                 2.060418e-02 3 1  ON 72
ci_024                 2.051122e-02 3 1  ON 73
ci_025                 2.044992e-02 3 1  ON 74
ci_026                 2.046231e-02 3 1  ON 75
ci_027                 2.054449e-02 3 1  ON 76
ci_028                -2.060408e-02 3 1  ON 77
ci_029                -2.056778e-02 3 1  ON 78
ci_030                -1.805511e-02 3 1  ON 79
ci_031                -1.824033e-02 3 1  ON 80
ci_032                -1.836646e-02 3 1  ON 81
ci_033                 1.710161e-02 3 1  ON 82
ci_034                 1.733573e-02 3 1  ON 83
ci_035                -1.657770e-02 3 1  ON 84
ci_036                -1.757443e-02 3 1  ON 85
ci_037                -1.761391e-02 3 1  ON 86
ci_038                 1.564560e-02 3 1  ON 87
ci_039                 1.567688e-02 3 1  ON 88
ci_040                -1.503864e-02 3 1  ON 89
ci_041                 1.572956e-02 3 1  ON 90
ci_042                 1.566152e-02 3 1  ON 91
ci_043                -1.478018e-02 3 1  ON 92
ci_044                -1.486621e-02 3 1  ON 93
ci_045                -1.421594e-02 3 1  ON 94
ci_046                 1.400099e-02 3 1  ON 95
ci_047                 1.404803e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7022e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7159e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.159
    reference variance = 0.364614
====================================================
  Execution time = 2.7653e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0495e+04
  VMC Eavg = -1.7203e+01
  VMC Evar = 3.7845e-01
  Total weights = 1.963869617e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3312e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358384980309
                                         uncertainty =       0.002913959535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358384980309
                                         uncertainty =       0.002913959535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423241745
  error estimate for blocks of size 2^( 2) =       0.000435708185
  error estimate for blocks of size 2^( 3) =       0.000445999462
  error estimate for blocks of size 2^( 4) =       0.000453144952
  error estimate for blocks of size 2^( 5) =       0.000457549867
  error estimate for blocks of size 2^( 6) =       0.000460206389
  error estimate for blocks of size 2^( 7) =       0.000460125097

      target function =      -0.811198595532
              le_mean =     -17.202723519482
             les_mean =     296.312148985447
             stat err =       0.000457756576
             autocorr =       1.169747675278
   target nu stat err =       0.000457756576
   target dn stat err =       0.005109061529
      target stat err =       0.005170668439
              std dev =       0.598563793372
             le_variance =       0.358278614736


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720272351948e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.811230921434       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.827599202705       residual = 2.63e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.830825388997       residual = 7.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.831893553599       residual = 2.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.832224566584       residual = 8.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.832366948746       residual = 6.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.832487860952       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.832569984644       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.832677608797       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.832737792028       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.832769316575       residual = 6.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.832785559404       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.832790783542       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.832796323279       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.832799807770       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.832803494102       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.832805951237       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.832809719016       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.832811741835       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.832814858995       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.832814817424       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.832817151217       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.832817515109       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.832817908463       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.832818228013       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.832818859286       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.832819364873       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.832819509133       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.832819483298       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.832819588535       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.832819725818       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.832819603944       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.832819732373       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.832819676041       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.832819739031       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.832819786785       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.832819879565       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.832819900081       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.832819810671       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.832819760463       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.832819674258       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.832819669269       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.832819688413       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.832819804688       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.832819787879       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.832819783599       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.832819770032       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.832819795504       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.832819805823       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.832819829940       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.832819839608       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.832819839770       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         51 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e-01 is 5.022488e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.811230921434       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.816044579221       residual = 2.54e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.816949513334       residual = 7.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.817246887161       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.817340210548       residual = 7.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.817379168043       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.817412922095       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.817436860474       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.817466871595       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.817483263413       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.817491282465       residual = 5.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.817495430413       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.817496768731       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.817498437312       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.817499463327       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.817500413767       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.817501055438       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.817502015232       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.817502524749       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.817503313865       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.817503274262       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.817503800659       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.817503867045       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.817503955397       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.817504008552       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.817504154458       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.817504220546       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.817504264477       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.817504241663       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.817504268596       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.817504290235       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.817504264477       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.817504284311       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.817504270216       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.817504291034       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.817504298961       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.817504308626       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.817504309229       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.817504292933       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.817504277300       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.817504258949       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.817504261538       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.817504279231       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.817504292842       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.817504288135       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.817504281489       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.817504289735       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.817504291018       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.817504294545       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.817504295487       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.817504297114       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         50 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 1.486200e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.811230921434       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.812488516851       residual = 2.51e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.812721144836       residual = 7.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.812797501246       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.812821527830       residual = 7.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.812831487776       residual = 5.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.812840153449       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.812846376737       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.812854067840       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.812858242544       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.812860242172       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.812861279567       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.812861630691       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.812862055355       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.812862320340       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.812862559085       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.812862720614       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.812862960765       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.812863088027       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.812863283977       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.812863272048       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.812863398733       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.812863413411       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.812863434815       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.812863446188       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.812863481743       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.812863493919       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.812863505393       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.812863499096       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.812863505692       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.812863510042       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.812863504313       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.812863508031       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.812863505105       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.812863510481       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.812863512159       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.812863513898       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.812863513456       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.812863509919       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.812863505800       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.812863501822       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.812863502358       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.812863507753       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.812863510155       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.812863508421       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.812863507174       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.812863509627       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.812863509739       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.812863510337       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.812863510826       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         49 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 3.888445e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.757184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6139e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 1.941364e-01 1 1  ON 0
  uu_1                 3.803786e-02 1 1  ON 1
  uu_2                -4.493804e-02 1 1  ON 2
  uu_3                -9.400932e-02 1 1  ON 3
  uu_4                -1.257687e-01 1 1  ON 4
  uu_5                -1.331808e-01 1 1  ON 5
  uu_6                -1.100151e-01 1 1  ON 6
  uu_7                -3.495376e-02 1 1  ON 7
  uu_8                 1.012848e-01 1 1  ON 8
  uu_9                 1.190747e-01 1 1  ON 9
  ud_0                 3.135786e-01 1 1  ON 10
  ud_1                 7.694984e-02 1 1  ON 11
  ud_2                -9.394554e-03 1 1  ON 12
  ud_3                -5.822356e-02 1 1  ON 13
  ud_4                -1.070481e-01 1 1  ON 14
  ud_5                -1.466623e-01 1 1  ON 15
  ud_6                -1.540150e-01 1 1  ON 16
  ud_7                -1.063430e-01 1 1  ON 17
  ud_8                 8.243457e-03 1 1  ON 18
  ud_9                 9.231597e-02 1 1  ON 19
  eO_0                -6.834099e-01 1 1  ON 20
  eO_1                -4.054911e-01 1 1  ON 21
  eO_2                -5.830907e-02 1 1  ON 22
  eO_3                 1.653107e-01 1 1  ON 23
  eO_4                 2.633826e-01 1 1  ON 24
  eO_5                 3.052114e-01 1 1  ON 25
  eO_6                 2.486756e-01 1 1  ON 26
  eO_7                 1.088134e-01 1 1  ON 27
  eO_8                 2.729386e-02 1 1  ON 28
  eO_9                 1.815234e-02 1 1  ON 29
 eH1_0                -1.803094e-01 1 1  ON 30
 eH1_1                -9.873748e-02 1 1  ON 31
 eH1_2                -5.976906e-02 1 1  ON 32
 eH1_3                -2.680472e-02 1 1  ON 33
 eH1_4                 1.808317e-02 1 1  ON 34
 eH1_5                 3.098735e-02 1 1  ON 35
 eH1_6                 7.771950e-02 1 1  ON 36
 eH1_7                 1.112857e-01 1 1  ON 37
 eH1_8                 8.888819e-02 1 1  ON 38
 eH1_9                 2.362679e-02 1 1  ON 39
 eH2_0                -1.819270e-01 1 1  ON 40
 eH2_1                -1.002895e-01 1 1  ON 41
 eH2_2                -6.176498e-02 1 1  ON 42
 eH2_3                -2.834478e-02 1 1  ON 43
 eH2_4                 1.669570e-02 1 1  ON 44
 eH2_5                 3.083775e-02 1 1  ON 45
 eH2_6                 7.993799e-02 1 1  ON 46
 eH2_7                 1.152380e-01 1 1  ON 47
 eH2_8                 9.204997e-02 1 1  ON 48
 eH2_9                 2.567258e-02 1 1  ON 49
ci_001                -6.269602e-02 3 1  ON 50
ci_002                -4.824734e-02 3 1  ON 51
ci_003                -3.536094e-02 3 1  ON 52
ci_004                 3.478861e-02 3 1  ON 53
ci_005                 3.478419e-02 3 1  ON 54
ci_006                -3.297404e-02 3 1  ON 55
ci_007                -3.301041e-02 3 1  ON 56
ci_008                -2.715923e-02 3 1  ON 57
ci_009                -2.691275e-02 3 1  ON 58
ci_010                -2.577057e-02 3 1  ON 59
ci_011                -2.557512e-02 3 1  ON 60
ci_012                -2.538373e-02 3 1  ON 61
ci_013                -2.580479e-02 3 1  ON 62
ci_014                 2.446410e-02 3 1  ON 63
ci_015                 2.452718e-02 3 1  ON 64
ci_016                 2.405276e-02 3 1  ON 65
ci_017                 2.405141e-02 3 1  ON 66
ci_018                 2.236682e-02 3 1  ON 67
ci_019                 2.234064e-02 3 1  ON 68
ci_020                 2.353332e-02 3 1  ON 69
ci_021                 2.364601e-02 3 1  ON 70
ci_022                 2.015858e-02 3 1  ON 71
ci_023                 1.986192e-02 3 1  ON 72
ci_024                 1.972015e-02 3 1  ON 73
ci_025                 1.963440e-02 3 1  ON 74
ci_026                 1.980553e-02 3 1  ON 75
ci_027                 1.997889e-02 3 1  ON 76
ci_028                -2.031574e-02 3 1  ON 77
ci_029                -2.023857e-02 3 1  ON 78
ci_030                -1.705684e-02 3 1  ON 79
ci_031                -1.705835e-02 3 1  ON 80
ci_032                -1.820507e-02 3 1  ON 81
ci_033                 1.647152e-02 3 1  ON 82
ci_034                 1.670002e-02 3 1  ON 83
ci_035                -1.574703e-02 3 1  ON 84
ci_036                -1.729965e-02 3 1  ON 85
ci_037                -1.741706e-02 3 1  ON 86
ci_038                 1.460368e-02 3 1  ON 87
ci_039                 1.466919e-02 3 1  ON 88
ci_040                -1.413060e-02 3 1  ON 89
ci_041                 1.523335e-02 3 1  ON 90
ci_042                 1.523074e-02 3 1  ON 91
ci_043                -1.398483e-02 3 1  ON 92
ci_044                -1.405705e-02 3 1  ON 93
ci_045                -1.335027e-02 3 1  ON 94
ci_046                 1.345306e-02 3 1  ON 95
ci_047                 1.352539e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2042
    reference variance = 0.244282
====================================================
  Execution time = 2.7396e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7204e+01
  VMC Evar = 3.6414e-01
  Total weights = 1.9639e+06
  Execution time = 2.4077e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358030970963
                                         uncertainty =       0.002474864332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358030970963
                                         uncertainty =       0.002474864332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423058693
  error estimate for blocks of size 2^( 2) =       0.000435021635
  error estimate for blocks of size 2^( 3) =       0.000445722384
  error estimate for blocks of size 2^( 4) =       0.000453208173
  error estimate for blocks of size 2^( 5) =       0.000457069029
  error estimate for blocks of size 2^( 6) =       0.000458793142
  error estimate for blocks of size 2^( 7) =       0.000458761872

      target function =      -0.797468142470
              le_mean =     -17.203745797450
             les_mean =     296.360999545475
             stat err =       0.000456958054
             autocorr =       1.166679121635
   target nu stat err =       0.000456958054
   target dn stat err =       0.015523475348
      target stat err =       0.015130291922
              std dev =       0.598304914148
             le_variance =       0.357968770294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437062773881
                                         uncertainty =       0.106055923183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437062773881
                                         uncertainty =       0.106055923183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467412221
  error estimate for blocks of size 2^( 2) =       0.000477571978
  error estimate for blocks of size 2^( 3) =       0.000486764315
  error estimate for blocks of size 2^( 4) =       0.000493553009
  error estimate for blocks of size 2^( 5) =       0.000496169063
  error estimate for blocks of size 2^( 6) =       0.000497918100
  error estimate for blocks of size 2^( 7) =       0.000498167953

      target function =      -0.238568439454
              le_mean =     -17.204449211553
             les_mean =     297.799019146701
             stat err =       0.000496452031
             autocorr =       1.128117817170
   target nu stat err =       0.000496452031
   target dn stat err =       1.059868725981
      target stat err =       0.113302696823
              std dev =       0.661031277859
             le_variance =       0.436962350308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335960331249
                                         uncertainty =       0.002147709891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335960331249
                                         uncertainty =       0.002147709891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409810877
  error estimate for blocks of size 2^( 2) =       0.000421657212
  error estimate for blocks of size 2^( 3) =       0.000432299870
  error estimate for blocks of size 2^( 4) =       0.000439846029
  error estimate for blocks of size 2^( 5) =       0.000443666933
  error estimate for blocks of size 2^( 6) =       0.000445227565
  error estimate for blocks of size 2^( 7) =       0.000445370600

      target function =      -0.597583390949
              le_mean =     -17.203757198827
             les_mean =     296.575715537622
             stat err =       0.000443527782
             autocorr =       1.171317672199
   target nu stat err =       0.000443527782
   target dn stat err =       0.248942094258
      target stat err =       0.144003889420
              std dev =       0.579569372647
             le_variance =       0.335900657711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354674196685
                                         uncertainty =       0.002376900567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354674196685
                                         uncertainty =       0.002376900567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421070868
  error estimate for blocks of size 2^( 2) =       0.000433028766
  error estimate for blocks of size 2^( 3) =       0.000443739145
  error estimate for blocks of size 2^( 4) =       0.000451208658
  error estimate for blocks of size 2^( 5) =       0.000455070293
  error estimate for blocks of size 2^( 6) =       0.000456772802
  error estimate for blocks of size 2^( 7) =       0.000456821338

      target function =      -0.699496971786
              le_mean =     -17.203701997417
             les_mean =     296.468026561312
             stat err =       0.000454968273
             autocorr =       1.167486406675
   target nu stat err =       0.000454968273
   target dn stat err =       0.077560819087
      target stat err =       0.058506545178
              std dev =       0.595493660178
             le_variance =       0.354612699312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.797468142470        initial  <--
     2.5000e-01     2.5000e+00             5.0225e-03        -0.238568439454
     1.0000e+00     1.0000e+01             1.4862e-03        -0.597583390949
     4.0000e+00     4.0000e+01             3.8884e-04        -0.699496971786

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.5025
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 1.933349e-01 1 1  ON 0
  uu_1                 3.728840e-02 1 1  ON 1
  uu_2                -4.516840e-02 1 1  ON 2
  uu_3                -9.392367e-02 1 1  ON 3
  uu_4                -1.257066e-01 1 1  ON 4
  uu_5                -1.330643e-01 1 1  ON 5
  uu_6                -1.097610e-01 1 1  ON 6
  uu_7                -3.432215e-02 1 1  ON 7
  uu_8                 1.020425e-01 1 1  ON 8
  uu_9                 1.190478e-01 1 1  ON 9
  ud_0                 3.141601e-01 1 1  ON 10
  ud_1                 7.666837e-02 1 1  ON 11
  ud_2                -8.668197e-03 1 1  ON 12
  ud_3                -5.728435e-02 1 1  ON 13
  ud_4                -1.068804e-01 1 1  ON 14
  ud_5                -1.475145e-01 1 1  ON 15
  ud_6                -1.552281e-01 1 1  ON 16
  ud_7                -1.069830e-01 1 1  ON 17
  ud_8                 8.827854e-03 1 1  ON 18
  ud_9                 9.239308e-02 1 1  ON 19
  eO_0                -6.827495e-01 1 1  ON 20
  eO_1                -4.047647e-01 1 1  ON 21
  eO_2                -5.928798e-02 1 1  ON 22
  eO_3                 1.644375e-01 1 1  ON 23
  eO_4                 2.637513e-01 1 1  ON 24
  eO_5                 3.056704e-01 1 1  ON 25
  eO_6                 2.485231e-01 1 1  ON 26
  eO_7                 1.085864e-01 1 1  ON 27
  eO_8                 2.731486e-02 1 1  ON 28
  eO_9                 1.815684e-02 1 1  ON 29
 eH1_0                -1.790448e-01 1 1  ON 30
 eH1_1                -9.881627e-02 1 1  ON 31
 eH1_2                -6.065328e-02 1 1  ON 32
 eH1_3                -2.754466e-02 1 1  ON 33
 eH1_4                 1.797222e-02 1 1  ON 34
 eH1_5                 3.119392e-02 1 1  ON 35
 eH1_6                 7.803393e-02 1 1  ON 36
 eH1_7                 1.114248e-01 1 1  ON 37
 eH1_8                 8.875765e-02 1 1  ON 38
 eH1_9                 2.364186e-02 1 1  ON 39
 eH2_0                -1.804408e-01 1 1  ON 40
 eH2_1                -1.002601e-01 1 1  ON 41
 eH2_2                -6.255397e-02 1 1  ON 42
 eH2_3                -2.902735e-02 1 1  ON 43
 eH2_4                 1.648914e-02 1 1  ON 44
 eH2_5                 3.103751e-02 1 1  ON 45
 eH2_6                 8.005640e-02 1 1  ON 46
 eH2_7                 1.152535e-01 1 1  ON 47
 eH2_8                 9.192333e-02 1 1  ON 48
 eH2_9                 2.563836e-02 1 1  ON 49
ci_001                -6.390863e-02 3 1  ON 50
ci_002                -4.942792e-02 3 1  ON 51
ci_003                -3.583074e-02 3 1  ON 52
ci_004                 3.534603e-02 3 1  ON 53
ci_005                 3.537612e-02 3 1  ON 54
ci_006                -3.378763e-02 3 1  ON 55
ci_007                -3.382217e-02 3 1  ON 56
ci_008                -2.857675e-02 3 1  ON 57
ci_009                -2.784056e-02 3 1  ON 58
ci_010                -2.693643e-02 3 1  ON 59
ci_011                -2.663849e-02 3 1  ON 60
ci_012                -2.644955e-02 3 1  ON 61
ci_013                -2.616407e-02 3 1  ON 62
ci_014                 2.526310e-02 3 1  ON 63
ci_015                 2.526458e-02 3 1  ON 64
ci_016                 2.461610e-02 3 1  ON 65
ci_017                 2.458353e-02 3 1  ON 66
ci_018                 2.330437e-02 3 1  ON 67
ci_019                 2.329825e-02 3 1  ON 68
ci_020                 2.384866e-02 3 1  ON 69
ci_021                 2.399309e-02 3 1  ON 70
ci_022                 2.082323e-02 3 1  ON 71
ci_023                 2.060418e-02 3 1  ON 72
ci_024                 2.051122e-02 3 1  ON 73
ci_025                 2.044992e-02 3 1  ON 74
ci_026                 2.046231e-02 3 1  ON 75
ci_027                 2.054449e-02 3 1  ON 76
ci_028                -2.060408e-02 3 1  ON 77
ci_029                -2.056778e-02 3 1  ON 78
ci_030                -1.805511e-02 3 1  ON 79
ci_031                -1.824033e-02 3 1  ON 80
ci_032                -1.836646e-02 3 1  ON 81
ci_033                 1.710161e-02 3 1  ON 82
ci_034                 1.733573e-02 3 1  ON 83
ci_035                -1.657770e-02 3 1  ON 84
ci_036                -1.757443e-02 3 1  ON 85
ci_037                -1.761391e-02 3 1  ON 86
ci_038                 1.564560e-02 3 1  ON 87
ci_039                 1.567688e-02 3 1  ON 88
ci_040                -1.503864e-02 3 1  ON 89
ci_041                 1.572956e-02 3 1  ON 90
ci_042                 1.566152e-02 3 1  ON 91
ci_043                -1.478018e-02 3 1  ON 92
ci_044                -1.486621e-02 3 1  ON 93
ci_045                -1.421594e-02 3 1  ON 94
ci_046                 1.400099e-02 3 1  ON 95
ci_047                 1.404803e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5648e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7164e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2051
    reference variance = 0.700403
====================================================
  Execution time = 2.7625e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0450e+04
  VMC Eavg = -1.7202e+01
  VMC Evar = 3.6988e-01
  Total weights = 1.963656239e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3016e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353610875408
                                         uncertainty =       0.002520885541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353610875408
                                         uncertainty =       0.002520885541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420466948
  error estimate for blocks of size 2^( 2) =       0.000432962730
  error estimate for blocks of size 2^( 3) =       0.000443440546
  error estimate for blocks of size 2^( 4) =       0.000449926181
  error estimate for blocks of size 2^( 5) =       0.000453643382
  error estimate for blocks of size 2^( 6) =       0.000457065046
  error estimate for blocks of size 2^( 7) =       0.000460176058

      target function =      -0.819885454511
              le_mean =     -17.202245087874
             les_mean =     296.287117859163
             stat err =       0.000455202667
             autocorr =       1.172049276860
   target nu stat err =       0.000455202667
   target dn stat err =       0.003597307816
      target stat err =       0.003737556815
              std dev =       0.594639573897
             le_variance =       0.353596222844


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720224508787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.819901664237       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.821856384806       residual = 2.49e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.822220384890       residual = 7.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.822349999433       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.822382852980       residual = 9.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.822402898287       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.822417436732       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.822426901051       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.822438416946       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.822444997733       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.822448939246       residual = 8.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.822451379989       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.822452629752       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.822453166295       residual = 9.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.822453643771       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.822453957899       residual = 8.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.822454286211       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.822454734531       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.822454951358       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.822455191703       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.822455256698       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.822455294526       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.822455498328       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.822455695792       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.822455828967       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.822455873191       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.822455887779       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.822455907974       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.822455877743       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.822455879801       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.822455909929       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.822455930922       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.822455933336       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.822455949426       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.822455962043       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.822455972596       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.822455984255       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.822455983382       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.822455985619       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.822455985161       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.822455997834       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.822455991062       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.822455992847       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.822455992131       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.822455989899       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.822455992820       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.822455990822       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.822455990998       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.822455989636       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.822455990798       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         49 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+00 is 6.864197e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.819901664237       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.820399309165       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.820491334702       residual = 7.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.820524037601       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.820532358854       residual = 9.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.820537438748       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.820541096210       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.820543504854       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.820546419223       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.820548079974       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.820549069916       residual = 8.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.820549684958       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.820549998201       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.820550132006       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.820550253426       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.820550331975       residual = 8.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.820550415030       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.820550526911       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.820550580625       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.820550639954       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.820550656552       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.820550665653       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.820550716570       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.820550766022       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.820550798440       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.820550809132       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.820550812177       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.820550816798       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.820550809187       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.820550809936       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.820550817416       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.820550822632       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.820550823203       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.820550827242       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.820550830170       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.820550833058       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.820550835791       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.820550835381       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.820550835937       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.820550835862       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.820550838827       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.820550837151       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.820550837608       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.820550837443       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.820550836847       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.820550837625       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.820550837112       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.820550837160       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.820550836843       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.820550837099       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         49 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+01 is 1.748582e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.819901664237       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.820026646980       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.820049717365       residual = 7.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.820057911731       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.820059998860       residual = 9.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.820061273151       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.820062188925       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.820062793793       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.820063524571       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.820063940721       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.820064188483       residual = 8.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.820064342543       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.820064420894       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.820064454322       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.820064484809       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.820064504446       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.820064525272       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.820064553224       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.820064566621       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.820064581403       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.820064585575       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.820064587828       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.820064600554       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.820064612921       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.820064620969       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.820064623619       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.820064624343       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.820064625471       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.820064623565       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.820064623768       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.820064625634       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.820064626936       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.820064627077       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.820064628087       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.820064628806       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.820064629543       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.820064630214       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.820064630100       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.820064630239       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.820064630223       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.820064630951       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.820064630534       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.820064630648       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.820064630608       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.820064630457       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.820064630653       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.820064630525       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.820064630537       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.820064630459       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.820064630521       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         49 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+01 is 4.392189e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.887837 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6065e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 1.934027e-01 1 1  ON 0
  uu_1                 3.736152e-02 1 1  ON 1
  uu_2                -4.515047e-02 1 1  ON 2
  uu_3                -9.393892e-02 1 1  ON 3
  uu_4                -1.257194e-01 1 1  ON 4
  uu_5                -1.330856e-01 1 1  ON 5
  uu_6                -1.097910e-01 1 1  ON 6
  uu_7                -3.437352e-02 1 1  ON 7
  uu_8                 1.019835e-01 1 1  ON 8
  uu_9                 1.190575e-01 1 1  ON 9
  ud_0                 3.141082e-01 1 1  ON 10
  ud_1                 7.670614e-02 1 1  ON 11
  ud_2                -8.740668e-03 1 1  ON 12
  ud_3                -5.738496e-02 1 1  ON 13
  ud_4                -1.069040e-01 1 1  ON 14
  ud_5                -1.474337e-01 1 1  ON 15
  ud_6                -1.551084e-01 1 1  ON 16
  ud_7                -1.069332e-01 1 1  ON 17
  ud_8                 8.780674e-03 1 1  ON 18
  ud_9                 9.238268e-02 1 1  ON 19
  eO_0                -6.828322e-01 1 1  ON 20
  eO_1                -4.048489e-01 1 1  ON 21
  eO_2                -5.916895e-02 1 1  ON 22
  eO_3                 1.645412e-01 1 1  ON 23
  eO_4                 2.637348e-01 1 1  ON 24
  eO_5                 3.055910e-01 1 1  ON 25
  eO_6                 2.485317e-01 1 1  ON 26
  eO_7                 1.086134e-01 1 1  ON 27
  eO_8                 2.731480e-02 1 1  ON 28
  eO_9                 1.815945e-02 1 1  ON 29
 eH1_0                -1.792116e-01 1 1  ON 30
 eH1_1                -9.883833e-02 1 1  ON 31
 eH1_2                -6.057431e-02 1 1  ON 32
 eH1_3                -2.747418e-02 1 1  ON 33
 eH1_4                 1.799446e-02 1 1  ON 34
 eH1_5                 3.120402e-02 1 1  ON 35
 eH1_6                 7.803688e-02 1 1  ON 36
 eH1_7                 1.114087e-01 1 1  ON 37
 eH1_8                 8.877263e-02 1 1  ON 38
 eH1_9                 2.364450e-02 1 1  ON 39
 eH2_0                -1.806157e-01 1 1  ON 40
 eH2_1                -1.002663e-01 1 1  ON 41
 eH2_2                -6.245934e-02 1 1  ON 42
 eH2_3                -2.894498e-02 1 1  ON 43
 eH2_4                 1.652762e-02 1 1  ON 44
 eH2_5                 3.102127e-02 1 1  ON 45
 eH2_6                 8.003130e-02 1 1  ON 46
 eH2_7                 1.152442e-01 1 1  ON 47
 eH2_8                 9.193634e-02 1 1  ON 48
 eH2_9                 2.563955e-02 1 1  ON 49
ci_001                -6.377649e-02 3 1  ON 50
ci_002                -4.929926e-02 3 1  ON 51
ci_003                -3.576259e-02 3 1  ON 52
ci_004                 3.528721e-02 3 1  ON 53
ci_005                 3.530643e-02 3 1  ON 54
ci_006                -3.370054e-02 3 1  ON 55
ci_007                -3.374063e-02 3 1  ON 56
ci_008                -2.843382e-02 3 1  ON 57
ci_009                -2.774832e-02 3 1  ON 58
ci_010                -2.682543e-02 3 1  ON 59
ci_011                -2.651958e-02 3 1  ON 60
ci_012                -2.632756e-02 3 1  ON 61
ci_013                -2.612974e-02 3 1  ON 62
ci_014                 2.518560e-02 3 1  ON 63
ci_015                 2.517831e-02 3 1  ON 64
ci_016                 2.455452e-02 3 1  ON 65
ci_017                 2.452560e-02 3 1  ON 66
ci_018                 2.319801e-02 3 1  ON 67
ci_019                 2.321307e-02 3 1  ON 68
ci_020                 2.380522e-02 3 1  ON 69
ci_021                 2.394918e-02 3 1  ON 70
ci_022                 2.074906e-02 3 1  ON 71
ci_023                 2.053297e-02 3 1  ON 72
ci_024                 2.042258e-02 3 1  ON 73
ci_025                 2.037839e-02 3 1  ON 74
ci_026                 2.040370e-02 3 1  ON 75
ci_027                 2.050077e-02 3 1  ON 76
ci_028                -2.058046e-02 3 1  ON 77
ci_029                -2.053515e-02 3 1  ON 78
ci_030                -1.794608e-02 3 1  ON 79
ci_031                -1.813536e-02 3 1  ON 80
ci_032                -1.834731e-02 3 1  ON 81
ci_033                 1.703682e-02 3 1  ON 82
ci_034                 1.726309e-02 3 1  ON 83
ci_035                -1.648661e-02 3 1  ON 84
ci_036                -1.756069e-02 3 1  ON 85
ci_037                -1.758210e-02 3 1  ON 86
ci_038                 1.553698e-02 3 1  ON 87
ci_039                 1.556292e-02 3 1  ON 88
ci_040                -1.493766e-02 3 1  ON 89
ci_041                 1.564541e-02 3 1  ON 90
ci_042                 1.561431e-02 3 1  ON 91
ci_043                -1.469393e-02 3 1  ON 92
ci_044                -1.479033e-02 3 1  ON 93
ci_045                -1.412895e-02 3 1  ON 94
ci_046                 1.394036e-02 3 1  ON 95
ci_047                 1.398812e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2508
    reference variance = 0.196064
====================================================
  Execution time = 2.7326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7202e+01
  VMC Evar = 3.6677e-01
  Total weights = 1.9637e+06
  Execution time = 2.3869e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355231244909
                                         uncertainty =       0.002760303258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355231244909
                                         uncertainty =       0.002760303258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421450752
  error estimate for blocks of size 2^( 2) =       0.000433724895
  error estimate for blocks of size 2^( 3) =       0.000443842310
  error estimate for blocks of size 2^( 4) =       0.000451293075
  error estimate for blocks of size 2^( 5) =       0.000456597567
  error estimate for blocks of size 2^( 6) =       0.000458996692
  error estimate for blocks of size 2^( 7) =       0.000458848603

      target function =      -0.820930732228
              le_mean =     -17.202169714481
             les_mean =     296.283503511312
             stat err =       0.000456433984
             autocorr =       1.172903489367
   target nu stat err =       0.000456433984
   target dn stat err =       0.003301563942
      target stat err =       0.003446243466
              std dev =       0.596030906117
             le_variance =       0.355252841046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350439236396
                                         uncertainty =       0.002694529291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350439236396
                                         uncertainty =       0.002694529291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418598701
  error estimate for blocks of size 2^( 2) =       0.000430824397
  error estimate for blocks of size 2^( 3) =       0.000440937309
  error estimate for blocks of size 2^( 4) =       0.000448385812
  error estimate for blocks of size 2^( 5) =       0.000453702133
  error estimate for blocks of size 2^( 6) =       0.000456119347
  error estimate for blocks of size 2^( 7) =       0.000455985844

      target function =      -0.826110649153
              le_mean =     -17.202187881270
             les_mean =     296.279130079186
             stat err =       0.000453548284
             autocorr =       1.173954604690
   target nu stat err =       0.000453548284
   target dn stat err =       0.003217717854
      target stat err =       0.003402578781
              std dev =       0.591997431706
             le_variance =       0.350460959147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352752002655
                                         uncertainty =       0.002726033895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352752002655
                                         uncertainty =       0.002726033895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419977614
  error estimate for blocks of size 2^( 2) =       0.000432226424
  error estimate for blocks of size 2^( 3) =       0.000442341344
  error estimate for blocks of size 2^( 4) =       0.000449791035
  error estimate for blocks of size 2^( 5) =       0.000455101250
  error estimate for blocks of size 2^( 6) =       0.000457509462
  error estimate for blocks of size 2^( 7) =       0.000457371147

      target function =      -0.819847883198
              le_mean =     -17.202175737244
             les_mean =     296.284744419531
             stat err =       0.000454943224
             autocorr =       1.173443320165
   target nu stat err =       0.000454943224
   target dn stat err =       0.005206315356
      target stat err =       0.005375336045
              std dev =       0.593947540722
             le_variance =       0.352773681130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354915563538
                                         uncertainty =       0.002755948432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354915563538
                                         uncertainty =       0.002755948432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421263465
  error estimate for blocks of size 2^( 2) =       0.000433534227
  error estimate for blocks of size 2^( 3) =       0.000443651296
  error estimate for blocks of size 2^( 4) =       0.000451102339
  error estimate for blocks of size 2^( 5) =       0.000456407606
  error estimate for blocks of size 2^( 6) =       0.000458807926
  error estimate for blocks of size 2^( 7) =       0.000458661868

      target function =      -0.822012799284
              le_mean =     -17.202169930888
             les_mean =     296.282461843456
             stat err =       0.000456244935
             autocorr =       1.172974363461
   target nu stat err =       0.000456244935
   target dn stat err =       0.003209514362
      target stat err =       0.003361520179
              std dev =       0.595766037891
             le_variance =       0.354937171904


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.820930732228        initial
     2.5000e+00     2.5000e+01             6.8642e-04        -0.826110649153  <--
     1.0000e+01     1.0000e+02             1.7486e-04        -0.819847883198
     4.0000e+01     4.0000e+02             4.3922e-05        -0.822012799284

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 3.9293e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 1.936022e-01 1 1  ON 0
  uu_1                 3.757609e-02 1 1  ON 1
  uu_2                -4.509695e-02 1 1  ON 2
  uu_3                -9.398242e-02 1 1  ON 3
  uu_4                -1.257562e-01 1 1  ON 4
  uu_5                -1.331479e-01 1 1  ON 5
  uu_6                -1.098796e-01 1 1  ON 6
  uu_7                -3.452597e-02 1 1  ON 7
  uu_8                 1.018073e-01 1 1  ON 8
  uu_9                 1.190865e-01 1 1  ON 9
  ud_0                 3.139551e-01 1 1  ON 10
  ud_1                 7.681334e-02 1 1  ON 11
  ud_2                -8.954161e-03 1 1  ON 12
  ud_3                -5.767985e-02 1 1  ON 13
  ud_4                -1.069732e-01 1 1  ON 14
  ud_5                -1.471959e-01 1 1  ON 15
  ud_6                -1.547551e-01 1 1  ON 16
  ud_7                -1.067843e-01 1 1  ON 17
  ud_8                 8.640921e-03 1 1  ON 18
  ud_9                 9.235160e-02 1 1  ON 19
  eO_0                -6.830721e-01 1 1  ON 20
  eO_1                -4.050921e-01 1 1  ON 21
  eO_2                -5.882169e-02 1 1  ON 22
  eO_3                 1.648422e-01 1 1  ON 23
  eO_4                 2.636848e-01 1 1  ON 24
  eO_5                 3.053559e-01 1 1  ON 25
  eO_6                 2.485577e-01 1 1  ON 26
  eO_7                 1.086941e-01 1 1  ON 27
  eO_8                 2.731463e-02 1 1  ON 28
  eO_9                 1.816725e-02 1 1  ON 29
 eH1_0                -1.797004e-01 1 1  ON 30
 eH1_1                -9.890262e-02 1 1  ON 31
 eH1_2                -6.034322e-02 1 1  ON 32
 eH1_3                -2.726783e-02 1 1  ON 33
 eH1_4                 1.805939e-02 1 1  ON 34
 eH1_5                 3.123301e-02 1 1  ON 35
 eH1_6                 7.804573e-02 1 1  ON 36
 eH1_7                 1.113610e-01 1 1  ON 37
 eH1_8                 8.881745e-02 1 1  ON 38
 eH1_9                 2.365243e-02 1 1  ON 39
 eH2_0                -1.811272e-01 1 1  ON 40
 eH2_1                -1.002837e-01 1 1  ON 41
 eH2_2                -6.218195e-02 1 1  ON 42
 eH2_3                -2.870338e-02 1 1  ON 43
 eH2_4                 1.664009e-02 1 1  ON 44
 eH2_5                 3.097264e-02 1 1  ON 45
 eH2_6                 7.995643e-02 1 1  ON 46
 eH2_7                 1.152165e-01 1 1  ON 47
 eH2_8                 9.197533e-02 1 1  ON 48
 eH2_9                 2.564314e-02 1 1  ON 49
ci_001                -6.338913e-02 3 1  ON 50
ci_002                -4.892258e-02 3 1  ON 51
ci_003                -3.556269e-02 3 1  ON 52
ci_004                 3.511474e-02 3 1  ON 53
ci_005                 3.510224e-02 3 1  ON 54
ci_006                -3.344565e-02 3 1  ON 55
ci_007                -3.350206e-02 3 1  ON 56
ci_008                -2.801750e-02 3 1  ON 57
ci_009                -2.747887e-02 3 1  ON 58
ci_010                -2.650090e-02 3 1  ON 59
ci_011                -2.617221e-02 3 1  ON 60
ci_012                -2.597128e-02 3 1  ON 61
ci_013                -2.602903e-02 3 1  ON 62
ci_014                 2.495905e-02 3 1  ON 63
ci_015                 2.492616e-02 3 1  ON 64
ci_016                 2.437449e-02 3 1  ON 65
ci_017                 2.435635e-02 3 1  ON 66
ci_018                 2.288786e-02 3 1  ON 67
ci_019                 2.296451e-02 3 1  ON 68
ci_020                 2.367783e-02 3 1  ON 69
ci_021                 2.382023e-02 3 1  ON 70
ci_022                 2.053249e-02 3 1  ON 71
ci_023                 2.032500e-02 3 1  ON 72
ci_024                 2.016286e-02 3 1  ON 73
ci_025                 2.016876e-02 3 1  ON 74
ci_026                 2.023268e-02 3 1  ON 75
ci_027                 2.037293e-02 3 1  ON 76
ci_028                -2.051115e-02 3 1  ON 77
ci_029                -2.043976e-02 3 1  ON 78
ci_030                -1.762844e-02 3 1  ON 79
ci_031                -1.782952e-02 3 1  ON 80
ci_032                -1.829131e-02 3 1  ON 81
ci_033                 1.684714e-02 3 1  ON 82
ci_034                 1.705047e-02 3 1  ON 83
ci_035                -1.622086e-02 3 1  ON 84
ci_036                -1.751978e-02 3 1  ON 85
ci_037                -1.748864e-02 3 1  ON 86
ci_038                 1.522014e-02 3 1  ON 87
ci_039                 1.523057e-02 3 1  ON 88
ci_040                -1.464340e-02 3 1  ON 89
ci_041                 1.540022e-02 3 1  ON 90
ci_042                 1.547666e-02 3 1  ON 91
ci_043                -1.444221e-02 3 1  ON 92
ci_044                -1.456851e-02 3 1  ON 93
ci_045                -1.387536e-02 3 1  ON 94
ci_046                 1.376311e-02 3 1  ON 95
ci_047                 1.381301e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7175e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1709
    reference variance = 0.373461
====================================================
  Execution time = 2.7899e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0439e+04
  VMC Eavg = -1.7203e+01
  VMC Evar = 3.6070e-01
  Total weights = 1.963826159e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3353e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347105533547
                                         uncertainty =       0.002086662970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347105533547
                                         uncertainty =       0.002086662970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416605687
  error estimate for blocks of size 2^( 2) =       0.000428566889
  error estimate for blocks of size 2^( 3) =       0.000438797192
  error estimate for blocks of size 2^( 4) =       0.000445629084
  error estimate for blocks of size 2^( 5) =       0.000449498666
  error estimate for blocks of size 2^( 6) =       0.000451412721
  error estimate for blocks of size 2^( 7) =       0.000453815032

      target function =      -0.829523576492
              le_mean =     -17.203149894586
             les_mean =     296.309065567052
             stat err =       0.000450088876
             autocorr =       1.167202394627
   target nu stat err =       0.000450088876
   target dn stat err =       0.003363205357
      target stat err =       0.003585767308
              std dev =       0.589178839877
             le_variance =       0.347131705359


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720314989459e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.829538320827       residual = 1.20e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.836487995824       residual = 2.34e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.837828605246       residual = 7.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.838274857029       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.838415325479       residual = 8.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.838482233491       residual = 6.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.838534362190       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.838582568836       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.838628388212       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.838656875252       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.838672026406       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.838678009916       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.838681535084       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.838682809577       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.838683825055       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.838684991017       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.838685565526       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.838686416234       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.838687502360       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.838688035662       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.838688533508       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.838689458922       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.838689563192       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.838689371772       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.838689214965       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.838689586288       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.838690097991       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.838690556865       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.838690668694       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.838690779489       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.838690796724       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.838690903391       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.838690895882       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.838690922665       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.838690980441       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.838691028166       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.838690930881       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.838690907978       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.838690886165       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.838690971338       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.838690998875       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.838690988235       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.838690977456       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.838690957654       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.838690965946       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.838690983397       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.838690976372       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.838690987822       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.838690995931       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.838690996984       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.838690994135       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         50 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 2.860532e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.829538320827       residual = 1.20e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.831404543794       residual = 2.30e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.831755526392       residual = 7.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.831872135589       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.831909273401       residual = 8.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.831926748794       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.831940402114       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.831953244516       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.831965186475       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.831972533288       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.831976390509       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.831977898405       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.831978717092       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.831979056338       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.831979274491       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.831979664167       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.831979833756       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.831980036640       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.831980304931       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.831980441996       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.831980572167       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.831980807900       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.831980820895       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.831980768505       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.831980730685       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.831980829580       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.831980955643       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.831981058176       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.831981074646       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.831981099862       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.831981106114       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.831981130341       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.831981126869       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.831981130697       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.831981149143       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.831981150945       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.831981126611       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.831981124436       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.831981121618       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.831981144045       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.831981144465       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.831981141757       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.831981138745       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.831981137004       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.831981137747       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.831981141192       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.831981139745       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.831981142867       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.831981143724       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.831981143999       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         49 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+00 is 7.629796e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.829538320827       residual = 1.20e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.830013597800       residual = 2.29e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.830102339224       residual = 7.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.830131815118       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.830141229351       residual = 8.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.830145646205       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.830149099474       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.830152361559       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.830155376511       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.830157226498       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.830158194261       residual = 5.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.830158571358       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.830158770308       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.830158859371       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.830158917678       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.830159015528       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.830159058095       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.830159108354       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.830159175000       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.830159209561       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.830159242515       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.830159301536       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.830159303982       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.830159290561       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.830159281305       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.830159306513       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.830159337675       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.830159362510       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.830159365880       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.830159371993       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.830159373693       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.830159379567       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.830159378681       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.830159379416       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.830159384248       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.830159383906       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.830159378207       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.830159377661       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.830159377301       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.830159382758       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.830159382532       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.830159381832       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.830159381038       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.830159380955       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.830159380977       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.830159381779       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.830159381445       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.830159382261       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.830159382364       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+01 is 1.939719e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.021187 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6375e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 1.938638e-01 1 1  ON 0
  uu_1                 3.786973e-02 1 1  ON 1
  uu_2                -4.500582e-02 1 1  ON 2
  uu_3                -9.401590e-02 1 1  ON 3
  uu_4                -1.257996e-01 1 1  ON 4
  uu_5                -1.332221e-01 1 1  ON 5
  uu_6                -1.100566e-01 1 1  ON 6
  uu_7                -3.476565e-02 1 1  ON 7
  uu_8                 1.016176e-01 1 1  ON 8
  uu_9                 1.191115e-01 1 1  ON 9
  ud_0                 3.137290e-01 1 1  ON 10
  ud_1                 7.689988e-02 1 1  ON 11
  ud_2                -9.282222e-03 1 1  ON 12
  ud_3                -5.811131e-02 1 1  ON 13
  ud_4                -1.070984e-01 1 1  ON 14
  ud_5                -1.468801e-01 1 1  ON 15
  ud_6                -1.542512e-01 1 1  ON 16
  ud_7                -1.066139e-01 1 1  ON 17
  ud_8                 8.549055e-03 1 1  ON 18
  ud_9                 9.239791e-02 1 1  ON 19
  eO_0                -6.833616e-01 1 1  ON 20
  eO_1                -4.053741e-01 1 1  ON 21
  eO_2                -5.837694e-02 1 1  ON 22
  eO_3                 1.652169e-01 1 1  ON 23
  eO_4                 2.634795e-01 1 1  ON 24
  eO_5                 3.050989e-01 1 1  ON 25
  eO_6                 2.485497e-01 1 1  ON 26
  eO_7                 1.088457e-01 1 1  ON 27
  eO_8                 2.737316e-02 1 1  ON 28
  eO_9                 1.817840e-02 1 1  ON 29
 eH1_0                -1.803457e-01 1 1  ON 30
 eH1_1                -9.895965e-02 1 1  ON 31
 eH1_2                -6.001519e-02 1 1  ON 32
 eH1_3                -2.698892e-02 1 1  ON 33
 eH1_4                 1.810030e-02 1 1  ON 34
 eH1_5                 3.125869e-02 1 1  ON 35
 eH1_6                 7.801033e-02 1 1  ON 36
 eH1_7                 1.112629e-01 1 1  ON 37
 eH1_8                 8.893444e-02 1 1  ON 38
 eH1_9                 2.369524e-02 1 1  ON 39
 eH2_0                -1.818902e-01 1 1  ON 40
 eH2_1                -1.003716e-01 1 1  ON 41
 eH2_2                -6.188173e-02 1 1  ON 42
 eH2_3                -2.845529e-02 1 1  ON 43
 eH2_4                 1.668301e-02 1 1  ON 44
 eH2_5                 3.100794e-02 1 1  ON 45
 eH2_6                 8.001712e-02 1 1  ON 46
 eH2_7                 1.152581e-01 1 1  ON 47
 eH2_8                 9.201969e-02 1 1  ON 48
 eH2_9                 2.569429e-02 1 1  ON 49
ci_001                -6.287434e-02 3 1  ON 50
ci_002                -4.844938e-02 3 1  ON 51
ci_003                -3.535639e-02 3 1  ON 52
ci_004                 3.484287e-02 3 1  ON 53
ci_005                 3.482557e-02 3 1  ON 54
ci_006                -3.311586e-02 3 1  ON 55
ci_007                -3.316062e-02 3 1  ON 56
ci_008                -2.743642e-02 3 1  ON 57
ci_009                -2.712082e-02 3 1  ON 58
ci_010                -2.603251e-02 3 1  ON 59
ci_011                -2.574804e-02 3 1  ON 60
ci_012                -2.556143e-02 3 1  ON 61
ci_013                -2.587082e-02 3 1  ON 62
ci_014                 2.463140e-02 3 1  ON 63
ci_015                 2.462773e-02 3 1  ON 64
ci_016                 2.416215e-02 3 1  ON 65
ci_017                 2.413414e-02 3 1  ON 66
ci_018                 2.247221e-02 3 1  ON 67
ci_019                 2.256794e-02 3 1  ON 68
ci_020                 2.351883e-02 3 1  ON 69
ci_021                 2.366709e-02 3 1  ON 70
ci_022                 2.026391e-02 3 1  ON 71
ci_023                 2.006548e-02 3 1  ON 72
ci_024                 1.982714e-02 3 1  ON 73
ci_025                 1.985540e-02 3 1  ON 74
ci_026                 1.999444e-02 3 1  ON 75
ci_027                 2.013389e-02 3 1  ON 76
ci_028                -2.036924e-02 3 1  ON 77
ci_029                -2.028053e-02 3 1  ON 78
ci_030                -1.723238e-02 3 1  ON 79
ci_031                -1.740566e-02 3 1  ON 80
ci_032                -1.819402e-02 3 1  ON 81
ci_033                 1.657997e-02 3 1  ON 82
ci_034                 1.675951e-02 3 1  ON 83
ci_035                -1.589060e-02 3 1  ON 84
ci_036                -1.741322e-02 3 1  ON 85
ci_037                -1.736487e-02 3 1  ON 86
ci_038                 1.479372e-02 3 1  ON 87
ci_039                 1.480987e-02 3 1  ON 88
ci_040                -1.427534e-02 3 1  ON 89
ci_041                 1.518109e-02 3 1  ON 90
ci_042                 1.529163e-02 3 1  ON 91
ci_043                -1.412415e-02 3 1  ON 92
ci_044                -1.426602e-02 3 1  ON 93
ci_045                -1.354207e-02 3 1  ON 94
ci_046                 1.353532e-02 3 1  ON 95
ci_047                 1.359592e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.0018
    reference variance = 0.694639
====================================================
  Execution time = 2.6973e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7204e+01
  VMC Evar = 3.6962e-01
  Total weights = 1.9639e+06
  Execution time = 2.3756e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351676660848
                                         uncertainty =       0.002547213676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351676660848
                                         uncertainty =       0.002547213676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419369994
  error estimate for blocks of size 2^( 2) =       0.000431798189
  error estimate for blocks of size 2^( 3) =       0.000441856259
  error estimate for blocks of size 2^( 4) =       0.000448916848
  error estimate for blocks of size 2^( 5) =       0.000454626101
  error estimate for blocks of size 2^( 6) =       0.000457194848
  error estimate for blocks of size 2^( 7) =       0.000457886496

      target function =      -0.812994520614
              le_mean =     -17.203673946436
             les_mean =     296.343140189359
             stat err =       0.000454656073
             autocorr =       1.175361025979
   target nu stat err =       0.000454656073
   target dn stat err =       0.005242043442
      target stat err =       0.005334379008
              std dev =       0.593088222812
             le_variance =       0.351753640038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336099227125
                                         uncertainty =       0.002451450990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336099227125
                                         uncertainty =       0.002451450990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409978622
  error estimate for blocks of size 2^( 2) =       0.000422315981
  error estimate for blocks of size 2^( 3) =       0.000432372726
  error estimate for blocks of size 2^( 4) =       0.000439632517
  error estimate for blocks of size 2^( 5) =       0.000445349479
  error estimate for blocks of size 2^( 6) =       0.000448011118
  error estimate for blocks of size 2^( 7) =       0.000448687960

      target function =      -0.814125354866
              le_mean =     -17.203771518292
             les_mean =     296.345180587605
             stat err =       0.000445420268
             autocorr =       1.180368271587
   target nu stat err =       0.000445420268
   target dn stat err =       0.013960792661
      target stat err =       0.014182544920
              std dev =       0.579806604622
             le_variance =       0.336175698764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342866643967
                                         uncertainty =       0.002474783078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342866643967
                                         uncertainty =       0.002474783078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414084729
  error estimate for blocks of size 2^( 2) =       0.000426460996
  error estimate for blocks of size 2^( 3) =       0.000436520943
  error estimate for blocks of size 2^( 4) =       0.000443663005
  error estimate for blocks of size 2^( 5) =       0.000449383191
  error estimate for blocks of size 2^( 6) =       0.000452007294
  error estimate for blocks of size 2^( 7) =       0.000452682008

      target function =      -0.821331930259
              le_mean =     -17.203675885988
             les_mean =     296.335034059940
             stat err =       0.000449433875
             autocorr =       1.178021389618
   target nu stat err =       0.000449433875
   target dn stat err =       0.006373338867
      target stat err =       0.006606333118
              std dev =       0.585613609617
             le_variance =       0.342943299768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350466702547
                                         uncertainty =       0.002537590437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350466702547
                                         uncertainty =       0.002537590437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418648107
  error estimate for blocks of size 2^( 2) =       0.000431068861
  error estimate for blocks of size 2^( 3) =       0.000441128407
  error estimate for blocks of size 2^( 4) =       0.000448200835
  error estimate for blocks of size 2^( 5) =       0.000453908322
  error estimate for blocks of size 2^( 6) =       0.000456481763
  error estimate for blocks of size 2^( 7) =       0.000457172096

      target function =      -0.813818217435
              le_mean =     -17.203669797026
             les_mean =     296.342180152798
             stat err =       0.000453940754
             autocorr =       1.175709656502
   target nu stat err =       0.000453940754
   target dn stat err =       0.005516056341
      target stat err =       0.005621374410
              std dev =       0.592067303975
             le_variance =       0.350543692437


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.812994520614        initial
     6.2500e-01     6.2500e+00             2.8605e-03        -0.814125354866
     2.5000e+00     2.5000e+01             7.6298e-04        -0.821331930259  <--
     1.0000e+01     1.0000e+02             1.9397e-04        -0.813818217435

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 3.8910e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 1.938638e-01 1 1  ON 0
  uu_1                 3.786973e-02 1 1  ON 1
  uu_2                -4.500582e-02 1 1  ON 2
  uu_3                -9.401590e-02 1 1  ON 3
  uu_4                -1.257996e-01 1 1  ON 4
  uu_5                -1.332221e-01 1 1  ON 5
  uu_6                -1.100566e-01 1 1  ON 6
  uu_7                -3.476565e-02 1 1  ON 7
  uu_8                 1.016176e-01 1 1  ON 8
  uu_9                 1.191115e-01 1 1  ON 9
  ud_0                 3.137290e-01 1 1  ON 10
  ud_1                 7.689988e-02 1 1  ON 11
  ud_2                -9.282222e-03 1 1  ON 12
  ud_3                -5.811131e-02 1 1  ON 13
  ud_4                -1.070984e-01 1 1  ON 14
  ud_5                -1.468801e-01 1 1  ON 15
  ud_6                -1.542512e-01 1 1  ON 16
  ud_7                -1.066139e-01 1 1  ON 17
  ud_8                 8.549055e-03 1 1  ON 18
  ud_9                 9.239791e-02 1 1  ON 19
  eO_0                -6.833616e-01 1 1  ON 20
  eO_1                -4.053741e-01 1 1  ON 21
  eO_2                -5.837694e-02 1 1  ON 22
  eO_3                 1.652169e-01 1 1  ON 23
  eO_4                 2.634795e-01 1 1  ON 24
  eO_5                 3.050989e-01 1 1  ON 25
  eO_6                 2.485497e-01 1 1  ON 26
  eO_7                 1.088457e-01 1 1  ON 27
  eO_8                 2.737316e-02 1 1  ON 28
  eO_9                 1.817840e-02 1 1  ON 29
 eH1_0                -1.803457e-01 1 1  ON 30
 eH1_1                -9.895965e-02 1 1  ON 31
 eH1_2                -6.001519e-02 1 1  ON 32
 eH1_3                -2.698892e-02 1 1  ON 33
 eH1_4                 1.810030e-02 1 1  ON 34
 eH1_5                 3.125869e-02 1 1  ON 35
 eH1_6                 7.801033e-02 1 1  ON 36
 eH1_7                 1.112629e-01 1 1  ON 37
 eH1_8                 8.893444e-02 1 1  ON 38
 eH1_9                 2.369524e-02 1 1  ON 39
 eH2_0                -1.818902e-01 1 1  ON 40
 eH2_1                -1.003716e-01 1 1  ON 41
 eH2_2                -6.188173e-02 1 1  ON 42
 eH2_3                -2.845529e-02 1 1  ON 43
 eH2_4                 1.668301e-02 1 1  ON 44
 eH2_5                 3.100794e-02 1 1  ON 45
 eH2_6                 8.001712e-02 1 1  ON 46
 eH2_7                 1.152581e-01 1 1  ON 47
 eH2_8                 9.201969e-02 1 1  ON 48
 eH2_9                 2.569429e-02 1 1  ON 49
ci_001                -6.287434e-02 3 1  ON 50
ci_002                -4.844938e-02 3 1  ON 51
ci_003                -3.535639e-02 3 1  ON 52
ci_004                 3.484287e-02 3 1  ON 53
ci_005                 3.482557e-02 3 1  ON 54
ci_006                -3.311586e-02 3 1  ON 55
ci_007                -3.316062e-02 3 1  ON 56
ci_008                -2.743642e-02 3 1  ON 57
ci_009                -2.712082e-02 3 1  ON 58
ci_010                -2.603251e-02 3 1  ON 59
ci_011                -2.574804e-02 3 1  ON 60
ci_012                -2.556143e-02 3 1  ON 61
ci_013                -2.587082e-02 3 1  ON 62
ci_014                 2.463140e-02 3 1  ON 63
ci_015                 2.462773e-02 3 1  ON 64
ci_016                 2.416215e-02 3 1  ON 65
ci_017                 2.413414e-02 3 1  ON 66
ci_018                 2.247221e-02 3 1  ON 67
ci_019                 2.256794e-02 3 1  ON 68
ci_020                 2.351883e-02 3 1  ON 69
ci_021                 2.366709e-02 3 1  ON 70
ci_022                 2.026391e-02 3 1  ON 71
ci_023                 2.006548e-02 3 1  ON 72
ci_024                 1.982714e-02 3 1  ON 73
ci_025                 1.985540e-02 3 1  ON 74
ci_026                 1.999444e-02 3 1  ON 75
ci_027                 2.013389e-02 3 1  ON 76
ci_028                -2.036924e-02 3 1  ON 77
ci_029                -2.028053e-02 3 1  ON 78
ci_030                -1.723238e-02 3 1  ON 79
ci_031                -1.740566e-02 3 1  ON 80
ci_032                -1.819402e-02 3 1  ON 81
ci_033                 1.657997e-02 3 1  ON 82
ci_034                 1.675951e-02 3 1  ON 83
ci_035                -1.589060e-02 3 1  ON 84
ci_036                -1.741322e-02 3 1  ON 85
ci_037                -1.736487e-02 3 1  ON 86
ci_038                 1.479372e-02 3 1  ON 87
ci_039                 1.480987e-02 3 1  ON 88
ci_040                -1.427534e-02 3 1  ON 89
ci_041                 1.518109e-02 3 1  ON 90
ci_042                 1.529163e-02 3 1  ON 91
ci_043                -1.412415e-02 3 1  ON 92
ci_044                -1.426602e-02 3 1  ON 93
ci_045                -1.354207e-02 3 1  ON 94
ci_046                 1.353532e-02 3 1  ON 95
ci_047                 1.359592e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5291e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7162e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1084
    reference variance = 0.135141
====================================================
  Execution time = 2.7511e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0451e+04
  VMC Eavg = -1.7204e+01
  VMC Evar = 3.5548e-01
  Total weights = 1.963816557e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4172e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342839829318
                                         uncertainty =       0.001962369315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342839829318
                                         uncertainty =       0.001962369315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414025636
  error estimate for blocks of size 2^( 2) =       0.000426256545
  error estimate for blocks of size 2^( 3) =       0.000436265598
  error estimate for blocks of size 2^( 4) =       0.000443792698
  error estimate for blocks of size 2^( 5) =       0.000446695145
  error estimate for blocks of size 2^( 6) =       0.000449572174
  error estimate for blocks of size 2^( 7) =       0.000450201055

      target function =      -0.835164042880
              le_mean =     -17.204044793237
             les_mean =     296.334637249212
             stat err =       0.000447565268
             autocorr =       1.168579567768
   target nu stat err =       0.000447565268
   target dn stat err =       0.002599553671
      target stat err =       0.002835721802
              std dev =       0.585530037511
             le_variance =       0.342845424828


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720404479324e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.835172980149       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.841732578079       residual = 2.32e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.843081893634       residual = 6.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.843501359246       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.843630554578       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.843697945863       residual = 6.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.843744472298       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.843787714650       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.843834946792       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.843860109960       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.843873712670       residual = 6.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.843877455002       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.843879654801       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.843881289577       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.843882729230       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.843884504833       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.843885898222       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.843886310706       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.843887747742       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.843888955492       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.843889055993       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.843889592904       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.843889767004       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.843890359352       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.843890524661       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.843890664708       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.843890651328       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.843890830894       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.843890984876       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.843891155752       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.843891218775       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.843891215514       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.843891217504       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.843891259070       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.843891234787       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.843891274350       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.843891294026       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.843891298190       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.843891310083       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.843891339675       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.843891325895       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.843891306119       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.843891295746       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.843891308506       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.843891312539       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.843891307980       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.843891300065       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.843891304367       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.843891301797       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 2.426165e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.835172980149       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.836937224305       residual = 2.28e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.837290804649       residual = 6.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.837400431350       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.837434724556       residual = 7.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.837452435160       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.837464624310       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.837476170835       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.837488521724       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.837495039222       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.837498490507       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.837499418195       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.837499972376       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.837500392815       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.837500768992       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.837501237904       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.837501588399       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.837501688235       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.837502055729       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.837502351947       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.837502368548       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.837502498358       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.837502542516       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.837502681976       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.837502717823       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.837502747961       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.837502743678       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.837502788752       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.837502821483       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.837502862268       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.837502878806       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.837502876826       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.837502877624       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.837502881955       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.837502882699       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.837502879645       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.837502892846       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.837502891496       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.837502894742       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.837502900550       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.837502898385       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.837502893591       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.837502890894       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.837502893314       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.837502894505       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.837502893553       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.837502892454       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.837502893217       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.837502892307       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+00 is 6.505430e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.835172980149       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.835622484049       residual = 2.27e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.835711903709       residual = 6.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.835739617424       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.835748319817       residual = 7.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.835752803790       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.835755886963       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.835758821644       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.835761942814       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.835763585816       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.835764450926       residual = 5.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.835764682104       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.835764820813       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.835764926675       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.835765021777       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.835765140600       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.835765228271       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.835765253007       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.835765345315       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.835765418816       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.835765422445       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.835765454602       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.835765465670       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.835765499850       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.835765508488       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.835765515747       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.835765514617       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.835765525841       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.835765533695       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.835765543713       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.835765547919       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.835765547361       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.835765547551       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.835765548349       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.835765548590       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.835765547893       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.835765551061       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.835765550746       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.835765551545       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.835765552882       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.835765552298       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.835765551181       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.835765550530       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.835765551088       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.835765551376       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.835765551153       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.835765550934       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.835765551086       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.835765550859       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+01 is 1.656133e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.151326 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8869e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 1.941034e-01 1 1  ON 0
  uu_1                 3.812733e-02 1 1  ON 1
  uu_2                -4.492918e-02 1 1  ON 2
  uu_3                -9.405899e-02 1 1  ON 3
  uu_4                -1.258355e-01 1 1  ON 4
  uu_5                -1.332475e-01 1 1  ON 5
  uu_6                -1.101707e-01 1 1  ON 6
  uu_7                -3.498470e-02 1 1  ON 7
  uu_8                 1.013306e-01 1 1  ON 8
  uu_9                 1.191564e-01 1 1  ON 9
  ud_0                 3.135267e-01 1 1  ON 10
  ud_1                 7.702132e-02 1 1  ON 11
  ud_2                -9.570380e-03 1 1  ON 12
  ud_3                -5.850636e-02 1 1  ON 13
  ud_4                -1.071962e-01 1 1  ON 14
  ud_5                -1.465664e-01 1 1  ON 15
  ud_6                -1.538065e-01 1 1  ON 16
  ud_7                -1.064384e-01 1 1  ON 17
  ud_8                 8.378507e-03 1 1  ON 18
  ud_9                 9.238979e-02 1 1  ON 19
  eO_0                -6.836814e-01 1 1  ON 20
  eO_1                -4.056814e-01 1 1  ON 21
  eO_2                -5.795394e-02 1 1  ON 22
  eO_3                 1.656296e-01 1 1  ON 23
  eO_4                 2.633361e-01 1 1  ON 24
  eO_5                 3.048441e-01 1 1  ON 25
  eO_6                 2.485955e-01 1 1  ON 26
  eO_7                 1.089637e-01 1 1  ON 27
  eO_8                 2.737869e-02 1 1  ON 28
  eO_9                 1.818451e-02 1 1  ON 29
 eH1_0                -1.809606e-01 1 1  ON 30
 eH1_1                -9.896421e-02 1 1  ON 31
 eH1_2                -5.966712e-02 1 1  ON 32
 eH1_3                -2.666956e-02 1 1  ON 33
 eH1_4                 1.819651e-02 1 1  ON 34
 eH1_5                 3.118191e-02 1 1  ON 35
 eH1_6                 7.786373e-02 1 1  ON 36
 eH1_7                 1.112565e-01 1 1  ON 37
 eH1_8                 8.899216e-02 1 1  ON 38
 eH1_9                 2.370924e-02 1 1  ON 39
 eH2_0                -1.825408e-01 1 1  ON 40
 eH2_1                -1.004253e-01 1 1  ON 41
 eH2_2                -6.158442e-02 1 1  ON 42
 eH2_3                -2.820638e-02 1 1  ON 43
 eH2_4                 1.674323e-02 1 1  ON 44
 eH2_5                 3.100950e-02 1 1  ON 45
 eH2_6                 8.005557e-02 1 1  ON 46
 eH2_7                 1.152468e-01 1 1  ON 47
 eH2_8                 9.206453e-02 1 1  ON 48
 eH2_9                 2.571282e-02 1 1  ON 49
ci_001                -6.236901e-02 3 1  ON 50
ci_002                -4.798739e-02 3 1  ON 51
ci_003                -3.515334e-02 3 1  ON 52
ci_004                 3.458199e-02 3 1  ON 53
ci_005                 3.459377e-02 3 1  ON 54
ci_006                -3.278799e-02 3 1  ON 55
ci_007                -3.280986e-02 3 1  ON 56
ci_008                -2.685550e-02 3 1  ON 57
ci_009                -2.674782e-02 3 1  ON 58
ci_010                -2.559087e-02 3 1  ON 59
ci_011                -2.536872e-02 3 1  ON 60
ci_012                -2.513091e-02 3 1  ON 61
ci_013                -2.572909e-02 3 1  ON 62
ci_014                 2.432174e-02 3 1  ON 63
ci_015                 2.430507e-02 3 1  ON 64
ci_016                 2.393654e-02 3 1  ON 65
ci_017                 2.389645e-02 3 1  ON 66
ci_018                 2.212666e-02 3 1  ON 67
ci_019                 2.221469e-02 3 1  ON 68
ci_020                 2.334411e-02 3 1  ON 69
ci_021                 2.350321e-02 3 1  ON 70
ci_022                 2.000036e-02 3 1  ON 71
ci_023                 1.979675e-02 3 1  ON 72
ci_024                 1.950843e-02 3 1  ON 73
ci_025                 1.953903e-02 3 1  ON 74
ci_026                 1.979081e-02 3 1  ON 75
ci_027                 1.989922e-02 3 1  ON 76
ci_028                -2.023854e-02 3 1  ON 77
ci_029                -2.016396e-02 3 1  ON 78
ci_030                -1.686374e-02 3 1  ON 79
ci_031                -1.700518e-02 3 1  ON 80
ci_032                -1.811530e-02 3 1  ON 81
ci_033                 1.635469e-02 3 1  ON 82
ci_034                 1.649150e-02 3 1  ON 83
ci_035                -1.555385e-02 3 1  ON 84
ci_036                -1.732812e-02 3 1  ON 85
ci_037                -1.726082e-02 3 1  ON 86
ci_038                 1.436694e-02 3 1  ON 87
ci_039                 1.440809e-02 3 1  ON 88
ci_040                -1.392239e-02 3 1  ON 89
ci_041                 1.497734e-02 3 1  ON 90
ci_042                 1.508111e-02 3 1  ON 91
ci_043                -1.381050e-02 3 1  ON 92
ci_044                -1.399526e-02 3 1  ON 93
ci_045                -1.320428e-02 3 1  ON 94
ci_046                 1.332813e-02 3 1  ON 95
ci_047                 1.338310e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2626
    reference variance = 0.281196
====================================================
  Execution time = 2.6909e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7204e+01
  VMC Evar = 3.5513e-01
  Total weights = 1.9641e+06
  Execution time = 2.3744e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343188085435
                                         uncertainty =       0.002412119336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343188085435
                                         uncertainty =       0.002412119336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414353606
  error estimate for blocks of size 2^( 2) =       0.000426355799
  error estimate for blocks of size 2^( 3) =       0.000436973041
  error estimate for blocks of size 2^( 4) =       0.000444645456
  error estimate for blocks of size 2^( 5) =       0.000448775950
  error estimate for blocks of size 2^( 6) =       0.000452132124
  error estimate for blocks of size 2^( 7) =       0.000452689308

      target function =      -0.830336430089
              le_mean =     -17.204193789640
             les_mean =     296.344319484217
             stat err =       0.000449560710
             autocorr =       1.177157167517
   target nu stat err =       0.000449560710
   target dn stat err =       0.003226583349
      target stat err =       0.003455937621
              std dev =       0.585993864521
             le_variance =       0.343388809256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329629594548
                                         uncertainty =       0.002641338513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329629594548
                                         uncertainty =       0.002641338513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406066882
  error estimate for blocks of size 2^( 2) =       0.000417928862
  error estimate for blocks of size 2^( 3) =       0.000428488672
  error estimate for blocks of size 2^( 4) =       0.000436168783
  error estimate for blocks of size 2^( 5) =       0.000440334522
  error estimate for blocks of size 2^( 6) =       0.000443569562
  error estimate for blocks of size 2^( 7) =       0.000444169972

      target function =      -0.747548704807
              le_mean =     -17.204307668688
             les_mean =     296.430967600667
             stat err =       0.000441060710
             autocorr =       1.179781557798
   target nu stat err =       0.000441060710
   target dn stat err =       0.061376677685
      target stat err =       0.052822381903
              std dev =       0.574274479732
             le_variance =       0.329791178072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334813438799
                                         uncertainty =       0.002327759036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334813438799
                                         uncertainty =       0.002327759036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409256760
  error estimate for blocks of size 2^( 2) =       0.000421187385
  error estimate for blocks of size 2^( 3) =       0.000431784029
  error estimate for blocks of size 2^( 4) =       0.000439482649
  error estimate for blocks of size 2^( 5) =       0.000443638495
  error estimate for blocks of size 2^( 6) =       0.000446972717
  error estimate for blocks of size 2^( 7) =       0.000447527801

      target function =      -0.838254915999
              le_mean =     -17.204204040096
             les_mean =     296.337240842258
             stat err =       0.000444405416
             autocorr =       1.179144315750
   target nu stat err =       0.000444405416
   target dn stat err =       0.003958569865
      target stat err =       0.004299784353
              std dev =       0.578785720974
             le_variance =       0.334992910804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342065051081
                                         uncertainty =       0.002400560269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342065051081
                                         uncertainty =       0.002400560269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413673759
  error estimate for blocks of size 2^( 2) =       0.000425665898
  error estimate for blocks of size 2^( 3) =       0.000436279644
  error estimate for blocks of size 2^( 4) =       0.000443955612
  error estimate for blocks of size 2^( 5) =       0.000448089146
  error estimate for blocks of size 2^( 6) =       0.000451441525
  error estimate for blocks of size 2^( 7) =       0.000451998107

      target function =      -0.831935395714
              le_mean =     -17.204189573946
             les_mean =     296.342663108743
             stat err =       0.000448871098
             autocorr =       1.177408970228
   target nu stat err =       0.000448871098
   target dn stat err =       0.003229467018
      target stat err =       0.003471926882
              std dev =       0.585032400095
             le_variance =       0.342262909161


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.830336430089        initial
     6.2500e-01     6.2500e+00             2.4262e-03        -0.747548704807
     2.5000e+00     2.5000e+01             6.5054e-04        -0.838254915999  <--
     1.0000e+01     1.0000e+02             1.6561e-04        -0.831935395714

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 3.8835e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 1.941034e-01 1 1  ON 0
  uu_1                 3.812733e-02 1 1  ON 1
  uu_2                -4.492918e-02 1 1  ON 2
  uu_3                -9.405899e-02 1 1  ON 3
  uu_4                -1.258355e-01 1 1  ON 4
  uu_5                -1.332475e-01 1 1  ON 5
  uu_6                -1.101707e-01 1 1  ON 6
  uu_7                -3.498470e-02 1 1  ON 7
  uu_8                 1.013306e-01 1 1  ON 8
  uu_9                 1.191564e-01 1 1  ON 9
  ud_0                 3.135267e-01 1 1  ON 10
  ud_1                 7.702132e-02 1 1  ON 11
  ud_2                -9.570380e-03 1 1  ON 12
  ud_3                -5.850636e-02 1 1  ON 13
  ud_4                -1.071962e-01 1 1  ON 14
  ud_5                -1.465664e-01 1 1  ON 15
  ud_6                -1.538065e-01 1 1  ON 16
  ud_7                -1.064384e-01 1 1  ON 17
  ud_8                 8.378507e-03 1 1  ON 18
  ud_9                 9.238979e-02 1 1  ON 19
  eO_0                -6.836814e-01 1 1  ON 20
  eO_1                -4.056814e-01 1 1  ON 21
  eO_2                -5.795394e-02 1 1  ON 22
  eO_3                 1.656296e-01 1 1  ON 23
  eO_4                 2.633361e-01 1 1  ON 24
  eO_5                 3.048441e-01 1 1  ON 25
  eO_6                 2.485955e-01 1 1  ON 26
  eO_7                 1.089637e-01 1 1  ON 27
  eO_8                 2.737869e-02 1 1  ON 28
  eO_9                 1.818451e-02 1 1  ON 29
 eH1_0                -1.809606e-01 1 1  ON 30
 eH1_1                -9.896421e-02 1 1  ON 31
 eH1_2                -5.966712e-02 1 1  ON 32
 eH1_3                -2.666956e-02 1 1  ON 33
 eH1_4                 1.819651e-02 1 1  ON 34
 eH1_5                 3.118191e-02 1 1  ON 35
 eH1_6                 7.786373e-02 1 1  ON 36
 eH1_7                 1.112565e-01 1 1  ON 37
 eH1_8                 8.899216e-02 1 1  ON 38
 eH1_9                 2.370924e-02 1 1  ON 39
 eH2_0                -1.825408e-01 1 1  ON 40
 eH2_1                -1.004253e-01 1 1  ON 41
 eH2_2                -6.158442e-02 1 1  ON 42
 eH2_3                -2.820638e-02 1 1  ON 43
 eH2_4                 1.674323e-02 1 1  ON 44
 eH2_5                 3.100950e-02 1 1  ON 45
 eH2_6                 8.005557e-02 1 1  ON 46
 eH2_7                 1.152468e-01 1 1  ON 47
 eH2_8                 9.206453e-02 1 1  ON 48
 eH2_9                 2.571282e-02 1 1  ON 49
ci_001                -6.236901e-02 3 1  ON 50
ci_002                -4.798739e-02 3 1  ON 51
ci_003                -3.515334e-02 3 1  ON 52
ci_004                 3.458199e-02 3 1  ON 53
ci_005                 3.459377e-02 3 1  ON 54
ci_006                -3.278799e-02 3 1  ON 55
ci_007                -3.280986e-02 3 1  ON 56
ci_008                -2.685550e-02 3 1  ON 57
ci_009                -2.674782e-02 3 1  ON 58
ci_010                -2.559087e-02 3 1  ON 59
ci_011                -2.536872e-02 3 1  ON 60
ci_012                -2.513091e-02 3 1  ON 61
ci_013                -2.572909e-02 3 1  ON 62
ci_014                 2.432174e-02 3 1  ON 63
ci_015                 2.430507e-02 3 1  ON 64
ci_016                 2.393654e-02 3 1  ON 65
ci_017                 2.389645e-02 3 1  ON 66
ci_018                 2.212666e-02 3 1  ON 67
ci_019                 2.221469e-02 3 1  ON 68
ci_020                 2.334411e-02 3 1  ON 69
ci_021                 2.350321e-02 3 1  ON 70
ci_022                 2.000036e-02 3 1  ON 71
ci_023                 1.979675e-02 3 1  ON 72
ci_024                 1.950843e-02 3 1  ON 73
ci_025                 1.953903e-02 3 1  ON 74
ci_026                 1.979081e-02 3 1  ON 75
ci_027                 1.989922e-02 3 1  ON 76
ci_028                -2.023854e-02 3 1  ON 77
ci_029                -2.016396e-02 3 1  ON 78
ci_030                -1.686374e-02 3 1  ON 79
ci_031                -1.700518e-02 3 1  ON 80
ci_032                -1.811530e-02 3 1  ON 81
ci_033                 1.635469e-02 3 1  ON 82
ci_034                 1.649150e-02 3 1  ON 83
ci_035                -1.555385e-02 3 1  ON 84
ci_036                -1.732812e-02 3 1  ON 85
ci_037                -1.726082e-02 3 1  ON 86
ci_038                 1.436694e-02 3 1  ON 87
ci_039                 1.440809e-02 3 1  ON 88
ci_040                -1.392239e-02 3 1  ON 89
ci_041                 1.497734e-02 3 1  ON 90
ci_042                 1.508111e-02 3 1  ON 91
ci_043                -1.381050e-02 3 1  ON 92
ci_044                -1.399526e-02 3 1  ON 93
ci_045                -1.320428e-02 3 1  ON 94
ci_046                 1.332813e-02 3 1  ON 95
ci_047                 1.338310e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0172e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7165e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1625
    reference variance = 0.708311
====================================================
  Execution time = 2.7045e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0457e+04
  VMC Eavg = -1.7204e+01
  VMC Evar = 3.5621e-01
  Total weights = 1.963826900e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3777e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342492190927
                                         uncertainty =       0.002737965617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342492190927
                                         uncertainty =       0.002737965617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414037259
  error estimate for blocks of size 2^( 2) =       0.000426498947
  error estimate for blocks of size 2^( 3) =       0.000436917295
  error estimate for blocks of size 2^( 4) =       0.000444213756
  error estimate for blocks of size 2^( 5) =       0.000449801803
  error estimate for blocks of size 2^( 6) =       0.000451597323
  error estimate for blocks of size 2^( 7) =       0.000450615092

      target function =      -0.834411247204
              le_mean =     -17.204408236664
             les_mean =     296.347875917803
             stat err =       0.000449056994
             autocorr =       1.176316204836
   target nu stat err =       0.000449056994
   target dn stat err =       0.003915122145
      target stat err =       0.004216983220
              std dev =       0.585546475157
             le_variance =       0.342864674569


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720440823666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.834431876421       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.840762432190       residual = 2.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.842016933847       residual = 6.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.842416409579       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.842533253668       residual = 7.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.842590312684       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.842636021714       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.842672127856       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.842707335950       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.842732195233       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.842747070082       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.842752607703       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.842755763706       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.842756578175       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.842756941433       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.842758581719       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.842759151443       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.842760359058       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.842762041785       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.842762925989       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.842763701942       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.842764549383       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.842765072958       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.842765293707       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.842765314239       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.842765228153       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.842765747317       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.842765770935       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.842765746429       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.842765775798       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.842765798689       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.842765715209       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.842765730906       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.842765787174       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.842765800956       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.842765708460       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.842765723947       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.842765724582       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.842765669674       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.842765709266       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.842765685201       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.842765685419       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.842765727206       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.842765751736       residual = 9.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.842765744244       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.842765768654       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.842765748780       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.842765757206       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.842765758022       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.842765760426       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.842765774767       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.842765774326       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         51 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 2.535675e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.834431876421       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.836133739650       residual = 2.14e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.836462660214       residual = 6.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.836567223204       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.836598141534       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.836613138393       residual = 5.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.836625092754       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.836634719581       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.836643923380       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.836650380170       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.836654186532       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.836655598734       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.836656305386       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.836656594029       residual = 8.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.836656679095       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.836657125178       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.836657272784       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.836657569846       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.836657997380       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.836658225206       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.836658414894       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.836658617610       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.836658754276       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.836658803899       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.836658794868       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.836658777357       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.836658891080       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.836658901572       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.836658892348       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.836658893846       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.836658898627       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.836658877225       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.836658889948       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.836658893728       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.836658900104       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.836658871128       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.836658883264       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.836658873826       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.836658875598       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.836658873585       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.836658872627       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.836658869575       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.836658883262       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.836658886183       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.836658884364       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.836658890151       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.836658885589       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.836658887334       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.836658887241       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+00 is 6.772623e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.834431876421       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.834865434876       residual = 2.13e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.834948633315       residual = 6.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.834975078128       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.834982917891       residual = 7.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.834986714833       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.834989737452       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.834992183301       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.834994508968       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.834996138053       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.834997094439       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.834997448817       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.834997620113       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.834997697417       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.834997719543       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.834997832895       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.834997869730       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.834997943693       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.834998050854       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.834998108211       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.834998155349       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.834998205338       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.834998239793       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.834998251789       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.834998248640       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.834998244744       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.834998272080       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.834998274739       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.834998272407       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.834998272282       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.834998273487       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.834998268181       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.834998271833       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.834998272176       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.834998273819       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.834998266655       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.834998269638       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.834998267638       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.834998267433       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.834998267488       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.834998266932       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.834998266380       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.834998269756       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.834998270459       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.834998269934       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.834998271359       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.834998270239       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.834998270669       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.834998270626       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+01 is 1.722357e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.285614 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5564e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 1.943737e-01 1 1  ON 0
  uu_1                 3.842090e-02 1 1  ON 1
  uu_2                -4.482958e-02 1 1  ON 2
  uu_3                -9.407970e-02 1 1  ON 3
  uu_4                -1.258386e-01 1 1  ON 4
  uu_5                -1.332680e-01 1 1  ON 5
  uu_6                -1.102978e-01 1 1  ON 6
  uu_7                -3.534671e-02 1 1  ON 7
  uu_8                 1.010991e-01 1 1  ON 8
  uu_9                 1.191929e-01 1 1  ON 9
  ud_0                 3.133200e-01 1 1  ON 10
  ud_1                 7.714570e-02 1 1  ON 11
  ud_2                -9.837794e-03 1 1  ON 12
  ud_3                -5.886751e-02 1 1  ON 13
  ud_4                -1.072792e-01 1 1  ON 14
  ud_5                -1.462433e-01 1 1  ON 15
  ud_6                -1.533714e-01 1 1  ON 16
  ud_7                -1.062691e-01 1 1  ON 17
  ud_8                 8.169959e-03 1 1  ON 18
  ud_9                 9.240042e-02 1 1  ON 19
  eO_0                -6.839608e-01 1 1  ON 20
  eO_1                -4.059624e-01 1 1  ON 21
  eO_2                -5.757242e-02 1 1  ON 22
  eO_3                 1.660111e-01 1 1  ON 23
  eO_4                 2.631382e-01 1 1  ON 24
  eO_5                 3.046295e-01 1 1  ON 25
  eO_6                 2.486592e-01 1 1  ON 26
  eO_7                 1.090938e-01 1 1  ON 27
  eO_8                 2.738167e-02 1 1  ON 28
  eO_9                 1.819307e-02 1 1  ON 29
 eH1_0                -1.815939e-01 1 1  ON 30
 eH1_1                -9.906177e-02 1 1  ON 31
 eH1_2                -5.942986e-02 1 1  ON 32
 eH1_3                -2.645247e-02 1 1  ON 33
 eH1_4                 1.824475e-02 1 1  ON 34
 eH1_5                 3.110353e-02 1 1  ON 35
 eH1_6                 7.802704e-02 1 1  ON 36
 eH1_7                 1.113121e-01 1 1  ON 37
 eH1_8                 8.905520e-02 1 1  ON 38
 eH1_9                 2.372466e-02 1 1  ON 39
 eH2_0                -1.832180e-01 1 1  ON 40
 eH2_1                -1.005325e-01 1 1  ON 41
 eH2_2                -6.131097e-02 1 1  ON 42
 eH2_3                -2.795916e-02 1 1  ON 43
 eH2_4                 1.677962e-02 1 1  ON 44
 eH2_5                 3.098489e-02 1 1  ON 45
 eH2_6                 8.022445e-02 1 1  ON 46
 eH2_7                 1.152508e-01 1 1  ON 47
 eH2_8                 9.213572e-02 1 1  ON 48
 eH2_9                 2.571455e-02 1 1  ON 49
ci_001                -6.188370e-02 3 1  ON 50
ci_002                -4.753699e-02 3 1  ON 51
ci_003                -3.493002e-02 3 1  ON 52
ci_004                 3.433968e-02 3 1  ON 53
ci_005                 3.436777e-02 3 1  ON 54
ci_006                -3.249323e-02 3 1  ON 55
ci_007                -3.250267e-02 3 1  ON 56
ci_008                -2.631453e-02 3 1  ON 57
ci_009                -2.639300e-02 3 1  ON 58
ci_010                -2.508823e-02 3 1  ON 59
ci_011                -2.494654e-02 3 1  ON 60
ci_012                -2.470743e-02 3 1  ON 61
ci_013                -2.557623e-02 3 1  ON 62
ci_014                 2.402338e-02 3 1  ON 63
ci_015                 2.399959e-02 3 1  ON 64
ci_016                 2.375369e-02 3 1  ON 65
ci_017                 2.368982e-02 3 1  ON 66
ci_018                 2.178247e-02 3 1  ON 67
ci_019                 2.184563e-02 3 1  ON 68
ci_020                 2.317987e-02 3 1  ON 69
ci_021                 2.333902e-02 3 1  ON 70
ci_022                 1.974793e-02 3 1  ON 71
ci_023                 1.951400e-02 3 1  ON 72
ci_024                 1.922832e-02 3 1  ON 73
ci_025                 1.916946e-02 3 1  ON 74
ci_026                 1.955175e-02 3 1  ON 75
ci_027                 1.968244e-02 3 1  ON 76
ci_028                -2.008093e-02 3 1  ON 77
ci_029                -2.003272e-02 3 1  ON 78
ci_030                -1.650437e-02 3 1  ON 79
ci_031                -1.659097e-02 3 1  ON 80
ci_032                -1.803641e-02 3 1  ON 81
ci_033                 1.613008e-02 3 1  ON 82
ci_034                 1.628149e-02 3 1  ON 83
ci_035                -1.523925e-02 3 1  ON 84
ci_036                -1.722163e-02 3 1  ON 85
ci_037                -1.716552e-02 3 1  ON 86
ci_038                 1.398265e-02 3 1  ON 87
ci_039                 1.400330e-02 3 1  ON 88
ci_040                -1.358522e-02 3 1  ON 89
ci_041                 1.480153e-02 3 1  ON 90
ci_042                 1.489321e-02 3 1  ON 91
ci_043                -1.350621e-02 3 1  ON 92
ci_044                -1.373714e-02 3 1  ON 93
ci_045                -1.288018e-02 3 1  ON 94
ci_046                 1.311858e-02 3 1  ON 95
ci_047                 1.315471e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1231
    reference variance = 0.336085
====================================================
  Execution time = 2.7224e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7204e+01
  VMC Evar = 3.5341e-01
  Total weights = 1.9639e+06
  Execution time = 2.3688e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340370052908
                                         uncertainty =       0.002175940243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340370052908
                                         uncertainty =       0.002175940243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412570534
  error estimate for blocks of size 2^( 2) =       0.000424849405
  error estimate for blocks of size 2^( 3) =       0.000435029177
  error estimate for blocks of size 2^( 4) =       0.000443133396
  error estimate for blocks of size 2^( 5) =       0.000446978419
  error estimate for blocks of size 2^( 6) =       0.000449270474
  error estimate for blocks of size 2^( 7) =       0.000449623996

      target function =      -0.817046213750
              le_mean =     -17.204426677063
             les_mean =     296.364973707021
             stat err =       0.000447251571
             autocorr =       1.175187966517
   target nu stat err =       0.000447251571
   target dn stat err =       0.011927180690
      target stat err =       0.012218488544
              std dev =       0.583472179888
             le_variance =       0.340439784703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327946707738
                                         uncertainty =       0.002351333312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327946707738
                                         uncertainty =       0.002351333312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404963945
  error estimate for blocks of size 2^( 2) =       0.000417053649
  error estimate for blocks of size 2^( 3) =       0.000427215281
  error estimate for blocks of size 2^( 4) =       0.000435391989
  error estimate for blocks of size 2^( 5) =       0.000439179351
  error estimate for blocks of size 2^( 6) =       0.000441529594
  error estimate for blocks of size 2^( 7) =       0.000441661736

      target function =      -0.806805383017
              le_mean =     -17.204503530878
             les_mean =     296.377278292037
             stat err =       0.000439440667
             autocorr =       1.177518594357
   target nu stat err =       0.000439440667
   target dn stat err =       0.023136549401
      target stat err =       0.023109717434
              std dev =       0.572714666729
             le_variance =       0.328002089486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332493689157
                                         uncertainty =       0.002056586707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332493689157
                                         uncertainty =       0.002056586707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407765412
  error estimate for blocks of size 2^( 2) =       0.000419972094
  error estimate for blocks of size 2^( 3) =       0.000430170641
  error estimate for blocks of size 2^( 4) =       0.000438310634
  error estimate for blocks of size 2^( 5) =       0.000442176854
  error estimate for blocks of size 2^( 6) =       0.000444472259
  error estimate for blocks of size 2^( 7) =       0.000444737254

      target function =      -0.840680238565
              le_mean =     -17.204421986759
             les_mean =     296.342500195109
             stat err =       0.000442424250
             autocorr =       1.177218499013
   target nu stat err =       0.000442424250
   target dn stat err =       0.005507165574
      target stat err =       0.005992598912
              std dev =       0.576676602157
             le_variance =       0.332555903475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339294465301
                                         uncertainty =       0.002157717395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339294465301
                                         uncertainty =       0.002157717395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411917711
  error estimate for blocks of size 2^( 2) =       0.000424186997
  error estimate for blocks of size 2^( 3) =       0.000434366417
  error estimate for blocks of size 2^( 4) =       0.000442476820
  error estimate for blocks of size 2^( 5) =       0.000446323548
  error estimate for blocks of size 2^( 6) =       0.000448610562
  error estimate for blocks of size 2^( 7) =       0.000448965952

      target function =      -0.833619312914
              le_mean =     -17.204421696110
             les_mean =     296.349069539356
             stat err =       0.000446594220
             autocorr =       1.175452988927
   target nu stat err =       0.000446594220
   target dn stat err =       0.005131789118
      target stat err =       0.005495486474
              std dev =       0.582548934682
             le_variance =       0.339363261299


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.817046213750        initial
     6.2500e-01     6.2500e+00             2.5357e-03        -0.806805383017
     2.5000e+00     2.5000e+01             6.7726e-04        -0.840680238565  <--
     1.0000e+01     1.0000e+02             1.7224e-04        -0.833619312914

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 3.9139e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 1.943737e-01 1 1  ON 0
  uu_1                 3.842090e-02 1 1  ON 1
  uu_2                -4.482958e-02 1 1  ON 2
  uu_3                -9.407970e-02 1 1  ON 3
  uu_4                -1.258386e-01 1 1  ON 4
  uu_5                -1.332680e-01 1 1  ON 5
  uu_6                -1.102978e-01 1 1  ON 6
  uu_7                -3.534671e-02 1 1  ON 7
  uu_8                 1.010991e-01 1 1  ON 8
  uu_9                 1.191929e-01 1 1  ON 9
  ud_0                 3.133200e-01 1 1  ON 10
  ud_1                 7.714570e-02 1 1  ON 11
  ud_2                -9.837794e-03 1 1  ON 12
  ud_3                -5.886751e-02 1 1  ON 13
  ud_4                -1.072792e-01 1 1  ON 14
  ud_5                -1.462433e-01 1 1  ON 15
  ud_6                -1.533714e-01 1 1  ON 16
  ud_7                -1.062691e-01 1 1  ON 17
  ud_8                 8.169959e-03 1 1  ON 18
  ud_9                 9.240042e-02 1 1  ON 19
  eO_0                -6.839608e-01 1 1  ON 20
  eO_1                -4.059624e-01 1 1  ON 21
  eO_2                -5.757242e-02 1 1  ON 22
  eO_3                 1.660111e-01 1 1  ON 23
  eO_4                 2.631382e-01 1 1  ON 24
  eO_5                 3.046295e-01 1 1  ON 25
  eO_6                 2.486592e-01 1 1  ON 26
  eO_7                 1.090938e-01 1 1  ON 27
  eO_8                 2.738167e-02 1 1  ON 28
  eO_9                 1.819307e-02 1 1  ON 29
 eH1_0                -1.815939e-01 1 1  ON 30
 eH1_1                -9.906177e-02 1 1  ON 31
 eH1_2                -5.942986e-02 1 1  ON 32
 eH1_3                -2.645247e-02 1 1  ON 33
 eH1_4                 1.824475e-02 1 1  ON 34
 eH1_5                 3.110353e-02 1 1  ON 35
 eH1_6                 7.802704e-02 1 1  ON 36
 eH1_7                 1.113121e-01 1 1  ON 37
 eH1_8                 8.905520e-02 1 1  ON 38
 eH1_9                 2.372466e-02 1 1  ON 39
 eH2_0                -1.832180e-01 1 1  ON 40
 eH2_1                -1.005325e-01 1 1  ON 41
 eH2_2                -6.131097e-02 1 1  ON 42
 eH2_3                -2.795916e-02 1 1  ON 43
 eH2_4                 1.677962e-02 1 1  ON 44
 eH2_5                 3.098489e-02 1 1  ON 45
 eH2_6                 8.022445e-02 1 1  ON 46
 eH2_7                 1.152508e-01 1 1  ON 47
 eH2_8                 9.213572e-02 1 1  ON 48
 eH2_9                 2.571455e-02 1 1  ON 49
ci_001                -6.188370e-02 3 1  ON 50
ci_002                -4.753699e-02 3 1  ON 51
ci_003                -3.493002e-02 3 1  ON 52
ci_004                 3.433968e-02 3 1  ON 53
ci_005                 3.436777e-02 3 1  ON 54
ci_006                -3.249323e-02 3 1  ON 55
ci_007                -3.250267e-02 3 1  ON 56
ci_008                -2.631453e-02 3 1  ON 57
ci_009                -2.639300e-02 3 1  ON 58
ci_010                -2.508823e-02 3 1  ON 59
ci_011                -2.494654e-02 3 1  ON 60
ci_012                -2.470743e-02 3 1  ON 61
ci_013                -2.557623e-02 3 1  ON 62
ci_014                 2.402338e-02 3 1  ON 63
ci_015                 2.399959e-02 3 1  ON 64
ci_016                 2.375369e-02 3 1  ON 65
ci_017                 2.368982e-02 3 1  ON 66
ci_018                 2.178247e-02 3 1  ON 67
ci_019                 2.184563e-02 3 1  ON 68
ci_020                 2.317987e-02 3 1  ON 69
ci_021                 2.333902e-02 3 1  ON 70
ci_022                 1.974793e-02 3 1  ON 71
ci_023                 1.951400e-02 3 1  ON 72
ci_024                 1.922832e-02 3 1  ON 73
ci_025                 1.916946e-02 3 1  ON 74
ci_026                 1.955175e-02 3 1  ON 75
ci_027                 1.968244e-02 3 1  ON 76
ci_028                -2.008093e-02 3 1  ON 77
ci_029                -2.003272e-02 3 1  ON 78
ci_030                -1.650437e-02 3 1  ON 79
ci_031                -1.659097e-02 3 1  ON 80
ci_032                -1.803641e-02 3 1  ON 81
ci_033                 1.613008e-02 3 1  ON 82
ci_034                 1.628149e-02 3 1  ON 83
ci_035                -1.523925e-02 3 1  ON 84
ci_036                -1.722163e-02 3 1  ON 85
ci_037                -1.716552e-02 3 1  ON 86
ci_038                 1.398265e-02 3 1  ON 87
ci_039                 1.400330e-02 3 1  ON 88
ci_040                -1.358522e-02 3 1  ON 89
ci_041                 1.480153e-02 3 1  ON 90
ci_042                 1.489321e-02 3 1  ON 91
ci_043                -1.350621e-02 3 1  ON 92
ci_044                -1.373714e-02 3 1  ON 93
ci_045                -1.288018e-02 3 1  ON 94
ci_046                 1.311858e-02 3 1  ON 95
ci_047                 1.315471e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4714e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7162e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1639
    reference variance = 0.436154
====================================================
  Execution time = 2.7368e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0460e+04
  VMC Eavg = -1.7205e+01
  VMC Evar = 3.5802e-01
  Total weights = 1.964013669e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1601e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338290579192
                                         uncertainty =       0.002160841433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338290579192
                                         uncertainty =       0.002160841433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411295782
  error estimate for blocks of size 2^( 2) =       0.000423220435
  error estimate for blocks of size 2^( 3) =       0.000433084269
  error estimate for blocks of size 2^( 4) =       0.000440658532
  error estimate for blocks of size 2^( 5) =       0.000445165484
  error estimate for blocks of size 2^( 6) =       0.000447963488
  error estimate for blocks of size 2^( 7) =       0.000449030187

      target function =      -0.832535996730
              le_mean =     -17.205102709324
             les_mean =     296.373581168050
             stat err =       0.000445704423
             autocorr =       1.174317073329
   target nu stat err =       0.000445704423
   target dn stat err =       0.005853967025
      target stat err =       0.006251327824
              std dev =       0.581669379983
             le_variance =       0.338339267610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720510270932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.832582329249       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.838667081738       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.839762431611       residual = 6.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.840165214953       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.840279680640       residual = 7.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.840336905601       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.840385052183       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.840420774723       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.840457918164       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.840480346473       residual = 9.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.840491832267       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.840497593722       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.840499638124       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.840500832594       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.840501414117       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.840502881605       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.840503570765       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.840504684652       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.840505482664       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.840507078405       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.840507453946       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.840508164168       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.840508379366       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.840508695577       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.840508606836       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.840508821159       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.840508879721       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.840509230526       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.840509312889       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.840509343207       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.840509409980       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.840509446877       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.840509436715       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.840509523217       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.840509434750       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.840509419832       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.840509434391       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.840509462607       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.840509451054       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.840509461204       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.840509444589       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.840509442259       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.840509439981       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.840509458312       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.840509464842       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.840509483800       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.840509488783       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.840509479750       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.840509478899       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.840509471572       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.840509483796       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.840509485510       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         51 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 2.132335e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.832582329249       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.834217546084       residual = 1.99e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.834505393200       residual = 6.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.834611092931       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.834641354967       residual = 7.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.834656358509       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.834668970088       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.834678523772       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.834688225794       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.834694031791       residual = 9.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.834696947395       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.834698417418       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.834698891625       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.834699221964       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.834699391056       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.834699771147       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.834699946203       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.834700226528       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.834700437004       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.834700835259       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.834700924319       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.834701094901       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.834701139529       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.834701219607       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.834701193491       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.834701242605       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.834701255996       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.834701338829       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.834701356452       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.834701358240       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.834701380797       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.834701383940       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.834701387815       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.834701402369       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.834701378394       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.834701378027       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.834701383714       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.834701385881       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.834701383193       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.834701386297       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.834701381289       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.834701382392       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.834701382240       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.834701386639       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.834701387040       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.834701389844       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.834701393357       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.834701390722       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.834701389280       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+00 is 5.741328e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.832582329249       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.832998872424       residual = 1.99e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.833071730888       residual = 6.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.833098479891       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.833106152255       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.833109948722       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.833113138635       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.833115567936       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.833118019018       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.833119482526       residual = 9.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.833120213630       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.833120582691       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.833120699132       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.833120783680       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.833120827222       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.833120923118       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.833120966995       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.833121037187       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.833121090502       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.833121189850       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.833121211798       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.833121253927       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.833121264436       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.833121284520       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.833121277774       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.833121289777       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.833121292997       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.833121313360       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.833121317598       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.833121317606       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.833121323821       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.833121323962       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.833121325834       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.833121328591       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.833121322521       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.833121322741       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.833121324205       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.833121324396       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.833121323844       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.833121324617       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.833121323283       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.833121323703       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.833121323804       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.833121324776       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.833121324809       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.833121325530       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.833121326349       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.833121325707       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+01 is 1.462958e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.417940 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5668e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 1.946219e-01 1 1  ON 0
  uu_1                 3.868522e-02 1 1  ON 1
  uu_2                -4.474493e-02 1 1  ON 2
  uu_3                -9.411991e-02 1 1  ON 3
  uu_4                -1.258671e-01 1 1  ON 4
  uu_5                -1.333122e-01 1 1  ON 5
  uu_6                -1.104200e-01 1 1  ON 6
  uu_7                -3.557416e-02 1 1  ON 7
  uu_8                 1.008781e-01 1 1  ON 8
  uu_9                 1.192069e-01 1 1  ON 9
  ud_0                 3.131244e-01 1 1  ON 10
  ud_1                 7.726469e-02 1 1  ON 11
  ud_2                -1.011125e-02 1 1  ON 12
  ud_3                -5.923644e-02 1 1  ON 13
  ud_4                -1.073730e-01 1 1  ON 14
  ud_5                -1.459243e-01 1 1  ON 15
  ud_6                -1.529581e-01 1 1  ON 16
  ud_7                -1.061033e-01 1 1  ON 17
  ud_8                 8.052518e-03 1 1  ON 18
  ud_9                 9.238324e-02 1 1  ON 19
  eO_0                -6.841869e-01 1 1  ON 20
  eO_1                -4.061901e-01 1 1  ON 21
  eO_2                -5.714463e-02 1 1  ON 22
  eO_3                 1.664077e-01 1 1  ON 23
  eO_4                 2.629925e-01 1 1  ON 24
  eO_5                 3.042813e-01 1 1  ON 25
  eO_6                 2.486550e-01 1 1  ON 26
  eO_7                 1.092111e-01 1 1  ON 27
  eO_8                 2.738530e-02 1 1  ON 28
  eO_9                 1.819666e-02 1 1  ON 29
 eH1_0                -1.821680e-01 1 1  ON 30
 eH1_1                -9.908550e-02 1 1  ON 31
 eH1_2                -5.912273e-02 1 1  ON 32
 eH1_3                -2.615025e-02 1 1  ON 33
 eH1_4                 1.834382e-02 1 1  ON 34
 eH1_5                 3.101099e-02 1 1  ON 35
 eH1_6                 7.797430e-02 1 1  ON 36
 eH1_7                 1.112866e-01 1 1  ON 37
 eH1_8                 8.911254e-02 1 1  ON 38
 eH1_9                 2.372978e-02 1 1  ON 39
 eH2_0                -1.837776e-01 1 1  ON 40
 eH2_1                -1.005074e-01 1 1  ON 41
 eH2_2                -6.096068e-02 1 1  ON 42
 eH2_3                -2.768011e-02 1 1  ON 43
 eH2_4                 1.684048e-02 1 1  ON 44
 eH2_5                 3.086186e-02 1 1  ON 45
 eH2_6                 8.014803e-02 1 1  ON 46
 eH2_7                 1.152137e-01 1 1  ON 47
 eH2_8                 9.219847e-02 1 1  ON 48
 eH2_9                 2.573080e-02 1 1  ON 49
ci_001                -6.139147e-02 3 1  ON 50
ci_002                -4.710503e-02 3 1  ON 51
ci_003                -3.472896e-02 3 1  ON 52
ci_004                 3.410959e-02 3 1  ON 53
ci_005                 3.415052e-02 3 1  ON 54
ci_006                -3.217123e-02 3 1  ON 55
ci_007                -3.218789e-02 3 1  ON 56
ci_008                -2.578896e-02 3 1  ON 57
ci_009                -2.604221e-02 3 1  ON 58
ci_010                -2.468108e-02 3 1  ON 59
ci_011                -2.455639e-02 3 1  ON 60
ci_012                -2.431034e-02 3 1  ON 61
ci_013                -2.543138e-02 3 1  ON 62
ci_014                 2.373662e-02 3 1  ON 63
ci_015                 2.370406e-02 3 1  ON 64
ci_016                 2.357226e-02 3 1  ON 65
ci_017                 2.347807e-02 3 1  ON 66
ci_018                 2.141587e-02 3 1  ON 67
ci_019                 2.152025e-02 3 1  ON 68
ci_020                 2.303377e-02 3 1  ON 69
ci_021                 2.319089e-02 3 1  ON 70
ci_022                 1.947025e-02 3 1  ON 71
ci_023                 1.924299e-02 3 1  ON 72
ci_024                 1.891342e-02 3 1  ON 73
ci_025                 1.889924e-02 3 1  ON 74
ci_026                 1.926328e-02 3 1  ON 75
ci_027                 1.945073e-02 3 1  ON 76
ci_028                -1.995011e-02 3 1  ON 77
ci_029                -1.989433e-02 3 1  ON 78
ci_030                -1.615786e-02 3 1  ON 79
ci_031                -1.623717e-02 3 1  ON 80
ci_032                -1.797576e-02 3 1  ON 81
ci_033                 1.591154e-02 3 1  ON 82
ci_034                 1.606098e-02 3 1  ON 83
ci_035                -1.492816e-02 3 1  ON 84
ci_036                -1.713069e-02 3 1  ON 85
ci_037                -1.701994e-02 3 1  ON 86
ci_038                 1.360005e-02 3 1  ON 87
ci_039                 1.362241e-02 3 1  ON 88
ci_040                -1.325323e-02 3 1  ON 89
ci_041                 1.461598e-02 3 1  ON 90
ci_042                 1.467985e-02 3 1  ON 91
ci_043                -1.318242e-02 3 1  ON 92
ci_044                -1.342929e-02 3 1  ON 93
ci_045                -1.256872e-02 3 1  ON 94
ci_046                 1.289526e-02 3 1  ON 95
ci_047                 1.297593e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.3464
    reference variance = 1.26467
====================================================
  Execution time = 2.6977e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7204e+01
  VMC Evar = 3.5138e-01
  Total weights = 1.9639e+06
  Execution time = 2.3636e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0995238
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341088447824
                                         uncertainty =       0.002320817588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341088447824
                                         uncertainty =       0.002320817588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412992622
  error estimate for blocks of size 2^( 2) =       0.000424830188
  error estimate for blocks of size 2^( 3) =       0.000434862709
  error estimate for blocks of size 2^( 4) =       0.000441472855
  error estimate for blocks of size 2^( 5) =       0.000445362514
  error estimate for blocks of size 2^( 6) =       0.000447333327
  error estimate for blocks of size 2^( 7) =       0.000448035974

      target function =      -0.834238453731
              le_mean =     -17.204256911363
             les_mean =     296.342822063908
             stat err =       0.000445551167
             autocorr =       1.163886378086
   target nu stat err =       0.000445551167
   target dn stat err =       0.003127446501
      target stat err =       0.003383289969
              std dev =       0.584069112196
             le_variance =       0.341136727821

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00258095
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327760495980
                                         uncertainty =       0.002234890999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327760495980
                                         uncertainty =       0.002234890999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404836656
  error estimate for blocks of size 2^( 2) =       0.000416595135
  error estimate for blocks of size 2^( 3) =       0.000426674694
  error estimate for blocks of size 2^( 4) =       0.000433372700
  error estimate for blocks of size 2^( 5) =       0.000437270194
  error estimate for blocks of size 2^( 6) =       0.000439248504
  error estimate for blocks of size 2^( 7) =       0.000440032696

      target function =      -0.848739110310
              le_mean =     -17.204314372762
             les_mean =     296.331441735941
             stat err =       0.000437481024
             autocorr =       1.167773945133
   target nu stat err =       0.000437481024
   target dn stat err =       0.002947176507
      target stat err =       0.003302643315
              std dev =       0.572534649845
             le_variance =       0.327795925274

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.103072
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333488716028
                                         uncertainty =       0.002264636812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333488716028
                                         uncertainty =       0.002264636812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408362188
  error estimate for blocks of size 2^( 2) =       0.000420150075
  error estimate for blocks of size 2^( 3) =       0.000430205343
  error estimate for blocks of size 2^( 4) =       0.000436859741
  error estimate for blocks of size 2^( 5) =       0.000440755096
  error estimate for blocks of size 2^( 6) =       0.000442729404
  error estimate for blocks of size 2^( 7) =       0.000443480642

      target function =      -0.843954914842
              le_mean =     -17.204254441374
             les_mean =     296.333731625317
             stat err =       0.000440956221
             autocorr =       1.166003630900
   target nu stat err =       0.000440956221
   target dn stat err =       0.002879022868
      target stat err =       0.003193334419
              std dev =       0.577520584896
             le_variance =       0.333530025979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340066319706
                                         uncertainty =       0.002312033003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340066319706
                                         uncertainty =       0.002312033003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412372907
  error estimate for blocks of size 2^( 2) =       0.000424203233
  error estimate for blocks of size 2^( 3) =       0.000434238001
  error estimate for blocks of size 2^( 4) =       0.000440853270
  error estimate for blocks of size 2^( 5) =       0.000444743466
  error estimate for blocks of size 2^( 6) =       0.000446714493
  error estimate for blocks of size 2^( 7) =       0.000447422359

      target function =      -0.836021463828
              le_mean =     -17.204252039903
             les_mean =     296.340986019708
             stat err =       0.000444933397
             autocorr =       1.164152196471
   target nu stat err =       0.000444933397
   target dn stat err =       0.003047544723
      target stat err =       0.003313076888
              std dev =       0.583192689208
             le_variance =       0.340113712745


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.834238453731        initial
     6.2500e-01     6.2500e+00             2.1323e-03        -0.848739110310  <--
     2.5000e+00     2.5000e+01             5.7413e-04        -0.843954914842
     1.0000e+01     1.0000e+02             1.4630e-04        -0.836021463828

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.8887e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 1.953137e-01 1 1  ON 0
  uu_1                 3.941439e-02 1 1  ON 1
  uu_2                -4.450033e-02 1 1  ON 2
  uu_3                -9.421345e-02 1 1  ON 3
  uu_4                -1.259349e-01 1 1  ON 4
  uu_5                -1.334281e-01 1 1  ON 5
  uu_6                -1.107571e-01 1 1  ON 6
  uu_7                -3.622484e-02 1 1  ON 7
  uu_8                 1.002203e-01 1 1  ON 8
  uu_9                 1.192467e-01 1 1  ON 9
  ud_0                 3.125786e-01 1 1  ON 10
  ud_1                 7.754509e-02 1 1  ON 11
  ud_2                -1.087230e-02 1 1  ON 12
  ud_3                -6.024531e-02 1 1  ON 13
  ud_4                -1.076273e-01 1 1  ON 14
  ud_5                -1.450452e-01 1 1  ON 15
  ud_6                -1.518026e-01 1 1  ON 16
  ud_7                -1.056125e-01 1 1  ON 17
  ud_8                 7.720973e-03 1 1  ON 18
  ud_9                 9.233073e-02 1 1  ON 19
  eO_0                -6.847709e-01 1 1  ON 20
  eO_1                -4.067665e-01 1 1  ON 21
  eO_2                -5.598840e-02 1 1  ON 22
  eO_3                 1.674644e-01 1 1  ON 23
  eO_4                 2.625695e-01 1 1  ON 24
  eO_5                 3.032806e-01 1 1  ON 25
  eO_6                 2.486428e-01 1 1  ON 26
  eO_7                 1.095641e-01 1 1  ON 27
  eO_8                 2.739645e-02 1 1  ON 28
  eO_9                 1.820713e-02 1 1  ON 29
 eH1_0                -1.837262e-01 1 1  ON 30
 eH1_1                -9.914160e-02 1 1  ON 31
 eH1_2                -5.828310e-02 1 1  ON 32
 eH1_3                -2.532497e-02 1 1  ON 33
 eH1_4                 1.861113e-02 1 1  ON 34
 eH1_5                 3.074402e-02 1 1  ON 35
 eH1_6                 7.781662e-02 1 1  ON 36
 eH1_7                 1.112123e-01 1 1  ON 37
 eH1_8                 8.928480e-02 1 1  ON 38
 eH1_9                 2.374532e-02 1 1  ON 39
 eH2_0                -1.852895e-01 1 1  ON 40
 eH2_1                -1.004286e-01 1 1  ON 41
 eH2_2                -6.000264e-02 1 1  ON 42
 eH2_3                -2.691574e-02 1 1  ON 43
 eH2_4                 1.700138e-02 1 1  ON 44
 eH2_5                 3.050471e-02 1 1  ON 45
 eH2_6                 7.992174e-02 1 1  ON 46
 eH2_7                 1.151048e-01 1 1  ON 47
 eH2_8                 9.238670e-02 1 1  ON 48
 eH2_9                 2.577968e-02 1 1  ON 49
ci_001                -6.004572e-02 3 1  ON 50
ci_002                -4.593124e-02 3 1  ON 51
ci_003                -3.417395e-02 3 1  ON 52
ci_004                 3.347686e-02 3 1  ON 53
ci_005                 3.355558e-02 3 1  ON 54
ci_006                -3.129742e-02 3 1  ON 55
ci_007                -3.133279e-02 3 1  ON 56
ci_008                -2.438782e-02 3 1  ON 57
ci_009                -2.509653e-02 3 1  ON 58
ci_010                -2.358073e-02 3 1  ON 59
ci_011                -2.350540e-02 3 1  ON 60
ci_012                -2.323967e-02 3 1  ON 61
ci_013                -2.503450e-02 3 1  ON 62
ci_014                 2.296272e-02 3 1  ON 63
ci_015                 2.290632e-02 3 1  ON 64
ci_016                 2.308278e-02 3 1  ON 65
ci_017                 2.290664e-02 3 1  ON 66
ci_018                 2.043365e-02 3 1  ON 67
ci_019                 2.064725e-02 3 1  ON 68
ci_020                 2.263257e-02 3 1  ON 69
ci_021                 2.278355e-02 3 1  ON 70
ci_022                 1.872077e-02 3 1  ON 71
ci_023                 1.851186e-02 3 1  ON 72
ci_024                 1.805518e-02 3 1  ON 73
ci_025                 1.816057e-02 3 1  ON 74
ci_026                 1.848902e-02 3 1  ON 75
ci_027                 1.882784e-02 3 1  ON 76
ci_028                -1.959456e-02 3 1  ON 77
ci_029                -1.951713e-02 3 1  ON 78
ci_030                -1.523245e-02 3 1  ON 79
ci_031                -1.529194e-02 3 1  ON 80
ci_032                -1.781239e-02 3 1  ON 81
ci_033                 1.531703e-02 3 1  ON 82
ci_034                 1.546053e-02 3 1  ON 83
ci_035                -1.409346e-02 3 1  ON 84
ci_036                -1.687813e-02 3 1  ON 85
ci_037                -1.662424e-02 3 1  ON 86
ci_038                 1.257461e-02 3 1  ON 87
ci_039                 1.260107e-02 3 1  ON 88
ci_040                -1.236581e-02 3 1  ON 89
ci_041                 1.411824e-02 3 1  ON 90
ci_042                 1.410802e-02 3 1  ON 91
ci_043                -1.231274e-02 3 1  ON 92
ci_044                -1.259838e-02 3 1  ON 93
ci_045                -1.173627e-02 3 1  ON 94
ci_046                 1.229132e-02 3 1  ON 95
ci_047                 1.249267e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4571e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7172e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2237
    reference variance = 0.504978
====================================================
  Execution time = 2.7276e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0470e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.4235e-01
  Total weights = 1.963888613e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3598e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326289926505
                                         uncertainty =       0.002335359104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326289926505
                                         uncertainty =       0.002335359104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403893284
  error estimate for blocks of size 2^( 2) =       0.000415621188
  error estimate for blocks of size 2^( 3) =       0.000425996143
  error estimate for blocks of size 2^( 4) =       0.000433536167
  error estimate for blocks of size 2^( 5) =       0.000436538680
  error estimate for blocks of size 2^( 6) =       0.000438504861
  error estimate for blocks of size 2^( 7) =       0.000438406053

      target function =      -0.849771351121
              le_mean =     -17.206532479926
             les_mean =     296.407107054097
             stat err =       0.000436746440
             autocorr =       1.169298748730
   target nu stat err =       0.000436746440
   target dn stat err =       0.003805070948
      target stat err =       0.004263245344
              std dev =       0.571200498816
             le_variance =       0.326270009848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720653247993e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.849791775925       residual = 9.43e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.865742570664       residual = 1.71e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.868876322869       residual = 5.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.869989248638       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.870281707135       residual = 6.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.870438457501       residual = 5.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.870571515875       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.870680095186       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.870786681795       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.870853211839       residual = 9.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.870888037166       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.870905022373       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.870913324841       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.870917782872       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.870922020222       residual = 6.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.870925345798       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.870929226176       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.870932996642       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.870937923221       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.870942908314       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.870945556006       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.870948878805       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.870949808930       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.870950695549       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.870951125207       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.870951792623       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.870952788621       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.870954773712       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.870955850966       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.870956111919       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.870956355653       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.870956589323       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.870956754948       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.870957070595       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.870957406226       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.870957277096       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.870956979399       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.870956924227       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.870956893108       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.870956958199       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.870957063384       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.870957158542       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.870957130360       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.870957118574       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.870957144616       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.870957155268       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.870957154977       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.870957072518       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.870957104945       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.870957165262       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.870957147800       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.870957116832       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.870957115812       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         52 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e-01 is 6.031240e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.849791775925       residual = 9.43e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.854964840806       residual = 1.65e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.855920264255       residual = 5.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.856256862847       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.856348813721       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.856396505126       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.856437076606       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.856472286222       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.856504550923       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.856523945750       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.856533351747       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.856537855566       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.856539826798       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.856541692669       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.856542884449       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.856543790269       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.856544887177       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.856545950960       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.856547434557       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.856548581348       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.856549218968       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.856550011210       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.856550237012       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.856550381816       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.856550424405       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.856550541469       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.856550792165       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.856551230596       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.856551377674       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.856551414570       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.856551486905       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.856551529987       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.856551567577       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.856551617851       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.856551661350       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.856551559514       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.856551498725       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.856551509897       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.856551506436       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.856551534675       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.856551545320       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.856551545784       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.856551535878       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.856551536064       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.856551546639       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.856551547760       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.856551545463       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.856551535724       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.856551544934       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.856551551987       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.856551547482       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.856551548227       residual = 1.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         51 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 1.944106e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.849791775925       residual = 9.43e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.851186732570       residual = 1.62e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.851438206166       residual = 5.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.851526815795       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.851551271577       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.851563869007       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.851574576652       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.851584027221       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.851592470492       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.851597495778       residual = 8.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.851599871696       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.851601006377       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.851601529616       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.851602020664       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.851602317522       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.851602549915       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.851602830960       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.851603106676       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.851603494604       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.851603765140       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.851603923379       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.851604114715       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.851604169025       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.851604197289       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.851604202414       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.851604231283       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.851604297043       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.851604395326       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.851604421959       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.851604430078       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.851604448651       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.851604457910       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.851604467808       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.851604477127       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.851604483845       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.851604456428       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.851604441097       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.851604447969       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.851604446371       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.851604451480       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.851604455385       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.851604454866       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.851604452221       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.851604452559       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.851604454936       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.851604455646       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.851604455214       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.851604453391       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+00 is 5.232340e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.575657 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5802e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 1.961506e-01 1 1  ON 0
  uu_1                 4.031171e-02 1 1  ON 1
  uu_2                -4.423234e-02 1 1  ON 2
  uu_3                -9.430261e-02 1 1  ON 3
  uu_4                -1.259751e-01 1 1  ON 4
  uu_5                -1.334515e-01 1 1  ON 5
  uu_6                -1.110793e-01 1 1  ON 6
  uu_7                -3.711007e-02 1 1  ON 7
  uu_8                 9.923122e-02 1 1  ON 8
  uu_9                 1.193289e-01 1 1  ON 9
  ud_0                 3.118231e-01 1 1  ON 10
  ud_1                 7.775903e-02 1 1  ON 11
  ud_2                -1.193519e-02 1 1  ON 12
  ud_3                -6.156331e-02 1 1  ON 13
  ud_4                -1.079763e-01 1 1  ON 14
  ud_5                -1.439771e-01 1 1  ON 15
  ud_6                -1.501582e-01 1 1  ON 16
  ud_7                -1.046800e-01 1 1  ON 17
  ud_8                 7.194602e-03 1 1  ON 18
  ud_9                 9.224068e-02 1 1  ON 19
  eO_0                -6.855019e-01 1 1  ON 20
  eO_1                -4.074767e-01 1 1  ON 21
  eO_2                -5.454250e-02 1 1  ON 22
  eO_3                 1.687308e-01 1 1  ON 23
  eO_4                 2.616230e-01 1 1  ON 24
  eO_5                 3.021550e-01 1 1  ON 25
  eO_6                 2.488400e-01 1 1  ON 26
  eO_7                 1.100728e-01 1 1  ON 27
  eO_8                 2.746694e-02 1 1  ON 28
  eO_9                 1.820770e-02 1 1  ON 29
 eH1_0                -1.856703e-01 1 1  ON 30
 eH1_1                -9.907842e-02 1 1  ON 31
 eH1_2                -5.728802e-02 1 1  ON 32
 eH1_3                -2.450435e-02 1 1  ON 33
 eH1_4                 1.866306e-02 1 1  ON 34
 eH1_5                 3.038511e-02 1 1  ON 35
 eH1_6                 7.770055e-02 1 1  ON 36
 eH1_7                 1.113415e-01 1 1  ON 37
 eH1_8                 8.960325e-02 1 1  ON 38
 eH1_9                 2.378462e-02 1 1  ON 39
 eH2_0                -1.871244e-01 1 1  ON 40
 eH2_1                -1.001629e-01 1 1  ON 41
 eH2_2                -5.877360e-02 1 1  ON 42
 eH2_3                -2.580613e-02 1 1  ON 43
 eH2_4                 1.733036e-02 1 1  ON 44
 eH2_5                 2.986370e-02 1 1  ON 45
 eH2_6                 7.951576e-02 1 1  ON 46
 eH2_7                 1.147391e-01 1 1  ON 47
 eH2_8                 9.259291e-02 1 1  ON 48
 eH2_9                 2.586727e-02 1 1  ON 49
ci_001                -5.837668e-02 3 1  ON 50
ci_002                -4.438258e-02 3 1  ON 51
ci_003                -3.346565e-02 3 1  ON 52
ci_004                 3.264847e-02 3 1  ON 53
ci_005                 3.274629e-02 3 1  ON 54
ci_006                -3.021224e-02 3 1  ON 55
ci_007                -3.024310e-02 3 1  ON 56
ci_008                -2.258482e-02 3 1  ON 57
ci_009                -2.406314e-02 3 1  ON 58
ci_010                -2.218885e-02 3 1  ON 59
ci_011                -2.212885e-02 3 1  ON 60
ci_012                -2.186734e-02 3 1  ON 61
ci_013                -2.440994e-02 3 1  ON 62
ci_014                 2.194589e-02 3 1  ON 63
ci_015                 2.194268e-02 3 1  ON 64
ci_016                 2.248818e-02 3 1  ON 65
ci_017                 2.229057e-02 3 1  ON 66
ci_018                 1.930864e-02 3 1  ON 67
ci_019                 1.958344e-02 3 1  ON 68
ci_020                 2.204554e-02 3 1  ON 69
ci_021                 2.213398e-02 3 1  ON 70
ci_022                 1.791554e-02 3 1  ON 71
ci_023                 1.767041e-02 3 1  ON 72
ci_024                 1.706153e-02 3 1  ON 73
ci_025                 1.722977e-02 3 1  ON 74
ci_026                 1.763575e-02 3 1  ON 75
ci_027                 1.801943e-02 3 1  ON 76
ci_028                -1.913751e-02 3 1  ON 77
ci_029                -1.911203e-02 3 1  ON 78
ci_030                -1.401855e-02 3 1  ON 79
ci_031                -1.419337e-02 3 1  ON 80
ci_032                -1.745837e-02 3 1  ON 81
ci_033                 1.453449e-02 3 1  ON 82
ci_034                 1.467047e-02 3 1  ON 83
ci_035                -1.303493e-02 3 1  ON 84
ci_036                -1.636977e-02 3 1  ON 85
ci_037                -1.630679e-02 3 1  ON 86
ci_038                 1.135557e-02 3 1  ON 87
ci_039                 1.131764e-02 3 1  ON 88
ci_040                -1.132547e-02 3 1  ON 89
ci_041                 1.340295e-02 3 1  ON 90
ci_042                 1.345543e-02 3 1  ON 91
ci_043                -1.141703e-02 3 1  ON 92
ci_044                -1.175117e-02 3 1  ON 93
ci_045                -1.069096e-02 3 1  ON 94
ci_046                 1.161947e-02 3 1  ON 95
ci_047                 1.182579e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2131
    reference variance = 0.406739
====================================================
  Execution time = 2.6795e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.2502e-01
  Total weights = 1.9642e+06
  Execution time = 2.3617e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330752492130
                                         uncertainty =       0.005753127418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330752492130
                                         uncertainty =       0.005753127418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406632887
  error estimate for blocks of size 2^( 2) =       0.000418341335
  error estimate for blocks of size 2^( 3) =       0.000429030339
  error estimate for blocks of size 2^( 4) =       0.000435770230
  error estimate for blocks of size 2^( 5) =       0.000439158519
  error estimate for blocks of size 2^( 6) =       0.000441720335
  error estimate for blocks of size 2^( 7) =       0.000443925035

      target function =      -0.444172390933
              le_mean =     -17.207342058443
             les_mean =     296.935572682797
             stat err =       0.000440143530
             autocorr =       1.171611550775
   target nu stat err =       0.000440143530
   target dn stat err =       0.500155338098
      target stat err =       0.175632932952
              std dev =       0.575074944473
             le_variance =       0.330711191761

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.142726
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298413072830
                                         uncertainty =       0.002091482173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298413072830
                                         uncertainty =       0.002091482173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386242411
  error estimate for blocks of size 2^( 2) =       0.000398115803
  error estimate for blocks of size 2^( 3) =       0.000409172303
  error estimate for blocks of size 2^( 4) =       0.000416308430
  error estimate for blocks of size 2^( 5) =       0.000420040740
  error estimate for blocks of size 2^( 6) =       0.000422668401
  error estimate for blocks of size 2^( 7) =       0.000424922724

      target function =      -0.868642867051
              le_mean =     -17.207913002073
             les_mean =     296.438080026635
             stat err =       0.000420985074
             autocorr =       1.187991891100
   target nu stat err =       0.000420985074
   target dn stat err =       0.009968359678
      target stat err =       0.011605280386
              std dev =       0.546237996235
             le_variance =       0.298375948531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305740640671
                                         uncertainty =       0.002070178309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305740640671
                                         uncertainty =       0.002070178309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390956354
  error estimate for blocks of size 2^( 2) =       0.000402726820
  error estimate for blocks of size 2^( 3) =       0.000413648517
  error estimate for blocks of size 2^( 4) =       0.000420729924
  error estimate for blocks of size 2^( 5) =       0.000424335347
  error estimate for blocks of size 2^( 6) =       0.000426724919
  error estimate for blocks of size 2^( 7) =       0.000428931399

      target function =      -0.837931602040
              le_mean =     -17.207487923165
             les_mean =     296.450224515690
             stat err =       0.000425180397
             autocorr =       1.182741717340
   target nu stat err =       0.000425180397
   target dn stat err =       0.023275611321
      target stat err =       0.025193460395
              std dev =       0.552904624038
             le_variance =       0.305703523283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322828839393
                                         uncertainty =       0.002243091846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322828839393
                                         uncertainty =       0.002243091846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401733105
  error estimate for blocks of size 2^( 2) =       0.000413471735
  error estimate for blocks of size 2^( 3) =       0.000424211370
  error estimate for blocks of size 2^( 4) =       0.000430992100
  error estimate for blocks of size 2^( 5) =       0.000434459597
  error estimate for blocks of size 2^( 6) =       0.000436576560
  error estimate for blocks of size 2^( 7) =       0.000438534262

      target function =      -0.728717638468
              le_mean =     -17.207354784022
             les_mean =     296.554034330613
             stat err =       0.000435140630
             autocorr =       1.173232348221
   target nu stat err =       0.000435140630
   target dn stat err =       0.086514744790
      target stat err =       0.071408800735
              std dev =       0.568145495767
             le_variance =       0.322789304360


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.444172390933        initial
     1.5625e-01     1.5625e+00             6.0312e-03        -0.868642867051  <--
     6.2500e-01     6.2500e+00             1.9441e-03        -0.837931602040
     2.5000e+00     2.5000e+01             5.2323e-04        -0.728717638468

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.8695e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 1.980658e-01 1 1  ON 0
  uu_1                 4.230969e-02 1 1  ON 1
  uu_2                -4.351109e-02 1 1  ON 2
  uu_3                -9.431962e-02 1 1  ON 3
  uu_4                -1.259264e-01 1 1  ON 4
  uu_5                -1.334131e-01 1 1  ON 5
  uu_6                -1.117748e-01 1 1  ON 6
  uu_7                -3.931876e-02 1 1  ON 7
  uu_8                 9.643478e-02 1 1  ON 8
  uu_9                 1.195547e-01 1 1  ON 9
  ud_0                 3.099993e-01 1 1  ON 10
  ud_1                 7.777296e-02 1 1  ON 11
  ud_2                -1.440190e-02 1 1  ON 12
  ud_3                -6.445096e-02 1 1  ON 13
  ud_4                -1.087344e-01 1 1  ON 14
  ud_5                -1.416044e-01 1 1  ON 15
  ud_6                -1.463101e-01 1 1  ON 16
  ud_7                -1.021645e-01 1 1  ON 17
  ud_8                 5.939071e-03 1 1  ON 18
  ud_9                 9.197538e-02 1 1  ON 19
  eO_0                -6.867441e-01 1 1  ON 20
  eO_1                -4.086186e-01 1 1  ON 21
  eO_2                -5.157969e-02 1 1  ON 22
  eO_3                 1.711202e-01 1 1  ON 23
  eO_4                 2.592590e-01 1 1  ON 24
  eO_5                 2.992256e-01 1 1  ON 25
  eO_6                 2.494023e-01 1 1  ON 26
  eO_7                 1.115556e-01 1 1  ON 27
  eO_8                 2.767498e-02 1 1  ON 28
  eO_9                 1.820980e-02 1 1  ON 29
 eH1_0                -1.897574e-01 1 1  ON 30
 eH1_1                -9.892616e-02 1 1  ON 31
 eH1_2                -5.520342e-02 1 1  ON 32
 eH1_3                -2.280559e-02 1 1  ON 33
 eH1_4                 1.865791e-02 1 1  ON 34
 eH1_5                 2.941334e-02 1 1  ON 35
 eH1_6                 7.738431e-02 1 1  ON 36
 eH1_7                 1.117411e-01 1 1  ON 37
 eH1_8                 9.052899e-02 1 1  ON 38
 eH1_9                 2.389935e-02 1 1  ON 39
 eH2_0                -1.908235e-01 1 1  ON 40
 eH2_1                -9.943962e-02 1 1  ON 41
 eH2_2                -5.605284e-02 1 1  ON 42
 eH2_3                -2.336546e-02 1 1  ON 43
 eH2_4                 1.801433e-02 1 1  ON 44
 eH2_5                 2.826640e-02 1 1  ON 45
 eH2_6                 7.835965e-02 1 1  ON 46
 eH2_7                 1.137063e-01 1 1  ON 47
 eH2_8                 9.319087e-02 1 1  ON 48
 eH2_9                 2.612529e-02 1 1  ON 49
ci_001                -5.480029e-02 3 1  ON 50
ci_002                -4.112780e-02 3 1  ON 51
ci_003                -3.191482e-02 3 1  ON 52
ci_004                 3.085199e-02 3 1  ON 53
ci_005                 3.100079e-02 3 1  ON 54
ci_006                -2.793867e-02 3 1  ON 55
ci_007                -2.795407e-02 3 1  ON 56
ci_008                -1.902042e-02 3 1  ON 57
ci_009                -2.194893e-02 3 1  ON 58
ci_010                -1.931540e-02 3 1  ON 59
ci_011                -1.930199e-02 3 1  ON 60
ci_012                -1.905250e-02 3 1  ON 61
ci_013                -2.304831e-02 3 1  ON 62
ci_014                 1.984899e-02 3 1  ON 63
ci_015                 1.995706e-02 3 1  ON 64
ci_016                 2.127575e-02 3 1  ON 65
ci_017                 2.103107e-02 3 1  ON 66
ci_018                 1.703377e-02 3 1  ON 67
ci_019                 1.743127e-02 3 1  ON 68
ci_020                 2.077217e-02 3 1  ON 69
ci_021                 2.073124e-02 3 1  ON 70
ci_022                 1.626141e-02 3 1  ON 71
ci_023                 1.594074e-02 3 1  ON 72
ci_024                 1.494737e-02 3 1  ON 73
ci_025                 1.525686e-02 3 1  ON 74
ci_026                 1.589805e-02 3 1  ON 75
ci_027                 1.637624e-02 3 1  ON 76
ci_028                -1.817490e-02 3 1  ON 77
ci_029                -1.826471e-02 3 1  ON 78
ci_030                -1.162280e-02 3 1  ON 79
ci_031                -1.200621e-02 3 1  ON 80
ci_032                -1.672331e-02 3 1  ON 81
ci_033                 1.289699e-02 3 1  ON 82
ci_034                 1.300729e-02 3 1  ON 83
ci_035                -1.089861e-02 3 1  ON 84
ci_036                -1.529424e-02 3 1  ON 85
ci_037                -1.559910e-02 3 1  ON 86
ci_038                 8.899786e-03 3 1  ON 87
ci_039                 8.734597e-03 3 1  ON 88
ci_040                -9.249771e-03 3 1  ON 89
ci_041                 1.196655e-02 3 1  ON 90
ci_042                 1.215262e-02 3 1  ON 91
ci_043                -9.606259e-03 3 1  ON 92
ci_044                -1.000312e-02 3 1  ON 93
ci_045                -8.608574e-03 3 1  ON 94
ci_046                 1.022460e-02 3 1  ON 95
ci_047                 1.044490e-02 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4513e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7176e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1622
    reference variance = 0.332671
====================================================
  Execution time = 2.7146e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0453e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 3.1329e-01
  Total weights = 1.964999950e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6437e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298120642697
                                         uncertainty =       0.002224780006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298120642697
                                         uncertainty =       0.002224780006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386028935
  error estimate for blocks of size 2^( 2) =       0.000398083068
  error estimate for blocks of size 2^( 3) =       0.000409360862
  error estimate for blocks of size 2^( 4) =       0.000417105272
  error estimate for blocks of size 2^( 5) =       0.000421874437
  error estimate for blocks of size 2^( 6) =       0.000424539415
  error estimate for blocks of size 2^( 7) =       0.000426329829

      target function =      -0.883819390504
              le_mean =     -17.209102446315
             les_mean =     296.466495325414
             stat err =       0.000422462238
             autocorr =       1.197666974854
   target nu stat err =       0.000422462238
   target dn stat err =       0.004003814740
      target stat err =       0.004862317482
              std dev =       0.545936089927
             le_variance =       0.298046214284


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720910244632e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883845224878       residual = 5.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900010348150       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903733089989       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904961947366       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905242299925       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905424190533       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905546234476       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905642394172       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905746802828       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905821803190       residual = 6.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905868235843       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905897792366       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905907691241       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905916410570       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905917658323       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905925666178       residual = 9.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905928524730       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905938518205       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.905947007499       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905955650251       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905960715013       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905961611383       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905968425350       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905970928576       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905972291551       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.905976492090       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.905979397402       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.905984739911       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.905987295370       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.905989955149       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.905991132151       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.905991312633       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.905992015591       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.905993552324       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.905994381840       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.905994378775       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.905995082352       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.905995826849       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.905996535717       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.905996177607       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.905996437951       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.905996620802       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.905996509923       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.905996330312       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.905996603942       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.905996628369       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.905996558994       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.905996496968       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.905996447703       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.905996809525       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.905997288586       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.905997887896       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.905997831345       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.905997777290       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.905997845665       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.905997952009       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.905997937166       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.905997909418       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.905998003624       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.905997885819       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.905997920186       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.905997903402       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.905997945175       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         62 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e-02 is 1.349943e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883845224878       residual = 5.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.891848537007       residual = 9.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.893568544501       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.894088850242       residual = 6.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.894207337728       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.894297885807       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.894359465157       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.894419090583       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.894453118972       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.894489075782       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.894506690602       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.894518264942       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.894520988117       residual = 9.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.894524833666       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.894525224377       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.894528827585       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.894530056564       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.894534017117       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.894536968634       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.894539975086       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.894541253646       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.894541113601       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.894543693676       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.894544275538       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.894544417726       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.894545228545       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.894546364426       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.894547281680       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.894547941123       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.894548391884       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.894548483385       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.894548592015       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.894548744993       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.894549043136       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.894549187791       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.894549222641       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.894549315069       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.894549377401       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.894549414738       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.894549249211       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.894549075663       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.894549247766       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.894549226914       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.894549173042       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.894549144132       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.894549160786       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.894549095674       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.894549145378       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.894549152279       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.894549159814       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.894549199715       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.894549294660       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.894549299939       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         52 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e-01 is 4.896028e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883845224878       residual = 5.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886485357648       residual = 9.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887023099084       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887176778063       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887214610008       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887244161880       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887262818182       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887277654129       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887293571239       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887304908965       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887310124365       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887313288280       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887314035518       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887315106165       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887315232685       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887316396614       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887316666521       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.887317808209       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.887318583353       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.887319337680       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.887319610238       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.887319577642       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.887320274933       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.887320331610       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.887320354947       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.887320489270       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.887320771189       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.887320949405       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.887321091766       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.887321173792       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.887321152109       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.887321207115       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.887321258711       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.887321284886       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.887321323382       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.887321327670       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.887321356340       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.887321336588       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.887321334492       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.887321284443       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.887321268259       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.887321299414       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.887321294681       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.887321279780       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.887321271470       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.887321272852       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.887321265145       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.887321277391       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.887321277447       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.887321279850       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.887321288436       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         50 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 1.567595e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.786746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6009e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.000849e-01 1 1  ON 0
  uu_1                 4.449853e-02 1 1  ON 1
  uu_2                -4.219877e-02 1 1  ON 2
  uu_3                -9.396538e-02 1 1  ON 3
  uu_4                -1.258177e-01 1 1  ON 4
  uu_5                -1.338566e-01 1 1  ON 5
  uu_6                -1.128670e-01 1 1  ON 6
  uu_7                -4.148169e-02 1 1  ON 7
  uu_8                 9.255004e-02 1 1  ON 8
  uu_9                 1.200538e-01 1 1  ON 9
  ud_0                 3.077093e-01 1 1  ON 10
  ud_1                 7.737461e-02 1 1  ON 11
  ud_2                -1.715150e-02 1 1  ON 12
  ud_3                -6.762425e-02 1 1  ON 13
  ud_4                -1.094028e-01 1 1  ON 14
  ud_5                -1.389610e-01 1 1  ON 15
  ud_6                -1.415186e-01 1 1  ON 16
  ud_7                -9.904063e-02 1 1  ON 17
  ud_8                 4.331031e-03 1 1  ON 18
  ud_9                 9.139607e-02 1 1  ON 19
  eO_0                -6.877751e-01 1 1  ON 20
  eO_1                -4.098624e-01 1 1  ON 21
  eO_2                -4.832817e-02 1 1  ON 22
  eO_3                 1.739074e-01 1 1  ON 23
  eO_4                 2.577184e-01 1 1  ON 24
  eO_5                 2.947390e-01 1 1  ON 25
  eO_6                 2.495906e-01 1 1  ON 26
  eO_7                 1.134374e-01 1 1  ON 27
  eO_8                 2.777571e-02 1 1  ON 28
  eO_9                 1.828571e-02 1 1  ON 29
 eH1_0                -1.946535e-01 1 1  ON 30
 eH1_1                -9.922882e-02 1 1  ON 31
 eH1_2                -5.307526e-02 1 1  ON 32
 eH1_3                -2.082620e-02 1 1  ON 33
 eH1_4                 1.927255e-02 1 1  ON 34
 eH1_5                 2.941253e-02 1 1  ON 35
 eH1_6                 7.733838e-02 1 1  ON 36
 eH1_7                 1.112662e-01 1 1  ON 37
 eH1_8                 9.121743e-02 1 1  ON 38
 eH1_9                 2.409674e-02 1 1  ON 39
 eH2_0                -1.950031e-01 1 1  ON 40
 eH2_1                -9.962152e-02 1 1  ON 41
 eH2_2                -5.397594e-02 1 1  ON 42
 eH2_3                -2.157681e-02 1 1  ON 43
 eH2_4                 1.796570e-02 1 1  ON 44
 eH2_5                 2.835636e-02 1 1  ON 45
 eH2_6                 7.841147e-02 1 1  ON 46
 eH2_7                 1.132004e-01 1 1  ON 47
 eH2_8                 9.394664e-02 1 1  ON 48
 eH2_9                 2.625345e-02 1 1  ON 49
ci_001                -5.141041e-02 3 1  ON 50
ci_002                -3.822590e-02 3 1  ON 51
ci_003                -3.042897e-02 3 1  ON 52
ci_004                 2.881756e-02 3 1  ON 53
ci_005                 2.924347e-02 3 1  ON 54
ci_006                -2.564397e-02 3 1  ON 55
ci_007                -2.547248e-02 3 1  ON 56
ci_008                -1.530825e-02 3 1  ON 57
ci_009                -1.944229e-02 3 1  ON 58
ci_010                -1.596856e-02 3 1  ON 59
ci_011                -1.679737e-02 3 1  ON 60
ci_012                -1.608979e-02 3 1  ON 61
ci_013                -2.201188e-02 3 1  ON 62
ci_014                 1.732094e-02 3 1  ON 63
ci_015                 1.824338e-02 3 1  ON 64
ci_016                 1.998327e-02 3 1  ON 65
ci_017                 1.918725e-02 3 1  ON 66
ci_018                 1.472286e-02 3 1  ON 67
ci_019                 1.496093e-02 3 1  ON 68
ci_020                 1.952500e-02 3 1  ON 69
ci_021                 1.944614e-02 3 1  ON 70
ci_022                 1.412388e-02 3 1  ON 71
ci_023                 1.425976e-02 3 1  ON 72
ci_024                 1.241864e-02 3 1  ON 73
ci_025                 1.275527e-02 3 1  ON 74
ci_026                 1.489787e-02 3 1  ON 75
ci_027                 1.461779e-02 3 1  ON 76
ci_028                -1.737560e-02 3 1  ON 77
ci_029                -1.729639e-02 3 1  ON 78
ci_030                -9.673823e-03 3 1  ON 79
ci_031                -9.458088e-03 3 1  ON 80
ci_032                -1.614224e-02 3 1  ON 81
ci_033                 1.150561e-02 3 1  ON 82
ci_034                 1.142741e-02 3 1  ON 83
ci_035                -8.747763e-03 3 1  ON 84
ci_036                -1.440356e-02 3 1  ON 85
ci_037                -1.466542e-02 3 1  ON 86
ci_038                 6.711739e-03 3 1  ON 87
ci_039                 6.243873e-03 3 1  ON 88
ci_040                -7.096119e-03 3 1  ON 89
ci_041                 1.085280e-02 3 1  ON 90
ci_042                 1.096077e-02 3 1  ON 91
ci_043                -7.410496e-03 3 1  ON 92
ci_044                -8.566675e-03 3 1  ON 93
ci_045                -6.451691e-03 3 1  ON 94
ci_046                 8.958377e-03 3 1  ON 95
ci_047                 9.031400e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2275
    reference variance = 0.204464
====================================================
  Execution time = 2.7046e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9718e-01
  Total weights = 1.9654e+06
  Execution time = 2.3613e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307490104722
                                         uncertainty =       0.004876757535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307490104722
                                         uncertainty =       0.004876757535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392063320
  error estimate for blocks of size 2^( 2) =       0.000404086078
  error estimate for blocks of size 2^( 3) =       0.000415026254
  error estimate for blocks of size 2^( 4) =       0.000422711745
  error estimate for blocks of size 2^( 5) =       0.000427673868
  error estimate for blocks of size 2^( 6) =       0.000430050033
  error estimate for blocks of size 2^( 7) =       0.000433012525

      target function =      -0.771306341179
              le_mean =     -17.210718621342
             les_mean =     296.626904667418
             stat err =       0.000428362043
             autocorr =       1.193739418580
   target nu stat err =       0.000428362043
   target dn stat err =       0.042473124826
      target stat err =       0.039207160644
              std dev =       0.554470136077
             le_variance =       0.307437131801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284969146856
                                         uncertainty =       0.006156807328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284969146856
                                         uncertainty =       0.006156807328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377458987
  error estimate for blocks of size 2^( 2) =       0.000390724017
  error estimate for blocks of size 2^( 3) =       0.000402903808
  error estimate for blocks of size 2^( 4) =       0.000411745856
  error estimate for blocks of size 2^( 5) =       0.000417463228
  error estimate for blocks of size 2^( 6) =       0.000419571782
  error estimate for blocks of size 2^( 7) =       0.000422419541

      target function =      -0.883375426380
              le_mean =     -17.210791030457
             les_mean =     296.524911274586
             stat err =       0.000417800101
             autocorr =       1.225173353771
   target nu stat err =       0.000417800101
   target dn stat err =       0.016445717047
      target stat err =       0.019880696298
              std dev =       0.533816158978
             le_variance =       0.284959691586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280865207945
                                         uncertainty =       0.001957398575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280865207945
                                         uncertainty =       0.001957398575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374727493
  error estimate for blocks of size 2^( 2) =       0.000388043402
  error estimate for blocks of size 2^( 3) =       0.000400224474
  error estimate for blocks of size 2^( 4) =       0.000409028595
  error estimate for blocks of size 2^( 5) =       0.000414860612
  error estimate for blocks of size 2^( 6) =       0.000417155118
  error estimate for blocks of size 2^( 7) =       0.000420074991

      target function =      -0.826376315307
              le_mean =     -17.210731684346
             les_mean =     296.570050843090
             stat err =       0.000415279829
             autocorr =       1.228147587613
   target nu stat err =       0.000415279829
   target dn stat err =       0.053194971662
      target stat err =       0.056482862212
              std dev =       0.529953181525
             le_variance =       0.280850374608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294853853965
                                         uncertainty =       0.001843816088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294853853965
                                         uncertainty =       0.001843816088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383932848
  error estimate for blocks of size 2^( 2) =       0.000396336348
  error estimate for blocks of size 2^( 3) =       0.000407564052
  error estimate for blocks of size 2^( 4) =       0.000415455566
  error estimate for blocks of size 2^( 5) =       0.000420745131
  error estimate for blocks of size 2^( 6) =       0.000422637617
  error estimate for blocks of size 2^( 7) =       0.000425746304

      target function =      -0.879306543013
              le_mean =     -17.210453651991
             les_mean =     296.516954245948
             stat err =       0.000421146154
             autocorr =       1.203247969577
   target nu stat err =       0.000421146154
   target dn stat err =       0.005722231754
      target stat err =       0.006868335106
              std dev =       0.542971728334
             le_variance =       0.294818297770


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.771306341179        initial
     3.9062e-02     3.9062e-01             1.3499e-02        -0.883375426380  <--
     1.5625e-01     1.5625e+00             4.8960e-03        -0.826376315307
     6.2500e-01     6.2500e+00             1.5676e-03        -0.879306543013

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.8988e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.032682e-01 1 1  ON 0
  uu_1                 4.775484e-02 1 1  ON 1
  uu_2                -3.991204e-02 1 1  ON 2
  uu_3                -9.272401e-02 1 1  ON 3
  uu_4                -1.249910e-01 1 1  ON 4
  uu_5                -1.338264e-01 1 1  ON 5
  uu_6                -1.141750e-01 1 1  ON 6
  uu_7                -4.576516e-02 1 1  ON 7
  uu_8                 8.293535e-02 1 1  ON 8
  uu_9                 1.210881e-01 1 1  ON 9
  ud_0                 3.040708e-01 1 1  ON 10
  ud_1                 7.545264e-02 1 1  ON 11
  ud_2                -2.121775e-02 1 1  ON 12
  ud_3                -7.180168e-02 1 1  ON 13
  ud_4                -1.104704e-01 1 1  ON 14
  ud_5                -1.356560e-01 1 1  ON 15
  ud_6                -1.347239e-01 1 1  ON 16
  ud_7                -9.313342e-02 1 1  ON 17
  ud_8                 2.121039e-03 1 1  ON 18
  ud_9                 8.974344e-02 1 1  ON 19
  eO_0                -6.879228e-01 1 1  ON 20
  eO_1                -4.101549e-01 1 1  ON 21
  eO_2                -4.470746e-02 1 1  ON 22
  eO_3                 1.763265e-01 1 1  ON 23
  eO_4                 2.544613e-01 1 1  ON 24
  eO_5                 2.861369e-01 1 1  ON 25
  eO_6                 2.494694e-01 1 1  ON 26
  eO_7                 1.191225e-01 1 1  ON 27
  eO_8                 2.819428e-02 1 1  ON 28
  eO_9                 1.851369e-02 1 1  ON 29
 eH1_0                -2.003684e-01 1 1  ON 30
 eH1_1                -9.979731e-02 1 1  ON 31
 eH1_2                -5.104246e-02 1 1  ON 32
 eH1_3                -1.892645e-02 1 1  ON 33
 eH1_4                 1.964206e-02 1 1  ON 34
 eH1_5                 2.910022e-02 1 1  ON 35
 eH1_6                 7.758996e-02 1 1  ON 36
 eH1_7                 1.103244e-01 1 1  ON 37
 eH1_8                 9.321724e-02 1 1  ON 38
 eH1_9                 2.472900e-02 1 1  ON 39
 eH2_0                -1.997501e-01 1 1  ON 40
 eH2_1                -9.992189e-02 1 1  ON 41
 eH2_2                -5.189243e-02 1 1  ON 42
 eH2_3                -1.985729e-02 1 1  ON 43
 eH2_4                 1.749371e-02 1 1  ON 44
 eH2_5                 2.797768e-02 1 1  ON 45
 eH2_6                 7.886993e-02 1 1  ON 46
 eH2_7                 1.121330e-01 1 1  ON 47
 eH2_8                 9.615865e-02 1 1  ON 48
 eH2_9                 2.666698e-02 1 1  ON 49
ci_001                -4.753459e-02 3 1  ON 50
ci_002                -3.504425e-02 3 1  ON 51
ci_003                -2.859721e-02 3 1  ON 52
ci_004                 2.657548e-02 3 1  ON 53
ci_005                 2.719156e-02 3 1  ON 54
ci_006                -2.313176e-02 3 1  ON 55
ci_007                -2.272901e-02 3 1  ON 56
ci_008                -1.170271e-02 3 1  ON 57
ci_009                -1.687009e-02 3 1  ON 58
ci_010                -1.239788e-02 3 1  ON 59
ci_011                -1.416880e-02 3 1  ON 60
ci_012                -1.299082e-02 3 1  ON 61
ci_013                -2.076498e-02 3 1  ON 62
ci_014                 1.461954e-02 3 1  ON 63
ci_015                 1.643642e-02 3 1  ON 64
ci_016                 1.863559e-02 3 1  ON 65
ci_017                 1.719830e-02 3 1  ON 66
ci_018                 1.236283e-02 3 1  ON 67
ci_019                 1.244787e-02 3 1  ON 68
ci_020                 1.804975e-02 3 1  ON 69
ci_021                 1.788742e-02 3 1  ON 70
ci_022                 1.192304e-02 3 1  ON 71
ci_023                 1.249992e-02 3 1  ON 72
ci_024                 9.560169e-03 3 1  ON 73
ci_025                 1.014346e-02 3 1  ON 74
ci_026                 1.380479e-02 3 1  ON 75
ci_027                 1.277636e-02 3 1  ON 76
ci_028                -1.652417e-02 3 1  ON 77
ci_029                -1.625035e-02 3 1  ON 78
ci_030                -7.756343e-03 3 1  ON 79
ci_031                -6.983761e-03 3 1  ON 80
ci_032                -1.551759e-02 3 1  ON 81
ci_033                 1.002277e-02 3 1  ON 82
ci_034                 9.668698e-03 3 1  ON 83
ci_035                -6.566775e-03 3 1  ON 84
ci_036                -1.333388e-02 3 1  ON 85
ci_037                -1.359437e-02 3 1  ON 86
ci_038                 4.486279e-03 3 1  ON 87
ci_039                 3.734866e-03 3 1  ON 88
ci_040                -4.970511e-03 3 1  ON 89
ci_041                 9.728128e-03 3 1  ON 90
ci_042                 9.771642e-03 3 1  ON 91
ci_043                -5.182063e-03 3 1  ON 92
ci_044                -7.020517e-03 3 1  ON 93
ci_045                -4.325888e-03 3 1  ON 94
ci_046                 7.627805e-03 3 1  ON 95
ci_047                 7.524858e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5004e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7178e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2478
    reference variance = 0.180181
====================================================
  Execution time = 2.7100e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0440e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8965e-01
  Total weights = 1.965897316e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3568e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279261374416
                                         uncertainty =       0.001961703950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279261374416
                                         uncertainty =       0.001961703950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373662636
  error estimate for blocks of size 2^( 2) =       0.000386652009
  error estimate for blocks of size 2^( 3) =       0.000398660365
  error estimate for blocks of size 2^( 4) =       0.000407103996
  error estimate for blocks of size 2^( 5) =       0.000412713429
  error estimate for blocks of size 2^( 6) =       0.000413864286
  error estimate for blocks of size 2^( 7) =       0.000418043826

      target function =      -0.913640432539
              le_mean =     -17.210484606368
             les_mean =     296.490431734826
             stat err =       0.000412931384
             autocorr =       1.221227111480
   target nu stat err =       0.000412931384
   target dn stat err =       0.002807237513
      target stat err =       0.003671786209
              std dev =       0.528447222991
             le_variance =       0.279256467487


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721048460637e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913654343836       residual = 5.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916555720996       residual = 9.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917084139453       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917283080112       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917342371710       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917372352878       residual = 5.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917407775807       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917426910491       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917465161431       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917481791680       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917497499135       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917503892208       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917508673650       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917513066131       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917512962116       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917518640761       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917527249038       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917536953595       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917543049533       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917548861813       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917550295664       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917557105159       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917556909378       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917559098094       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917561276581       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917563929356       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917566575408       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917568228475       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917571110931       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917573316038       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917575210256       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917575097809       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917577124713       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917577860205       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917580297232       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917583391319       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917585582783       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917586644058       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917587717788       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917587744449       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.917589783927       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.917591760056       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.917592449682       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.917592813928       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.917593334829       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.917593776540       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.917593732717       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.917593993319       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.917594403220       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.917594978624       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.917595669062       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.917595615123       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.917596329059       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.917596421949       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.917596152898       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.917596190713       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.917597801474       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.917597439935       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.917597373255       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.917598598644       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.917599141425       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.917599555351       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.917599689779       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.917599656768       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.917599671498       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.917599636776       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.917599037828       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.917598461470       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.917598683321       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.917598703886       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.917598854252       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         70 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e-03 is 2.653047e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913654343836       residual = 5.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915818292904       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916193604715       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916333655733       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916376474994       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916397253604       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916422529108       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916436926955       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916464986822       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916476688847       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916487288726       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916490819615       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916493883566       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916496178558       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916496164845       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916500595178       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916506284668       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916510829642       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916514644766       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916517904682       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916518160355       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916521038795       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916520729048       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916522030414       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916522542589       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916523179963       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916524693631       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916525274164       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916526101606       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916526751617       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916527745142       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916527478214       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916527753105       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916528802968       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916529710773       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916529946720       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916531131462       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916531323027       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916530927555       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916531124128       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.916531563769       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.916531811538       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.916531884730       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.916531812069       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.916531675896       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.916531810728       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.916531741869       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.916531478728       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.916531600447       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.916531669875       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.916531816088       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.916531707860       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.916531711242       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.916531746312       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.916531585725       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.916531720607       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.916531738533       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         56 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e-02 is 8.338958e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913654343836       residual = 5.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914726524839       residual = 9.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914898774157       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914963021349       residual = 9.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914983538744       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914994795598       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915005845848       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915012609191       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915025772038       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915031079368       residual = 9.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915035508216       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915036626594       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915037922302       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915038498126       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915038662100       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915040896965       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915043061110       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915044122195       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915045775274       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915046648624       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915046545353       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915047255780       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915047113616       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915047517559       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915047427068       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915047419922       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915048006859       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915048069743       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915048238064       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915048338124       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915048544820       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915048477100       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915048597851       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915048860553       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915048980991       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915049033893       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915049216885       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915049254377       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915049152691       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915049124455       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.915049171339       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.915049181512       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.915049173697       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.915049146394       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.915049133453       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.915049135193       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.915049071148       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.915049074733       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.915049115758       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.915049101626       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.915049118725       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.915049104068       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         51 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e-01 is 2.847717e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.068805 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5746e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.072228e-01 1 1  ON 0
  uu_1                 5.117563e-02 1 1  ON 1
  uu_2                -3.826528e-02 1 1  ON 2
  uu_3                -9.182980e-02 1 1  ON 3
  uu_4                -1.242752e-01 1 1  ON 4
  uu_5                -1.330614e-01 1 1  ON 5
  uu_6                -1.145237e-01 1 1  ON 6
  uu_7                -5.332362e-02 1 1  ON 7
  uu_8                 7.459639e-02 1 1  ON 8
  uu_9                 1.218148e-01 1 1  ON 9
  ud_0                 3.019821e-01 1 1  ON 10
  ud_1                 7.417487e-02 1 1  ON 11
  ud_2                -2.386979e-02 1 1  ON 12
  ud_3                -7.479154e-02 1 1  ON 13
  ud_4                -1.113319e-01 1 1  ON 14
  ud_5                -1.327405e-01 1 1  ON 15
  ud_6                -1.295281e-01 1 1  ON 16
  ud_7                -9.045997e-02 1 1  ON 17
  ud_8                -1.239051e-03 1 1  ON 18
  ud_9                 8.855888e-02 1 1  ON 19
  eO_0                -6.906175e-01 1 1  ON 20
  eO_1                -4.106782e-01 1 1  ON 21
  eO_2                -4.130554e-02 1 1  ON 22
  eO_3                 1.782240e-01 1 1  ON 23
  eO_4                 2.524729e-01 1 1  ON 24
  eO_5                 2.791074e-01 1 1  ON 25
  eO_6                 2.488209e-01 1 1  ON 26
  eO_7                 1.259331e-01 1 1  ON 27
  eO_8                 2.816704e-02 1 1  ON 28
  eO_9                 1.911846e-02 1 1  ON 29
 eH1_0                -2.037453e-01 1 1  ON 30
 eH1_1                -1.001541e-01 1 1  ON 31
 eH1_2                -5.016599e-02 1 1  ON 32
 eH1_3                -1.793712e-02 1 1  ON 33
 eH1_4                 2.017498e-02 1 1  ON 34
 eH1_5                 2.843125e-02 1 1  ON 35
 eH1_6                 7.632409e-02 1 1  ON 36
 eH1_7                 1.078593e-01 1 1  ON 37
 eH1_8                 9.850535e-02 1 1  ON 38
 eH1_9                 2.533501e-02 1 1  ON 39
 eH2_0                -2.014398e-01 1 1  ON 40
 eH2_1                -9.750705e-02 1 1  ON 41
 eH2_2                -4.796697e-02 1 1  ON 42
 eH2_3                -1.718359e-02 1 1  ON 43
 eH2_4                 1.798027e-02 1 1  ON 44
 eH2_5                 2.364749e-02 1 1  ON 45
 eH2_6                 7.457402e-02 1 1  ON 46
 eH2_7                 1.094349e-01 1 1  ON 47
 eH2_8                 9.836651e-02 1 1  ON 48
 eH2_9                 2.751679e-02 1 1  ON 49
ci_001                -4.443339e-02 3 1  ON 50
ci_002                -3.313054e-02 3 1  ON 51
ci_003                -2.702960e-02 3 1  ON 52
ci_004                 2.568455e-02 3 1  ON 53
ci_005                 2.684179e-02 3 1  ON 54
ci_006                -2.126207e-02 3 1  ON 55
ci_007                -2.177565e-02 3 1  ON 56
ci_008                -1.022980e-02 3 1  ON 57
ci_009                -1.589349e-02 3 1  ON 58
ci_010                -9.162684e-03 3 1  ON 59
ci_011                -1.226255e-02 3 1  ON 60
ci_012                -1.161838e-02 3 1  ON 61
ci_013                -2.015633e-02 3 1  ON 62
ci_014                 1.378713e-02 3 1  ON 63
ci_015                 1.380494e-02 3 1  ON 64
ci_016                 1.720074e-02 3 1  ON 65
ci_017                 1.602779e-02 3 1  ON 66
ci_018                 1.143457e-02 3 1  ON 67
ci_019                 1.074709e-02 3 1  ON 68
ci_020                 1.715391e-02 3 1  ON 69
ci_021                 1.672036e-02 3 1  ON 70
ci_022                 1.080064e-02 3 1  ON 71
ci_023                 9.757571e-03 3 1  ON 72
ci_024                 8.436371e-03 3 1  ON 73
ci_025                 8.595360e-03 3 1  ON 74
ci_026                 1.225465e-02 3 1  ON 75
ci_027                 1.257491e-02 3 1  ON 76
ci_028                -1.596649e-02 3 1  ON 77
ci_029                -1.586969e-02 3 1  ON 78
ci_030                -4.946072e-03 3 1  ON 79
ci_031                -5.836180e-03 3 1  ON 80
ci_032                -1.520252e-02 3 1  ON 81
ci_033                 8.480729e-03 3 1  ON 82
ci_034                 8.113093e-03 3 1  ON 83
ci_035                -5.350072e-03 3 1  ON 84
ci_036                -1.309682e-02 3 1  ON 85
ci_037                -1.259398e-02 3 1  ON 86
ci_038                 2.232460e-03 3 1  ON 87
ci_039                 2.183412e-03 3 1  ON 88
ci_040                -4.209757e-03 3 1  ON 89
ci_041                 8.306147e-03 3 1  ON 90
ci_042                 9.193050e-03 3 1  ON 91
ci_043                -4.046053e-03 3 1  ON 92
ci_044                -5.923158e-03 3 1  ON 93
ci_045                -3.432902e-03 3 1  ON 94
ci_046                 6.642887e-03 3 1  ON 95
ci_047                 6.345457e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1771
    reference variance = 0.224592
====================================================
  Execution time = 2.6926e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8480e-01
  Total weights = 1.9659e+06
  Execution time = 2.3668e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286934170193
                                         uncertainty =       0.008067750508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286934170193
                                         uncertainty =       0.008067750508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378727211
  error estimate for blocks of size 2^( 2) =       0.000391999097
  error estimate for blocks of size 2^( 3) =       0.000403850707
  error estimate for blocks of size 2^( 4) =       0.000412504322
  error estimate for blocks of size 2^( 5) =       0.000417700027
  error estimate for blocks of size 2^( 6) =       0.000419547033
  error estimate for blocks of size 2^( 7) =       0.000420963116

      target function =      -0.557812944580
              le_mean =     -17.210201266459
             les_mean =     296.846918653306
             stat err =       0.000417678625
             autocorr =       1.216274160086
   target nu stat err =       0.000417678625
   target dn stat err =       0.302781200062
      target stat err =       0.157241294425
              std dev =       0.535609728085
             le_variance =       0.286877780820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274752553750
                                         uncertainty =       0.001682307732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274752553750
                                         uncertainty =       0.001682307732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370622664
  error estimate for blocks of size 2^( 2) =       0.000384926104
  error estimate for blocks of size 2^( 3) =       0.000397829216
  error estimate for blocks of size 2^( 4) =       0.000407282919
  error estimate for blocks of size 2^( 5) =       0.000412938111
  error estimate for blocks of size 2^( 6) =       0.000414916484
  error estimate for blocks of size 2^( 7) =       0.000416664752

      target function =      -0.902938134286
              le_mean =     -17.210119924067
             les_mean =     296.486097031313
             stat err =       0.000412950566
             autocorr =       1.241458442720
   target nu stat err =       0.000412950566
   target dn stat err =       0.008939189373
      target stat err =       0.011284657148
              std dev =       0.524147983677
             le_variance =       0.274731108793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276324671482
                                         uncertainty =       0.001654394599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276324671482
                                         uncertainty =       0.001654394599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371680928
  error estimate for blocks of size 2^( 2) =       0.000386383897
  error estimate for blocks of size 2^( 3) =       0.000399591938
  error estimate for blocks of size 2^( 4) =       0.000409325535
  error estimate for blocks of size 2^( 5) =       0.000415134211
  error estimate for blocks of size 2^( 6) =       0.000417242602
  error estimate for blocks of size 2^( 7) =       0.000419041193

      target function =      -0.908335663482
              le_mean =     -17.210329297684
             les_mean =     296.489156995625
             stat err =       0.000415185885
             autocorr =       1.247798930271
   target nu stat err =       0.000415185885
   target dn stat err =       0.005489518533
      target stat err =       0.007029631550
              std dev =       0.525644618875
             le_variance =       0.276302265353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275895369693
                                         uncertainty =       0.001790449391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275895369693
                                         uncertainty =       0.001790449391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371392881
  error estimate for blocks of size 2^( 2) =       0.000385168383
  error estimate for blocks of size 2^( 3) =       0.000397506245
  error estimate for blocks of size 2^( 4) =       0.000406462742
  error estimate for blocks of size 2^( 5) =       0.000411826445
  error estimate for blocks of size 2^( 6) =       0.000413605235
  error estimate for blocks of size 2^( 7) =       0.000415335513

      target function =      -0.906922892126
              le_mean =     -17.210094515909
             les_mean =     296.482142930805
             stat err =       0.000411807484
             autocorr =       1.229479577249
   target nu stat err =       0.000411807484
   target dn stat err =       0.005266977114
      target stat err =       0.006722885924
              std dev =       0.525237253256
             le_variance =       0.275874172207


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.557812944580        initial
     9.7656e-03     9.7656e-02             2.6530e-02        -0.902938134286
     3.9062e-02     3.9062e-01             8.3390e-03        -0.908335663482  <--
     1.5625e-01     1.5625e+00             2.8477e-03        -0.906922892126

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.8837e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.072228e-01 1 1  ON 0
  uu_1                 5.117563e-02 1 1  ON 1
  uu_2                -3.826528e-02 1 1  ON 2
  uu_3                -9.182980e-02 1 1  ON 3
  uu_4                -1.242752e-01 1 1  ON 4
  uu_5                -1.330614e-01 1 1  ON 5
  uu_6                -1.145237e-01 1 1  ON 6
  uu_7                -5.332362e-02 1 1  ON 7
  uu_8                 7.459639e-02 1 1  ON 8
  uu_9                 1.218148e-01 1 1  ON 9
  ud_0                 3.019821e-01 1 1  ON 10
  ud_1                 7.417487e-02 1 1  ON 11
  ud_2                -2.386979e-02 1 1  ON 12
  ud_3                -7.479154e-02 1 1  ON 13
  ud_4                -1.113319e-01 1 1  ON 14
  ud_5                -1.327405e-01 1 1  ON 15
  ud_6                -1.295281e-01 1 1  ON 16
  ud_7                -9.045997e-02 1 1  ON 17
  ud_8                -1.239051e-03 1 1  ON 18
  ud_9                 8.855888e-02 1 1  ON 19
  eO_0                -6.906175e-01 1 1  ON 20
  eO_1                -4.106782e-01 1 1  ON 21
  eO_2                -4.130554e-02 1 1  ON 22
  eO_3                 1.782240e-01 1 1  ON 23
  eO_4                 2.524729e-01 1 1  ON 24
  eO_5                 2.791074e-01 1 1  ON 25
  eO_6                 2.488209e-01 1 1  ON 26
  eO_7                 1.259331e-01 1 1  ON 27
  eO_8                 2.816704e-02 1 1  ON 28
  eO_9                 1.911846e-02 1 1  ON 29
 eH1_0                -2.037453e-01 1 1  ON 30
 eH1_1                -1.001541e-01 1 1  ON 31
 eH1_2                -5.016599e-02 1 1  ON 32
 eH1_3                -1.793712e-02 1 1  ON 33
 eH1_4                 2.017498e-02 1 1  ON 34
 eH1_5                 2.843125e-02 1 1  ON 35
 eH1_6                 7.632409e-02 1 1  ON 36
 eH1_7                 1.078593e-01 1 1  ON 37
 eH1_8                 9.850535e-02 1 1  ON 38
 eH1_9                 2.533501e-02 1 1  ON 39
 eH2_0                -2.014398e-01 1 1  ON 40
 eH2_1                -9.750705e-02 1 1  ON 41
 eH2_2                -4.796697e-02 1 1  ON 42
 eH2_3                -1.718359e-02 1 1  ON 43
 eH2_4                 1.798027e-02 1 1  ON 44
 eH2_5                 2.364749e-02 1 1  ON 45
 eH2_6                 7.457402e-02 1 1  ON 46
 eH2_7                 1.094349e-01 1 1  ON 47
 eH2_8                 9.836651e-02 1 1  ON 48
 eH2_9                 2.751679e-02 1 1  ON 49
ci_001                -4.443339e-02 3 1  ON 50
ci_002                -3.313054e-02 3 1  ON 51
ci_003                -2.702960e-02 3 1  ON 52
ci_004                 2.568455e-02 3 1  ON 53
ci_005                 2.684179e-02 3 1  ON 54
ci_006                -2.126207e-02 3 1  ON 55
ci_007                -2.177565e-02 3 1  ON 56
ci_008                -1.022980e-02 3 1  ON 57
ci_009                -1.589349e-02 3 1  ON 58
ci_010                -9.162684e-03 3 1  ON 59
ci_011                -1.226255e-02 3 1  ON 60
ci_012                -1.161838e-02 3 1  ON 61
ci_013                -2.015633e-02 3 1  ON 62
ci_014                 1.378713e-02 3 1  ON 63
ci_015                 1.380494e-02 3 1  ON 64
ci_016                 1.720074e-02 3 1  ON 65
ci_017                 1.602779e-02 3 1  ON 66
ci_018                 1.143457e-02 3 1  ON 67
ci_019                 1.074709e-02 3 1  ON 68
ci_020                 1.715391e-02 3 1  ON 69
ci_021                 1.672036e-02 3 1  ON 70
ci_022                 1.080064e-02 3 1  ON 71
ci_023                 9.757571e-03 3 1  ON 72
ci_024                 8.436371e-03 3 1  ON 73
ci_025                 8.595360e-03 3 1  ON 74
ci_026                 1.225465e-02 3 1  ON 75
ci_027                 1.257491e-02 3 1  ON 76
ci_028                -1.596649e-02 3 1  ON 77
ci_029                -1.586969e-02 3 1  ON 78
ci_030                -4.946072e-03 3 1  ON 79
ci_031                -5.836180e-03 3 1  ON 80
ci_032                -1.520252e-02 3 1  ON 81
ci_033                 8.480729e-03 3 1  ON 82
ci_034                 8.113093e-03 3 1  ON 83
ci_035                -5.350072e-03 3 1  ON 84
ci_036                -1.309682e-02 3 1  ON 85
ci_037                -1.259398e-02 3 1  ON 86
ci_038                 2.232460e-03 3 1  ON 87
ci_039                 2.183412e-03 3 1  ON 88
ci_040                -4.209757e-03 3 1  ON 89
ci_041                 8.306147e-03 3 1  ON 90
ci_042                 9.193050e-03 3 1  ON 91
ci_043                -4.046053e-03 3 1  ON 92
ci_044                -5.923158e-03 3 1  ON 93
ci_045                -3.432902e-03 3 1  ON 94
ci_046                 6.642887e-03 3 1  ON 95
ci_047                 6.345457e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4589e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7180e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1808
    reference variance = 0.252335
====================================================
  Execution time = 2.7419e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0470e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8882e-01
  Total weights = 1.966342658e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1505e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279920349665
                                         uncertainty =       0.001821277875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279920349665
                                         uncertainty =       0.001821277875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374121816
  error estimate for blocks of size 2^( 2) =       0.000387648602
  error estimate for blocks of size 2^( 3) =       0.000400110078
  error estimate for blocks of size 2^( 4) =       0.000409183395
  error estimate for blocks of size 2^( 5) =       0.000415224939
  error estimate for blocks of size 2^( 6) =       0.000419740847
  error estimate for blocks of size 2^( 7) =       0.000421251382

      target function =      -0.914749763361
              le_mean =     -17.210596978035
             les_mean =     296.493466186670
             stat err =       0.000416350141
             autocorr =       1.238486746216
   target nu stat err =       0.000416350141
   target dn stat err =       0.002524024860
      target stat err =       0.003320565200
              std dev =       0.529096611889
             le_variance =       0.279943224712


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721059697804e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914760994363       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915361904229       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915527753936       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915579952024       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915589673604       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915602575862       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915608204336       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915610279657       residual = 8.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915619238409       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915621444877       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915629912503       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915631654455       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915633403622       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915634791341       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915638289307       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915640443010       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915640649184       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915644587920       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915647687716       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915651742206       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915650952690       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915652131828       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915653205739       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915655594670       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915657033875       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915656545983       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915657527895       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915658889422       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915659729661       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915661524551       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915664216513       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915665114795       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915666841686       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915670242399       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915672728674       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915674120748       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915675124008       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915673965354       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915675132500       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915675039006       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.915675309884       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.915675552744       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.915675543103       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.915675772236       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.915676280184       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.915676546012       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.915675751140       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.915675466026       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.915676348534       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.915676428299       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.915676473755       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.915676361470       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.915676792498       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.915677443674       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.915678292533       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.915679690985       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.915680111958       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.915680225492       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.915679949718       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.915680036089       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.915679979562       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.915679927335       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.915680885280       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.915680929865       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.915680862619       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.915680726810       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.915680418765       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.915680378612       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         67 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e-03 is 2.359138e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914760994363       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915212567421       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915332170898       residual = 9.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915366221820       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915372784685       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915382314544       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915385257663       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915387175505       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915393103252       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915394958582       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915400364835       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915401572951       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915402862728       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915403372664       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915405978114       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915406944886       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915406995129       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915409499245       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915411251788       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915413122199       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915412310933       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915412743964       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915413332238       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915414214806       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915414500685       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915414214424       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915414772348       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915415222585       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915415298548       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915415954097       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915417070797       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915417228947       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915417562444       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915418654604       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915419369140       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915419366122       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915419542193       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915419319363       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915419394027       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915418909939       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.915419176073       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.915419034777       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.915418990926       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.915419181717       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.915419239787       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.915419094103       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.915418981940       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.915418925271       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.915419062941       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.915419102197       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.915419089282       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.915419039326       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.915419120299       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.915419181425       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.915419304665       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.915419423062       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         55 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e-02 is 9.010585e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914760994363       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914987416455       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915043729276       residual = 7.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915057426526       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915060419549       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915065068467       residual = 8.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915065619182       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915067442656       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915069349560       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915070444733       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915072614951       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915073147171       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915073614850       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915073787194       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915075012499       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915075123814       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915075198627       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915076238484       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915076763968       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915077162164       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915076805493       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915076983258       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915077060751       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915077165160       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915077236436       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915077198537       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915077298795       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915077439175       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915077350183       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915077460407       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915077827441       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915077803924       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915077885223       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915078104364       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915078108731       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915078110606       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915078122539       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915078033926       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915078018115       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915077987982       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.915077999530       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.915077985607       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.915077956830       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.915077993717       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.915078001506       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.915077995962       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.915077957749       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.915077978503       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.915077988885       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e-01 is 2.605812e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.318011 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5826e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.082260e-01 1 1  ON 0
  uu_1                 5.220841e-02 1 1  ON 1
  uu_2                -3.740116e-02 1 1  ON 2
  uu_3                -9.071585e-02 1 1  ON 3
  uu_4                -1.228896e-01 1 1  ON 4
  uu_5                -1.323975e-01 1 1  ON 5
  uu_6                -1.138385e-01 1 1  ON 6
  uu_7                -5.437981e-02 1 1  ON 7
  uu_8                 6.558580e-02 1 1  ON 8
  uu_9                 1.215499e-01 1 1  ON 9
  ud_0                 3.021333e-01 1 1  ON 10
  ud_1                 7.475847e-02 1 1  ON 11
  ud_2                -2.451429e-02 1 1  ON 12
  ud_3                -7.568455e-02 1 1  ON 13
  ud_4                -1.116042e-01 1 1  ON 14
  ud_5                -1.320565e-01 1 1  ON 15
  ud_6                -1.290045e-01 1 1  ON 16
  ud_7                -9.125180e-02 1 1  ON 17
  ud_8                -2.278925e-03 1 1  ON 18
  ud_9                 8.594522e-02 1 1  ON 19
  eO_0                -6.933727e-01 1 1  ON 20
  eO_1                -4.128989e-01 1 1  ON 21
  eO_2                -4.033985e-02 1 1  ON 22
  eO_3                 1.799697e-01 1 1  ON 23
  eO_4                 2.515913e-01 1 1  ON 24
  eO_5                 2.770140e-01 1 1  ON 25
  eO_6                 2.478131e-01 1 1  ON 26
  eO_7                 1.314210e-01 1 1  ON 27
  eO_8                 2.843963e-02 1 1  ON 28
  eO_9                 1.919041e-02 1 1  ON 29
 eH1_0                -2.044881e-01 1 1  ON 30
 eH1_1                -1.000546e-01 1 1  ON 31
 eH1_2                -4.916118e-02 1 1  ON 32
 eH1_3                -1.720690e-02 1 1  ON 33
 eH1_4                 1.807975e-02 1 1  ON 34
 eH1_5                 2.536346e-02 1 1  ON 35
 eH1_6                 7.793291e-02 1 1  ON 36
 eH1_7                 1.074782e-01 1 1  ON 37
 eH1_8                 1.006975e-01 1 1  ON 38
 eH1_9                 2.539479e-02 1 1  ON 39
 eH2_0                -2.011155e-01 1 1  ON 40
 eH2_1                -9.591886e-02 1 1  ON 41
 eH2_2                -4.606184e-02 1 1  ON 42
 eH2_3                -1.565204e-02 1 1  ON 43
 eH2_4                 1.817887e-02 1 1  ON 44
 eH2_5                 2.112096e-02 1 1  ON 45
 eH2_6                 6.973687e-02 1 1  ON 46
 eH2_7                 1.070835e-01 1 1  ON 47
 eH2_8                 1.023050e-01 1 1  ON 48
 eH2_9                 2.758910e-02 1 1  ON 49
ci_001                -4.292003e-02 3 1  ON 50
ci_002                -3.152806e-02 3 1  ON 51
ci_003                -2.590852e-02 3 1  ON 52
ci_004                 2.512862e-02 3 1  ON 53
ci_005                 2.470613e-02 3 1  ON 54
ci_006                -2.047593e-02 3 1  ON 55
ci_007                -2.094668e-02 3 1  ON 56
ci_008                -9.201759e-03 3 1  ON 57
ci_009                -1.540368e-02 3 1  ON 58
ci_010                -9.476503e-03 3 1  ON 59
ci_011                -1.090404e-02 3 1  ON 60
ci_012                -1.086483e-02 3 1  ON 61
ci_013                -1.983903e-02 3 1  ON 62
ci_014                 1.306449e-02 3 1  ON 63
ci_015                 1.373562e-02 3 1  ON 64
ci_016                 1.663748e-02 3 1  ON 65
ci_017                 1.647768e-02 3 1  ON 66
ci_018                 1.059040e-02 3 1  ON 67
ci_019                 1.050890e-02 3 1  ON 68
ci_020                 1.632201e-02 3 1  ON 69
ci_021                 1.646680e-02 3 1  ON 70
ci_022                 1.049819e-02 3 1  ON 71
ci_023                 9.817022e-03 3 1  ON 72
ci_024                 7.816447e-03 3 1  ON 73
ci_025                 7.970062e-03 3 1  ON 74
ci_026                 1.222013e-02 3 1  ON 75
ci_027                 1.164491e-02 3 1  ON 76
ci_028                -1.566756e-02 3 1  ON 77
ci_029                -1.562373e-02 3 1  ON 78
ci_030                -4.661165e-03 3 1  ON 79
ci_031                -5.390318e-03 3 1  ON 80
ci_032                -1.520114e-02 3 1  ON 81
ci_033                 8.141292e-03 3 1  ON 82
ci_034                 7.802191e-03 3 1  ON 83
ci_035                -4.767497e-03 3 1  ON 84
ci_036                -1.284420e-02 3 1  ON 85
ci_037                -1.263819e-02 3 1  ON 86
ci_038                 1.288372e-03 3 1  ON 87
ci_039                 1.640517e-03 3 1  ON 88
ci_040                -2.940241e-03 3 1  ON 89
ci_041                 8.573661e-03 3 1  ON 90
ci_042                 8.661402e-03 3 1  ON 91
ci_043                -3.749624e-03 3 1  ON 92
ci_044                -4.951195e-03 3 1  ON 93
ci_045                -2.844885e-03 3 1  ON 94
ci_046                 5.965104e-03 3 1  ON 95
ci_047                 6.011118e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1346
    reference variance = 0.511257
====================================================
  Execution time = 2.7318e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8875e-01
  Total weights = 1.9662e+06
  Execution time = 2.3895e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280411910636
                                         uncertainty =       0.001794467676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280411910636
                                         uncertainty =       0.001794467676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374399427
  error estimate for blocks of size 2^( 2) =       0.000388726293
  error estimate for blocks of size 2^( 3) =       0.000401418706
  error estimate for blocks of size 2^( 4) =       0.000410304833
  error estimate for blocks of size 2^( 5) =       0.000415581052
  error estimate for blocks of size 2^( 6) =       0.000418788781
  error estimate for blocks of size 2^( 7) =       0.000419996067

      target function =      -0.899092644539
              le_mean =     -17.210124276976
             les_mean =     296.489329281433
             stat err =       0.000416167683
             autocorr =       1.235567155114
   target nu stat err =       0.000416167683
   target dn stat err =       0.008214585304
      target stat err =       0.010284456120
              std dev =       0.529489219011
             le_variance =       0.280358833049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279445034500
                                         uncertainty =       0.001820687356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279445034500
                                         uncertainty =       0.001820687356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373755535
  error estimate for blocks of size 2^( 2) =       0.000388341139
  error estimate for blocks of size 2^( 3) =       0.000401310374
  error estimate for blocks of size 2^( 4) =       0.000410432386
  error estimate for blocks of size 2^( 5) =       0.000415793260
  error estimate for blocks of size 2^( 6) =       0.000418959660
  error estimate for blocks of size 2^( 7) =       0.000420206215

      target function =      -0.912524296724
              le_mean =     -17.210087959080
             les_mean =     296.477565142929
             stat err =       0.000416347880
             autocorr =       1.240901905439
   target nu stat err =       0.000416347880
   target dn stat err =       0.002916472777
      target stat err =       0.003800337161
              std dev =       0.528578602998
             le_variance =       0.279395339547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279610150352
                                         uncertainty =       0.001841287680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279610150352
                                         uncertainty =       0.001841287680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373866650
  error estimate for blocks of size 2^( 2) =       0.000388576438
  error estimate for blocks of size 2^( 3) =       0.000401669699
  error estimate for blocks of size 2^( 4) =       0.000410896702
  error estimate for blocks of size 2^( 5) =       0.000416297905
  error estimate for blocks of size 2^( 6) =       0.000419446362
  error estimate for blocks of size 2^( 7) =       0.000420706787

      target function =      -0.913394504532
              le_mean =     -17.210145942927
             les_mean =     296.478899984914
             stat err =       0.000416836939
             autocorr =       1.243079607592
   target nu stat err =       0.000416836939
   target dn stat err =       0.002550602862
      target stat err =       0.003342445333
              std dev =       0.528735747199
             le_variance =       0.279561490366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279886139806
                                         uncertainty =       0.001799251770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279886139806
                                         uncertainty =       0.001799251770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374049029
  error estimate for blocks of size 2^( 2) =       0.000388462445
  error estimate for blocks of size 2^( 3) =       0.000401248968
  error estimate for blocks of size 2^( 4) =       0.000410211452
  error estimate for blocks of size 2^( 5) =       0.000415510203
  error estimate for blocks of size 2^( 6) =       0.000418691219
  error estimate for blocks of size 2^( 7) =       0.000419910258

      target function =      -0.909579033186
              le_mean =     -17.210082949610
             les_mean =     296.479685845124
             stat err =       0.000416080783
             autocorr =       1.237366210757
   target nu stat err =       0.000416080783
   target dn stat err =       0.003049303933
      target stat err =       0.003943995010
              std dev =       0.528993673885
             le_variance =       0.279834307010


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899092644539        initial
     9.7656e-03     9.7656e-02             2.3591e-02        -0.912524296724
     3.9062e-02     3.9062e-01             9.0106e-03        -0.913394504532  <--
     1.5625e-01     1.5625e+00             2.6058e-03        -0.909579033186

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.9327e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.082260e-01 1 1  ON 0
  uu_1                 5.220841e-02 1 1  ON 1
  uu_2                -3.740116e-02 1 1  ON 2
  uu_3                -9.071585e-02 1 1  ON 3
  uu_4                -1.228896e-01 1 1  ON 4
  uu_5                -1.323975e-01 1 1  ON 5
  uu_6                -1.138385e-01 1 1  ON 6
  uu_7                -5.437981e-02 1 1  ON 7
  uu_8                 6.558580e-02 1 1  ON 8
  uu_9                 1.215499e-01 1 1  ON 9
  ud_0                 3.021333e-01 1 1  ON 10
  ud_1                 7.475847e-02 1 1  ON 11
  ud_2                -2.451429e-02 1 1  ON 12
  ud_3                -7.568455e-02 1 1  ON 13
  ud_4                -1.116042e-01 1 1  ON 14
  ud_5                -1.320565e-01 1 1  ON 15
  ud_6                -1.290045e-01 1 1  ON 16
  ud_7                -9.125180e-02 1 1  ON 17
  ud_8                -2.278925e-03 1 1  ON 18
  ud_9                 8.594522e-02 1 1  ON 19
  eO_0                -6.933727e-01 1 1  ON 20
  eO_1                -4.128989e-01 1 1  ON 21
  eO_2                -4.033985e-02 1 1  ON 22
  eO_3                 1.799697e-01 1 1  ON 23
  eO_4                 2.515913e-01 1 1  ON 24
  eO_5                 2.770140e-01 1 1  ON 25
  eO_6                 2.478131e-01 1 1  ON 26
  eO_7                 1.314210e-01 1 1  ON 27
  eO_8                 2.843963e-02 1 1  ON 28
  eO_9                 1.919041e-02 1 1  ON 29
 eH1_0                -2.044881e-01 1 1  ON 30
 eH1_1                -1.000546e-01 1 1  ON 31
 eH1_2                -4.916118e-02 1 1  ON 32
 eH1_3                -1.720690e-02 1 1  ON 33
 eH1_4                 1.807975e-02 1 1  ON 34
 eH1_5                 2.536346e-02 1 1  ON 35
 eH1_6                 7.793291e-02 1 1  ON 36
 eH1_7                 1.074782e-01 1 1  ON 37
 eH1_8                 1.006975e-01 1 1  ON 38
 eH1_9                 2.539479e-02 1 1  ON 39
 eH2_0                -2.011155e-01 1 1  ON 40
 eH2_1                -9.591886e-02 1 1  ON 41
 eH2_2                -4.606184e-02 1 1  ON 42
 eH2_3                -1.565204e-02 1 1  ON 43
 eH2_4                 1.817887e-02 1 1  ON 44
 eH2_5                 2.112096e-02 1 1  ON 45
 eH2_6                 6.973687e-02 1 1  ON 46
 eH2_7                 1.070835e-01 1 1  ON 47
 eH2_8                 1.023050e-01 1 1  ON 48
 eH2_9                 2.758910e-02 1 1  ON 49
ci_001                -4.292003e-02 3 1  ON 50
ci_002                -3.152806e-02 3 1  ON 51
ci_003                -2.590852e-02 3 1  ON 52
ci_004                 2.512862e-02 3 1  ON 53
ci_005                 2.470613e-02 3 1  ON 54
ci_006                -2.047593e-02 3 1  ON 55
ci_007                -2.094668e-02 3 1  ON 56
ci_008                -9.201759e-03 3 1  ON 57
ci_009                -1.540368e-02 3 1  ON 58
ci_010                -9.476503e-03 3 1  ON 59
ci_011                -1.090404e-02 3 1  ON 60
ci_012                -1.086483e-02 3 1  ON 61
ci_013                -1.983903e-02 3 1  ON 62
ci_014                 1.306449e-02 3 1  ON 63
ci_015                 1.373562e-02 3 1  ON 64
ci_016                 1.663748e-02 3 1  ON 65
ci_017                 1.647768e-02 3 1  ON 66
ci_018                 1.059040e-02 3 1  ON 67
ci_019                 1.050890e-02 3 1  ON 68
ci_020                 1.632201e-02 3 1  ON 69
ci_021                 1.646680e-02 3 1  ON 70
ci_022                 1.049819e-02 3 1  ON 71
ci_023                 9.817022e-03 3 1  ON 72
ci_024                 7.816447e-03 3 1  ON 73
ci_025                 7.970062e-03 3 1  ON 74
ci_026                 1.222013e-02 3 1  ON 75
ci_027                 1.164491e-02 3 1  ON 76
ci_028                -1.566756e-02 3 1  ON 77
ci_029                -1.562373e-02 3 1  ON 78
ci_030                -4.661165e-03 3 1  ON 79
ci_031                -5.390318e-03 3 1  ON 80
ci_032                -1.520114e-02 3 1  ON 81
ci_033                 8.141292e-03 3 1  ON 82
ci_034                 7.802191e-03 3 1  ON 83
ci_035                -4.767497e-03 3 1  ON 84
ci_036                -1.284420e-02 3 1  ON 85
ci_037                -1.263819e-02 3 1  ON 86
ci_038                 1.288372e-03 3 1  ON 87
ci_039                 1.640517e-03 3 1  ON 88
ci_040                -2.940241e-03 3 1  ON 89
ci_041                 8.573661e-03 3 1  ON 90
ci_042                 8.661402e-03 3 1  ON 91
ci_043                -3.749624e-03 3 1  ON 92
ci_044                -4.951195e-03 3 1  ON 93
ci_045                -2.844885e-03 3 1  ON 94
ci_046                 5.965104e-03 3 1  ON 95
ci_047                 6.011118e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5160e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7179e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1994
    reference variance = 0.270396
====================================================
  Execution time = 2.7547e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0508e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8550e-01
  Total weights = 1.966225976e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2847e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276452020804
                                         uncertainty =       0.001809470692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276452020804
                                         uncertainty =       0.001809470692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371770214
  error estimate for blocks of size 2^( 2) =       0.000386016563
  error estimate for blocks of size 2^( 3) =       0.000398555525
  error estimate for blocks of size 2^( 4) =       0.000408313962
  error estimate for blocks of size 2^( 5) =       0.000413792053
  error estimate for blocks of size 2^( 6) =       0.000416303345
  error estimate for blocks of size 2^( 7) =       0.000419443125

      target function =      -0.919042894543
              le_mean =     -17.210493974177
             les_mean =     296.486599995006
             stat err =       0.000414463121
             autocorr =       1.242861125745
   target nu stat err =       0.000414463121
   target dn stat err =       0.002392469150
      target stat err =       0.003181227122
              std dev =       0.525770890744
             le_variance =       0.276435029553


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721049397418e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919053098470       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919355745508       residual = 9.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919403226754       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919414109137       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919419894227       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919420210645       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919421521816       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919421866970       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919422807556       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919424211590       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919425866559       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919425412236       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919426417558       residual = 9.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919427745837       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919430412074       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919434180400       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919438666337       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919444711034       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919449014613       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919452247065       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919454350731       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919454588239       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919456099605       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919455180960       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919455854771       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919456101279       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919458115320       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919457717946       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919458311394       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919460834676       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919460895247       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919462210163       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919462998238       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919464916100       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919464634008       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919464615716       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919465841102       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919465296151       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919465674572       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919464648274       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.919463996023       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.919464679193       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.919465321103       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.919465238527       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.919465695356       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.919466078132       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.919466946864       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.919467363287       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.919469788495       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.919470379972       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.919470311777       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.919470686077       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.919470906895       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.919471187419       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.919470992366       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.919471074019       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.919471585714       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.919471633696       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.919471685082       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.919471648776       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.919471748429       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.919471608551       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.919471116024       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.919470979876       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.919471030711       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         64 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e-03 is 3.237829e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919053098470       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919279292317       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919312685875       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919319450805       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919323294551       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919323526588       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919324318649       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919324367282       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919325231277       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919325929595       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919327133517       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919326887708       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919327427584       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919328523547       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919330366910       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919332683575       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919335127990       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919338245508       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919339747607       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919340832018       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919341245603       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919340887054       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919341423674       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919340955312       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919341221197       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919341288314       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919341912472       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919341573618       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919341878008       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919342672866       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919342479444       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919342956162       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919343201599       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919343360972       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919343161678       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919343018237       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919343292991       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919343053017       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919342745633       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919342664214       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.919342486248       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.919342620259       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.919342739076       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.919342658888       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.919342692485       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.919342782680       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.919342851514       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.919343102285       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.919343261630       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.919343312389       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.919343321780       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.919343336296       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.919343347977       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         52 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e-02 is 8.532384e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919053098470       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919165597739       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919180734184       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919183242922       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919184850580       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919185047602       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919185307972       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919185225876       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919185772787       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919185931269       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919186463226       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919186410439       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919186650149       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919187198082       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919187900918       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919188816627       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919189674116       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919190416156       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919190649815       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919190873571       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919190904472       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919190775239       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919190893312       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919190745038       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919190799787       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919190809854       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919190950388       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919190890518       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919190961294       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919191132542       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919191015746       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919191097943       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919191148305       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919191143761       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919191098318       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919191069309       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919191084402       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919191011605       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919190955717       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919190967347       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.919190943263       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.919190970061       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.919190962256       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.919190967329       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.919190984077       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e-01 is 2.193751e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.527253 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6048e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.077589e-01 1 1  ON 0
  uu_1                 5.128737e-02 1 1  ON 1
  uu_2                -3.784513e-02 1 1  ON 2
  uu_3                -9.101273e-02 1 1  ON 3
  uu_4                -1.227914e-01 1 1  ON 4
  uu_5                -1.313043e-01 1 1  ON 5
  uu_6                -1.128326e-01 1 1  ON 6
  uu_7                -5.322512e-02 1 1  ON 7
  uu_8                 5.998156e-02 1 1  ON 8
  uu_9                 1.222527e-01 1 1  ON 9
  ud_0                 3.011592e-01 1 1  ON 10
  ud_1                 7.373215e-02 1 1  ON 11
  ud_2                -2.565528e-02 1 1  ON 12
  ud_3                -7.672778e-02 1 1  ON 13
  ud_4                -1.121601e-01 1 1  ON 14
  ud_5                -1.324377e-01 1 1  ON 15
  ud_6                -1.282345e-01 1 1  ON 16
  ud_7                -8.999268e-02 1 1  ON 17
  ud_8                -3.672410e-03 1 1  ON 18
  ud_9                 8.417645e-02 1 1  ON 19
  eO_0                -6.933126e-01 1 1  ON 20
  eO_1                -4.130820e-01 1 1  ON 21
  eO_2                -4.097695e-02 1 1  ON 22
  eO_3                 1.786374e-01 1 1  ON 23
  eO_4                 2.501920e-01 1 1  ON 24
  eO_5                 2.724850e-01 1 1  ON 25
  eO_6                 2.454052e-01 1 1  ON 26
  eO_7                 1.399534e-01 1 1  ON 27
  eO_8                 2.943444e-02 1 1  ON 28
  eO_9                 1.974816e-02 1 1  ON 29
 eH1_0                -2.044234e-01 1 1  ON 30
 eH1_1                -9.886341e-02 1 1  ON 31
 eH1_2                -4.737985e-02 1 1  ON 32
 eH1_3                -1.581259e-02 1 1  ON 33
 eH1_4                 1.894978e-02 1 1  ON 34
 eH1_5                 2.494319e-02 1 1  ON 35
 eH1_6                 7.303687e-02 1 1  ON 36
 eH1_7                 1.042808e-01 1 1  ON 37
 eH1_8                 1.035796e-01 1 1  ON 38
 eH1_9                 2.561239e-02 1 1  ON 39
 eH2_0                -2.007004e-01 1 1  ON 40
 eH2_1                -9.633532e-02 1 1  ON 41
 eH2_2                -4.535481e-02 1 1  ON 42
 eH2_3                -1.511895e-02 1 1  ON 43
 eH2_4                 1.773040e-02 1 1  ON 44
 eH2_5                 1.995349e-02 1 1  ON 45
 eH2_6                 6.615765e-02 1 1  ON 46
 eH2_7                 1.051924e-01 1 1  ON 47
 eH2_8                 1.059241e-01 1 1  ON 48
 eH2_9                 2.934723e-02 1 1  ON 49
ci_001                -4.308991e-02 3 1  ON 50
ci_002                -3.175825e-02 3 1  ON 51
ci_003                -2.567496e-02 3 1  ON 52
ci_004                 2.474232e-02 3 1  ON 53
ci_005                 2.424287e-02 3 1  ON 54
ci_006                -2.028789e-02 3 1  ON 55
ci_007                -2.044265e-02 3 1  ON 56
ci_008                -9.043467e-03 3 1  ON 57
ci_009                -1.496974e-02 3 1  ON 58
ci_010                -9.413388e-03 3 1  ON 59
ci_011                -1.039888e-02 3 1  ON 60
ci_012                -9.859337e-03 3 1  ON 61
ci_013                -1.890546e-02 3 1  ON 62
ci_014                 1.192513e-02 3 1  ON 63
ci_015                 1.349407e-02 3 1  ON 64
ci_016                 1.664877e-02 3 1  ON 65
ci_017                 1.635833e-02 3 1  ON 66
ci_018                 1.063116e-02 3 1  ON 67
ci_019                 1.000964e-02 3 1  ON 68
ci_020                 1.640065e-02 3 1  ON 69
ci_021                 1.634635e-02 3 1  ON 70
ci_022                 1.120935e-02 3 1  ON 71
ci_023                 1.031468e-02 3 1  ON 72
ci_024                 7.551707e-03 3 1  ON 73
ci_025                 8.288887e-03 3 1  ON 74
ci_026                 1.175115e-02 3 1  ON 75
ci_027                 1.149284e-02 3 1  ON 76
ci_028                -1.500900e-02 3 1  ON 77
ci_029                -1.537766e-02 3 1  ON 78
ci_030                -5.972663e-03 3 1  ON 79
ci_031                -4.814207e-03 3 1  ON 80
ci_032                -1.512117e-02 3 1  ON 81
ci_033                 7.242769e-03 3 1  ON 82
ci_034                 7.555503e-03 3 1  ON 83
ci_035                -4.880538e-03 3 1  ON 84
ci_036                -1.282095e-02 3 1  ON 85
ci_037                -1.284568e-02 3 1  ON 86
ci_038                 1.347624e-03 3 1  ON 87
ci_039                 1.403229e-03 3 1  ON 88
ci_040                -3.019217e-03 3 1  ON 89
ci_041                 8.597608e-03 3 1  ON 90
ci_042                 8.379016e-03 3 1  ON 91
ci_043                -3.498876e-03 3 1  ON 92
ci_044                -4.975017e-03 3 1  ON 93
ci_045                -3.077700e-03 3 1  ON 94
ci_046                 5.953189e-03 3 1  ON 95
ci_047                 5.854451e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2617
    reference variance = 0.247784
====================================================
  Execution time = 2.6900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8845e-01
  Total weights = 1.9666e+06
  Execution time = 2.3634e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278453503946
                                         uncertainty =       0.001524657705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278453503946
                                         uncertainty =       0.001524657705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373135760
  error estimate for blocks of size 2^( 2) =       0.000387438292
  error estimate for blocks of size 2^( 3) =       0.000400330491
  error estimate for blocks of size 2^( 4) =       0.000410112740
  error estimate for blocks of size 2^( 5) =       0.000415571565
  error estimate for blocks of size 2^( 6) =       0.000417485083
  error estimate for blocks of size 2^( 7) =       0.000416133258

      target function =      -0.911048971680
              le_mean =     -17.210519854738
             les_mean =     296.493663961177
             stat err =       0.000414825662
             autocorr =       1.235940276161
   target nu stat err =       0.000414825662
   target dn stat err =       0.002868808278
      target stat err =       0.003729941435
              std dev =       0.527702095165
             le_variance =       0.278469501241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278159749366
                                         uncertainty =       0.001512324646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278159749366
                                         uncertainty =       0.001512324646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372933818
  error estimate for blocks of size 2^( 2) =       0.000387422332
  error estimate for blocks of size 2^( 3) =       0.000400525667
  error estimate for blocks of size 2^( 4) =       0.000410486118
  error estimate for blocks of size 2^( 5) =       0.000416031456
  error estimate for blocks of size 2^( 6) =       0.000418080812
  error estimate for blocks of size 2^( 7) =       0.000416698458

      target function =      -0.902290168331
              le_mean =     -17.210494973840
             les_mean =     296.499607760018
             stat err =       0.000415324211
             autocorr =       1.240254932800
   target nu stat err =       0.000415324211
   target dn stat err =       0.008212230951
      target stat err =       0.010360545243
              std dev =       0.527416501789
             le_variance =       0.278168166360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278352071807
                                         uncertainty =       0.001512687422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278352071807
                                         uncertainty =       0.001512687422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373061318
  error estimate for blocks of size 2^( 2) =       0.000387614166
  error estimate for blocks of size 2^( 3) =       0.000400783411
  error estimate for blocks of size 2^( 4) =       0.000410801370
  error estimate for blocks of size 2^( 5) =       0.000416376436
  error estimate for blocks of size 2^( 6) =       0.000418467282
  error estimate for blocks of size 2^( 7) =       0.000417074688

      target function =      -0.912336546439
              le_mean =     -17.210512049676
             les_mean =     296.492395817099
             stat err =       0.000415679944
             autocorr =       1.241531382490
   target nu stat err =       0.000415679944
   target dn stat err =       0.002415969700
      target stat err =       0.003165903822
              std dev =       0.527596816731
             le_variance =       0.278358401025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278288336352
                                         uncertainty =       0.001519349955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278288336352
                                         uncertainty =       0.001519349955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373023122
  error estimate for blocks of size 2^( 2) =       0.000387382850
  error estimate for blocks of size 2^( 3) =       0.000400338472
  error estimate for blocks of size 2^( 4) =       0.000410171097
  error estimate for blocks of size 2^( 5) =       0.000415654501
  error estimate for blocks of size 2^( 6) =       0.000417611873
  error estimate for blocks of size 2^( 7) =       0.000416244462

      target function =      -0.914245611225
              le_mean =     -17.210500887114
             les_mean =     296.490530820785
             stat err =       0.000414920483
             autocorr =       1.237252226436
   target nu stat err =       0.000414920483
   target dn stat err =       0.002277398126
      target stat err =       0.003002760307
              std dev =       0.527542799223
             le_variance =       0.278301405012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911048971680        initial
     9.7656e-03     9.7656e-02             3.2378e-02        -0.902290168331
     3.9062e-02     3.9062e-01             8.5324e-03        -0.912336546439
     1.5625e-01     1.5625e+00             2.1938e-03        -0.914245611225  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.8792e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.080690e-01 1 1  ON 0
  uu_1                 5.181584e-02 1 1  ON 1
  uu_2                -3.756030e-02 1 1  ON 2
  uu_3                -9.082379e-02 1 1  ON 3
  uu_4                -1.228393e-01 1 1  ON 4
  uu_5                -1.319294e-01 1 1  ON 5
  uu_6                -1.134934e-01 1 1  ON 6
  uu_7                -5.391973e-02 1 1  ON 7
  uu_8                 6.393346e-02 1 1  ON 8
  uu_9                 1.217652e-01 1 1  ON 9
  ud_0                 3.018820e-01 1 1  ON 10
  ud_1                 7.447910e-02 1 1  ON 11
  ud_2                -2.486234e-02 1 1  ON 12
  ud_3                -7.600714e-02 1 1  ON 13
  ud_4                -1.117251e-01 1 1  ON 14
  ud_5                -1.321767e-01 1 1  ON 15
  ud_6                -1.286879e-01 1 1  ON 16
  ud_7                -9.078767e-02 1 1  ON 17
  ud_8                -2.745967e-03 1 1  ON 18
  ud_9                 8.548937e-02 1 1  ON 19
  eO_0                -6.932017e-01 1 1  ON 20
  eO_1                -4.128199e-01 1 1  ON 21
  eO_2                -4.042305e-02 1 1  ON 22
  eO_3                 1.796243e-01 1 1  ON 23
  eO_4                 2.512320e-01 1 1  ON 24
  eO_5                 2.754600e-01 1 1  ON 25
  eO_6                 2.472430e-01 1 1  ON 26
  eO_7                 1.336148e-01 1 1  ON 27
  eO_8                 2.867906e-02 1 1  ON 28
  eO_9                 1.933192e-02 1 1  ON 29
 eH1_0                -2.046535e-01 1 1  ON 30
 eH1_1                -9.968635e-02 1 1  ON 31
 eH1_2                -4.849834e-02 1 1  ON 32
 eH1_3                -1.671831e-02 1 1  ON 33
 eH1_4                 1.838061e-02 1 1  ON 34
 eH1_5                 2.526229e-02 1 1  ON 35
 eH1_6                 7.633095e-02 1 1  ON 36
 eH1_7                 1.066945e-01 1 1  ON 37
 eH1_8                 1.014484e-01 1 1  ON 38
 eH1_9                 2.544739e-02 1 1  ON 39
 eH2_0                -2.009168e-01 1 1  ON 40
 eH2_1                -9.614042e-02 1 1  ON 41
 eH2_2                -4.572272e-02 1 1  ON 42
 eH2_3                -1.538881e-02 1 1  ON 43
 eH2_4                 1.803056e-02 1 1  ON 44
 eH2_5                 2.079466e-02 1 1  ON 45
 eH2_6                 6.860514e-02 1 1  ON 46
 eH2_7                 1.066163e-01 1 1  ON 47
 eH2_8                 1.032382e-01 1 1  ON 48
 eH2_9                 2.803178e-02 1 1  ON 49
ci_001                -4.299413e-02 3 1  ON 50
ci_002                -3.163115e-02 3 1  ON 51
ci_003                -2.579466e-02 3 1  ON 52
ci_004                 2.496109e-02 3 1  ON 53
ci_005                 2.449847e-02 3 1  ON 54
ci_006                -2.038747e-02 3 1  ON 55
ci_007                -2.071663e-02 3 1  ON 56
ci_008                -9.120420e-03 3 1  ON 57
ci_009                -1.519372e-02 3 1  ON 58
ci_010                -9.447088e-03 3 1  ON 59
ci_011                -1.066065e-02 3 1  ON 60
ci_012                -1.038034e-02 3 1  ON 61
ci_013                -1.942640e-02 3 1  ON 62
ci_014                 1.252455e-02 3 1  ON 63
ci_015                 1.361968e-02 3 1  ON 64
ci_016                 1.664270e-02 3 1  ON 65
ci_017                 1.642324e-02 3 1  ON 66
ci_018                 1.061028e-02 3 1  ON 67
ci_019                 1.026199e-02 3 1  ON 68
ci_020                 1.636307e-02 3 1  ON 69
ci_021                 1.640617e-02 3 1  ON 70
ci_022                 1.083494e-02 3 1  ON 71
ci_023                 1.005132e-02 3 1  ON 72
ci_024                 7.691961e-03 3 1  ON 73
ci_025                 8.116979e-03 3 1  ON 74
ci_026                 1.199494e-02 3 1  ON 75
ci_027                 1.157708e-02 3 1  ON 76
ci_028                -1.536635e-02 3 1  ON 77
ci_029                -1.551492e-02 3 1  ON 78
ci_030                -5.309420e-03 3 1  ON 79
ci_031                -5.103735e-03 3 1  ON 80
ci_032                -1.516288e-02 3 1  ON 81
ci_033                 7.714425e-03 3 1  ON 82
ci_034                 7.683761e-03 3 1  ON 83
ci_035                -4.822312e-03 3 1  ON 84
ci_036                -1.283407e-02 3 1  ON 85
ci_037                -1.274219e-02 3 1  ON 86
ci_038                 1.316606e-03 3 1  ON 87
ci_039                 1.522682e-03 3 1  ON 88
ci_040                -2.978798e-03 3 1  ON 89
ci_041                 8.595966e-03 3 1  ON 90
ci_042                 8.525811e-03 3 1  ON 91
ci_043                -3.625839e-03 3 1  ON 92
ci_044                -4.962204e-03 3 1  ON 93
ci_045                -2.958476e-03 3 1  ON 94
ci_046                 5.957520e-03 3 1  ON 95
ci_047                 5.934977e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4848e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7182e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2778
    reference variance = 0.329427
====================================================
  Execution time = 2.7186e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0492e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8808e-01
  Total weights = 1.966299533e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7014e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279369476330
                                         uncertainty =       0.001810696195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279369476330
                                         uncertainty =       0.001810696195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373730734
  error estimate for blocks of size 2^( 2) =       0.000388087505
  error estimate for blocks of size 2^( 3) =       0.000400909671
  error estimate for blocks of size 2^( 4) =       0.000409700573
  error estimate for blocks of size 2^( 5) =       0.000415755291
  error estimate for blocks of size 2^( 6) =       0.000419350887
  error estimate for blocks of size 2^( 7) =       0.000420793037

      target function =      -0.915748775514
              le_mean =     -17.210749753710
             les_mean =     296.497986361533
             stat err =       0.000416399947
             autocorr =       1.241377030185
   target nu stat err =       0.000416399947
   target dn stat err =       0.002291047269
      target stat err =       0.003031397715
              std dev =       0.528543528553
             le_variance =       0.279358261576


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721074975371e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915757972903       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915876417986       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915923913506       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915937629599       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915941404921       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915943221013       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915945378373       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915944751147       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915945552636       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915945971180       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915947526580       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915947811609       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915948848013       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915949922704       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915955024660       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915957733370       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915959848075       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915962754634       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915964829138       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915967798482       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915968321991       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915967441674       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915968275980       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915968617658       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915969127413       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915968615226       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915969399508       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915970222175       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915971491627       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915971260954       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915970927458       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915971527211       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915971582717       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915972059306       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915972382883       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915972092363       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915971702638       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915971327559       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915971545627       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915971811211       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.915971800588       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.915971831819       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.915971949807       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.915972332268       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.915972212564       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.915972320072       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.915972294651       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.915972406984       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.915972607662       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.915972765418       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.915972772866       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.915972863889       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.915972842879       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.915972833770       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         53 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e-02 is 8.960034e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915757972903       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915816737279       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915838674178       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915844826973       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915846249950       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915846782734       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915847730542       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915847415739       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915847675516       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915847793994       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915848392335       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915848511350       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915848983904       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915849567944       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915851922648       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915852717679       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915853230726       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915854164021       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915854693917       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915855253587       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915855097874       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915854819575       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915855144127       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915855116695       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915855178425       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915855065753       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915855383907       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915855461618       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915855481209       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915855405535       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915855369980       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915855503888       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915855595820       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915855580553       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915855651341       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915855479224       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915855422861       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915855463892       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915855447712       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915855490000       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.915855469434       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.915855502566       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.915855516215       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.915855559682       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.915855559904       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.915855536108       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.915855544674       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.915855560369       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e-01 is 2.402508e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915757972903       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915777459968       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915784383862       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915786319534       residual = 9.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915786697273       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915786834180       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915787114544       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915787004394       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915787078525       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915787106968       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915787280647       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915787309841       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915787469441       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915787681677       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915788386451       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915788553743       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915788660872       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915788894499       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915789012815       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915789096024       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915789037337       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915788977327       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915789069644       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915789042035       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915789054303       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915789035917       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915789110314       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915789107220       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915789095181       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915789085991       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915789088008       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915789119324       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915789137356       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915789118556       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915789126904       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915789099074       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915789086411       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915789102135       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915789098221       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915789101324       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 6.189524e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.656628 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6025e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.079619e-01 1 1  ON 0
  uu_1                 5.192032e-02 1 1  ON 1
  uu_2                -3.728251e-02 1 1  ON 2
  uu_3                -9.061630e-02 1 1  ON 3
  uu_4                -1.224212e-01 1 1  ON 4
  uu_5                -1.311615e-01 1 1  ON 5
  uu_6                -1.132184e-01 1 1  ON 6
  uu_7                -5.452742e-02 1 1  ON 7
  uu_8                 6.153096e-02 1 1  ON 8
  uu_9                 1.219584e-01 1 1  ON 9
  ud_0                 3.014155e-01 1 1  ON 10
  ud_1                 7.406597e-02 1 1  ON 11
  ud_2                -2.535621e-02 1 1  ON 12
  ud_3                -7.657628e-02 1 1  ON 13
  ud_4                -1.121635e-01 1 1  ON 14
  ud_5                -1.321178e-01 1 1  ON 15
  ud_6                -1.277480e-01 1 1  ON 16
  ud_7                -8.956690e-02 1 1  ON 17
  ud_8                -3.598237e-03 1 1  ON 18
  ud_9                 8.568000e-02 1 1  ON 19
  eO_0                -6.930100e-01 1 1  ON 20
  eO_1                -4.125655e-01 1 1  ON 21
  eO_2                -4.032097e-02 1 1  ON 22
  eO_3                 1.792040e-01 1 1  ON 23
  eO_4                 2.504562e-01 1 1  ON 24
  eO_5                 2.733824e-01 1 1  ON 25
  eO_6                 2.473450e-01 1 1  ON 26
  eO_7                 1.359126e-01 1 1  ON 27
  eO_8                 2.891239e-02 1 1  ON 28
  eO_9                 1.931587e-02 1 1  ON 29
 eH1_0                -2.053632e-01 1 1  ON 30
 eH1_1                -1.002040e-01 1 1  ON 31
 eH1_2                -4.884611e-02 1 1  ON 32
 eH1_3                -1.726078e-02 1 1  ON 33
 eH1_4                 1.790272e-02 1 1  ON 34
 eH1_5                 2.553551e-02 1 1  ON 35
 eH1_6                 7.800779e-02 1 1  ON 36
 eH1_7                 1.061844e-01 1 1  ON 37
 eH1_8                 1.023600e-01 1 1  ON 38
 eH1_9                 2.563156e-02 1 1  ON 39
 eH2_0                -2.008155e-01 1 1  ON 40
 eH2_1                -9.602373e-02 1 1  ON 41
 eH2_2                -4.547574e-02 1 1  ON 42
 eH2_3                -1.516271e-02 1 1  ON 43
 eH2_4                 1.817679e-02 1 1  ON 44
 eH2_5                 2.073291e-02 1 1  ON 45
 eH2_6                 6.783400e-02 1 1  ON 46
 eH2_7                 1.052969e-01 1 1  ON 47
 eH2_8                 1.042263e-01 1 1  ON 48
 eH2_9                 2.828258e-02 1 1  ON 49
ci_001                -4.287180e-02 3 1  ON 50
ci_002                -3.160467e-02 3 1  ON 51
ci_003                -2.548808e-02 3 1  ON 52
ci_004                 2.479452e-02 3 1  ON 53
ci_005                 2.474906e-02 3 1  ON 54
ci_006                -2.040729e-02 3 1  ON 55
ci_007                -2.039326e-02 3 1  ON 56
ci_008                -8.885932e-03 3 1  ON 57
ci_009                -1.496788e-02 3 1  ON 58
ci_010                -9.223498e-03 3 1  ON 59
ci_011                -1.036351e-02 3 1  ON 60
ci_012                -1.025870e-02 3 1  ON 61
ci_013                -1.951212e-02 3 1  ON 62
ci_014                 1.294642e-02 3 1  ON 63
ci_015                 1.361590e-02 3 1  ON 64
ci_016                 1.644995e-02 3 1  ON 65
ci_017                 1.641939e-02 3 1  ON 66
ci_018                 1.037058e-02 3 1  ON 67
ci_019                 1.032706e-02 3 1  ON 68
ci_020                 1.650390e-02 3 1  ON 69
ci_021                 1.636541e-02 3 1  ON 70
ci_022                 1.055370e-02 3 1  ON 71
ci_023                 1.044108e-02 3 1  ON 72
ci_024                 7.588310e-03 3 1  ON 73
ci_025                 8.368767e-03 3 1  ON 74
ci_026                 1.203885e-02 3 1  ON 75
ci_027                 1.156874e-02 3 1  ON 76
ci_028                -1.504265e-02 3 1  ON 77
ci_029                -1.582251e-02 3 1  ON 78
ci_030                -5.082740e-03 3 1  ON 79
ci_031                -4.954020e-03 3 1  ON 80
ci_032                -1.513212e-02 3 1  ON 81
ci_033                 7.664699e-03 3 1  ON 82
ci_034                 7.733369e-03 3 1  ON 83
ci_035                -4.694601e-03 3 1  ON 84
ci_036                -1.262662e-02 3 1  ON 85
ci_037                -1.269410e-02 3 1  ON 86
ci_038                 1.209321e-03 3 1  ON 87
ci_039                 1.508839e-03 3 1  ON 88
ci_040                -2.848198e-03 3 1  ON 89
ci_041                 8.403996e-03 3 1  ON 90
ci_042                 8.523266e-03 3 1  ON 91
ci_043                -3.565408e-03 3 1  ON 92
ci_044                -4.514099e-03 3 1  ON 93
ci_045                -2.790080e-03 3 1  ON 94
ci_046                 5.787709e-03 3 1  ON 95
ci_047                 5.912047e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1856
    reference variance = 0.145991
====================================================
  Execution time = 2.6995e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8851e-01
  Total weights = 1.9664e+06
  Execution time = 2.3624e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278572157190
                                         uncertainty =       0.002034046131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278572157190
                                         uncertainty =       0.002034046131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373150466
  error estimate for blocks of size 2^( 2) =       0.000386879060
  error estimate for blocks of size 2^( 3) =       0.000399921293
  error estimate for blocks of size 2^( 4) =       0.000409203104
  error estimate for blocks of size 2^( 5) =       0.000413870364
  error estimate for blocks of size 2^( 6) =       0.000417160814
  error estimate for blocks of size 2^( 7) =       0.000416993494

      target function =      -0.912473346389
              le_mean =     -17.209718086713
             les_mean =     296.464798344079
             stat err =       0.000414306944
             autocorr =       1.232754077592
   target nu stat err =       0.000414306944
   target dn stat err =       0.003178509830
      target stat err =       0.004130744220
              std dev =       0.527722893370
             le_variance =       0.278491452187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278417321262
                                         uncertainty =       0.002014670864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278417321262
                                         uncertainty =       0.002014670864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373046776
  error estimate for blocks of size 2^( 2) =       0.000386871381
  error estimate for blocks of size 2^( 3) =       0.000400012730
  error estimate for blocks of size 2^( 4) =       0.000409378720
  error estimate for blocks of size 2^( 5) =       0.000414095027
  error estimate for blocks of size 2^( 6) =       0.000417456242
  error estimate for blocks of size 2^( 7) =       0.000417316292

      target function =      -0.908624039665
              le_mean =     -17.209729752859
             les_mean =     296.468182705852
             stat err =       0.000414561570
             autocorr =       1.234956040585
   target nu stat err =       0.000414561570
   target dn stat err =       0.005232257815
      target stat err =       0.006700433464
              std dev =       0.527576251565
             le_variance =       0.278336701215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278415842843
                                         uncertainty =       0.002014639730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278415842843
                                         uncertainty =       0.002014639730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373045785
  error estimate for blocks of size 2^( 2) =       0.000386862013
  error estimate for blocks of size 2^( 3) =       0.000399994082
  error estimate for blocks of size 2^( 4) =       0.000409351282
  error estimate for blocks of size 2^( 5) =       0.000414063621
  error estimate for blocks of size 2^( 6) =       0.000417421755
  error estimate for blocks of size 2^( 7) =       0.000417286571

      target function =      -0.913727808733
              le_mean =     -17.209728210591
             les_mean =     296.464175521557
             stat err =       0.000414530807
             autocorr =       1.234779323974
   target nu stat err =       0.000414530807
   target dn stat err =       0.003123797571
      target stat err =       0.004072240072
              std dev =       0.527574850150
             le_variance =       0.278335222510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278527241439
                                         uncertainty =       0.002030331053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278527241439
                                         uncertainty =       0.002030331053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373120395
  error estimate for blocks of size 2^( 2) =       0.000386862797
  error estimate for blocks of size 2^( 3) =       0.000399919934
  error estimate for blocks of size 2^( 4) =       0.000409214790
  error estimate for blocks of size 2^( 5) =       0.000413888103
  error estimate for blocks of size 2^( 6) =       0.000417187547
  error estimate for blocks of size 2^( 7) =       0.000417026052

      target function =      -0.914451501935
              le_mean =     -17.209716782647
             les_mean =     296.463219940880
             stat err =       0.000414329123
             autocorr =       1.233084800630
   target nu stat err =       0.000414329123
   target dn stat err =       0.003055172716
      target stat err =       0.003990778374
              std dev =       0.527680365336
             le_variance =       0.278446567961


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912473346389        initial
     3.9062e-02     3.9062e-01             8.9600e-03        -0.908624039665
     1.5625e-01     1.5625e+00             2.4025e-03        -0.913727808733
     6.2500e-01     6.2500e+00             6.1895e-04        -0.914451501935  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.8906e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.080215e-01 1 1  ON 0
  uu_1                 5.183876e-02 1 1  ON 1
  uu_2                -3.748103e-02 1 1  ON 2
  uu_3                -9.077115e-02 1 1  ON 3
  uu_4                -1.227203e-01 1 1  ON 4
  uu_5                -1.316995e-01 1 1  ON 5
  uu_6                -1.134237e-01 1 1  ON 6
  uu_7                -5.409407e-02 1 1  ON 7
  uu_8                 6.331451e-02 1 1  ON 8
  uu_9                 1.218184e-01 1 1  ON 9
  ud_0                 3.017572e-01 1 1  ON 10
  ud_1                 7.437251e-02 1 1  ON 11
  ud_2                -2.499665e-02 1 1  ON 12
  ud_3                -7.616876e-02 1 1  ON 13
  ud_4                -1.118492e-01 1 1  ON 14
  ud_5                -1.321515e-01 1 1  ON 15
  ud_6                -1.284006e-01 1 1  ON 16
  ud_7                -9.045411e-02 1 1  ON 17
  ud_8                -2.991542e-03 1 1  ON 18
  ud_9                 8.553840e-02 1 1  ON 19
  eO_0                -6.931445e-01 1 1  ON 20
  eO_1                -4.127385e-01 1 1  ON 21
  eO_2                -4.037907e-02 1 1  ON 22
  eO_3                 1.795219e-01 1 1  ON 23
  eO_4                 2.510475e-01 1 1  ON 24
  eO_5                 2.748888e-01 1 1  ON 25
  eO_6                 2.472745e-01 1 1  ON 26
  eO_7                 1.341805e-01 1 1  ON 27
  eO_8                 2.873467e-02 1 1  ON 28
  eO_9                 1.932798e-02 1 1  ON 29
 eH1_0                -2.048484e-01 1 1  ON 30
 eH1_1                -9.982001e-02 1 1  ON 31
 eH1_2                -4.857601e-02 1 1  ON 32
 eH1_3                -1.685932e-02 1 1  ON 33
 eH1_4                 1.825329e-02 1 1  ON 34
 eH1_5                 2.534529e-02 1 1  ON 35
 eH1_6                 7.678150e-02 1 1  ON 36
 eH1_7                 1.065511e-01 1 1  ON 37
 eH1_8                 1.016734e-01 1 1  ON 38
 eH1_9                 2.549225e-02 1 1  ON 39
 eH2_0                -2.008887e-01 1 1  ON 40
 eH2_1                -9.610856e-02 1 1  ON 41
 eH2_2                -4.564710e-02 1 1  ON 42
 eH2_3                -1.531859e-02 1 1  ON 43
 eH2_4                 1.807507e-02 1 1  ON 44
 eH2_5                 2.077416e-02 1 1  ON 45
 eH2_6                 6.838142e-02 1 1  ON 46
 eH2_7                 1.062843e-01 1 1  ON 47
 eH2_8                 1.034843e-01 1 1  ON 48
 eH2_9                 2.809301e-02 1 1  ON 49
ci_001                -4.295507e-02 3 1  ON 50
ci_002                -3.162185e-02 3 1  ON 51
ci_003                -2.569904e-02 3 1  ON 52
ci_004                 2.490754e-02 3 1  ON 53
ci_005                 2.457681e-02 3 1  ON 54
ci_006                -2.039320e-02 3 1  ON 55
ci_007                -2.061479e-02 3 1  ON 56
ci_008                -9.043152e-03 3 1  ON 57
ci_009                -1.511981e-02 3 1  ON 58
ci_010                -9.374323e-03 3 1  ON 59
ci_011                -1.056417e-02 3 1  ON 60
ci_012                -1.034061e-02 3 1  ON 61
ci_013                -1.945179e-02 3 1  ON 62
ci_014                 1.266002e-02 3 1  ON 63
ci_015                 1.361835e-02 3 1  ON 64
ci_016                 1.658306e-02 3 1  ON 65
ci_017                 1.642128e-02 3 1  ON 66
ci_018                 1.053115e-02 3 1  ON 67
ci_019                 1.028213e-02 3 1  ON 68
ci_020                 1.640635e-02 3 1  ON 69
ci_021                 1.639447e-02 3 1  ON 70
ci_022                 1.074408e-02 3 1  ON 71
ci_023                 1.017677e-02 3 1  ON 72
ci_024                 7.659603e-03 3 1  ON 73
ci_025                 8.197549e-03 3 1  ON 74
ci_026                 1.201028e-02 3 1  ON 75
ci_027                 1.157221e-02 3 1  ON 76
ci_028                -1.526515e-02 3 1  ON 77
ci_029                -1.561212e-02 3 1  ON 78
ci_030                -5.234247e-03 3 1  ON 79
ci_031                -5.054262e-03 3 1  ON 80
ci_032                -1.515262e-02 3 1  ON 81
ci_033                 7.698707e-03 3 1  ON 82
ci_034                 7.700225e-03 3 1  ON 83
ci_035                -4.780226e-03 3 1  ON 84
ci_036                -1.276776e-02 3 1  ON 85
ci_037                -1.272887e-02 3 1  ON 86
ci_038                 1.280889e-03 3 1  ON 87
ci_039                 1.517911e-03 3 1  ON 88
ci_040                -2.935461e-03 3 1  ON 89
ci_041                 8.534573e-03 3 1  ON 90
ci_042                 8.522891e-03 3 1  ON 91
ci_043                -3.605958e-03 3 1  ON 92
ci_044                -4.816475e-03 3 1  ON 93
ci_045                -2.902503e-03 3 1  ON 94
ci_046                 5.902707e-03 3 1  ON 95
ci_047                 5.927415e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4939e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7185e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2576
    reference variance = 0.547985
====================================================
  Execution time = 2.7120e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0468e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8518e-01
  Total weights = 1.966322217e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3725e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276615568269
                                         uncertainty =       0.001545715762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276615568269
                                         uncertainty =       0.001545715762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371847875
  error estimate for blocks of size 2^( 2) =       0.000386216431
  error estimate for blocks of size 2^( 3) =       0.000398863401
  error estimate for blocks of size 2^( 4) =       0.000409000607
  error estimate for blocks of size 2^( 5) =       0.000413499813
  error estimate for blocks of size 2^( 6) =       0.000416426941
  error estimate for blocks of size 2^( 7) =       0.000417703758

      target function =      -0.919174164971
              le_mean =     -17.209432555349
             les_mean =     296.449749306784
             stat err =       0.000414157780
             autocorr =       1.240512199404
   target nu stat err =       0.000414157780
   target dn stat err =       0.002012595735
      target stat err =       0.002691244529
              std dev =       0.525880722000
             le_variance =       0.276550533771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720943255535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919181327989       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919252593733       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919282389021       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919292296092       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919295551464       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919297525947       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919298188424       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919298788753       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919298982563       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919298855873       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919299808240       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919300035714       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919300354829       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919301437975       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919302186993       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919302599799       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919303163009       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919303088065       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919302763686       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919303753724       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919303995399       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919304320981       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919304562038       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919304299546       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919304260010       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919304242094       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919304218884       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919304189221       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919304457224       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919304676757       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919304802811       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919304713227       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919304731371       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919304785751       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919304780552       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919304760755       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919304921473       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919304922643       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919304927672       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919304847764       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.919304861224       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.919304878199       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.919304899609       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.919304883049       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.919304902668       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.919304891300       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.919304888482       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.919304871630       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e-01 is 2.234117e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919181327989       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919205244603       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919214680315       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919217623748       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919218599451       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919219157842       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919219343490       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919219492922       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919219518097       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919219482040       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919219774288       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919219850950       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919219927801       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919220262384       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919220467862       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919220559270       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919220676990       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919220637278       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919220579956       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919220852242       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919220913468       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919220990273       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919221030553       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919220945551       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919220937775       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919220936234       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919220914213       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919220908759       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919220996067       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919221031158       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919221054428       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919221030950       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919221052199       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919221045812       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919221038101       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919221049594       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919221081517       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919221067181       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919221065272       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919221056346       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.919221057787       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.919221062813       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 6.353898e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919181327989       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919187866810       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919190392119       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919191161688       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919191418559       residual = 7.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919191562593       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919191610233       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919191646054       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919191651175       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919191641159       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919191718477       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919191740273       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919191758367       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919191847169       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919191899154       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919191920152       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919191947223       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919191936467       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919191925540       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919191993822       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919192008986       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919192027059       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919192034938       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919192013066       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919192011426       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919192010925       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919192003717       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919192003349       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919192026481       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919192033881       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919192038772       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919192032985       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919192038744       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919192036111       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919192034710       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919192037870       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919192044732       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919192041058       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919192040650       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919192038858       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.919192039133       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+00 is 1.641883e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.753421 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5597e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.079755e-01 1 1  ON 0
  uu_1                 5.180321e-02 1 1  ON 1
  uu_2                -3.751700e-02 1 1  ON 2
  uu_3                -9.075111e-02 1 1  ON 3
  uu_4                -1.226122e-01 1 1  ON 4
  uu_5                -1.315750e-01 1 1  ON 5
  uu_6                -1.133496e-01 1 1  ON 6
  uu_7                -5.421601e-02 1 1  ON 7
  uu_8                 6.305566e-02 1 1  ON 8
  uu_9                 1.218481e-01 1 1  ON 9
  ud_0                 3.016088e-01 1 1  ON 10
  ud_1                 7.420496e-02 1 1  ON 11
  ud_2                -2.518122e-02 1 1  ON 12
  ud_3                -7.638978e-02 1 1  ON 13
  ud_4                -1.120972e-01 1 1  ON 14
  ud_5                -1.322646e-01 1 1  ON 15
  ud_6                -1.281256e-01 1 1  ON 16
  ud_7                -8.981873e-02 1 1  ON 17
  ud_8                -2.919971e-03 1 1  ON 18
  ud_9                 8.546725e-02 1 1  ON 19
  eO_0                -6.932771e-01 1 1  ON 20
  eO_1                -4.129244e-01 1 1  ON 21
  eO_2                -4.055235e-02 1 1  ON 22
  eO_3                 1.794567e-01 1 1  ON 23
  eO_4                 2.510846e-01 1 1  ON 24
  eO_5                 2.746439e-01 1 1  ON 25
  eO_6                 2.474906e-01 1 1  ON 26
  eO_7                 1.346340e-01 1 1  ON 27
  eO_8                 2.881939e-02 1 1  ON 28
  eO_9                 1.932491e-02 1 1  ON 29
 eH1_0                -2.047999e-01 1 1  ON 30
 eH1_1                -9.971243e-02 1 1  ON 31
 eH1_2                -4.856109e-02 1 1  ON 32
 eH1_3                -1.700953e-02 1 1  ON 33
 eH1_4                 1.800694e-02 1 1  ON 34
 eH1_5                 2.518938e-02 1 1  ON 35
 eH1_6                 7.687492e-02 1 1  ON 36
 eH1_7                 1.065447e-01 1 1  ON 37
 eH1_8                 1.018760e-01 1 1  ON 38
 eH1_9                 2.558713e-02 1 1  ON 39
 eH2_0                -2.008658e-01 1 1  ON 40
 eH2_1                -9.621253e-02 1 1  ON 41
 eH2_2                -4.577981e-02 1 1  ON 42
 eH2_3                -1.541425e-02 1 1  ON 43
 eH2_4                 1.802076e-02 1 1  ON 44
 eH2_5                 2.081356e-02 1 1  ON 45
 eH2_6                 6.847976e-02 1 1  ON 46
 eH2_7                 1.062279e-01 1 1  ON 47
 eH2_8                 1.037564e-01 1 1  ON 48
 eH2_9                 2.809214e-02 1 1  ON 49
ci_001                -4.297190e-02 3 1  ON 50
ci_002                -3.144567e-02 3 1  ON 51
ci_003                -2.574216e-02 3 1  ON 52
ci_004                 2.480552e-02 3 1  ON 53
ci_005                 2.446462e-02 3 1  ON 54
ci_006                -2.040334e-02 3 1  ON 55
ci_007                -2.067088e-02 3 1  ON 56
ci_008                -8.998954e-03 3 1  ON 57
ci_009                -1.517580e-02 3 1  ON 58
ci_010                -9.420493e-03 3 1  ON 59
ci_011                -1.067297e-02 3 1  ON 60
ci_012                -1.038093e-02 3 1  ON 61
ci_013                -1.941648e-02 3 1  ON 62
ci_014                 1.277451e-02 3 1  ON 63
ci_015                 1.363218e-02 3 1  ON 64
ci_016                 1.656975e-02 3 1  ON 65
ci_017                 1.639372e-02 3 1  ON 66
ci_018                 1.042124e-02 3 1  ON 67
ci_019                 1.024292e-02 3 1  ON 68
ci_020                 1.651308e-02 3 1  ON 69
ci_021                 1.637199e-02 3 1  ON 70
ci_022                 1.081341e-02 3 1  ON 71
ci_023                 1.016532e-02 3 1  ON 72
ci_024                 7.613752e-03 3 1  ON 73
ci_025                 8.107584e-03 3 1  ON 74
ci_026                 1.204216e-02 3 1  ON 75
ci_027                 1.159428e-02 3 1  ON 76
ci_028                -1.513333e-02 3 1  ON 77
ci_029                -1.555904e-02 3 1  ON 78
ci_030                -5.186442e-03 3 1  ON 79
ci_031                -5.003712e-03 3 1  ON 80
ci_032                -1.520672e-02 3 1  ON 81
ci_033                 7.537634e-03 3 1  ON 82
ci_034                 7.732050e-03 3 1  ON 83
ci_035                -4.766500e-03 3 1  ON 84
ci_036                -1.275373e-02 3 1  ON 85
ci_037                -1.268451e-02 3 1  ON 86
ci_038                 1.292063e-03 3 1  ON 87
ci_039                 1.565851e-03 3 1  ON 88
ci_040                -2.946618e-03 3 1  ON 89
ci_041                 8.556933e-03 3 1  ON 90
ci_042                 8.509738e-03 3 1  ON 91
ci_043                -3.596346e-03 3 1  ON 92
ci_044                -4.726073e-03 3 1  ON 93
ci_045                -2.921047e-03 3 1  ON 94
ci_046                 5.844347e-03 3 1  ON 95
ci_047                 5.936098e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2298
    reference variance = 0.119486
====================================================
  Execution time = 2.6907e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8999e-01
  Total weights = 1.9664e+06
  Execution time = 2.3704e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277117363210
                                         uncertainty =       0.001704487569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277117363210
                                         uncertainty =       0.001704487569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372251993
  error estimate for blocks of size 2^( 2) =       0.000386241777
  error estimate for blocks of size 2^( 3) =       0.000399160509
  error estimate for blocks of size 2^( 4) =       0.000408521328
  error estimate for blocks of size 2^( 5) =       0.000413741484
  error estimate for blocks of size 2^( 6) =       0.000417696361
  error estimate for blocks of size 2^( 7) =       0.000418546974

      target function =      -0.882053086348
              le_mean =     -17.209759868862
             les_mean =     296.490090730140
             stat err =       0.000414626537
             autocorr =       1.240623848616
   target nu stat err =       0.000414626537
   target dn stat err =       0.021463688528
      target stat err =       0.025832532244
              std dev =       0.526452240047
             le_variance =       0.277151961050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277085421623
                                         uncertainty =       0.001698103090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277085421623
                                         uncertainty =       0.001698103090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372231962
  error estimate for blocks of size 2^( 2) =       0.000386241858
  error estimate for blocks of size 2^( 3) =       0.000399185013
  error estimate for blocks of size 2^( 4) =       0.000408553961
  error estimate for blocks of size 2^( 5) =       0.000413784057
  error estimate for blocks of size 2^( 6) =       0.000417731243
  error estimate for blocks of size 2^( 7) =       0.000418532004

      target function =      -0.903448574019
              le_mean =     -17.209751505519
             les_mean =     296.472972272985
             stat err =       0.000414650316
             autocorr =       1.240899698384
   target nu stat err =       0.000414650316
   target dn stat err =       0.007658370672
      target stat err =       0.009677495711
              std dev =       0.526423911443
             le_variance =       0.277122134539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277082599960
                                         uncertainty =       0.001700163656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277082599960
                                         uncertainty =       0.001700163656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372229562
  error estimate for blocks of size 2^( 2) =       0.000386231857
  error estimate for blocks of size 2^( 3) =       0.000399165262
  error estimate for blocks of size 2^( 4) =       0.000408529565
  error estimate for blocks of size 2^( 5) =       0.000413757248
  error estimate for blocks of size 2^( 6) =       0.000417707434
  error estimate for blocks of size 2^( 7) =       0.000418529327

      target function =      -0.914475272874
              le_mean =     -17.209753041566
             les_mean =     296.464455006370
             stat err =       0.000414630893
             autocorr =       1.240799451524
   target nu stat err =       0.000414630893
   target dn stat err =       0.003253038448
      target stat err =       0.004244367564
              std dev =       0.526420516976
             le_variance =       0.277118560693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277106771410
                                         uncertainty =       0.001703828491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277106771410
                                         uncertainty =       0.001703828491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372245009
  error estimate for blocks of size 2^( 2) =       0.000386236421
  error estimate for blocks of size 2^( 3) =       0.000399156866
  error estimate for blocks of size 2^( 4) =       0.000408517262
  error estimate for blocks of size 2^( 5) =       0.000413740272
  error estimate for blocks of size 2^( 6) =       0.000417691007
  error estimate for blocks of size 2^( 7) =       0.000418545650

      target function =      -0.908413911423
              le_mean =     -17.209757995224
             les_mean =     296.469294127314
             stat err =       0.000414623548
             autocorr =       1.240652514323
   target nu stat err =       0.000414623548
   target dn stat err =       0.007027637561
      target stat err =       0.008981091790
              std dev =       0.526442362851
             le_variance =       0.277141561404


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.882053086348        initial
     1.5625e-01     1.5625e+00             2.2341e-03        -0.903448574019
     6.2500e-01     6.2500e+00             6.3539e-04        -0.914475272874  <--
     2.5000e+00     2.5000e+01             1.6419e-04        -0.908413911423

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.8836e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.079755e-01 1 1  ON 0
  uu_1                 5.180321e-02 1 1  ON 1
  uu_2                -3.751700e-02 1 1  ON 2
  uu_3                -9.075111e-02 1 1  ON 3
  uu_4                -1.226122e-01 1 1  ON 4
  uu_5                -1.315750e-01 1 1  ON 5
  uu_6                -1.133496e-01 1 1  ON 6
  uu_7                -5.421601e-02 1 1  ON 7
  uu_8                 6.305566e-02 1 1  ON 8
  uu_9                 1.218481e-01 1 1  ON 9
  ud_0                 3.016088e-01 1 1  ON 10
  ud_1                 7.420496e-02 1 1  ON 11
  ud_2                -2.518122e-02 1 1  ON 12
  ud_3                -7.638978e-02 1 1  ON 13
  ud_4                -1.120972e-01 1 1  ON 14
  ud_5                -1.322646e-01 1 1  ON 15
  ud_6                -1.281256e-01 1 1  ON 16
  ud_7                -8.981873e-02 1 1  ON 17
  ud_8                -2.919971e-03 1 1  ON 18
  ud_9                 8.546725e-02 1 1  ON 19
  eO_0                -6.932771e-01 1 1  ON 20
  eO_1                -4.129244e-01 1 1  ON 21
  eO_2                -4.055235e-02 1 1  ON 22
  eO_3                 1.794567e-01 1 1  ON 23
  eO_4                 2.510846e-01 1 1  ON 24
  eO_5                 2.746439e-01 1 1  ON 25
  eO_6                 2.474906e-01 1 1  ON 26
  eO_7                 1.346340e-01 1 1  ON 27
  eO_8                 2.881939e-02 1 1  ON 28
  eO_9                 1.932491e-02 1 1  ON 29
 eH1_0                -2.047999e-01 1 1  ON 30
 eH1_1                -9.971243e-02 1 1  ON 31
 eH1_2                -4.856109e-02 1 1  ON 32
 eH1_3                -1.700953e-02 1 1  ON 33
 eH1_4                 1.800694e-02 1 1  ON 34
 eH1_5                 2.518938e-02 1 1  ON 35
 eH1_6                 7.687492e-02 1 1  ON 36
 eH1_7                 1.065447e-01 1 1  ON 37
 eH1_8                 1.018760e-01 1 1  ON 38
 eH1_9                 2.558713e-02 1 1  ON 39
 eH2_0                -2.008658e-01 1 1  ON 40
 eH2_1                -9.621253e-02 1 1  ON 41
 eH2_2                -4.577981e-02 1 1  ON 42
 eH2_3                -1.541425e-02 1 1  ON 43
 eH2_4                 1.802076e-02 1 1  ON 44
 eH2_5                 2.081356e-02 1 1  ON 45
 eH2_6                 6.847976e-02 1 1  ON 46
 eH2_7                 1.062279e-01 1 1  ON 47
 eH2_8                 1.037564e-01 1 1  ON 48
 eH2_9                 2.809214e-02 1 1  ON 49
ci_001                -4.297190e-02 3 1  ON 50
ci_002                -3.144567e-02 3 1  ON 51
ci_003                -2.574216e-02 3 1  ON 52
ci_004                 2.480552e-02 3 1  ON 53
ci_005                 2.446462e-02 3 1  ON 54
ci_006                -2.040334e-02 3 1  ON 55
ci_007                -2.067088e-02 3 1  ON 56
ci_008                -8.998954e-03 3 1  ON 57
ci_009                -1.517580e-02 3 1  ON 58
ci_010                -9.420493e-03 3 1  ON 59
ci_011                -1.067297e-02 3 1  ON 60
ci_012                -1.038093e-02 3 1  ON 61
ci_013                -1.941648e-02 3 1  ON 62
ci_014                 1.277451e-02 3 1  ON 63
ci_015                 1.363218e-02 3 1  ON 64
ci_016                 1.656975e-02 3 1  ON 65
ci_017                 1.639372e-02 3 1  ON 66
ci_018                 1.042124e-02 3 1  ON 67
ci_019                 1.024292e-02 3 1  ON 68
ci_020                 1.651308e-02 3 1  ON 69
ci_021                 1.637199e-02 3 1  ON 70
ci_022                 1.081341e-02 3 1  ON 71
ci_023                 1.016532e-02 3 1  ON 72
ci_024                 7.613752e-03 3 1  ON 73
ci_025                 8.107584e-03 3 1  ON 74
ci_026                 1.204216e-02 3 1  ON 75
ci_027                 1.159428e-02 3 1  ON 76
ci_028                -1.513333e-02 3 1  ON 77
ci_029                -1.555904e-02 3 1  ON 78
ci_030                -5.186442e-03 3 1  ON 79
ci_031                -5.003712e-03 3 1  ON 80
ci_032                -1.520672e-02 3 1  ON 81
ci_033                 7.537634e-03 3 1  ON 82
ci_034                 7.732050e-03 3 1  ON 83
ci_035                -4.766500e-03 3 1  ON 84
ci_036                -1.275373e-02 3 1  ON 85
ci_037                -1.268451e-02 3 1  ON 86
ci_038                 1.292063e-03 3 1  ON 87
ci_039                 1.565851e-03 3 1  ON 88
ci_040                -2.946618e-03 3 1  ON 89
ci_041                 8.556933e-03 3 1  ON 90
ci_042                 8.509738e-03 3 1  ON 91
ci_043                -3.596346e-03 3 1  ON 92
ci_044                -4.726073e-03 3 1  ON 93
ci_045                -2.921047e-03 3 1  ON 94
ci_046                 5.844347e-03 3 1  ON 95
ci_047                 5.936098e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4439e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7189e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2313
    reference variance = 0.56144
====================================================
  Execution time = 2.7298e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0461e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8393e-01
  Total weights = 1.966014467e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1463e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276022403168
                                         uncertainty =       0.001518624766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276022403168
                                         uncertainty =       0.001518624766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371487789
  error estimate for blocks of size 2^( 2) =       0.000385766139
  error estimate for blocks of size 2^( 3) =       0.000398641535
  error estimate for blocks of size 2^( 4) =       0.000408577274
  error estimate for blocks of size 2^( 5) =       0.000413961993
  error estimate for blocks of size 2^( 6) =       0.000417983082
  error estimate for blocks of size 2^( 7) =       0.000420525618

      target function =      -0.920943262566
              le_mean =     -17.209912627342
             les_mean =     296.465021200531
             stat err =       0.000415261992
             autocorr =       1.249554720103
   target nu stat err =       0.000415261992
   target dn stat err =       0.001817157296
      target stat err =       0.002454347181
              std dev =       0.525371475142
             le_variance =       0.276015186893


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720991262734e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920948994919       residual = 3.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921016586539       residual = 6.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921031388636       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921035335544       residual = 7.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921037769727       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921039069264       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921038899822       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921038723678       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921038598670       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921038257736       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921039249132       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921038541517       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921038841679       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921039336322       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921040302320       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921040730186       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921040703677       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921041079122       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921041375888       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921041402732       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921041248589       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921041705976       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921042053595       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921042251963       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921042313690       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921042260196       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921042461151       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921042769618       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921042758313       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921042634313       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921042768995       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921042839162       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.921042765800       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921042585801       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921042583287       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921042580945       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.921042592232       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921042715647       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.921042738507       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.921042714111       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.921042720714       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.921042762735       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.921042769109       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.921042744358       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.921042728362       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.921042684336       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         45 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e-01 is 2.665728e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920948994919       residual = 3.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920971497925       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920976178376       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920977354757       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920978084400       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920978490507       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920978413781       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920978328296       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920978343450       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920978207686       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920978517485       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920978312035       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920978411267       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920978569820       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920978837688       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920978925460       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920978941193       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920979045618       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920979116031       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920979111834       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920979074891       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920979209839       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920979278630       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920979304830       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920979312193       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920979310985       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920979375630       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920979414434       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920979399391       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920979372889       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920979411687       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920979410109       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920979380877       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920979356275       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920979362950       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920979367518       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.920979366488       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.920979381962       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.920979382961       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 6.835693e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920948994919       residual = 3.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920955129337       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920956381856       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920956690273       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920956881304       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920956990664       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920956966020       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920956942101       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920956950116       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920956912491       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920956994455       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920956940891       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920956968225       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920957010275       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920957078532       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920957098352       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920957105172       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920957131916       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920957148266       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920957146770       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920957138147       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920957172192       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920957187537       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920957192515       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920957194206       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920957195404       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920957211849       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920957218180       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920957214040       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920957208003       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920957217575       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920957215515       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920957208127       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920957204175       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920957206103       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920957207006       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.920957206194       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.920957209247       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.920957209883       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+00 is 1.722069e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.836709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5534e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.081376e-01 1 1  ON 0
  uu_1                 5.189901e-02 1 1  ON 1
  uu_2                -3.742396e-02 1 1  ON 2
  uu_3                -9.064532e-02 1 1  ON 3
  uu_4                -1.225421e-01 1 1  ON 4
  uu_5                -1.315355e-01 1 1  ON 5
  uu_6                -1.134253e-01 1 1  ON 6
  uu_7                -5.444809e-02 1 1  ON 7
  uu_8                 6.237209e-02 1 1  ON 8
  uu_9                 1.218615e-01 1 1  ON 9
  ud_0                 3.015159e-01 1 1  ON 10
  ud_1                 7.412266e-02 1 1  ON 11
  ud_2                -2.522622e-02 1 1  ON 12
  ud_3                -7.640763e-02 1 1  ON 13
  ud_4                -1.121890e-01 1 1  ON 14
  ud_5                -1.323810e-01 1 1  ON 15
  ud_6                -1.282618e-01 1 1  ON 16
  ud_7                -8.956226e-02 1 1  ON 17
  ud_8                -2.917989e-03 1 1  ON 18
  ud_9                 8.542243e-02 1 1  ON 19
  eO_0                -6.934041e-01 1 1  ON 20
  eO_1                -4.129623e-01 1 1  ON 21
  eO_2                -4.072036e-02 1 1  ON 22
  eO_3                 1.792282e-01 1 1  ON 23
  eO_4                 2.510226e-01 1 1  ON 24
  eO_5                 2.748631e-01 1 1  ON 25
  eO_6                 2.474129e-01 1 1  ON 26
  eO_7                 1.350156e-01 1 1  ON 27
  eO_8                 2.886210e-02 1 1  ON 28
  eO_9                 1.932358e-02 1 1  ON 29
 eH1_0                -2.047188e-01 1 1  ON 30
 eH1_1                -9.974479e-02 1 1  ON 31
 eH1_2                -4.855935e-02 1 1  ON 32
 eH1_3                -1.709612e-02 1 1  ON 33
 eH1_4                 1.800993e-02 1 1  ON 34
 eH1_5                 2.513536e-02 1 1  ON 35
 eH1_6                 7.676700e-02 1 1  ON 36
 eH1_7                 1.065449e-01 1 1  ON 37
 eH1_8                 1.020166e-01 1 1  ON 38
 eH1_9                 2.560827e-02 1 1  ON 39
 eH2_0                -2.008674e-01 1 1  ON 40
 eH2_1                -9.629514e-02 1 1  ON 41
 eH2_2                -4.579063e-02 1 1  ON 42
 eH2_3                -1.546316e-02 1 1  ON 43
 eH2_4                 1.806616e-02 1 1  ON 44
 eH2_5                 2.107154e-02 1 1  ON 45
 eH2_6                 6.818530e-02 1 1  ON 46
 eH2_7                 1.060957e-01 1 1  ON 47
 eH2_8                 1.039260e-01 1 1  ON 48
 eH2_9                 2.815022e-02 1 1  ON 49
ci_001                -4.292186e-02 3 1  ON 50
ci_002                -3.153948e-02 3 1  ON 51
ci_003                -2.577398e-02 3 1  ON 52
ci_004                 2.479088e-02 3 1  ON 53
ci_005                 2.449493e-02 3 1  ON 54
ci_006                -2.045152e-02 3 1  ON 55
ci_007                -2.069384e-02 3 1  ON 56
ci_008                -9.057216e-03 3 1  ON 57
ci_009                -1.518885e-02 3 1  ON 58
ci_010                -9.472934e-03 3 1  ON 59
ci_011                -1.060196e-02 3 1  ON 60
ci_012                -1.044617e-02 3 1  ON 61
ci_013                -1.931689e-02 3 1  ON 62
ci_014                 1.294892e-02 3 1  ON 63
ci_015                 1.358934e-02 3 1  ON 64
ci_016                 1.646992e-02 3 1  ON 65
ci_017                 1.637098e-02 3 1  ON 66
ci_018                 1.031730e-02 3 1  ON 67
ci_019                 1.034517e-02 3 1  ON 68
ci_020                 1.653124e-02 3 1  ON 69
ci_021                 1.640011e-02 3 1  ON 70
ci_022                 1.079035e-02 3 1  ON 71
ci_023                 1.015437e-02 3 1  ON 72
ci_024                 7.644544e-03 3 1  ON 73
ci_025                 8.060468e-03 3 1  ON 74
ci_026                 1.201042e-02 3 1  ON 75
ci_027                 1.158587e-02 3 1  ON 76
ci_028                -1.508194e-02 3 1  ON 77
ci_029                -1.541661e-02 3 1  ON 78
ci_030                -5.097989e-03 3 1  ON 79
ci_031                -5.014816e-03 3 1  ON 80
ci_032                -1.521073e-02 3 1  ON 81
ci_033                 7.526341e-03 3 1  ON 82
ci_034                 7.645871e-03 3 1  ON 83
ci_035                -4.768737e-03 3 1  ON 84
ci_036                -1.268417e-02 3 1  ON 85
ci_037                -1.275663e-02 3 1  ON 86
ci_038                 1.293130e-03 3 1  ON 87
ci_039                 1.494739e-03 3 1  ON 88
ci_040                -2.953848e-03 3 1  ON 89
ci_041                 8.493043e-03 3 1  ON 90
ci_042                 8.385530e-03 3 1  ON 91
ci_043                -3.629486e-03 3 1  ON 92
ci_044                -4.685556e-03 3 1  ON 93
ci_045                -2.899421e-03 3 1  ON 94
ci_046                 5.861872e-03 3 1  ON 95
ci_047                 5.923944e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2178
    reference variance = 0.15788
====================================================
  Execution time = 2.7023e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 3.1157e-01
  Total weights = 1.9660e+06
  Execution time = 2.3809e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285064641789
                                         uncertainty =       0.006793557242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285064641789
                                         uncertainty =       0.006793557242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377481004
  error estimate for blocks of size 2^( 2) =       0.000391313965
  error estimate for blocks of size 2^( 3) =       0.000404385566
  error estimate for blocks of size 2^( 4) =       0.000414458964
  error estimate for blocks of size 2^( 5) =       0.000420421165
  error estimate for blocks of size 2^( 6) =       0.000424774145
  error estimate for blocks of size 2^( 7) =       0.000425060075

      target function =      -0.883225699600
              le_mean =     -17.209542512665
             les_mean =     296.481448053701
             stat err =       0.000421178587
             autocorr =       1.244922635476
   target nu stat err =       0.000421178587
   target dn stat err =       0.023873751913
      target stat err =       0.028804773055
              std dev =       0.533847297240
             le_variance =       0.284992936771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284713407153
                                         uncertainty =       0.006416824855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284713407153
                                         uncertainty =       0.006416824855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377249219
  error estimate for blocks of size 2^( 2) =       0.000391108771
  error estimate for blocks of size 2^( 3) =       0.000404194227
  error estimate for blocks of size 2^( 4) =       0.000414273364
  error estimate for blocks of size 2^( 5) =       0.000420245121
  error estimate for blocks of size 2^( 6) =       0.000424600754
  error estimate for blocks of size 2^( 7) =       0.000424898547

      target function =      -0.883303463236
              le_mean =     -17.209545197335
             les_mean =     296.481568804551
             stat err =       0.000421004446
             autocorr =       1.245422379739
   target nu stat err =       0.000421004446
   target dn stat err =       0.022413674902
      target stat err =       0.027045305103
              std dev =       0.533519498569
             le_variance =       0.284643055353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284812613543
                                         uncertainty =       0.006545832502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284812613543
                                         uncertainty =       0.006545832502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377314673
  error estimate for blocks of size 2^( 2) =       0.000391165531
  error estimate for blocks of size 2^( 3) =       0.000404247186
  error estimate for blocks of size 2^( 4) =       0.000414325785
  error estimate for blocks of size 2^( 5) =       0.000420294956
  error estimate for blocks of size 2^( 6) =       0.000424651086
  error estimate for blocks of size 2^( 7) =       0.000424943093

      target function =      -0.885870735946
              le_mean =     -17.209544395027
             les_mean =     296.479386606345
             stat err =       0.000421053730
             autocorr =       1.245281825301
   target nu stat err =       0.000421053730
   target dn stat err =       0.022872691152
      target stat err =       0.027760757406
              std dev =       0.533612065295
             le_variance =       0.284741836229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285020221924
                                         uncertainty =       0.006759371151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285020221924
                                         uncertainty =       0.006759371151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377451690
  error estimate for blocks of size 2^( 2) =       0.000391287568
  error estimate for blocks of size 2^( 3) =       0.000404360944
  error estimate for blocks of size 2^( 4) =       0.000414435117
  error estimate for blocks of size 2^( 5) =       0.000420399132
  error estimate for blocks of size 2^( 6) =       0.000424753009
  error estimate for blocks of size 2^( 7) =       0.000425038927

      target function =      -0.884095454148
              le_mean =     -17.209543075264
             les_mean =     296.480755291848
             stat err =       0.000421156546
             autocorr =       1.244985698535
   target nu stat err =       0.000421156546
   target dn stat err =       0.023726327484
      target stat err =       0.028683074490
              std dev =       0.533805839781
             le_variance =       0.284948674584


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.883225699600        initial
     1.5625e-01     1.5625e+00             2.6657e-03        -0.883303463236
     6.2500e-01     6.2500e+00             6.8357e-04        -0.885870735946  <--
     2.5000e+00     2.5000e+01             1.7221e-04        -0.884095454148

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.8980e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.081376e-01 1 1  ON 0
  uu_1                 5.189901e-02 1 1  ON 1
  uu_2                -3.742396e-02 1 1  ON 2
  uu_3                -9.064532e-02 1 1  ON 3
  uu_4                -1.225421e-01 1 1  ON 4
  uu_5                -1.315355e-01 1 1  ON 5
  uu_6                -1.134253e-01 1 1  ON 6
  uu_7                -5.444809e-02 1 1  ON 7
  uu_8                 6.237209e-02 1 1  ON 8
  uu_9                 1.218615e-01 1 1  ON 9
  ud_0                 3.015159e-01 1 1  ON 10
  ud_1                 7.412266e-02 1 1  ON 11
  ud_2                -2.522622e-02 1 1  ON 12
  ud_3                -7.640763e-02 1 1  ON 13
  ud_4                -1.121890e-01 1 1  ON 14
  ud_5                -1.323810e-01 1 1  ON 15
  ud_6                -1.282618e-01 1 1  ON 16
  ud_7                -8.956226e-02 1 1  ON 17
  ud_8                -2.917989e-03 1 1  ON 18
  ud_9                 8.542243e-02 1 1  ON 19
  eO_0                -6.934041e-01 1 1  ON 20
  eO_1                -4.129623e-01 1 1  ON 21
  eO_2                -4.072036e-02 1 1  ON 22
  eO_3                 1.792282e-01 1 1  ON 23
  eO_4                 2.510226e-01 1 1  ON 24
  eO_5                 2.748631e-01 1 1  ON 25
  eO_6                 2.474129e-01 1 1  ON 26
  eO_7                 1.350156e-01 1 1  ON 27
  eO_8                 2.886210e-02 1 1  ON 28
  eO_9                 1.932358e-02 1 1  ON 29
 eH1_0                -2.047188e-01 1 1  ON 30
 eH1_1                -9.974479e-02 1 1  ON 31
 eH1_2                -4.855935e-02 1 1  ON 32
 eH1_3                -1.709612e-02 1 1  ON 33
 eH1_4                 1.800993e-02 1 1  ON 34
 eH1_5                 2.513536e-02 1 1  ON 35
 eH1_6                 7.676700e-02 1 1  ON 36
 eH1_7                 1.065449e-01 1 1  ON 37
 eH1_8                 1.020166e-01 1 1  ON 38
 eH1_9                 2.560827e-02 1 1  ON 39
 eH2_0                -2.008674e-01 1 1  ON 40
 eH2_1                -9.629514e-02 1 1  ON 41
 eH2_2                -4.579063e-02 1 1  ON 42
 eH2_3                -1.546316e-02 1 1  ON 43
 eH2_4                 1.806616e-02 1 1  ON 44
 eH2_5                 2.107154e-02 1 1  ON 45
 eH2_6                 6.818530e-02 1 1  ON 46
 eH2_7                 1.060957e-01 1 1  ON 47
 eH2_8                 1.039260e-01 1 1  ON 48
 eH2_9                 2.815022e-02 1 1  ON 49
ci_001                -4.292186e-02 3 1  ON 50
ci_002                -3.153948e-02 3 1  ON 51
ci_003                -2.577398e-02 3 1  ON 52
ci_004                 2.479088e-02 3 1  ON 53
ci_005                 2.449493e-02 3 1  ON 54
ci_006                -2.045152e-02 3 1  ON 55
ci_007                -2.069384e-02 3 1  ON 56
ci_008                -9.057216e-03 3 1  ON 57
ci_009                -1.518885e-02 3 1  ON 58
ci_010                -9.472934e-03 3 1  ON 59
ci_011                -1.060196e-02 3 1  ON 60
ci_012                -1.044617e-02 3 1  ON 61
ci_013                -1.931689e-02 3 1  ON 62
ci_014                 1.294892e-02 3 1  ON 63
ci_015                 1.358934e-02 3 1  ON 64
ci_016                 1.646992e-02 3 1  ON 65
ci_017                 1.637098e-02 3 1  ON 66
ci_018                 1.031730e-02 3 1  ON 67
ci_019                 1.034517e-02 3 1  ON 68
ci_020                 1.653124e-02 3 1  ON 69
ci_021                 1.640011e-02 3 1  ON 70
ci_022                 1.079035e-02 3 1  ON 71
ci_023                 1.015437e-02 3 1  ON 72
ci_024                 7.644544e-03 3 1  ON 73
ci_025                 8.060468e-03 3 1  ON 74
ci_026                 1.201042e-02 3 1  ON 75
ci_027                 1.158587e-02 3 1  ON 76
ci_028                -1.508194e-02 3 1  ON 77
ci_029                -1.541661e-02 3 1  ON 78
ci_030                -5.097989e-03 3 1  ON 79
ci_031                -5.014816e-03 3 1  ON 80
ci_032                -1.521073e-02 3 1  ON 81
ci_033                 7.526341e-03 3 1  ON 82
ci_034                 7.645871e-03 3 1  ON 83
ci_035                -4.768737e-03 3 1  ON 84
ci_036                -1.268417e-02 3 1  ON 85
ci_037                -1.275663e-02 3 1  ON 86
ci_038                 1.293130e-03 3 1  ON 87
ci_039                 1.494739e-03 3 1  ON 88
ci_040                -2.953848e-03 3 1  ON 89
ci_041                 8.493043e-03 3 1  ON 90
ci_042                 8.385530e-03 3 1  ON 91
ci_043                -3.629486e-03 3 1  ON 92
ci_044                -4.685556e-03 3 1  ON 93
ci_045                -2.899421e-03 3 1  ON 94
ci_046                 5.861872e-03 3 1  ON 95
ci_047                 5.923944e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4521e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2198
    reference variance = 0.189959
====================================================
  Execution time = 2.7222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0501e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9070e-01
  Total weights = 1.966269257e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4373e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279793490797
                                         uncertainty =       0.004421063790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279793490797
                                         uncertainty =       0.004421063790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373987973
  error estimate for blocks of size 2^( 2) =       0.000387797022
  error estimate for blocks of size 2^( 3) =       0.000401083313
  error estimate for blocks of size 2^( 4) =       0.000410108655
  error estimate for blocks of size 2^( 5) =       0.000416034191
  error estimate for blocks of size 2^( 6) =       0.000418177044
  error estimate for blocks of size 2^( 7) =       0.000419697916

      target function =      -0.911847218173
              le_mean =     -17.208924285459
             les_mean =     296.437771338705
             stat err =       0.000416004452
             autocorr =       1.237316155437
   target nu stat err =       0.000416004452
   target dn stat err =       0.005932063381
      target stat err =       0.007634794857
              std dev =       0.528907326215
             le_variance =       0.279742959724


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720892428546e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911909739554       residual = 4.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912818269233       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912997227076       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913033279121       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913037766101       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913040868629       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913042617487       residual = 9.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913046385352       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913048446191       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913049061602       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913050186293       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913050556994       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913050466199       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913051802493       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913053200577       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913053223892       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913054474081       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913054691775       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913055995146       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913056206395       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913056124545       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913056052700       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913056203754       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913056221423       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913056576147       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913056868444       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913057156146       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913057509408       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913057700493       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913057857875       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913057775156       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913057687948       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913057678686       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913057846670       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913057939381       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913057836454       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913057710078       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913057718818       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913057747434       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.913057827664       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913057810790       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913057835035       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.913057919180       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913057994117       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.913057980209       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.913057983024       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.913057968283       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         46 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e-01 is 3.425965e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911909739554       residual = 4.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912210831164       residual = 9.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912266451387       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912278185632       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912279554775       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912280453470       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912280964627       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912282165759       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912282746217       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912282901671       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912283247219       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912283378013       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912283339718       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912283778638       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912284187919       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912284170127       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912284491655       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912284562907       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912284883773       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912284906854       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912284867020       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912284844502       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912284912693       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912284934851       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912285011441       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912285039376       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912285115668       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912285214499       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912285240330       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912285255282       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912285231628       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912285218404       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912285221734       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912285250108       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912285252723       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912285222145       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912285206883       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912285224168       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912285238103       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912285233544       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.912285236358       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.912285242502       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912285268049       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.912285273344       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.912285265615       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.912285263477       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         45 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 1.109611e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911909739554       residual = 4.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911991676101       residual = 9.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912006459207       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912009632269       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912009998572       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912010230515       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912010362944       residual = 9.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912010686438       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912010835080       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912010873310       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912010965569       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912011001641       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912010990832       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912011109732       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912011215576       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912011209000       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912011289566       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912011309288       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912011387558       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912011390473       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912011379036       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912011373767       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912011393643       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912011400117       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912011416947       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912011420888       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912011440845       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912011465508       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912011470118       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912011472308       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912011466583       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912011464095       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912011465168       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912011470462       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912011470040       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912011462758       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912011460775       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912011465959       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912011468853       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912011466477       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.912011467698       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.912011469758       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912011475628       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.912011475798       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.912011473666       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+00 is 2.996324e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.947385 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5778e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.081816e-01 1 1  ON 0
  uu_1                 5.202055e-02 1 1  ON 1
  uu_2                -3.731023e-02 1 1  ON 2
  uu_3                -9.043337e-02 1 1  ON 3
  uu_4                -1.222977e-01 1 1  ON 4
  uu_5                -1.314245e-01 1 1  ON 5
  uu_6                -1.134521e-01 1 1  ON 6
  uu_7                -5.504481e-02 1 1  ON 7
  uu_8                 6.198693e-02 1 1  ON 8
  uu_9                 1.218964e-01 1 1  ON 9
  ud_0                 3.015668e-01 1 1  ON 10
  ud_1                 7.429373e-02 1 1  ON 11
  ud_2                -2.511001e-02 1 1  ON 12
  ud_3                -7.642330e-02 1 1  ON 13
  ud_4                -1.121723e-01 1 1  ON 14
  ud_5                -1.323927e-01 1 1  ON 15
  ud_6                -1.282926e-01 1 1  ON 16
  ud_7                -8.946315e-02 1 1  ON 17
  ud_8                -3.230437e-03 1 1  ON 18
  ud_9                 8.524684e-02 1 1  ON 19
  eO_0                -6.936691e-01 1 1  ON 20
  eO_1                -4.132982e-01 1 1  ON 21
  eO_2                -4.106203e-02 1 1  ON 22
  eO_3                 1.790219e-01 1 1  ON 23
  eO_4                 2.512011e-01 1 1  ON 24
  eO_5                 2.752569e-01 1 1  ON 25
  eO_6                 2.475406e-01 1 1  ON 26
  eO_7                 1.354316e-01 1 1  ON 27
  eO_8                 2.889831e-02 1 1  ON 28
  eO_9                 1.931013e-02 1 1  ON 29
 eH1_0                -2.044131e-01 1 1  ON 30
 eH1_1                -9.969731e-02 1 1  ON 31
 eH1_2                -4.878699e-02 1 1  ON 32
 eH1_3                -1.746304e-02 1 1  ON 33
 eH1_4                 1.766568e-02 1 1  ON 34
 eH1_5                 2.524762e-02 1 1  ON 35
 eH1_6                 7.695141e-02 1 1  ON 36
 eH1_7                 1.066486e-01 1 1  ON 37
 eH1_8                 1.021541e-01 1 1  ON 38
 eH1_9                 2.564875e-02 1 1  ON 39
 eH2_0                -2.011309e-01 1 1  ON 40
 eH2_1                -9.661433e-02 1 1  ON 41
 eH2_2                -4.613715e-02 1 1  ON 42
 eH2_3                -1.562781e-02 1 1  ON 43
 eH2_4                 1.812927e-02 1 1  ON 44
 eH2_5                 2.146246e-02 1 1  ON 45
 eH2_6                 6.860824e-02 1 1  ON 46
 eH2_7                 1.061700e-01 1 1  ON 47
 eH2_8                 1.040542e-01 1 1  ON 48
 eH2_9                 2.816822e-02 1 1  ON 49
ci_001                -4.287821e-02 3 1  ON 50
ci_002                -3.135078e-02 3 1  ON 51
ci_003                -2.591582e-02 3 1  ON 52
ci_004                 2.459390e-02 3 1  ON 53
ci_005                 2.456969e-02 3 1  ON 54
ci_006                -2.037083e-02 3 1  ON 55
ci_007                -2.059044e-02 3 1  ON 56
ci_008                -8.980734e-03 3 1  ON 57
ci_009                -1.514484e-02 3 1  ON 58
ci_010                -9.230886e-03 3 1  ON 59
ci_011                -1.057787e-02 3 1  ON 60
ci_012                -1.050609e-02 3 1  ON 61
ci_013                -1.940324e-02 3 1  ON 62
ci_014                 1.298474e-02 3 1  ON 63
ci_015                 1.350704e-02 3 1  ON 64
ci_016                 1.654568e-02 3 1  ON 65
ci_017                 1.629479e-02 3 1  ON 66
ci_018                 1.036929e-02 3 1  ON 67
ci_019                 1.033341e-02 3 1  ON 68
ci_020                 1.661031e-02 3 1  ON 69
ci_021                 1.651694e-02 3 1  ON 70
ci_022                 1.078880e-02 3 1  ON 71
ci_023                 1.010890e-02 3 1  ON 72
ci_024                 7.708144e-03 3 1  ON 73
ci_025                 6.950856e-03 3 1  ON 74
ci_026                 1.202542e-02 3 1  ON 75
ci_027                 1.157656e-02 3 1  ON 76
ci_028                -1.501150e-02 3 1  ON 77
ci_029                -1.540175e-02 3 1  ON 78
ci_030                -4.912541e-03 3 1  ON 79
ci_031                -5.008585e-03 3 1  ON 80
ci_032                -1.517536e-02 3 1  ON 81
ci_033                 6.717593e-03 3 1  ON 82
ci_034                 7.573153e-03 3 1  ON 83
ci_035                -4.750989e-03 3 1  ON 84
ci_036                -1.271408e-02 3 1  ON 85
ci_037                -1.276486e-02 3 1  ON 86
ci_038                 1.291349e-03 3 1  ON 87
ci_039                 1.564355e-03 3 1  ON 88
ci_040                -2.821012e-03 3 1  ON 89
ci_041                 8.610187e-03 3 1  ON 90
ci_042                 8.353174e-03 3 1  ON 91
ci_043                -3.673308e-03 3 1  ON 92
ci_044                -4.755111e-03 3 1  ON 93
ci_045                -2.891575e-03 3 1  ON 94
ci_046                 5.873513e-03 3 1  ON 95
ci_047                 5.863525e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2623
    reference variance = 0.26449
====================================================
  Execution time = 2.7266e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9014e-01
  Total weights = 1.9659e+06
  Execution time = 2.3560e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0102872
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279953302346
                                         uncertainty =       0.001916621445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279953302346
                                         uncertainty =       0.001916621445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374123198
  error estimate for blocks of size 2^( 2) =       0.000388137117
  error estimate for blocks of size 2^( 3) =       0.000401055435
  error estimate for blocks of size 2^( 4) =       0.000410225881
  error estimate for blocks of size 2^( 5) =       0.000416269013
  error estimate for blocks of size 2^( 6) =       0.000420425584
  error estimate for blocks of size 2^( 7) =       0.000422676662

      target function =      -0.906142357941
              le_mean =     -17.210235917633
             les_mean =     296.487646497982
             stat err =       0.000417399285
             autocorr =       1.244727042530
   target nu stat err =       0.000417399285
   target dn stat err =       0.005582116306
      target stat err =       0.007112279744
              std dev =       0.529098566359
             le_variance =       0.279945292923

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000821974
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279927425487
                                         uncertainty =       0.001890728656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279927425487
                                         uncertainty =       0.001890728656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374104984
  error estimate for blocks of size 2^( 2) =       0.000388184317
  error estimate for blocks of size 2^( 3) =       0.000401145686
  error estimate for blocks of size 2^( 4) =       0.000410387487
  error estimate for blocks of size 2^( 5) =       0.000416473255
  error estimate for blocks of size 2^( 6) =       0.000420677475
  error estimate for blocks of size 2^( 7) =       0.000422973478

      target function =      -0.805526502165
              le_mean =     -17.210258309566
             les_mean =     296.570154362057
             stat err =       0.000417627924
             autocorr =       1.246212402837
   target nu stat err =       0.000417627924
   target dn stat err =       0.076996630417
      target stat err =       0.077986816810
              std dev =       0.529072807448
             le_variance =       0.279918035581

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0100702
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279763804679
                                         uncertainty =       0.001896815784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279763804679
                                         uncertainty =       0.001896815784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373996065
  error estimate for blocks of size 2^( 2) =       0.000388059887
  error estimate for blocks of size 2^( 3) =       0.000401032013
  error estimate for blocks of size 2^( 4) =       0.000410261442
  error estimate for blocks of size 2^( 5) =       0.000416335830
  error estimate for blocks of size 2^( 6) =       0.000420525152
  error estimate for blocks of size 2^( 7) =       0.000422804629

      target function =      -0.912433613332
              le_mean =     -17.210241457881
             les_mean =     296.482951272498
             stat err =       0.000417481763
             autocorr =       1.246065729419
   target nu stat err =       0.000417481763
   target dn stat err =       0.002664669416
      target stat err =       0.003480826876
              std dev =       0.528918770385
             le_variance =       0.279755065665

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0341239
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279912276329
                                         uncertainty =       0.001913478765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279912276329
                                         uncertainty =       0.001913478765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374095725
  error estimate for blocks of size 2^( 2) =       0.000388115688
  error estimate for blocks of size 2^( 3) =       0.000401040644
  error estimate for blocks of size 2^( 4) =       0.000410223104
  error estimate for blocks of size 2^( 5) =       0.000416271349
  error estimate for blocks of size 2^( 6) =       0.000420428984
  error estimate for blocks of size 2^( 7) =       0.000422685547

      target function =      -0.911889919072
              le_mean =     -17.210235935389
             les_mean =     296.483182852905
             stat err =       0.000417402246
             autocorr =       1.244927534599
   target nu stat err =       0.000417402246
   target dn stat err =       0.002638372838
      target stat err =       0.003443367663
              std dev =       0.529059712713
             le_variance =       0.279904179616


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906142357941        initial
     1.5625e-01     1.5625e+00             3.4260e-03        -0.805526502165
     6.2500e-01     6.2500e+00             1.1096e-03        -0.912433613332  <--
     2.5000e+00     2.5000e+01             2.9963e-04        -0.911889919072

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.9123e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.081816e-01 1 1  ON 0
  uu_1                 5.202055e-02 1 1  ON 1
  uu_2                -3.731023e-02 1 1  ON 2
  uu_3                -9.043337e-02 1 1  ON 3
  uu_4                -1.222977e-01 1 1  ON 4
  uu_5                -1.314245e-01 1 1  ON 5
  uu_6                -1.134521e-01 1 1  ON 6
  uu_7                -5.504481e-02 1 1  ON 7
  uu_8                 6.198693e-02 1 1  ON 8
  uu_9                 1.218964e-01 1 1  ON 9
  ud_0                 3.015668e-01 1 1  ON 10
  ud_1                 7.429373e-02 1 1  ON 11
  ud_2                -2.511001e-02 1 1  ON 12
  ud_3                -7.642330e-02 1 1  ON 13
  ud_4                -1.121723e-01 1 1  ON 14
  ud_5                -1.323927e-01 1 1  ON 15
  ud_6                -1.282926e-01 1 1  ON 16
  ud_7                -8.946315e-02 1 1  ON 17
  ud_8                -3.230437e-03 1 1  ON 18
  ud_9                 8.524684e-02 1 1  ON 19
  eO_0                -6.936691e-01 1 1  ON 20
  eO_1                -4.132982e-01 1 1  ON 21
  eO_2                -4.106203e-02 1 1  ON 22
  eO_3                 1.790219e-01 1 1  ON 23
  eO_4                 2.512011e-01 1 1  ON 24
  eO_5                 2.752569e-01 1 1  ON 25
  eO_6                 2.475406e-01 1 1  ON 26
  eO_7                 1.354316e-01 1 1  ON 27
  eO_8                 2.889831e-02 1 1  ON 28
  eO_9                 1.931013e-02 1 1  ON 29
 eH1_0                -2.044131e-01 1 1  ON 30
 eH1_1                -9.969731e-02 1 1  ON 31
 eH1_2                -4.878699e-02 1 1  ON 32
 eH1_3                -1.746304e-02 1 1  ON 33
 eH1_4                 1.766568e-02 1 1  ON 34
 eH1_5                 2.524762e-02 1 1  ON 35
 eH1_6                 7.695141e-02 1 1  ON 36
 eH1_7                 1.066486e-01 1 1  ON 37
 eH1_8                 1.021541e-01 1 1  ON 38
 eH1_9                 2.564875e-02 1 1  ON 39
 eH2_0                -2.011309e-01 1 1  ON 40
 eH2_1                -9.661433e-02 1 1  ON 41
 eH2_2                -4.613715e-02 1 1  ON 42
 eH2_3                -1.562781e-02 1 1  ON 43
 eH2_4                 1.812927e-02 1 1  ON 44
 eH2_5                 2.146246e-02 1 1  ON 45
 eH2_6                 6.860824e-02 1 1  ON 46
 eH2_7                 1.061700e-01 1 1  ON 47
 eH2_8                 1.040542e-01 1 1  ON 48
 eH2_9                 2.816822e-02 1 1  ON 49
ci_001                -4.287821e-02 3 1  ON 50
ci_002                -3.135078e-02 3 1  ON 51
ci_003                -2.591582e-02 3 1  ON 52
ci_004                 2.459390e-02 3 1  ON 53
ci_005                 2.456969e-02 3 1  ON 54
ci_006                -2.037083e-02 3 1  ON 55
ci_007                -2.059044e-02 3 1  ON 56
ci_008                -8.980734e-03 3 1  ON 57
ci_009                -1.514484e-02 3 1  ON 58
ci_010                -9.230886e-03 3 1  ON 59
ci_011                -1.057787e-02 3 1  ON 60
ci_012                -1.050609e-02 3 1  ON 61
ci_013                -1.940324e-02 3 1  ON 62
ci_014                 1.298474e-02 3 1  ON 63
ci_015                 1.350704e-02 3 1  ON 64
ci_016                 1.654568e-02 3 1  ON 65
ci_017                 1.629479e-02 3 1  ON 66
ci_018                 1.036929e-02 3 1  ON 67
ci_019                 1.033341e-02 3 1  ON 68
ci_020                 1.661031e-02 3 1  ON 69
ci_021                 1.651694e-02 3 1  ON 70
ci_022                 1.078880e-02 3 1  ON 71
ci_023                 1.010890e-02 3 1  ON 72
ci_024                 7.708144e-03 3 1  ON 73
ci_025                 6.950856e-03 3 1  ON 74
ci_026                 1.202542e-02 3 1  ON 75
ci_027                 1.157656e-02 3 1  ON 76
ci_028                -1.501150e-02 3 1  ON 77
ci_029                -1.540175e-02 3 1  ON 78
ci_030                -4.912541e-03 3 1  ON 79
ci_031                -5.008585e-03 3 1  ON 80
ci_032                -1.517536e-02 3 1  ON 81
ci_033                 6.717593e-03 3 1  ON 82
ci_034                 7.573153e-03 3 1  ON 83
ci_035                -4.750989e-03 3 1  ON 84
ci_036                -1.271408e-02 3 1  ON 85
ci_037                -1.276486e-02 3 1  ON 86
ci_038                 1.291349e-03 3 1  ON 87
ci_039                 1.564355e-03 3 1  ON 88
ci_040                -2.821012e-03 3 1  ON 89
ci_041                 8.610187e-03 3 1  ON 90
ci_042                 8.353174e-03 3 1  ON 91
ci_043                -3.673308e-03 3 1  ON 92
ci_044                -4.755111e-03 3 1  ON 93
ci_045                -2.891575e-03 3 1  ON 94
ci_046                 5.873513e-03 3 1  ON 95
ci_047                 5.863525e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4913e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1571
    reference variance = 0.203679
====================================================
  Execution time = 2.7257e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0484e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8640e-01
  Total weights = 1.966118296e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6697e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277468880022
                                         uncertainty =       0.001455970614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277468880022
                                         uncertainty =       0.001455970614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372455435
  error estimate for blocks of size 2^( 2) =       0.000386500027
  error estimate for blocks of size 2^( 3) =       0.000399052485
  error estimate for blocks of size 2^( 4) =       0.000409310482
  error estimate for blocks of size 2^( 5) =       0.000415431631
  error estimate for blocks of size 2^( 6) =       0.000418266922
  error estimate for blocks of size 2^( 7) =       0.000420320237

      target function =      -0.917585724161
              le_mean =     -17.209422379022
             les_mean =     296.450615172953
             stat err =       0.000415832318
             autocorr =       1.246487268515
   target nu stat err =       0.000415832318
   target dn stat err =       0.002219955393
      target stat err =       0.002946309680
              std dev =       0.526739954568
             le_variance =       0.277454979738


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720942237902e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917594416557       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917684380140       residual = 5.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917696248685       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917700478248       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917701136394       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917701130448       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917702118107       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917703151979       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917703860404       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917704338605       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917705026550       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917706346102       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917706629131       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917707191023       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917708609508       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917709165213       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917708792332       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917708865448       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917709097558       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917709808473       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917709755249       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917710276339       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917710497553       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917710698469       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917710791460       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917710806805       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917710826433       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917710811359       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917710726229       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917710918690       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917710831384       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917710862591       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917710994021       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917710986853       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917710971013       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917711008619       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917711020336       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917711026497       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917710991816       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917710982943       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.917710932739       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.917710975163       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.917710985297       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.917711002482       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.917710994811       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.917711015326       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.917711071682       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.917711072478       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e-01 is 1.924849e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917594416557       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917624220169       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917627992902       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917629319539       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917629499216       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917629512295       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917629936164       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917630238123       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917630458236       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917630519330       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917630752790       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917631162431       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917631264367       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917631434383       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917631803782       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917631924480       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917631782402       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917631808976       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917631916821       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917632075762       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917632042004       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917632201428       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917632230232       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917632262979       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917632275527       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917632289215       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917632275181       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917632278672       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917632259017       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917632301558       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917632288647       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917632285701       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917632314416       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917632307241       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917632295565       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917632307663       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917632310204       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917632310450       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917632303273       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917632298458       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.917632294979       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.917632297433       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.917632304375       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.917632299372       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.917632305130       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 4.861796e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917594416557       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917602526626       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917603538209       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917603892631       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917603938111       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917603944351       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917604038589       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917604141270       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917604172811       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917604216031       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917604269780       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917604386299       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917604412901       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917604457810       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917604549771       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917604577600       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917604538036       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917604546201       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917604578141       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917604613789       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917604604499       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917604646794       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917604650707       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917604657959       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917604660254       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917604664582       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917604659603       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917604660980       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917604656367       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917604666091       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917604663628       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917604662572       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917604669046       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917604667109       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917604663528       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917604667111       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917604667538       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917604667522       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917604666009       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917604664736       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.917604664076       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.917604664542       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.917604666090       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+00 is 1.217065e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.062656 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6604e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.084493e-01 1 1  ON 0
  uu_1                 5.228487e-02 1 1  ON 1
  uu_2                -3.711003e-02 1 1  ON 2
  uu_3                -9.031521e-02 1 1  ON 3
  uu_4                -1.222864e-01 1 1  ON 4
  uu_5                -1.315827e-01 1 1  ON 5
  uu_6                -1.137284e-01 1 1  ON 6
  uu_7                -5.545551e-02 1 1  ON 7
  uu_8                 6.150075e-02 1 1  ON 8
  uu_9                 1.219189e-01 1 1  ON 9
  ud_0                 3.014856e-01 1 1  ON 10
  ud_1                 7.418923e-02 1 1  ON 11
  ud_2                -2.525028e-02 1 1  ON 12
  ud_3                -7.652877e-02 1 1  ON 13
  ud_4                -1.121883e-01 1 1  ON 14
  ud_5                -1.323150e-01 1 1  ON 15
  ud_6                -1.281438e-01 1 1  ON 16
  ud_7                -8.921262e-02 1 1  ON 17
  ud_8                -3.555811e-03 1 1  ON 18
  ud_9                 8.513529e-02 1 1  ON 19
  eO_0                -6.939457e-01 1 1  ON 20
  eO_1                -4.135013e-01 1 1  ON 21
  eO_2                -4.108723e-02 1 1  ON 22
  eO_3                 1.791444e-01 1 1  ON 23
  eO_4                 2.511450e-01 1 1  ON 24
  eO_5                 2.751824e-01 1 1  ON 25
  eO_6                 2.475315e-01 1 1  ON 26
  eO_7                 1.358289e-01 1 1  ON 27
  eO_8                 2.895871e-02 1 1  ON 28
  eO_9                 1.933619e-02 1 1  ON 29
 eH1_0                -2.045075e-01 1 1  ON 30
 eH1_1                -9.983279e-02 1 1  ON 31
 eH1_2                -4.887775e-02 1 1  ON 32
 eH1_3                -1.755822e-02 1 1  ON 33
 eH1_4                 1.771375e-02 1 1  ON 34
 eH1_5                 2.533403e-02 1 1  ON 35
 eH1_6                 7.713052e-02 1 1  ON 36
 eH1_7                 1.065132e-01 1 1  ON 37
 eH1_8                 1.023175e-01 1 1  ON 38
 eH1_9                 2.571104e-02 1 1  ON 39
 eH2_0                -2.011057e-01 1 1  ON 40
 eH2_1                -9.668474e-02 1 1  ON 41
 eH2_2                -4.630976e-02 1 1  ON 42
 eH2_3                -1.572589e-02 1 1  ON 43
 eH2_4                 1.796058e-02 1 1  ON 44
 eH2_5                 2.171964e-02 1 1  ON 45
 eH2_6                 6.878600e-02 1 1  ON 46
 eH2_7                 1.059515e-01 1 1  ON 47
 eH2_8                 1.042227e-01 1 1  ON 48
 eH2_9                 2.820613e-02 1 1  ON 49
ci_001                -4.279390e-02 3 1  ON 50
ci_002                -3.128177e-02 3 1  ON 51
ci_003                -2.589693e-02 3 1  ON 52
ci_004                 2.447117e-02 3 1  ON 53
ci_005                 2.454537e-02 3 1  ON 54
ci_006                -2.037456e-02 3 1  ON 55
ci_007                -2.053332e-02 3 1  ON 56
ci_008                -9.002679e-03 3 1  ON 57
ci_009                -1.511307e-02 3 1  ON 58
ci_010                -9.244607e-03 3 1  ON 59
ci_011                -1.059026e-02 3 1  ON 60
ci_012                -1.047095e-02 3 1  ON 61
ci_013                -1.947870e-02 3 1  ON 62
ci_014                 1.307102e-02 3 1  ON 63
ci_015                 1.353390e-02 3 1  ON 64
ci_016                 1.657162e-02 3 1  ON 65
ci_017                 1.624299e-02 3 1  ON 66
ci_018                 1.036777e-02 3 1  ON 67
ci_019                 1.019928e-02 3 1  ON 68
ci_020                 1.663369e-02 3 1  ON 69
ci_021                 1.650220e-02 3 1  ON 70
ci_022                 1.087323e-02 3 1  ON 71
ci_023                 1.005579e-02 3 1  ON 72
ci_024                 7.660060e-03 3 1  ON 73
ci_025                 6.984982e-03 3 1  ON 74
ci_026                 1.190838e-02 3 1  ON 75
ci_027                 1.163386e-02 3 1  ON 76
ci_028                -1.508079e-02 3 1  ON 77
ci_029                -1.540423e-02 3 1  ON 78
ci_030                -4.863258e-03 3 1  ON 79
ci_031                -4.876686e-03 3 1  ON 80
ci_032                -1.514484e-02 3 1  ON 81
ci_033                 6.788496e-03 3 1  ON 82
ci_034                 7.415045e-03 3 1  ON 83
ci_035                -4.678450e-03 3 1  ON 84
ci_036                -1.282880e-02 3 1  ON 85
ci_037                -1.272658e-02 3 1  ON 86
ci_038                 1.212248e-03 3 1  ON 87
ci_039                 1.531368e-03 3 1  ON 88
ci_040                -2.796388e-03 3 1  ON 89
ci_041                 8.542153e-03 3 1  ON 90
ci_042                 8.321515e-03 3 1  ON 91
ci_043                -3.607775e-03 3 1  ON 92
ci_044                -4.716037e-03 3 1  ON 93
ci_045                -2.863098e-03 3 1  ON 94
ci_046                 5.905665e-03 3 1  ON 95
ci_047                 5.859242e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1773
    reference variance = 0.286995
====================================================
  Execution time = 2.7455e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8647e-01
  Total weights = 1.9665e+06
  Execution time = 2.3716e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276435379054
                                         uncertainty =       0.001709213597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276435379054
                                         uncertainty =       0.001709213597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371821400
  error estimate for blocks of size 2^( 2) =       0.000385809953
  error estimate for blocks of size 2^( 3) =       0.000399487089
  error estimate for blocks of size 2^( 4) =       0.000409063082
  error estimate for blocks of size 2^( 5) =       0.000414571717
  error estimate for blocks of size 2^( 6) =       0.000417095629
  error estimate for blocks of size 2^( 7) =       0.000418462186

      target function =      -0.917144196742
              le_mean =     -17.209686911506
             les_mean =     296.460111792734
             stat err =       0.000414798153
             autocorr =       1.244528554659
   target nu stat err =       0.000414798153
   target dn stat err =       0.002522960806
      target stat err =       0.003331255180
              std dev =       0.525843279670
             le_variance =       0.276511154774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276488018980
                                         uncertainty =       0.001706775665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276488018980
                                         uncertainty =       0.001706775665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371858039
  error estimate for blocks of size 2^( 2) =       0.000385847097
  error estimate for blocks of size 2^( 3) =       0.000399530530
  error estimate for blocks of size 2^( 4) =       0.000409114595
  error estimate for blocks of size 2^( 5) =       0.000414627680
  error estimate for blocks of size 2^( 6) =       0.000417160333
  error estimate for blocks of size 2^( 7) =       0.000418562493

      target function =      -0.917214972522
              le_mean =     -17.209686627740
             les_mean =     296.460048428857
             stat err =       0.000414866275
             autocorr =       1.244692049102
   target nu stat err =       0.000414866275
   target dn stat err =       0.002391606914
      target stat err =       0.003163854291
              std dev =       0.525895096004
             le_variance =       0.276565652001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276460361584
                                         uncertainty =       0.001707464214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276460361584
                                         uncertainty =       0.001707464214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371838985
  error estimate for blocks of size 2^( 2) =       0.000385828264
  error estimate for blocks of size 2^( 3) =       0.000399510161
  error estimate for blocks of size 2^( 4) =       0.000409091769
  error estimate for blocks of size 2^( 5) =       0.000414603488
  error estimate for blocks of size 2^( 6) =       0.000417132802
  error estimate for blocks of size 2^( 7) =       0.000418522055

      target function =      -0.917682407031
              le_mean =     -17.209685302264
             les_mean =     296.459643027721
             stat err =       0.000414837528
             autocorr =       1.244647106884
   target nu stat err =       0.000414837528
   target dn stat err =       0.002403092261
      target stat err =       0.003181696194
              std dev =       0.525868149370
             le_variance =       0.276537310522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276436740684
                                         uncertainty =       0.001708924526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276436740684
                                         uncertainty =       0.001708924526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371822421
  error estimate for blocks of size 2^( 2) =       0.000385811099
  error estimate for blocks of size 2^( 3) =       0.000399488878
  error estimate for blocks of size 2^( 4) =       0.000409065601
  error estimate for blocks of size 2^( 5) =       0.000414574621
  error estimate for blocks of size 2^( 6) =       0.000417099243
  error estimate for blocks of size 2^( 7) =       0.000418468895

      target function =      -0.917375808777
              le_mean =     -17.209686390652
             les_mean =     296.459915771480
             stat err =       0.000414802090
             autocorr =       1.244545337316
   target nu stat err =       0.000414802090
   target dn stat err =       0.002497362560
      target stat err =       0.003300150684
              std dev =       0.525844724412
             le_variance =       0.276512674192


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917144196742        initial
     1.5625e-01     1.5625e+00             1.9248e-03        -0.917214972522
     6.2500e-01     6.2500e+00             4.8618e-04        -0.917682407031  <--
     2.5000e+00     2.5000e+01             1.2171e-04        -0.917375808777

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.9427e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.084493e-01 1 1  ON 0
  uu_1                 5.228487e-02 1 1  ON 1
  uu_2                -3.711003e-02 1 1  ON 2
  uu_3                -9.031521e-02 1 1  ON 3
  uu_4                -1.222864e-01 1 1  ON 4
  uu_5                -1.315827e-01 1 1  ON 5
  uu_6                -1.137284e-01 1 1  ON 6
  uu_7                -5.545551e-02 1 1  ON 7
  uu_8                 6.150075e-02 1 1  ON 8
  uu_9                 1.219189e-01 1 1  ON 9
  ud_0                 3.014856e-01 1 1  ON 10
  ud_1                 7.418923e-02 1 1  ON 11
  ud_2                -2.525028e-02 1 1  ON 12
  ud_3                -7.652877e-02 1 1  ON 13
  ud_4                -1.121883e-01 1 1  ON 14
  ud_5                -1.323150e-01 1 1  ON 15
  ud_6                -1.281438e-01 1 1  ON 16
  ud_7                -8.921262e-02 1 1  ON 17
  ud_8                -3.555811e-03 1 1  ON 18
  ud_9                 8.513529e-02 1 1  ON 19
  eO_0                -6.939457e-01 1 1  ON 20
  eO_1                -4.135013e-01 1 1  ON 21
  eO_2                -4.108723e-02 1 1  ON 22
  eO_3                 1.791444e-01 1 1  ON 23
  eO_4                 2.511450e-01 1 1  ON 24
  eO_5                 2.751824e-01 1 1  ON 25
  eO_6                 2.475315e-01 1 1  ON 26
  eO_7                 1.358289e-01 1 1  ON 27
  eO_8                 2.895871e-02 1 1  ON 28
  eO_9                 1.933619e-02 1 1  ON 29
 eH1_0                -2.045075e-01 1 1  ON 30
 eH1_1                -9.983279e-02 1 1  ON 31
 eH1_2                -4.887775e-02 1 1  ON 32
 eH1_3                -1.755822e-02 1 1  ON 33
 eH1_4                 1.771375e-02 1 1  ON 34
 eH1_5                 2.533403e-02 1 1  ON 35
 eH1_6                 7.713052e-02 1 1  ON 36
 eH1_7                 1.065132e-01 1 1  ON 37
 eH1_8                 1.023175e-01 1 1  ON 38
 eH1_9                 2.571104e-02 1 1  ON 39
 eH2_0                -2.011057e-01 1 1  ON 40
 eH2_1                -9.668474e-02 1 1  ON 41
 eH2_2                -4.630976e-02 1 1  ON 42
 eH2_3                -1.572589e-02 1 1  ON 43
 eH2_4                 1.796058e-02 1 1  ON 44
 eH2_5                 2.171964e-02 1 1  ON 45
 eH2_6                 6.878600e-02 1 1  ON 46
 eH2_7                 1.059515e-01 1 1  ON 47
 eH2_8                 1.042227e-01 1 1  ON 48
 eH2_9                 2.820613e-02 1 1  ON 49
ci_001                -4.279390e-02 3 1  ON 50
ci_002                -3.128177e-02 3 1  ON 51
ci_003                -2.589693e-02 3 1  ON 52
ci_004                 2.447117e-02 3 1  ON 53
ci_005                 2.454537e-02 3 1  ON 54
ci_006                -2.037456e-02 3 1  ON 55
ci_007                -2.053332e-02 3 1  ON 56
ci_008                -9.002679e-03 3 1  ON 57
ci_009                -1.511307e-02 3 1  ON 58
ci_010                -9.244607e-03 3 1  ON 59
ci_011                -1.059026e-02 3 1  ON 60
ci_012                -1.047095e-02 3 1  ON 61
ci_013                -1.947870e-02 3 1  ON 62
ci_014                 1.307102e-02 3 1  ON 63
ci_015                 1.353390e-02 3 1  ON 64
ci_016                 1.657162e-02 3 1  ON 65
ci_017                 1.624299e-02 3 1  ON 66
ci_018                 1.036777e-02 3 1  ON 67
ci_019                 1.019928e-02 3 1  ON 68
ci_020                 1.663369e-02 3 1  ON 69
ci_021                 1.650220e-02 3 1  ON 70
ci_022                 1.087323e-02 3 1  ON 71
ci_023                 1.005579e-02 3 1  ON 72
ci_024                 7.660060e-03 3 1  ON 73
ci_025                 6.984982e-03 3 1  ON 74
ci_026                 1.190838e-02 3 1  ON 75
ci_027                 1.163386e-02 3 1  ON 76
ci_028                -1.508079e-02 3 1  ON 77
ci_029                -1.540423e-02 3 1  ON 78
ci_030                -4.863258e-03 3 1  ON 79
ci_031                -4.876686e-03 3 1  ON 80
ci_032                -1.514484e-02 3 1  ON 81
ci_033                 6.788496e-03 3 1  ON 82
ci_034                 7.415045e-03 3 1  ON 83
ci_035                -4.678450e-03 3 1  ON 84
ci_036                -1.282880e-02 3 1  ON 85
ci_037                -1.272658e-02 3 1  ON 86
ci_038                 1.212248e-03 3 1  ON 87
ci_039                 1.531368e-03 3 1  ON 88
ci_040                -2.796388e-03 3 1  ON 89
ci_041                 8.542153e-03 3 1  ON 90
ci_042                 8.321515e-03 3 1  ON 91
ci_043                -3.607775e-03 3 1  ON 92
ci_044                -4.716037e-03 3 1  ON 93
ci_045                -2.863098e-03 3 1  ON 94
ci_046                 5.905665e-03 3 1  ON 95
ci_047                 5.859242e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6045e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2459
    reference variance = 0.272968
====================================================
  Execution time = 2.7261e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0465e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9155e-01
  Total weights = 1.966161603e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1947e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279058121214
                                         uncertainty =       0.002294075304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279058121214
                                         uncertainty =       0.002294075304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373535146
  error estimate for blocks of size 2^( 2) =       0.000387724209
  error estimate for blocks of size 2^( 3) =       0.000400911681
  error estimate for blocks of size 2^( 4) =       0.000410329461
  error estimate for blocks of size 2^( 5) =       0.000415482787
  error estimate for blocks of size 2^( 6) =       0.000417904781
  error estimate for blocks of size 2^( 7) =       0.000420722245

      target function =      -0.911005799365
              le_mean =     -17.209764688001
             les_mean =     296.467547016550
             stat err =       0.000416109819
             autocorr =       1.240946293583
   target nu stat err =       0.000416109819
   target dn stat err =       0.003866585809
      target stat err =       0.004993357245
              std dev =       0.528266921083
             le_variance =       0.279065939910


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720976468800e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911032559518       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911170112368       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911183690856       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911193318370       residual = 8.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911194882397       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911198840387       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911200251906       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911203378926       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911203131133       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911204036033       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911203954946       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911204590952       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911204880982       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911206233602       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911206520958       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911206795066       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911207474680       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911208312448       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911208502189       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911208598996       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911209155435       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911209349281       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911210034179       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911210157425       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911210135787       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911210040748       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911210289289       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911210210646       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911210104272       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911210186957       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911210235707       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911210184673       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911210092689       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911210109438       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911210265803       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911210541791       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911210563978       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911210499635       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911210402394       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911210346483       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.911210330686       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.911210293243       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.911210307123       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.911210356835       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.911210331396       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.911210319848       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.911210326362       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.911210350473       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.911210337731       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e-01 is 1.726703e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911032559518       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911077961867       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911082157182       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911085233039       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911085790547       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911087057037       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911087459715       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911088521066       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911088340271       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911088616415       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911088632787       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911088802700       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911088919724       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911089298455       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911089368138       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911089443589       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911089655305       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911089875677       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911089887016       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911089905410       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911090065488       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911090132844       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911090283775       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911090276342       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911090250421       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911090243442       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911090314077       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911090267283       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911090243249       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911090260106       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911090267969       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911090243748       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911090245620       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911090252859       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911090292256       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911090336969       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911090324575       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911090308685       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911090288480       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911090281494       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 4.712166e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911032559518       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911044897919       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911046012898       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911046838194       residual = 7.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911046994404       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911047335092       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911047438258       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911047728463       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911047672914       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911047744468       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911047752994       residual = 9.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911047796455       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911047828859       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911047926005       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911047942583       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911047962428       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911048019144       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911048074266       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911048071902       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911048078330       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911048119844       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911048137472       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911048172000       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911048166892       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911048159731       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911048160126       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911048177064       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911048163388       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911048157962       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911048161656       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911048163436       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911048157498       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911048159678       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911048161190       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911048170921       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911048178460       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911048179244       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911048172084       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911048168282       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911048166096       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+00 is 1.220818e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.166803 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5569e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.087837e-01 1 1  ON 0
  uu_1                 5.254040e-02 1 1  ON 1
  uu_2                -3.695832e-02 1 1  ON 2
  uu_3                -9.028825e-02 1 1  ON 3
  uu_4                -1.222888e-01 1 1  ON 4
  uu_5                -1.316963e-01 1 1  ON 5
  uu_6                -1.138450e-01 1 1  ON 6
  uu_7                -5.578602e-02 1 1  ON 7
  uu_8                 6.107978e-02 1 1  ON 8
  uu_9                 1.219451e-01 1 1  ON 9
  ud_0                 3.013152e-01 1 1  ON 10
  ud_1                 7.397451e-02 1 1  ON 11
  ud_2                -2.547995e-02 1 1  ON 12
  ud_3                -7.674931e-02 1 1  ON 13
  ud_4                -1.123254e-01 1 1  ON 14
  ud_5                -1.322389e-01 1 1  ON 15
  ud_6                -1.279304e-01 1 1  ON 16
  ud_7                -8.874141e-02 1 1  ON 17
  ud_8                -3.402236e-03 1 1  ON 18
  ud_9                 8.501137e-02 1 1  ON 19
  eO_0                -6.942360e-01 1 1  ON 20
  eO_1                -4.137045e-01 1 1  ON 21
  eO_2                -4.112873e-02 1 1  ON 22
  eO_3                 1.792224e-01 1 1  ON 23
  eO_4                 2.510199e-01 1 1  ON 24
  eO_5                 2.753625e-01 1 1  ON 25
  eO_6                 2.474362e-01 1 1  ON 26
  eO_7                 1.362500e-01 1 1  ON 27
  eO_8                 2.902358e-02 1 1  ON 28
  eO_9                 1.933674e-02 1 1  ON 29
 eH1_0                -2.044039e-01 1 1  ON 30
 eH1_1                -9.982860e-02 1 1  ON 31
 eH1_2                -4.897547e-02 1 1  ON 32
 eH1_3                -1.758595e-02 1 1  ON 33
 eH1_4                 1.756448e-02 1 1  ON 34
 eH1_5                 2.547292e-02 1 1  ON 35
 eH1_6                 7.719733e-02 1 1  ON 36
 eH1_7                 1.062349e-01 1 1  ON 37
 eH1_8                 1.024875e-01 1 1  ON 38
 eH1_9                 2.575824e-02 1 1  ON 39
 eH2_0                -2.012647e-01 1 1  ON 40
 eH2_1                -9.678443e-02 1 1  ON 41
 eH2_2                -4.634198e-02 1 1  ON 42
 eH2_3                -1.570232e-02 1 1  ON 43
 eH2_4                 1.781217e-02 1 1  ON 44
 eH2_5                 2.163224e-02 1 1  ON 45
 eH2_6                 6.898662e-02 1 1  ON 46
 eH2_7                 1.059808e-01 1 1  ON 47
 eH2_8                 1.044752e-01 1 1  ON 48
 eH2_9                 2.823216e-02 1 1  ON 49
ci_001                -4.268950e-02 3 1  ON 50
ci_002                -3.127867e-02 3 1  ON 51
ci_003                -2.587413e-02 3 1  ON 52
ci_004                 2.445834e-02 3 1  ON 53
ci_005                 2.457734e-02 3 1  ON 54
ci_006                -2.040255e-02 3 1  ON 55
ci_007                -2.054746e-02 3 1  ON 56
ci_008                -8.984966e-03 3 1  ON 57
ci_009                -1.497652e-02 3 1  ON 58
ci_010                -9.385693e-03 3 1  ON 59
ci_011                -1.049209e-02 3 1  ON 60
ci_012                -1.037998e-02 3 1  ON 61
ci_013                -1.945788e-02 3 1  ON 62
ci_014                 1.292296e-02 3 1  ON 63
ci_015                 1.333171e-02 3 1  ON 64
ci_016                 1.649115e-02 3 1  ON 65
ci_017                 1.618975e-02 3 1  ON 66
ci_018                 1.042450e-02 3 1  ON 67
ci_019                 1.028748e-02 3 1  ON 68
ci_020                 1.672700e-02 3 1  ON 69
ci_021                 1.646415e-02 3 1  ON 70
ci_022                 1.070136e-02 3 1  ON 71
ci_023                 1.020445e-02 3 1  ON 72
ci_024                 7.628612e-03 3 1  ON 73
ci_025                 7.025361e-03 3 1  ON 74
ci_026                 1.167159e-02 3 1  ON 75
ci_027                 1.149935e-02 3 1  ON 76
ci_028                -1.509980e-02 3 1  ON 77
ci_029                -1.539507e-02 3 1  ON 78
ci_030                -4.886246e-03 3 1  ON 79
ci_031                -4.919227e-03 3 1  ON 80
ci_032                -1.519144e-02 3 1  ON 81
ci_033                 6.827584e-03 3 1  ON 82
ci_034                 7.449327e-03 3 1  ON 83
ci_035                -4.706208e-03 3 1  ON 84
ci_036                -1.283785e-02 3 1  ON 85
ci_037                -1.265248e-02 3 1  ON 86
ci_038                 1.173131e-03 3 1  ON 87
ci_039                 1.494300e-03 3 1  ON 88
ci_040                -2.726247e-03 3 1  ON 89
ci_041                 8.576490e-03 3 1  ON 90
ci_042                 8.267924e-03 3 1  ON 91
ci_043                -3.651595e-03 3 1  ON 92
ci_044                -4.786937e-03 3 1  ON 93
ci_045                -2.839557e-03 3 1  ON 94
ci_046                 5.882121e-03 3 1  ON 95
ci_047                 5.880034e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1199
    reference variance = 0.193308
====================================================
  Execution time = 2.6878e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8560e-01
  Total weights = 1.9663e+06
  Execution time = 2.3689e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278261759294
                                         uncertainty =       0.001675739884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278261759294
                                         uncertainty =       0.001675739884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372982699
  error estimate for blocks of size 2^( 2) =       0.000386948453
  error estimate for blocks of size 2^( 3) =       0.000400081328
  error estimate for blocks of size 2^( 4) =       0.000409952057
  error estimate for blocks of size 2^( 5) =       0.000415632833
  error estimate for blocks of size 2^( 6) =       0.000418393328
  error estimate for blocks of size 2^( 7) =       0.000419343350

      target function =      -0.918695259346
              le_mean =     -17.209660857078
             les_mean =     296.458022111486
             stat err =       0.000415830392
             autocorr =       1.242954067557
   target nu stat err =       0.000415830392
   target dn stat err =       0.001920882182
      target stat err =       0.002573427715
              std dev =       0.527485631691
             le_variance =       0.278241091640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278512642276
                                         uncertainty =       0.001677966026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278512642276
                                         uncertainty =       0.001677966026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373151253
  error estimate for blocks of size 2^( 2) =       0.000387122904
  error estimate for blocks of size 2^( 3) =       0.000400270081
  error estimate for blocks of size 2^( 4) =       0.000410162698
  error estimate for blocks of size 2^( 5) =       0.000415855775
  error estimate for blocks of size 2^( 6) =       0.000418595861
  error estimate for blocks of size 2^( 7) =       0.000419553747

      target function =      -0.917988160547
              le_mean =     -17.209667637139
             les_mean =     296.458799408417
             stat err =       0.000416042020
             autocorr =       1.243095755927
   target nu stat err =       0.000416042020
   target dn stat err =       0.001945881631
      target stat err =       0.002601358619
              std dev =       0.527724006663
             le_variance =       0.278492627208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278407717148
                                         uncertainty =       0.001676911642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278407717148
                                         uncertainty =       0.001676911642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373080798
  error estimate for blocks of size 2^( 2) =       0.000387049510
  error estimate for blocks of size 2^( 3) =       0.000400190877
  error estimate for blocks of size 2^( 4) =       0.000410075100
  error estimate for blocks of size 2^( 5) =       0.000415763015
  error estimate for blocks of size 2^( 6) =       0.000418510240
  error estimate for blocks of size 2^( 7) =       0.000419466431

      target function =      -0.918202985644
              le_mean =     -17.209663844470
             les_mean =     296.458503185486
             stat err =       0.000415953697
             autocorr =       1.243037360616
   target nu stat err =       0.000415953697
   target dn stat err =       0.001935827764
      target stat err =       0.002589747648
              std dev =       0.527624366435
             le_variance =       0.278387472056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278278402256
                                         uncertainty =       0.001675860035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278278402256
                                         uncertainty =       0.001675860035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372993894
  error estimate for blocks of size 2^( 2) =       0.000386959976
  error estimate for blocks of size 2^( 3) =       0.000400093936
  error estimate for blocks of size 2^( 4) =       0.000409966483
  error estimate for blocks of size 2^( 5) =       0.000415648222
  error estimate for blocks of size 2^( 6) =       0.000418406857
  error estimate for blocks of size 2^( 7) =       0.000419357808

      target function =      -0.918726231723
              le_mean =     -17.209660851145
             les_mean =     296.457998161022
             stat err =       0.000415844842
             autocorr =       1.242965845767
   target nu stat err =       0.000415844842
   target dn stat err =       0.001919699733
      target stat err =       0.002572100446
              std dev =       0.527501462814
             le_variance =       0.278257793271


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918695259346        initial
     1.5625e-01     1.5625e+00             1.7267e-03        -0.917988160547
     6.2500e-01     6.2500e+00             4.7122e-04        -0.918202985644
     2.5000e+00     2.5000e+01             1.2208e-04        -0.918726231723  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 3.8812e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.085374e-01 1 1  ON 0
  uu_1                 5.235163e-02 1 1  ON 1
  uu_2                -3.707113e-02 1 1  ON 2
  uu_3                -9.030972e-02 1 1  ON 3
  uu_4                -1.222881e-01 1 1  ON 4
  uu_5                -1.316137e-01 1 1  ON 5
  uu_6                -1.137586e-01 1 1  ON 6
  uu_7                -5.553982e-02 1 1  ON 7
  uu_8                 6.139466e-02 1 1  ON 8
  uu_9                 1.219255e-01 1 1  ON 9
  ud_0                 3.014420e-01 1 1  ON 10
  ud_1                 7.413348e-02 1 1  ON 11
  ud_2                -2.531017e-02 1 1  ON 12
  ud_3                -7.658636e-02 1 1  ON 13
  ud_4                -1.122236e-01 1 1  ON 14
  ud_5                -1.322933e-01 1 1  ON 15
  ud_6                -1.280873e-01 1 1  ON 16
  ud_7                -8.909054e-02 1 1  ON 17
  ud_8                -3.518344e-03 1 1  ON 18
  ud_9                 8.510398e-02 1 1  ON 19
  eO_0                -6.940211e-01 1 1  ON 20
  eO_1                -4.135535e-01 1 1  ON 21
  eO_2                -4.109589e-02 1 1  ON 22
  eO_3                 1.791673e-01 1 1  ON 23
  eO_4                 2.511124e-01 1 1  ON 24
  eO_5                 2.752283e-01 1 1  ON 25
  eO_6                 2.475067e-01 1 1  ON 26
  eO_7                 1.359347e-01 1 1  ON 27
  eO_8                 2.897496e-02 1 1  ON 28
  eO_9                 1.933632e-02 1 1  ON 29
 eH1_0                -2.044795e-01 1 1  ON 30
 eH1_1                -9.983116e-02 1 1  ON 31
 eH1_2                -4.890378e-02 1 1  ON 32
 eH1_3                -1.756503e-02 1 1  ON 33
 eH1_4                 1.767409e-02 1 1  ON 34
 eH1_5                 2.537093e-02 1 1  ON 35
 eH1_6                 7.714682e-02 1 1  ON 36
 eH1_7                 1.064428e-01 1 1  ON 37
 eH1_8                 1.023602e-01 1 1  ON 38
 eH1_9                 2.572288e-02 1 1  ON 39
 eH2_0                -2.011469e-01 1 1  ON 40
 eH2_1                -9.671029e-02 1 1  ON 41
 eH2_2                -4.631719e-02 1 1  ON 42
 eH2_3                -1.571816e-02 1 1  ON 43
 eH2_4                 1.792196e-02 1 1  ON 44
 eH2_5                 2.169765e-02 1 1  ON 45
 eH2_6                 6.883756e-02 1 1  ON 46
 eH2_7                 1.059585e-01 1 1  ON 47
 eH2_8                 1.042860e-01 1 1  ON 48
 eH2_9                 2.821265e-02 1 1  ON 49
ci_001                -4.276608e-02 3 1  ON 50
ci_002                -3.128093e-02 3 1  ON 51
ci_003                -2.589101e-02 3 1  ON 52
ci_004                 2.446829e-02 3 1  ON 53
ci_005                 2.455419e-02 3 1  ON 54
ci_006                -2.038198e-02 3 1  ON 55
ci_007                -2.053701e-02 3 1  ON 56
ci_008                -8.997897e-03 3 1  ON 57
ci_009                -1.507616e-02 3 1  ON 58
ci_010                -9.282669e-03 3 1  ON 59
ci_011                -1.056378e-02 3 1  ON 60
ci_012                -1.044635e-02 3 1  ON 61
ci_013                -1.947318e-02 3 1  ON 62
ci_014                 1.303111e-02 3 1  ON 63
ci_015                 1.347943e-02 3 1  ON 64
ci_016                 1.655016e-02 3 1  ON 65
ci_017                 1.622869e-02 3 1  ON 66
ci_018                 1.038317e-02 3 1  ON 67
ci_019                 1.022304e-02 3 1  ON 68
ci_020                 1.665848e-02 3 1  ON 69
ci_021                 1.649188e-02 3 1  ON 70
ci_022                 1.082690e-02 3 1  ON 71
ci_023                 1.009579e-02 3 1  ON 72
ci_024                 7.651687e-03 3 1  ON 73
ci_025                 6.995829e-03 3 1  ON 74
ci_026                 1.184408e-02 3 1  ON 75
ci_027                 1.159725e-02 3 1  ON 76
ci_028                -1.508575e-02 3 1  ON 77
ci_029                -1.540188e-02 3 1  ON 78
ci_030                -4.869486e-03 3 1  ON 79
ci_031                -4.888219e-03 3 1  ON 80
ci_032                -1.515732e-02 3 1  ON 81
ci_033                 6.798987e-03 3 1  ON 82
ci_034                 7.424249e-03 3 1  ON 83
ci_035                -4.685945e-03 3 1  ON 84
ci_036                -1.283133e-02 3 1  ON 85
ci_037                -1.270654e-02 3 1  ON 86
ci_038                 1.201652e-03 3 1  ON 87
ci_039                 1.521333e-03 3 1  ON 88
ci_040                -2.777322e-03 3 1  ON 89
ci_041                 8.551448e-03 3 1  ON 90
ci_042                 8.306963e-03 3 1  ON 91
ci_043                -3.619646e-03 3 1  ON 92
ci_044                -4.735102e-03 3 1  ON 93
ci_045                -2.856711e-03 3 1  ON 94
ci_046                 5.899324e-03 3 1  ON 95
ci_047                 5.864832e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4397e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.234
    reference variance = 0.250932
====================================================
  Execution time = 2.7079e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0473e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8670e-01
  Total weights = 1.966353197e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3843e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275263917538
                                         uncertainty =       0.001425159573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275263917538
                                         uncertainty =       0.001425159573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370965524
  error estimate for blocks of size 2^( 2) =       0.000385044733
  error estimate for blocks of size 2^( 3) =       0.000398324703
  error estimate for blocks of size 2^( 4) =       0.000408492486
  error estimate for blocks of size 2^( 5) =       0.000414759161
  error estimate for blocks of size 2^( 6) =       0.000417941739
  error estimate for blocks of size 2^( 7) =       0.000420929009

      target function =      -0.917282713715
              le_mean =     -17.209803022160
             les_mean =     296.464019149097
             stat err =       0.000415530599
             autocorr =       1.254697173430
   target nu stat err =       0.000415530599
   target dn stat err =       0.003300342698
      target stat err =       0.004331657778
              std dev =       0.524632869054
             le_variance =       0.275239647292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720980302216e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917302287564       residual = 9.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917365055270       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917377372576       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917379746629       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917381910371       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917383129318       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917384772415       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917385965003       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917387764863       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917388112919       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917388293061       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917388525169       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917388761925       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917389282889       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917390258407       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917390708829       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917390629616       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917390764390       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917390770884       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917390882961       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917390994308       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917390922411       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917391192142       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917391136455       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917391123938       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917391189410       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917391250206       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917391224186       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917391252148       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917391324813       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917391344609       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917391344635       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917391366444       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917391375138       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917391349525       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917391371894       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917391397264       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917391397841       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917391409098       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917391410786       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.917391415267       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.917391412818       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.917391409442       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.917391393382       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.917391391716       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 8.773555e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917302287564       residual = 9.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917319364575       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917322644938       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917323265082       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917323834555       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917324152673       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917324582751       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917324898391       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917325368369       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917325438243       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917325491595       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917325547350       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917325612901       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917325754171       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917326009102       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917326106326       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917326079552       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917326116746       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917326119365       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917326145510       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917326173913       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917326156693       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917326223845       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917326207665       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917326202243       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917326218914       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917326230760       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917326225668       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917326234094       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917326250402       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917326252626       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917326253844       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917326260151       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917326259529       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917326254984       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917326262603       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917326265879       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917326266461       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917326269388       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917326268776       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.917326269637       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.917326269283       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.917326267460       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.917326264139       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+00 is 2.258855e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917302287564       residual = 9.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917306653144       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917307486750       residual = 7.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917307643547       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917307787781       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917307868271       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917307976952       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917308057403       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917308176186       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917308192041       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917308206399       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917308219791       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917308236735       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917308272784       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917308337131       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917308360323       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917308353211       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917308362780       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917308363508       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917308369892       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917308377036       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917308372799       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917308389517       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917308385310       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917308383835       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917308388000       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917308390724       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917308389605       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917308391777       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917308395688       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917308396154       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917308396522       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917308398024       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917308397930       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917308396789       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917308398606       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917308399378       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917308399600       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917308400268       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917308400144       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.917308400324       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.917308400200       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.917308399738       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.917308398937       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+01 is 5.689316e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.262459 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5566e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.085231e-01 1 1  ON 0
  uu_1                 5.234272e-02 1 1  ON 1
  uu_2                -3.707544e-02 1 1  ON 2
  uu_3                -9.031757e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315727e-01 1 1  ON 5
  uu_6                -1.137365e-01 1 1  ON 6
  uu_7                -5.557788e-02 1 1  ON 7
  uu_8                 6.127800e-02 1 1  ON 8
  uu_9                 1.219791e-01 1 1  ON 9
  ud_0                 3.013149e-01 1 1  ON 10
  ud_1                 7.401281e-02 1 1  ON 11
  ud_2                -2.540112e-02 1 1  ON 12
  ud_3                -7.665100e-02 1 1  ON 13
  ud_4                -1.122479e-01 1 1  ON 14
  ud_5                -1.322669e-01 1 1  ON 15
  ud_6                -1.279218e-01 1 1  ON 16
  ud_7                -8.886466e-02 1 1  ON 17
  ud_8                -3.540260e-03 1 1  ON 18
  ud_9                 8.507307e-02 1 1  ON 19
  eO_0                -6.939946e-01 1 1  ON 20
  eO_1                -4.135594e-01 1 1  ON 21
  eO_2                -4.114949e-02 1 1  ON 22
  eO_3                 1.790343e-01 1 1  ON 23
  eO_4                 2.510271e-01 1 1  ON 24
  eO_5                 2.753397e-01 1 1  ON 25
  eO_6                 2.475306e-01 1 1  ON 26
  eO_7                 1.360260e-01 1 1  ON 27
  eO_8                 2.899403e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044552e-01 1 1  ON 30
 eH1_1                -9.984426e-02 1 1  ON 31
 eH1_2                -4.893707e-02 1 1  ON 32
 eH1_3                -1.761995e-02 1 1  ON 33
 eH1_4                 1.758602e-02 1 1  ON 34
 eH1_5                 2.530899e-02 1 1  ON 35
 eH1_6                 7.729653e-02 1 1  ON 36
 eH1_7                 1.064297e-01 1 1  ON 37
 eH1_8                 1.024289e-01 1 1  ON 38
 eH1_9                 2.574326e-02 1 1  ON 39
 eH2_0                -2.011076e-01 1 1  ON 40
 eH2_1                -9.666827e-02 1 1  ON 41
 eH2_2                -4.626126e-02 1 1  ON 42
 eH2_3                -1.568638e-02 1 1  ON 43
 eH2_4                 1.794417e-02 1 1  ON 44
 eH2_5                 2.169024e-02 1 1  ON 45
 eH2_6                 6.870795e-02 1 1  ON 46
 eH2_7                 1.058418e-01 1 1  ON 47
 eH2_8                 1.043312e-01 1 1  ON 48
 eH2_9                 2.822430e-02 1 1  ON 49
ci_001                -4.271294e-02 3 1  ON 50
ci_002                -3.126059e-02 3 1  ON 51
ci_003                -2.592497e-02 3 1  ON 52
ci_004                 2.446755e-02 3 1  ON 53
ci_005                 2.454748e-02 3 1  ON 54
ci_006                -2.040418e-02 3 1  ON 55
ci_007                -2.055655e-02 3 1  ON 56
ci_008                -8.973253e-03 3 1  ON 57
ci_009                -1.503416e-02 3 1  ON 58
ci_010                -9.360430e-03 3 1  ON 59
ci_011                -1.056481e-02 3 1  ON 60
ci_012                -1.039129e-02 3 1  ON 61
ci_013                -1.948752e-02 3 1  ON 62
ci_014                 1.305628e-02 3 1  ON 63
ci_015                 1.351177e-02 3 1  ON 64
ci_016                 1.652818e-02 3 1  ON 65
ci_017                 1.623697e-02 3 1  ON 66
ci_018                 1.036327e-02 3 1  ON 67
ci_019                 1.021818e-02 3 1  ON 68
ci_020                 1.667204e-02 3 1  ON 69
ci_021                 1.651232e-02 3 1  ON 70
ci_022                 1.078672e-02 3 1  ON 71
ci_023                 1.010053e-02 3 1  ON 72
ci_024                 7.658063e-03 3 1  ON 73
ci_025                 7.006472e-03 3 1  ON 74
ci_026                 1.183944e-02 3 1  ON 75
ci_027                 1.160641e-02 3 1  ON 76
ci_028                -1.508835e-02 3 1  ON 77
ci_029                -1.541988e-02 3 1  ON 78
ci_030                -4.853521e-03 3 1  ON 79
ci_031                -4.846269e-03 3 1  ON 80
ci_032                -1.516532e-02 3 1  ON 81
ci_033                 6.838864e-03 3 1  ON 82
ci_034                 7.368069e-03 3 1  ON 83
ci_035                -4.689884e-03 3 1  ON 84
ci_036                -1.283734e-02 3 1  ON 85
ci_037                -1.270311e-02 3 1  ON 86
ci_038                 1.242893e-03 3 1  ON 87
ci_039                 1.513686e-03 3 1  ON 88
ci_040                -2.764622e-03 3 1  ON 89
ci_041                 8.544561e-03 3 1  ON 90
ci_042                 8.304689e-03 3 1  ON 91
ci_043                -3.617661e-03 3 1  ON 92
ci_044                -4.698254e-03 3 1  ON 93
ci_045                -2.844989e-03 3 1  ON 94
ci_046                 5.908821e-03 3 1  ON 95
ci_047                 5.850805e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.0971
    reference variance = 1.65053
====================================================
  Execution time = 2.7035e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8659e-01
  Total weights = 1.9662e+06
  Execution time = 2.3495e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278398783605
                                         uncertainty =       0.001721314338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278398783605
                                         uncertainty =       0.001721314338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373064138
  error estimate for blocks of size 2^( 2) =       0.000387103875
  error estimate for blocks of size 2^( 3) =       0.000400280652
  error estimate for blocks of size 2^( 4) =       0.000410416549
  error estimate for blocks of size 2^( 5) =       0.000417146146
  error estimate for blocks of size 2^( 6) =       0.000419963067
  error estimate for blocks of size 2^( 7) =       0.000422029958

      target function =      -0.917528027263
              le_mean =     -17.210505186481
             les_mean =     296.488150671247
             stat err =       0.000417388930
             autocorr =       1.251742061893
   target nu stat err =       0.000417388930
   target dn stat err =       0.002200891758
      target stat err =       0.002927005288
              std dev =       0.527600805650
             le_variance =       0.278362610122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278414073006
                                         uncertainty =       0.001724438041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278414073006
                                         uncertainty =       0.001724438041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373074276
  error estimate for blocks of size 2^( 2) =       0.000387133541
  error estimate for blocks of size 2^( 3) =       0.000400329214
  error estimate for blocks of size 2^( 4) =       0.000410480849
  error estimate for blocks of size 2^( 5) =       0.000417214054
  error estimate for blocks of size 2^( 6) =       0.000420039712
  error estimate for blocks of size 2^( 7) =       0.000422100779

      target function =      -0.917654659987
              le_mean =     -17.210506488575
             les_mean =     296.488098529365
             stat err =       0.000417458848
             autocorr =       1.252093418551
   target nu stat err =       0.000417458848
   target dn stat err =       0.002202009583
      target stat err =       0.002929248872
              std dev =       0.527615141865
             le_variance =       0.278377737925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278404863959
                                         uncertainty =       0.001722932378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278404863959
                                         uncertainty =       0.001722932378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373068156
  error estimate for blocks of size 2^( 2) =       0.000387118258
  error estimate for blocks of size 2^( 3) =       0.000400305087
  error estimate for blocks of size 2^( 4) =       0.000410449253
  error estimate for blocks of size 2^( 5) =       0.000417180641
  error estimate for blocks of size 2^( 6) =       0.000420002189
  error estimate for blocks of size 2^( 7) =       0.000422066061

      target function =      -0.917663686471
              le_mean =     -17.210505542405
             les_mean =     296.488058857050
             stat err =       0.000417424536
             autocorr =       1.251928669832
   target nu stat err =       0.000417424536
   target dn stat err =       0.002199262413
      target stat err =       0.002925786255
              std dev =       0.527606487546
             le_variance =       0.278368605701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278399248037
                                         uncertainty =       0.001721512106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278399248037
                                         uncertainty =       0.001721512106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373064443
  error estimate for blocks of size 2^( 2) =       0.000387105437
  error estimate for blocks of size 2^( 3) =       0.000400283475
  error estimate for blocks of size 2^( 4) =       0.000410420380
  error estimate for blocks of size 2^( 5) =       0.000417150339
  error estimate for blocks of size 2^( 6) =       0.000419967777
  error estimate for blocks of size 2^( 7) =       0.000422034443

      target function =      -0.917286477892
              le_mean =     -17.210505254105
             les_mean =     296.488338466973
             stat err =       0.000417393235
             autocorr =       1.251765841897
   target nu stat err =       0.000417393235
   target dn stat err =       0.002211051709
      target stat err =       0.002938450277
              std dev =       0.527601235704
             le_variance =       0.278363063917


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917528027263        initial
     6.2500e-01     6.2500e+00             8.7736e-04        -0.917654659987
     2.5000e+00     2.5000e+01             2.2589e-04        -0.917663686471  <--
     1.0000e+01     1.0000e+02             5.6893e-05        -0.917286477892

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 3.8893e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.085231e-01 1 1  ON 0
  uu_1                 5.234272e-02 1 1  ON 1
  uu_2                -3.707544e-02 1 1  ON 2
  uu_3                -9.031757e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315727e-01 1 1  ON 5
  uu_6                -1.137365e-01 1 1  ON 6
  uu_7                -5.557788e-02 1 1  ON 7
  uu_8                 6.127800e-02 1 1  ON 8
  uu_9                 1.219791e-01 1 1  ON 9
  ud_0                 3.013149e-01 1 1  ON 10
  ud_1                 7.401281e-02 1 1  ON 11
  ud_2                -2.540112e-02 1 1  ON 12
  ud_3                -7.665100e-02 1 1  ON 13
  ud_4                -1.122479e-01 1 1  ON 14
  ud_5                -1.322669e-01 1 1  ON 15
  ud_6                -1.279218e-01 1 1  ON 16
  ud_7                -8.886466e-02 1 1  ON 17
  ud_8                -3.540260e-03 1 1  ON 18
  ud_9                 8.507307e-02 1 1  ON 19
  eO_0                -6.939946e-01 1 1  ON 20
  eO_1                -4.135594e-01 1 1  ON 21
  eO_2                -4.114949e-02 1 1  ON 22
  eO_3                 1.790343e-01 1 1  ON 23
  eO_4                 2.510271e-01 1 1  ON 24
  eO_5                 2.753397e-01 1 1  ON 25
  eO_6                 2.475306e-01 1 1  ON 26
  eO_7                 1.360260e-01 1 1  ON 27
  eO_8                 2.899403e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044552e-01 1 1  ON 30
 eH1_1                -9.984426e-02 1 1  ON 31
 eH1_2                -4.893707e-02 1 1  ON 32
 eH1_3                -1.761995e-02 1 1  ON 33
 eH1_4                 1.758602e-02 1 1  ON 34
 eH1_5                 2.530899e-02 1 1  ON 35
 eH1_6                 7.729653e-02 1 1  ON 36
 eH1_7                 1.064297e-01 1 1  ON 37
 eH1_8                 1.024289e-01 1 1  ON 38
 eH1_9                 2.574326e-02 1 1  ON 39
 eH2_0                -2.011076e-01 1 1  ON 40
 eH2_1                -9.666827e-02 1 1  ON 41
 eH2_2                -4.626126e-02 1 1  ON 42
 eH2_3                -1.568638e-02 1 1  ON 43
 eH2_4                 1.794417e-02 1 1  ON 44
 eH2_5                 2.169024e-02 1 1  ON 45
 eH2_6                 6.870795e-02 1 1  ON 46
 eH2_7                 1.058418e-01 1 1  ON 47
 eH2_8                 1.043312e-01 1 1  ON 48
 eH2_9                 2.822430e-02 1 1  ON 49
ci_001                -4.271294e-02 3 1  ON 50
ci_002                -3.126059e-02 3 1  ON 51
ci_003                -2.592497e-02 3 1  ON 52
ci_004                 2.446755e-02 3 1  ON 53
ci_005                 2.454748e-02 3 1  ON 54
ci_006                -2.040418e-02 3 1  ON 55
ci_007                -2.055655e-02 3 1  ON 56
ci_008                -8.973253e-03 3 1  ON 57
ci_009                -1.503416e-02 3 1  ON 58
ci_010                -9.360430e-03 3 1  ON 59
ci_011                -1.056481e-02 3 1  ON 60
ci_012                -1.039129e-02 3 1  ON 61
ci_013                -1.948752e-02 3 1  ON 62
ci_014                 1.305628e-02 3 1  ON 63
ci_015                 1.351177e-02 3 1  ON 64
ci_016                 1.652818e-02 3 1  ON 65
ci_017                 1.623697e-02 3 1  ON 66
ci_018                 1.036327e-02 3 1  ON 67
ci_019                 1.021818e-02 3 1  ON 68
ci_020                 1.667204e-02 3 1  ON 69
ci_021                 1.651232e-02 3 1  ON 70
ci_022                 1.078672e-02 3 1  ON 71
ci_023                 1.010053e-02 3 1  ON 72
ci_024                 7.658063e-03 3 1  ON 73
ci_025                 7.006472e-03 3 1  ON 74
ci_026                 1.183944e-02 3 1  ON 75
ci_027                 1.160641e-02 3 1  ON 76
ci_028                -1.508835e-02 3 1  ON 77
ci_029                -1.541988e-02 3 1  ON 78
ci_030                -4.853521e-03 3 1  ON 79
ci_031                -4.846269e-03 3 1  ON 80
ci_032                -1.516532e-02 3 1  ON 81
ci_033                 6.838864e-03 3 1  ON 82
ci_034                 7.368069e-03 3 1  ON 83
ci_035                -4.689884e-03 3 1  ON 84
ci_036                -1.283734e-02 3 1  ON 85
ci_037                -1.270311e-02 3 1  ON 86
ci_038                 1.242893e-03 3 1  ON 87
ci_039                 1.513686e-03 3 1  ON 88
ci_040                -2.764622e-03 3 1  ON 89
ci_041                 8.544561e-03 3 1  ON 90
ci_042                 8.304689e-03 3 1  ON 91
ci_043                -3.617661e-03 3 1  ON 92
ci_044                -4.698254e-03 3 1  ON 93
ci_045                -2.844989e-03 3 1  ON 94
ci_046                 5.908821e-03 3 1  ON 95
ci_047                 5.850805e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4466e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7190e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1435
    reference variance = 0.171189
====================================================
  Execution time = 2.7233e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0490e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8421e-01
  Total weights = 1.966339289e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3385e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275438452241
                                         uncertainty =       0.001656930033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275438452241
                                         uncertainty =       0.001656930033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371047995
  error estimate for blocks of size 2^( 2) =       0.000385331240
  error estimate for blocks of size 2^( 3) =       0.000398302690
  error estimate for blocks of size 2^( 4) =       0.000407183671
  error estimate for blocks of size 2^( 5) =       0.000413466143
  error estimate for blocks of size 2^( 6) =       0.000417011583
  error estimate for blocks of size 2^( 7) =       0.000418615858

      target function =      -0.920645793697
              le_mean =     -17.210209671065
             les_mean =     296.475531519312
             stat err =       0.000414069314
             autocorr =       1.245334201244
   target nu stat err =       0.000414069314
   target dn stat err =       0.002264645563
      target stat err =       0.003026141823
              std dev =       0.524749502267
             le_variance =       0.275362040129


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721020967106e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920654922395       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920678688263       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920685296684       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920687035861       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920687849942       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920687736445       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920687961778       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920687941583       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920687940383       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920688000034       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920688086138       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920688022052       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920687863159       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920687957246       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920688125403       residual = 7.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920688244762       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920688217225       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920688146263       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920688191750       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920688249305       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920688372565       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920688365916       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920688452909       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920688520577       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920688448102       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920688452816       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920688508923       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920688511093       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920688532116       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920688481715       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920688471268       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920688472104       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920688483201       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920688475448       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920688465126       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920688484281       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.920688499711       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.920688502213       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.920688503084       residual = 9.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 5.308083e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920654922395       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920661378075       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920663166329       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920663614725       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920663838107       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920663808822       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920663863755       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920663860546       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920663858929       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920663873550       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920663895758       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920663879010       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920663836789       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920663864001       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920663910385       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920663936871       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920663927726       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920663909903       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920663923167       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920663938945       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920663969131       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920663967688       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920663989040       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920664005693       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920663986140       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920663989266       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920664001766       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920664000239       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920664003686       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920663991821       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920663990902       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920663992394       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920663994065       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920663991184       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920663989716       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920663995163       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.920663998396       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.920663998302       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+00 is 1.330312e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920654922395       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920656572006       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920657028492       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920657141432       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920657198638       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920657191291       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920657204919       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920657204201       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920657203729       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920657207357       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920657212958       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920657208709       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920657197997       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920657205066       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920657216937       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920657223302       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920657220869       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920657216428       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920657219884       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920657223909       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920657231399       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920657231049       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920657236366       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920657240493       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920657235537       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920657236444       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920657239442       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920657238920       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920657239683       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920657236807       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920657236654       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920657237129       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920657237425       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920657236707       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920657236369       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920657237678       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.920657238579       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.920657238446       residual = 8.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+01 is 3.328211e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.326150 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5643e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.085155e-01 1 1  ON 0
  uu_1                 5.233369e-02 1 1  ON 1
  uu_2                -3.707869e-02 1 1  ON 2
  uu_3                -9.030693e-02 1 1  ON 3
  uu_4                -1.222688e-01 1 1  ON 4
  uu_5                -1.315720e-01 1 1  ON 5
  uu_6                -1.137160e-01 1 1  ON 6
  uu_7                -5.553869e-02 1 1  ON 7
  uu_8                 6.118188e-02 1 1  ON 8
  uu_9                 1.219920e-01 1 1  ON 9
  ud_0                 3.013277e-01 1 1  ON 10
  ud_1                 7.402025e-02 1 1  ON 11
  ud_2                -2.540132e-02 1 1  ON 12
  ud_3                -7.664842e-02 1 1  ON 13
  ud_4                -1.122543e-01 1 1  ON 14
  ud_5                -1.322657e-01 1 1  ON 15
  ud_6                -1.279782e-01 1 1  ON 16
  ud_7                -8.883189e-02 1 1  ON 17
  ud_8                -3.552226e-03 1 1  ON 18
  ud_9                 8.503175e-02 1 1  ON 19
  eO_0                -6.940400e-01 1 1  ON 20
  eO_1                -4.135840e-01 1 1  ON 21
  eO_2                -4.118815e-02 1 1  ON 22
  eO_3                 1.790263e-01 1 1  ON 23
  eO_4                 2.510472e-01 1 1  ON 24
  eO_5                 2.752452e-01 1 1  ON 25
  eO_6                 2.475881e-01 1 1  ON 26
  eO_7                 1.361590e-01 1 1  ON 27
  eO_8                 2.899491e-02 1 1  ON 28
  eO_9                 1.933661e-02 1 1  ON 29
 eH1_0                -2.044885e-01 1 1  ON 30
 eH1_1                -9.988502e-02 1 1  ON 31
 eH1_2                -4.897360e-02 1 1  ON 32
 eH1_3                -1.764397e-02 1 1  ON 33
 eH1_4                 1.759925e-02 1 1  ON 34
 eH1_5                 2.535967e-02 1 1  ON 35
 eH1_6                 7.727763e-02 1 1  ON 36
 eH1_7                 1.064560e-01 1 1  ON 37
 eH1_8                 1.024792e-01 1 1  ON 38
 eH1_9                 2.575416e-02 1 1  ON 39
 eH2_0                -2.010780e-01 1 1  ON 40
 eH2_1                -9.668915e-02 1 1  ON 41
 eH2_2                -4.628826e-02 1 1  ON 42
 eH2_3                -1.572194e-02 1 1  ON 43
 eH2_4                 1.793564e-02 1 1  ON 44
 eH2_5                 2.165942e-02 1 1  ON 45
 eH2_6                 6.876074e-02 1 1  ON 46
 eH2_7                 1.058134e-01 1 1  ON 47
 eH2_8                 1.043978e-01 1 1  ON 48
 eH2_9                 2.822788e-02 1 1  ON 49
ci_001                -4.268788e-02 3 1  ON 50
ci_002                -3.123563e-02 3 1  ON 51
ci_003                -2.594719e-02 3 1  ON 52
ci_004                 2.445690e-02 3 1  ON 53
ci_005                 2.452745e-02 3 1  ON 54
ci_006                -2.039395e-02 3 1  ON 55
ci_007                -2.053569e-02 3 1  ON 56
ci_008                -8.981162e-03 3 1  ON 57
ci_009                -1.505386e-02 3 1  ON 58
ci_010                -9.402377e-03 3 1  ON 59
ci_011                -1.059412e-02 3 1  ON 60
ci_012                -1.041197e-02 3 1  ON 61
ci_013                -1.946937e-02 3 1  ON 62
ci_014                 1.306776e-02 3 1  ON 63
ci_015                 1.350020e-02 3 1  ON 64
ci_016                 1.652630e-02 3 1  ON 65
ci_017                 1.622929e-02 3 1  ON 66
ci_018                 1.034180e-02 3 1  ON 67
ci_019                 1.022969e-02 3 1  ON 68
ci_020                 1.664077e-02 3 1  ON 69
ci_021                 1.651680e-02 3 1  ON 70
ci_022                 1.079283e-02 3 1  ON 71
ci_023                 1.008740e-02 3 1  ON 72
ci_024                 7.670967e-03 3 1  ON 73
ci_025                 7.035836e-03 3 1  ON 74
ci_026                 1.182264e-02 3 1  ON 75
ci_027                 1.162400e-02 3 1  ON 76
ci_028                -1.508864e-02 3 1  ON 77
ci_029                -1.544586e-02 3 1  ON 78
ci_030                -4.875304e-03 3 1  ON 79
ci_031                -4.857250e-03 3 1  ON 80
ci_032                -1.517750e-02 3 1  ON 81
ci_033                 6.859801e-03 3 1  ON 82
ci_034                 7.350359e-03 3 1  ON 83
ci_035                -4.686679e-03 3 1  ON 84
ci_036                -1.284722e-02 3 1  ON 85
ci_037                -1.269538e-02 3 1  ON 86
ci_038                 1.234876e-03 3 1  ON 87
ci_039                 1.503697e-03 3 1  ON 88
ci_040                -2.767787e-03 3 1  ON 89
ci_041                 8.546424e-03 3 1  ON 90
ci_042                 8.275038e-03 3 1  ON 91
ci_043                -3.616404e-03 3 1  ON 92
ci_044                -4.721002e-03 3 1  ON 93
ci_045                -2.828647e-03 3 1  ON 94
ci_046                 5.903644e-03 3 1  ON 95
ci_047                 5.865899e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2201
    reference variance = 0.213626
====================================================
  Execution time = 2.7049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8674e-01
  Total weights = 1.9665e+06
  Execution time = 2.3557e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276808707390
                                         uncertainty =       0.001671942873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276808707390
                                         uncertainty =       0.001671942873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372013507
  error estimate for blocks of size 2^( 2) =       0.000386102814
  error estimate for blocks of size 2^( 3) =       0.000398572820
  error estimate for blocks of size 2^( 4) =       0.000408057681
  error estimate for blocks of size 2^( 5) =       0.000413587073
  error estimate for blocks of size 2^( 6) =       0.000415982551
  error estimate for blocks of size 2^( 7) =       0.000420951569

      target function =      -0.917365263373
              le_mean =     -17.210213751687
             les_mean =     296.478184687049
             stat err =       0.000414644718
             autocorr =       1.242323951627
   target nu stat err =       0.000414644718
   target dn stat err =       0.002276740706
      target stat err =       0.003020638403
              std dev =       0.526114964853
             le_variance =       0.276796956243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276780671083
                                         uncertainty =       0.001669700390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276780671083
                                         uncertainty =       0.001669700390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371994710
  error estimate for blocks of size 2^( 2) =       0.000386071868
  error estimate for blocks of size 2^( 3) =       0.000398528284
  error estimate for blocks of size 2^( 4) =       0.000408006388
  error estimate for blocks of size 2^( 5) =       0.000413535381
  error estimate for blocks of size 2^( 6) =       0.000415933608
  error estimate for blocks of size 2^( 7) =       0.000420904509

      target function =      -0.917250842302
              le_mean =     -17.210216739290
             les_mean =     296.478375997439
             stat err =       0.000414594972
             autocorr =       1.242151399963
   target nu stat err =       0.000414594972
   target dn stat err =       0.002287511864
      target stat err =       0.003033646207
              std dev =       0.526088381110
             le_variance =       0.276768984739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276792766199
                                         uncertainty =       0.001670723669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276792766199
                                         uncertainty =       0.001670723669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372002818
  error estimate for blocks of size 2^( 2) =       0.000386085583
  error estimate for blocks of size 2^( 3) =       0.000398548275
  error estimate for blocks of size 2^( 4) =       0.000408029498
  error estimate for blocks of size 2^( 5) =       0.000413558719
  error estimate for blocks of size 2^( 6) =       0.000415955763
  error estimate for blocks of size 2^( 7) =       0.000420925964

      target function =      -0.916982970614
              le_mean =     -17.210215282289
             les_mean =     296.478531446662
             stat err =       0.000414617486
             autocorr =       1.242232160586
   target nu stat err =       0.000414617486
   target dn stat err =       0.002297250705
      target stat err =       0.003044331142
              std dev =       0.526099848142
             le_variance =       0.276781050215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276806554070
                                         uncertainty =       0.001671786288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276806554070
                                         uncertainty =       0.001671786288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372012063
  error estimate for blocks of size 2^( 2) =       0.000386100535
  error estimate for blocks of size 2^( 3) =       0.000398569608
  error estimate for blocks of size 2^( 4) =       0.000408054010
  error estimate for blocks of size 2^( 5) =       0.000413583377
  error estimate for blocks of size 2^( 6) =       0.000415979048
  error estimate for blocks of size 2^( 7) =       0.000420948192

      target function =      -0.917362086196
              le_mean =     -17.210213923317
             les_mean =     296.478193066964
             stat err =       0.000414641157
             autocorr =       1.242312254615
   target nu stat err =       0.000414641157
   target dn stat err =       0.002277373723
      target stat err =       0.003021425711
              std dev =       0.526112922719
             le_variance =       0.276794807451


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917365263373        initial  <--
     6.2500e-01     6.2500e+00             5.3081e-04        -0.917250842302
     2.5000e+00     2.5000e+01             1.3303e-04        -0.916982970614
     1.0000e+01     1.0000e+02             3.3282e-05        -0.917362086196

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9208
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.085231e-01 1 1  ON 0
  uu_1                 5.234272e-02 1 1  ON 1
  uu_2                -3.707544e-02 1 1  ON 2
  uu_3                -9.031757e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315727e-01 1 1  ON 5
  uu_6                -1.137365e-01 1 1  ON 6
  uu_7                -5.557788e-02 1 1  ON 7
  uu_8                 6.127800e-02 1 1  ON 8
  uu_9                 1.219791e-01 1 1  ON 9
  ud_0                 3.013149e-01 1 1  ON 10
  ud_1                 7.401281e-02 1 1  ON 11
  ud_2                -2.540112e-02 1 1  ON 12
  ud_3                -7.665100e-02 1 1  ON 13
  ud_4                -1.122479e-01 1 1  ON 14
  ud_5                -1.322669e-01 1 1  ON 15
  ud_6                -1.279218e-01 1 1  ON 16
  ud_7                -8.886466e-02 1 1  ON 17
  ud_8                -3.540260e-03 1 1  ON 18
  ud_9                 8.507307e-02 1 1  ON 19
  eO_0                -6.939946e-01 1 1  ON 20
  eO_1                -4.135594e-01 1 1  ON 21
  eO_2                -4.114949e-02 1 1  ON 22
  eO_3                 1.790343e-01 1 1  ON 23
  eO_4                 2.510271e-01 1 1  ON 24
  eO_5                 2.753397e-01 1 1  ON 25
  eO_6                 2.475306e-01 1 1  ON 26
  eO_7                 1.360260e-01 1 1  ON 27
  eO_8                 2.899403e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044552e-01 1 1  ON 30
 eH1_1                -9.984426e-02 1 1  ON 31
 eH1_2                -4.893707e-02 1 1  ON 32
 eH1_3                -1.761995e-02 1 1  ON 33
 eH1_4                 1.758602e-02 1 1  ON 34
 eH1_5                 2.530899e-02 1 1  ON 35
 eH1_6                 7.729653e-02 1 1  ON 36
 eH1_7                 1.064297e-01 1 1  ON 37
 eH1_8                 1.024289e-01 1 1  ON 38
 eH1_9                 2.574326e-02 1 1  ON 39
 eH2_0                -2.011076e-01 1 1  ON 40
 eH2_1                -9.666827e-02 1 1  ON 41
 eH2_2                -4.626126e-02 1 1  ON 42
 eH2_3                -1.568638e-02 1 1  ON 43
 eH2_4                 1.794417e-02 1 1  ON 44
 eH2_5                 2.169024e-02 1 1  ON 45
 eH2_6                 6.870795e-02 1 1  ON 46
 eH2_7                 1.058418e-01 1 1  ON 47
 eH2_8                 1.043312e-01 1 1  ON 48
 eH2_9                 2.822430e-02 1 1  ON 49
ci_001                -4.271294e-02 3 1  ON 50
ci_002                -3.126059e-02 3 1  ON 51
ci_003                -2.592497e-02 3 1  ON 52
ci_004                 2.446755e-02 3 1  ON 53
ci_005                 2.454748e-02 3 1  ON 54
ci_006                -2.040418e-02 3 1  ON 55
ci_007                -2.055655e-02 3 1  ON 56
ci_008                -8.973253e-03 3 1  ON 57
ci_009                -1.503416e-02 3 1  ON 58
ci_010                -9.360430e-03 3 1  ON 59
ci_011                -1.056481e-02 3 1  ON 60
ci_012                -1.039129e-02 3 1  ON 61
ci_013                -1.948752e-02 3 1  ON 62
ci_014                 1.305628e-02 3 1  ON 63
ci_015                 1.351177e-02 3 1  ON 64
ci_016                 1.652818e-02 3 1  ON 65
ci_017                 1.623697e-02 3 1  ON 66
ci_018                 1.036327e-02 3 1  ON 67
ci_019                 1.021818e-02 3 1  ON 68
ci_020                 1.667204e-02 3 1  ON 69
ci_021                 1.651232e-02 3 1  ON 70
ci_022                 1.078672e-02 3 1  ON 71
ci_023                 1.010053e-02 3 1  ON 72
ci_024                 7.658063e-03 3 1  ON 73
ci_025                 7.006472e-03 3 1  ON 74
ci_026                 1.183944e-02 3 1  ON 75
ci_027                 1.160641e-02 3 1  ON 76
ci_028                -1.508835e-02 3 1  ON 77
ci_029                -1.541988e-02 3 1  ON 78
ci_030                -4.853521e-03 3 1  ON 79
ci_031                -4.846269e-03 3 1  ON 80
ci_032                -1.516532e-02 3 1  ON 81
ci_033                 6.838864e-03 3 1  ON 82
ci_034                 7.368069e-03 3 1  ON 83
ci_035                -4.689884e-03 3 1  ON 84
ci_036                -1.283734e-02 3 1  ON 85
ci_037                -1.270311e-02 3 1  ON 86
ci_038                 1.242893e-03 3 1  ON 87
ci_039                 1.513686e-03 3 1  ON 88
ci_040                -2.764622e-03 3 1  ON 89
ci_041                 8.544561e-03 3 1  ON 90
ci_042                 8.304689e-03 3 1  ON 91
ci_043                -3.617661e-03 3 1  ON 92
ci_044                -4.698254e-03 3 1  ON 93
ci_045                -2.844989e-03 3 1  ON 94
ci_046                 5.908821e-03 3 1  ON 95
ci_047                 5.850805e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4570e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7190e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2726
    reference variance = 0.18296
====================================================
  Execution time = 2.7300e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0474e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8757e-01
  Total weights = 1.966634345e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5859e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276553698944
                                         uncertainty =       0.001674206655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276553698944
                                         uncertainty =       0.001674206655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371829992
  error estimate for blocks of size 2^( 2) =       0.000386156542
  error estimate for blocks of size 2^( 3) =       0.000399049856
  error estimate for blocks of size 2^( 4) =       0.000409227966
  error estimate for blocks of size 2^( 5) =       0.000415302405
  error estimate for blocks of size 2^( 6) =       0.000418717078
  error estimate for blocks of size 2^( 7) =       0.000419672100

      target function =      -0.916259328242
              le_mean =     -17.210246178652
             les_mean =     296.480147254985
             stat err =       0.000415729887
             autocorr =       1.250068063523
   target nu stat err =       0.000415729887
   target dn stat err =       0.003595877000
      target stat err =       0.004705509871
              std dev =       0.525855431390
             le_variance =       0.276523934722


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721024617865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916282740618       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916288584791       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916289595573       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916289907266       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916290011127       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916290031087       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916290038768       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916290125656       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916290140426       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916290187057       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916290200914       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916290230078       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916290229523       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916290245188       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916290279008       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916290315047       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916290339840       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916290355995       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916290367439       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916290373047       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916290380936       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916290387559       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916290402268       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916290396874       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916290394543       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916290398458       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916290397170       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916290397339       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916290395523       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916290399893       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916290403372       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916290407665       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916290409426       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916290407995       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916290407462       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916290404497       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916290403923       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916290405154       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916290407204       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916290406536       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.916290406009       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+00 is 6.043703e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916282740618       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916284215493       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916284469900       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916284548074       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916284574334       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916284579231       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916284581227       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916284603124       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916284606751       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916284618498       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916284621940       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916284629254       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916284629129       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916284633090       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916284641593       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916284650585       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916284656758       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916284660817       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916284663694       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916284665059       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916284667010       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916284668653       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916284672311       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916284670918       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916284670386       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916284671349       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916284671018       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916284671042       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916284670591       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916284671682       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916284672565       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916284673636       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916284674063       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916284673684       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916284673544       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916284672816       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916284672682       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916284672992       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916284673491       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916284673319       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.916284673189       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+01 is 1.512339e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916282740618       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916283110212       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916283173921       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916283193480       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916283200064       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916283201282       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916283201786       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916283207271       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916283208174       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916283211116       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916283211975       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916283213805       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916283213775       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916283214768       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916283216897       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916283219144       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916283220685       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916283221702       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916283222422       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916283222761       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916283223247       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916283223657       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916283224570       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916283224219       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916283224089       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916283224329       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916283224246       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916283224251       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916283224138       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916283224411       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916283224632       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916283224900       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916283225006       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916283224910       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916283224874       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916283224693       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916283224660       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916283224738       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916283224862       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916283224819       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.916283224786       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+02 is 3.781730e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.401751 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7170e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.085277e-01 1 1  ON 0
  uu_1                 5.234648e-02 1 1  ON 1
  uu_2                -3.707348e-02 1 1  ON 2
  uu_3                -9.031651e-02 1 1  ON 3
  uu_4                -1.222786e-01 1 1  ON 4
  uu_5                -1.315708e-01 1 1  ON 5
  uu_6                -1.137355e-01 1 1  ON 6
  uu_7                -5.558444e-02 1 1  ON 7
  uu_8                 6.126288e-02 1 1  ON 8
  uu_9                 1.219795e-01 1 1  ON 9
  ud_0                 3.013069e-01 1 1  ON 10
  ud_1                 7.400549e-02 1 1  ON 11
  ud_2                -2.540855e-02 1 1  ON 12
  ud_3                -7.665789e-02 1 1  ON 13
  ud_4                -1.122518e-01 1 1  ON 14
  ud_5                -1.322679e-01 1 1  ON 15
  ud_6                -1.279160e-01 1 1  ON 16
  ud_7                -8.885165e-02 1 1  ON 17
  ud_8                -3.534407e-03 1 1  ON 18
  ud_9                 8.507527e-02 1 1  ON 19
  eO_0                -6.939989e-01 1 1  ON 20
  eO_1                -4.135618e-01 1 1  ON 21
  eO_2                -4.115690e-02 1 1  ON 22
  eO_3                 1.790302e-01 1 1  ON 23
  eO_4                 2.510247e-01 1 1  ON 24
  eO_5                 2.753391e-01 1 1  ON 25
  eO_6                 2.475388e-01 1 1  ON 26
  eO_7                 1.360365e-01 1 1  ON 27
  eO_8                 2.899533e-02 1 1  ON 28
  eO_9                 1.933979e-02 1 1  ON 29
 eH1_0                -2.044593e-01 1 1  ON 30
 eH1_1                -9.984878e-02 1 1  ON 31
 eH1_2                -4.894234e-02 1 1  ON 32
 eH1_3                -1.762246e-02 1 1  ON 33
 eH1_4                 1.758701e-02 1 1  ON 34
 eH1_5                 2.531589e-02 1 1  ON 35
 eH1_6                 7.729984e-02 1 1  ON 36
 eH1_7                 1.064274e-01 1 1  ON 37
 eH1_8                 1.024338e-01 1 1  ON 38
 eH1_9                 2.574572e-02 1 1  ON 39
 eH2_0                -2.011087e-01 1 1  ON 40
 eH2_1                -9.666540e-02 1 1  ON 41
 eH2_2                -4.625772e-02 1 1  ON 42
 eH2_3                -1.568197e-02 1 1  ON 43
 eH2_4                 1.795001e-02 1 1  ON 44
 eH2_5                 2.168176e-02 1 1  ON 45
 eH2_6                 6.869781e-02 1 1  ON 46
 eH2_7                 1.058387e-01 1 1  ON 47
 eH2_8                 1.043351e-01 1 1  ON 48
 eH2_9                 2.822582e-02 1 1  ON 49
ci_001                -4.271088e-02 3 1  ON 50
ci_002                -3.126102e-02 3 1  ON 51
ci_003                -2.592271e-02 3 1  ON 52
ci_004                 2.446921e-02 3 1  ON 53
ci_005                 2.454754e-02 3 1  ON 54
ci_006                -2.040475e-02 3 1  ON 55
ci_007                -2.055886e-02 3 1  ON 56
ci_008                -8.969570e-03 3 1  ON 57
ci_009                -1.503494e-02 3 1  ON 58
ci_010                -9.362440e-03 3 1  ON 59
ci_011                -1.056586e-02 3 1  ON 60
ci_012                -1.038773e-02 3 1  ON 61
ci_013                -1.948724e-02 3 1  ON 62
ci_014                 1.305751e-02 3 1  ON 63
ci_015                 1.351183e-02 3 1  ON 64
ci_016                 1.652951e-02 3 1  ON 65
ci_017                 1.623837e-02 3 1  ON 66
ci_018                 1.036353e-02 3 1  ON 67
ci_019                 1.022318e-02 3 1  ON 68
ci_020                 1.667062e-02 3 1  ON 69
ci_021                 1.651183e-02 3 1  ON 70
ci_022                 1.078315e-02 3 1  ON 71
ci_023                 1.009302e-02 3 1  ON 72
ci_024                 7.653675e-03 3 1  ON 73
ci_025                 7.010665e-03 3 1  ON 74
ci_026                 1.183727e-02 3 1  ON 75
ci_027                 1.160597e-02 3 1  ON 76
ci_028                -1.508870e-02 3 1  ON 77
ci_029                -1.541851e-02 3 1  ON 78
ci_030                -4.854355e-03 3 1  ON 79
ci_031                -4.844950e-03 3 1  ON 80
ci_032                -1.516429e-02 3 1  ON 81
ci_033                 6.837357e-03 3 1  ON 82
ci_034                 7.367989e-03 3 1  ON 83
ci_035                -4.690245e-03 3 1  ON 84
ci_036                -1.283512e-02 3 1  ON 85
ci_037                -1.270619e-02 3 1  ON 86
ci_038                 1.241270e-03 3 1  ON 87
ci_039                 1.513416e-03 3 1  ON 88
ci_040                -2.766445e-03 3 1  ON 89
ci_041                 8.540877e-03 3 1  ON 90
ci_042                 8.306256e-03 3 1  ON 91
ci_043                -3.617426e-03 3 1  ON 92
ci_044                -4.696538e-03 3 1  ON 93
ci_045                -2.847516e-03 3 1  ON 94
ci_046                 5.907181e-03 3 1  ON 95
ci_047                 5.851938e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2076
    reference variance = 0.409413
====================================================
  Execution time = 2.7118e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8818e-01
  Total weights = 1.9665e+06
  Execution time = 2.3775e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278836498838
                                         uncertainty =       0.001785967786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278836498838
                                         uncertainty =       0.001785967786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373353053
  error estimate for blocks of size 2^( 2) =       0.000387249314
  error estimate for blocks of size 2^( 3) =       0.000400289890
  error estimate for blocks of size 2^( 4) =       0.000409846415
  error estimate for blocks of size 2^( 5) =       0.000415311829
  error estimate for blocks of size 2^( 6) =       0.000419306596
  error estimate for blocks of size 2^( 7) =       0.000422124926

      target function =      -0.915594405035
              le_mean =     -17.210637662663
             les_mean =     296.494222810291
             stat err =       0.000416647441
             autocorr =       1.245368925145
   target nu stat err =       0.000416647441
   target dn stat err =       0.002546255846
      target stat err =       0.003355272296
              std dev =       0.528009398769
             le_variance =       0.278793925189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278838626568
                                         uncertainty =       0.001785909829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278838626568
                                         uncertainty =       0.001785909829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373354506
  error estimate for blocks of size 2^( 2) =       0.000387251709
  error estimate for blocks of size 2^( 3) =       0.000400293097
  error estimate for blocks of size 2^( 4) =       0.000409850327
  error estimate for blocks of size 2^( 5) =       0.000415316404
  error estimate for blocks of size 2^( 6) =       0.000419311696
  error estimate for blocks of size 2^( 7) =       0.000422130203

      target function =      -0.915544368820
              le_mean =     -17.210637769928
             les_mean =     296.494265032341
             stat err =       0.000416652157
             autocorr =       1.245387423100
   target nu stat err =       0.000416652157
   target dn stat err =       0.002555671343
      target stat err =       0.003366935710
              std dev =       0.528011453780
             le_variance =       0.278796095323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278837549199
                                         uncertainty =       0.001785937936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278837549199
                                         uncertainty =       0.001785937936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373353770
  error estimate for blocks of size 2^( 2) =       0.000387250505
  error estimate for blocks of size 2^( 3) =       0.000400291490
  error estimate for blocks of size 2^( 4) =       0.000409848370
  error estimate for blocks of size 2^( 5) =       0.000415314117
  error estimate for blocks of size 2^( 6) =       0.000419309149
  error estimate for blocks of size 2^( 7) =       0.000422127565

      target function =      -0.915569601537
              le_mean =     -17.210637713827
             les_mean =     296.494243669952
             stat err =       0.000416649800
             autocorr =       1.245378239034
   target nu stat err =       0.000416649800
   target dn stat err =       0.002550959354
      target stat err =       0.003361100287
              std dev =       0.528010413667
             le_variance =       0.278794996941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278836627857
                                         uncertainty =       0.001785963985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278836627857
                                         uncertainty =       0.001785963985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373353141
  error estimate for blocks of size 2^( 2) =       0.000387249461
  error estimate for blocks of size 2^( 3) =       0.000400290088
  error estimate for blocks of size 2^( 4) =       0.000409846658
  error estimate for blocks of size 2^( 5) =       0.000415312114
  error estimate for blocks of size 2^( 6) =       0.000419306914
  error estimate for blocks of size 2^( 7) =       0.000422125254

      target function =      -0.915591343020
              le_mean =     -17.210637668750
             les_mean =     296.494225377426
             stat err =       0.000416647735
             autocorr =       1.245370091986
   target nu stat err =       0.000416647735
   target dn stat err =       0.002546840056
      target stat err =       0.003355996326
              std dev =       0.528009523482
             le_variance =       0.278794056888


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915594405035        initial  <--
     6.2500e+00     6.2500e+01             6.0437e-05        -0.915544368820
     2.5000e+01     2.5000e+02             1.5123e-05        -0.915569601537
     1.0000e+02     1.0000e+03             3.7817e-06        -0.915591343020

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0813
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.085231e-01 1 1  ON 0
  uu_1                 5.234272e-02 1 1  ON 1
  uu_2                -3.707544e-02 1 1  ON 2
  uu_3                -9.031757e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315727e-01 1 1  ON 5
  uu_6                -1.137365e-01 1 1  ON 6
  uu_7                -5.557788e-02 1 1  ON 7
  uu_8                 6.127800e-02 1 1  ON 8
  uu_9                 1.219791e-01 1 1  ON 9
  ud_0                 3.013149e-01 1 1  ON 10
  ud_1                 7.401281e-02 1 1  ON 11
  ud_2                -2.540112e-02 1 1  ON 12
  ud_3                -7.665100e-02 1 1  ON 13
  ud_4                -1.122479e-01 1 1  ON 14
  ud_5                -1.322669e-01 1 1  ON 15
  ud_6                -1.279218e-01 1 1  ON 16
  ud_7                -8.886466e-02 1 1  ON 17
  ud_8                -3.540260e-03 1 1  ON 18
  ud_9                 8.507307e-02 1 1  ON 19
  eO_0                -6.939946e-01 1 1  ON 20
  eO_1                -4.135594e-01 1 1  ON 21
  eO_2                -4.114949e-02 1 1  ON 22
  eO_3                 1.790343e-01 1 1  ON 23
  eO_4                 2.510271e-01 1 1  ON 24
  eO_5                 2.753397e-01 1 1  ON 25
  eO_6                 2.475306e-01 1 1  ON 26
  eO_7                 1.360260e-01 1 1  ON 27
  eO_8                 2.899403e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044552e-01 1 1  ON 30
 eH1_1                -9.984426e-02 1 1  ON 31
 eH1_2                -4.893707e-02 1 1  ON 32
 eH1_3                -1.761995e-02 1 1  ON 33
 eH1_4                 1.758602e-02 1 1  ON 34
 eH1_5                 2.530899e-02 1 1  ON 35
 eH1_6                 7.729653e-02 1 1  ON 36
 eH1_7                 1.064297e-01 1 1  ON 37
 eH1_8                 1.024289e-01 1 1  ON 38
 eH1_9                 2.574326e-02 1 1  ON 39
 eH2_0                -2.011076e-01 1 1  ON 40
 eH2_1                -9.666827e-02 1 1  ON 41
 eH2_2                -4.626126e-02 1 1  ON 42
 eH2_3                -1.568638e-02 1 1  ON 43
 eH2_4                 1.794417e-02 1 1  ON 44
 eH2_5                 2.169024e-02 1 1  ON 45
 eH2_6                 6.870795e-02 1 1  ON 46
 eH2_7                 1.058418e-01 1 1  ON 47
 eH2_8                 1.043312e-01 1 1  ON 48
 eH2_9                 2.822430e-02 1 1  ON 49
ci_001                -4.271294e-02 3 1  ON 50
ci_002                -3.126059e-02 3 1  ON 51
ci_003                -2.592497e-02 3 1  ON 52
ci_004                 2.446755e-02 3 1  ON 53
ci_005                 2.454748e-02 3 1  ON 54
ci_006                -2.040418e-02 3 1  ON 55
ci_007                -2.055655e-02 3 1  ON 56
ci_008                -8.973253e-03 3 1  ON 57
ci_009                -1.503416e-02 3 1  ON 58
ci_010                -9.360430e-03 3 1  ON 59
ci_011                -1.056481e-02 3 1  ON 60
ci_012                -1.039129e-02 3 1  ON 61
ci_013                -1.948752e-02 3 1  ON 62
ci_014                 1.305628e-02 3 1  ON 63
ci_015                 1.351177e-02 3 1  ON 64
ci_016                 1.652818e-02 3 1  ON 65
ci_017                 1.623697e-02 3 1  ON 66
ci_018                 1.036327e-02 3 1  ON 67
ci_019                 1.021818e-02 3 1  ON 68
ci_020                 1.667204e-02 3 1  ON 69
ci_021                 1.651232e-02 3 1  ON 70
ci_022                 1.078672e-02 3 1  ON 71
ci_023                 1.010053e-02 3 1  ON 72
ci_024                 7.658063e-03 3 1  ON 73
ci_025                 7.006472e-03 3 1  ON 74
ci_026                 1.183944e-02 3 1  ON 75
ci_027                 1.160641e-02 3 1  ON 76
ci_028                -1.508835e-02 3 1  ON 77
ci_029                -1.541988e-02 3 1  ON 78
ci_030                -4.853521e-03 3 1  ON 79
ci_031                -4.846269e-03 3 1  ON 80
ci_032                -1.516532e-02 3 1  ON 81
ci_033                 6.838864e-03 3 1  ON 82
ci_034                 7.368069e-03 3 1  ON 83
ci_035                -4.689884e-03 3 1  ON 84
ci_036                -1.283734e-02 3 1  ON 85
ci_037                -1.270311e-02 3 1  ON 86
ci_038                 1.242893e-03 3 1  ON 87
ci_039                 1.513686e-03 3 1  ON 88
ci_040                -2.764622e-03 3 1  ON 89
ci_041                 8.544561e-03 3 1  ON 90
ci_042                 8.304689e-03 3 1  ON 91
ci_043                -3.617661e-03 3 1  ON 92
ci_044                -4.698254e-03 3 1  ON 93
ci_045                -2.844989e-03 3 1  ON 94
ci_046                 5.908821e-03 3 1  ON 95
ci_047                 5.850805e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6261e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2489
    reference variance = 0.144449
====================================================
  Execution time = 2.7095e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0475e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8531e-01
  Total weights = 1.966303042e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2369e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277659230984
                                         uncertainty =       0.001813578975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277659230984
                                         uncertainty =       0.001813578975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372545741
  error estimate for blocks of size 2^( 2) =       0.000386738597
  error estimate for blocks of size 2^( 3) =       0.000399788094
  error estimate for blocks of size 2^( 4) =       0.000409679033
  error estimate for blocks of size 2^( 5) =       0.000415728658
  error estimate for blocks of size 2^( 6) =       0.000418380956
  error estimate for blocks of size 2^( 7) =       0.000420875655

      target function =      -0.919032837580
              le_mean =     -17.209531263876
             les_mean =     296.453274691419
             stat err =       0.000416166075
             autocorr =       1.247883791083
   target nu stat err =       0.000416166075
   target dn stat err =       0.002141140747
      target stat err =       0.002855333656
              std dev =       0.526867669642
             le_variance =       0.277589541314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720953126388e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919041032188       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919041377574       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919041431186       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919041452562       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919041459472       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919041459451       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919041465215       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919041465277       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919041466270       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919041467943       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919041473040       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919041475896       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919041480076       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919041479458       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919041482058       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919041481734       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919041483126       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919041483668       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919041484672       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919041485565       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919041487827       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919041487617       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919041487996       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919041487667       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919041487440       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919041487674       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919041487345       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919041487488       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919041487454       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919041487202       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919041487185       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919041487054       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919041487176       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919041487174       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919041487459       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919041487474       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919041487373       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919041487165       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919041487202       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919041487254       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.919041487158       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+01 is 7.422480e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919041032188       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919041118615       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919041132028       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919041137377       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919041139105       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919041139100       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919041140542       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919041140557       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919041140806       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919041141223       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919041142500       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919041143214       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919041144259       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919041144104       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919041144754       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919041144673       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919041145022       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919041145157       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919041145408       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919041145632       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919041146196       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919041146144       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919041146239       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919041146156       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919041146098       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919041146158       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919041146076       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919041146111       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919041146102       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919041146040       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919041146035       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919041146003       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919041146033       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919041146032       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919041146104       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919041146107       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919041146084       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919041146031       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919041146039       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919041146053       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.919041146028       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+02 is 1.856043e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919041032188       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919041053800       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919041057154       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919041058491       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919041058924       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919041058921       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919041059283       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919041059285       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919041059348       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919041059452       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919041059771       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919041059948       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919041060213       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919041060172       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919041060334       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919041060317       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919041060403       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919041060436       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919041060499       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919041060553       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919041060700       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919041060671       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919041060712       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919041060688       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919041060668       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919041060691       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919041060668       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919041060671       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919041060675       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919041060653       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919041060656       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919041060650       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919041060655       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919041060656       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919041060674       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919041060672       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919041060668       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919041060656       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919041060656       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919041060657       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.919041060651       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+03 is 4.640372e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.476669 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5414e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.085230e-01 1 1  ON 0
  uu_1                 5.234263e-02 1 1  ON 1
  uu_2                -3.707544e-02 1 1  ON 2
  uu_3                -9.031757e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315727e-01 1 1  ON 5
  uu_6                -1.137357e-01 1 1  ON 6
  uu_7                -5.557781e-02 1 1  ON 7
  uu_8                 6.127674e-02 1 1  ON 8
  uu_9                 1.219791e-01 1 1  ON 9
  ud_0                 3.013146e-01 1 1  ON 10
  ud_1                 7.401241e-02 1 1  ON 11
  ud_2                -2.540135e-02 1 1  ON 12
  ud_3                -7.665097e-02 1 1  ON 13
  ud_4                -1.122478e-01 1 1  ON 14
  ud_5                -1.322667e-01 1 1  ON 15
  ud_6                -1.279213e-01 1 1  ON 16
  ud_7                -8.886387e-02 1 1  ON 17
  ud_8                -3.540992e-03 1 1  ON 18
  ud_9                 8.507283e-02 1 1  ON 19
  eO_0                -6.939942e-01 1 1  ON 20
  eO_1                -4.135590e-01 1 1  ON 21
  eO_2                -4.114948e-02 1 1  ON 22
  eO_3                 1.790344e-01 1 1  ON 23
  eO_4                 2.510266e-01 1 1  ON 24
  eO_5                 2.753378e-01 1 1  ON 25
  eO_6                 2.475310e-01 1 1  ON 26
  eO_7                 1.360270e-01 1 1  ON 27
  eO_8                 2.899401e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044544e-01 1 1  ON 30
 eH1_1                -9.984360e-02 1 1  ON 31
 eH1_2                -4.893648e-02 1 1  ON 32
 eH1_3                -1.761973e-02 1 1  ON 33
 eH1_4                 1.758595e-02 1 1  ON 34
 eH1_5                 2.530794e-02 1 1  ON 35
 eH1_6                 7.729558e-02 1 1  ON 36
 eH1_7                 1.064291e-01 1 1  ON 37
 eH1_8                 1.024294e-01 1 1  ON 38
 eH1_9                 2.574329e-02 1 1  ON 39
 eH2_0                -2.011070e-01 1 1  ON 40
 eH2_1                -9.666830e-02 1 1  ON 41
 eH2_2                -4.626147e-02 1 1  ON 42
 eH2_3                -1.568680e-02 1 1  ON 43
 eH2_4                 1.794385e-02 1 1  ON 44
 eH2_5                 2.168995e-02 1 1  ON 45
 eH2_6                 6.870805e-02 1 1  ON 46
 eH2_7                 1.058413e-01 1 1  ON 47
 eH2_8                 1.043319e-01 1 1  ON 48
 eH2_9                 2.822445e-02 1 1  ON 49
ci_001                -4.271297e-02 3 1  ON 50
ci_002                -3.126043e-02 3 1  ON 51
ci_003                -2.592516e-02 3 1  ON 52
ci_004                 2.446762e-02 3 1  ON 53
ci_005                 2.454732e-02 3 1  ON 54
ci_006                -2.040393e-02 3 1  ON 55
ci_007                -2.055633e-02 3 1  ON 56
ci_008                -8.973153e-03 3 1  ON 57
ci_009                -1.503422e-02 3 1  ON 58
ci_010                -9.360598e-03 3 1  ON 59
ci_011                -1.056484e-02 3 1  ON 60
ci_012                -1.039140e-02 3 1  ON 61
ci_013                -1.948767e-02 3 1  ON 62
ci_014                 1.305598e-02 3 1  ON 63
ci_015                 1.351173e-02 3 1  ON 64
ci_016                 1.652824e-02 3 1  ON 65
ci_017                 1.623692e-02 3 1  ON 66
ci_018                 1.036339e-02 3 1  ON 67
ci_019                 1.021824e-02 3 1  ON 68
ci_020                 1.667201e-02 3 1  ON 69
ci_021                 1.651228e-02 3 1  ON 70
ci_022                 1.078688e-02 3 1  ON 71
ci_023                 1.010059e-02 3 1  ON 72
ci_024                 7.658098e-03 3 1  ON 73
ci_025                 7.006927e-03 3 1  ON 74
ci_026                 1.183936e-02 3 1  ON 75
ci_027                 1.160638e-02 3 1  ON 76
ci_028                -1.508850e-02 3 1  ON 77
ci_029                -1.542000e-02 3 1  ON 78
ci_030                -4.852850e-03 3 1  ON 79
ci_031                -4.845974e-03 3 1  ON 80
ci_032                -1.516527e-02 3 1  ON 81
ci_033                 6.838741e-03 3 1  ON 82
ci_034                 7.367921e-03 3 1  ON 83
ci_035                -4.689734e-03 3 1  ON 84
ci_036                -1.283745e-02 3 1  ON 85
ci_037                -1.270321e-02 3 1  ON 86
ci_038                 1.242849e-03 3 1  ON 87
ci_039                 1.513485e-03 3 1  ON 88
ci_040                -2.764733e-03 3 1  ON 89
ci_041                 8.544392e-03 3 1  ON 90
ci_042                 8.304820e-03 3 1  ON 91
ci_043                -3.617602e-03 3 1  ON 92
ci_044                -4.697779e-03 3 1  ON 93
ci_045                -2.845094e-03 3 1  ON 94
ci_046                 5.908714e-03 3 1  ON 95
ci_047                 5.850786e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1291
    reference variance = 0.328826
====================================================
  Execution time = 2.6944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8646e-01
  Total weights = 1.9663e+06
  Execution time = 2.3782e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277973934764
                                         uncertainty =       0.001742606494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277973934764
                                         uncertainty =       0.001742606494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372862246
  error estimate for blocks of size 2^( 2) =       0.000387309487
  error estimate for blocks of size 2^( 3) =       0.000400341852
  error estimate for blocks of size 2^( 4) =       0.000410362613
  error estimate for blocks of size 2^( 5) =       0.000416079590
  error estimate for blocks of size 2^( 6) =       0.000419116097
  error estimate for blocks of size 2^( 7) =       0.000419726538

      target function =      -0.917729019082
              le_mean =     -17.210295507960
             les_mean =     296.480735404548
             stat err =       0.000416321209
             autocorr =       1.246695090193
   target nu stat err =       0.000416321209
   target dn stat err =       0.002362025166
      target stat err =       0.003132857825
              std dev =       0.527315282679
             le_variance =       0.278061407347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277973549920
                                         uncertainty =       0.001742575617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277973549920
                                         uncertainty =       0.001742575617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372861982
  error estimate for blocks of size 2^( 2) =       0.000387309315
  error estimate for blocks of size 2^( 3) =       0.000400341747
  error estimate for blocks of size 2^( 4) =       0.000410362612
  error estimate for blocks of size 2^( 5) =       0.000416079616
  error estimate for blocks of size 2^( 6) =       0.000419116118
  error estimate for blocks of size 2^( 7) =       0.000419726687

      target function =      -0.917730813350
              le_mean =     -17.210295500515
             les_mean =     296.480733770053
             stat err =       0.000416321258
             autocorr =       1.246697149903
   target nu stat err =       0.000416321258
   target dn stat err =       0.002361907770
      target stat err =       0.003132719661
              std dev =       0.527314908828
             le_variance =       0.278061013073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277973742062
                                         uncertainty =       0.001742591030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277973742062
                                         uncertainty =       0.001742591030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372862114
  error estimate for blocks of size 2^( 2) =       0.000387309400
  error estimate for blocks of size 2^( 3) =       0.000400341800
  error estimate for blocks of size 2^( 4) =       0.000410362612
  error estimate for blocks of size 2^( 5) =       0.000416079603
  error estimate for blocks of size 2^( 6) =       0.000419116107
  error estimate for blocks of size 2^( 7) =       0.000419726612

      target function =      -0.917729932510
              le_mean =     -17.210295504215
             les_mean =     296.480734574030
             stat err =       0.000416321234
             autocorr =       1.246696120955
   target nu stat err =       0.000416321234
   target dn stat err =       0.002361966236
      target stat err =       0.003132788556
              std dev =       0.527315095484
             le_variance =       0.278061209926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277973910654
                                         uncertainty =       0.001742604559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277973910654
                                         uncertainty =       0.001742604559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372862230
  error estimate for blocks of size 2^( 2) =       0.000387309476
  error estimate for blocks of size 2^( 3) =       0.000400341846
  error estimate for blocks of size 2^( 4) =       0.000410362613
  error estimate for blocks of size 2^( 5) =       0.000416079591
  error estimate for blocks of size 2^( 6) =       0.000419116098
  error estimate for blocks of size 2^( 7) =       0.000419726547

      target function =      -0.917729135043
              le_mean =     -17.210295507490
             les_mean =     296.480735299294
             stat err =       0.000416321212
             autocorr =       1.246695219069
   target nu stat err =       0.000416321212
   target dn stat err =       0.002362017778
      target stat err =       0.003132849150
              std dev =       0.527315259259
             le_variance =       0.278061382648


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917729019082        initial
     6.2500e+01     6.2500e+02             7.4225e-06        -0.917730813350  <--
     2.5000e+02     2.5000e+03             1.8560e-06        -0.917729932510
     1.0000e+03     1.0000e+04             4.6404e-07        -0.917729135043

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 3.8907e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557760e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114944e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056494e-02 3 1  ON 60
ci_012                -1.039171e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305213e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696355e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4328e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2136
    reference variance = 0.203516
====================================================
  Execution time = 2.7103e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0490e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9268e-01
  Total weights = 1.966326084e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3405e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281247960431
                                         uncertainty =       0.002054515373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281247960431
                                         uncertainty =       0.002054515373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375111304
  error estimate for blocks of size 2^( 2) =       0.000389200933
  error estimate for blocks of size 2^( 3) =       0.000402505404
  error estimate for blocks of size 2^( 4) =       0.000412114727
  error estimate for blocks of size 2^( 5) =       0.000418142736
  error estimate for blocks of size 2^( 6) =       0.000422490536
  error estimate for blocks of size 2^( 7) =       0.000422131100

      target function =      -0.909457273863
              le_mean =     -17.209325672365
             les_mean =     296.453570626820
             stat err =       0.000418719775
             autocorr =       1.246024668200
   target nu stat err =       0.000418719775
   target dn stat err =       0.002775577260
      target stat err =       0.003593558402
              std dev =       0.530495980772
             le_variance =       0.281425985615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720932567237e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909470786682       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909472330704       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909472686262       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909472832780       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909472855778       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909472900153       residual = 5.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909472921796       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909472931886       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909472942081       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909472944083       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909472962548       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909472983177       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909473005534       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909473015134       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909473031710       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909473038951       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909473041195       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909473051726       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909473060145       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909473065033       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909473059790       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909473068259       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909473076085       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909473068646       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909473069097       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909473072382       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909473069737       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909473072565       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909473073897       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909473074550       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909473075930       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909473075278       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909473077106       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909473077378       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909473078036       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909473076639       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909473075830       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.909473076313       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.909473075762       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.909473075811       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.909473075767       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.909473076183       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.909473076137       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+01 is 3.144862e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909470786682       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909471174090       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909471263218       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909471299928       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909471305687       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909471316807       residual = 5.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909471322226       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909471324751       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909471327296       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909471327796       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909471332431       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909471337598       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909471343190       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909471345596       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909471349739       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909471351545       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909471352114       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909471354742       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909471356843       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909471358069       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909471356755       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909471358873       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909471360827       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909471358963       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909471359072       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909471359896       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909471359229       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909471359939       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909471360270       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909471360432       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909471360777       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909471360613       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909471361071       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909471361135       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909471361299       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909471360942       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909471360750       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.909471360866       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.909471360732       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.909471360744       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.909471360736       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.909471360837       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.909471360825       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+01 is 7.863882e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909470786682       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909470883622       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909470905919       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909470915101       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909470916542       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909470919323       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909470920678       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909470921310       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909470921946       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909470922072       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909470923231       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909470924523       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909470925920       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909470926523       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909470927559       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909470928010       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909470928153       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909470928809       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909470929334       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909470929641       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909470929313       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909470929842       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909470930331       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909470929864       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909470929891       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909470930098       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909470929931       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909470930108       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909470930191       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909470930231       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909470930317       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909470930276       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909470930390       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909470930406       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909470930447       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909470930359       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909470930310       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.909470930339       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.909470930305       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.909470930309       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.909470930306       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.909470930332       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.909470930329       residual = 7.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+02 is 1.966078e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.562204 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5536e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.085261e-01 1 1  ON 0
  uu_1                 5.234555e-02 1 1  ON 1
  uu_2                -3.707313e-02 1 1  ON 2
  uu_3                -9.031535e-02 1 1  ON 3
  uu_4                -1.222768e-01 1 1  ON 4
  uu_5                -1.315717e-01 1 1  ON 5
  uu_6                -1.137345e-01 1 1  ON 6
  uu_7                -5.558406e-02 1 1  ON 7
  uu_8                 6.126509e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013114e-01 1 1  ON 10
  ud_1                 7.400886e-02 1 1  ON 11
  ud_2                -2.540449e-02 1 1  ON 12
  ud_3                -7.665315e-02 1 1  ON 13
  ud_4                -1.122484e-01 1 1  ON 14
  ud_5                -1.322639e-01 1 1  ON 15
  ud_6                -1.279161e-01 1 1  ON 16
  ud_7                -8.885558e-02 1 1  ON 17
  ud_8                -3.545411e-03 1 1  ON 18
  ud_9                 8.507049e-02 1 1  ON 19
  eO_0                -6.939935e-01 1 1  ON 20
  eO_1                -4.135585e-01 1 1  ON 21
  eO_2                -4.114984e-02 1 1  ON 22
  eO_3                 1.790347e-01 1 1  ON 23
  eO_4                 2.510228e-01 1 1  ON 24
  eO_5                 2.753314e-01 1 1  ON 25
  eO_6                 2.475331e-01 1 1  ON 26
  eO_7                 1.360335e-01 1 1  ON 27
  eO_8                 2.899425e-02 1 1  ON 28
  eO_9                 1.933892e-02 1 1  ON 29
 eH1_0                -2.044520e-01 1 1  ON 30
 eH1_1                -9.984021e-02 1 1  ON 31
 eH1_2                -4.893435e-02 1 1  ON 32
 eH1_3                -1.761961e-02 1 1  ON 33
 eH1_4                 1.758276e-02 1 1  ON 34
 eH1_5                 2.529940e-02 1 1  ON 35
 eH1_6                 7.729398e-02 1 1  ON 36
 eH1_7                 1.064300e-01 1 1  ON 37
 eH1_8                 1.024330e-01 1 1  ON 38
 eH1_9                 2.574382e-02 1 1  ON 39
 eH2_0                -2.011077e-01 1 1  ON 40
 eH2_1                -9.667077e-02 1 1  ON 41
 eH2_2                -4.626357e-02 1 1  ON 42
 eH2_3                -1.568852e-02 1 1  ON 43
 eH2_4                 1.794463e-02 1 1  ON 44
 eH2_5                 2.169088e-02 1 1  ON 45
 eH2_6                 6.871146e-02 1 1  ON 46
 eH2_7                 1.058382e-01 1 1  ON 47
 eH2_8                 1.043358e-01 1 1  ON 48
 eH2_9                 2.822537e-02 1 1  ON 49
ci_001                -4.271070e-02 3 1  ON 50
ci_002                -3.125918e-02 3 1  ON 51
ci_003                -2.592472e-02 3 1  ON 52
ci_004                 2.446764e-02 3 1  ON 53
ci_005                 2.454743e-02 3 1  ON 54
ci_006                -2.040394e-02 3 1  ON 55
ci_007                -2.055514e-02 3 1  ON 56
ci_008                -8.972274e-03 3 1  ON 57
ci_009                -1.503458e-02 3 1  ON 58
ci_010                -9.360468e-03 3 1  ON 59
ci_011                -1.056310e-02 3 1  ON 60
ci_012                -1.039000e-02 3 1  ON 61
ci_013                -1.948683e-02 3 1  ON 62
ci_014                 1.305376e-02 3 1  ON 63
ci_015                 1.351124e-02 3 1  ON 64
ci_016                 1.652895e-02 3 1  ON 65
ci_017                 1.623736e-02 3 1  ON 66
ci_018                 1.036371e-02 3 1  ON 67
ci_019                 1.021851e-02 3 1  ON 68
ci_020                 1.667128e-02 3 1  ON 69
ci_021                 1.651331e-02 3 1  ON 70
ci_022                 1.078689e-02 3 1  ON 71
ci_023                 1.010071e-02 3 1  ON 72
ci_024                 7.656821e-03 3 1  ON 73
ci_025                 7.009452e-03 3 1  ON 74
ci_026                 1.183819e-02 3 1  ON 75
ci_027                 1.160532e-02 3 1  ON 76
ci_028                -1.508976e-02 3 1  ON 77
ci_029                -1.542062e-02 3 1  ON 78
ci_030                -4.849526e-03 3 1  ON 79
ci_031                -4.845856e-03 3 1  ON 80
ci_032                -1.516586e-02 3 1  ON 81
ci_033                 6.838622e-03 3 1  ON 82
ci_034                 7.366425e-03 3 1  ON 83
ci_035                -4.688475e-03 3 1  ON 84
ci_036                -1.283727e-02 3 1  ON 85
ci_037                -1.270419e-02 3 1  ON 86
ci_038                 1.242740e-03 3 1  ON 87
ci_039                 1.512612e-03 3 1  ON 88
ci_040                -2.765311e-03 3 1  ON 89
ci_041                 8.544327e-03 3 1  ON 90
ci_042                 8.304839e-03 3 1  ON 91
ci_043                -3.617182e-03 3 1  ON 92
ci_044                -4.695559e-03 3 1  ON 93
ci_045                -2.845292e-03 3 1  ON 94
ci_046                 5.908380e-03 3 1  ON 95
ci_047                 5.849894e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2656
    reference variance = 0.268867
====================================================
  Execution time = 2.6837e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8786e-01
  Total weights = 1.9663e+06
  Execution time = 2.3769e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277361697125
                                         uncertainty =       0.002111796328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277361697125
                                         uncertainty =       0.002111796328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372403271
  error estimate for blocks of size 2^( 2) =       0.000386570114
  error estimate for blocks of size 2^( 3) =       0.000399773518
  error estimate for blocks of size 2^( 4) =       0.000409447487
  error estimate for blocks of size 2^( 5) =       0.000415806422
  error estimate for blocks of size 2^( 6) =       0.000417405179
  error estimate for blocks of size 2^( 7) =       0.000420689303

      target function =      -0.915651315935
              le_mean =     -17.209295205905
             les_mean =     296.447697449018
             stat err =       0.000415837098
             autocorr =       1.246865152540
   target nu stat err =       0.000415837098
   target dn stat err =       0.002963734387
      target stat err =       0.003881794474
              std dev =       0.526666183374
             le_variance =       0.277377268710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277361687021
                                         uncertainty =       0.002111639793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277361687021
                                         uncertainty =       0.002111639793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372403248
  error estimate for blocks of size 2^( 2) =       0.000386570846
  error estimate for blocks of size 2^( 3) =       0.000399775167
  error estimate for blocks of size 2^( 4) =       0.000409449696
  error estimate for blocks of size 2^( 5) =       0.000415809073
  error estimate for blocks of size 2^( 6) =       0.000417408168
  error estimate for blocks of size 2^( 7) =       0.000420692486

      target function =      -0.915640250768
              le_mean =     -17.209295246766
             les_mean =     296.447707394852
             stat err =       0.000415839856
             autocorr =       1.246881847036
   target nu stat err =       0.000415839856
   target dn stat err =       0.002965650115
      target stat err =       0.003884154200
              std dev =       0.526666150767
             le_variance =       0.277377234364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277361690101
                                         uncertainty =       0.002111717673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277361690101
                                         uncertainty =       0.002111717673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372403258
  error estimate for blocks of size 2^( 2) =       0.000386570480
  error estimate for blocks of size 2^( 3) =       0.000399774344
  error estimate for blocks of size 2^( 4) =       0.000409448593
  error estimate for blocks of size 2^( 5) =       0.000415807750
  error estimate for blocks of size 2^( 6) =       0.000417406676
  error estimate for blocks of size 2^( 7) =       0.000420690898

      target function =      -0.915646155059
              le_mean =     -17.209295225985
             les_mean =     296.447702122689
             stat err =       0.000415838479
             autocorr =       1.246873523179
   target nu stat err =       0.000415838479
   target dn stat err =       0.002964688179
      target stat err =       0.003882972251
              std dev =       0.526666165164
             le_variance =       0.277377249529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277361695989
                                         uncertainty =       0.002111786478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277361695989
                                         uncertainty =       0.002111786478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372403269
  error estimate for blocks of size 2^( 2) =       0.000386570160
  error estimate for blocks of size 2^( 3) =       0.000399773621
  error estimate for blocks of size 2^( 4) =       0.000409447625
  error estimate for blocks of size 2^( 5) =       0.000415806588
  error estimate for blocks of size 2^( 6) =       0.000417405366
  error estimate for blocks of size 2^( 7) =       0.000420689502

      target function =      -0.915650706629
              le_mean =     -17.209295208370
             les_mean =     296.447698004036
             stat err =       0.000415837270
             autocorr =       1.246866199540
   target nu stat err =       0.000415837270
   target dn stat err =       0.002963853190
      target stat err =       0.003881941459
              std dev =       0.526666180852
             le_variance =       0.277377266053


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915651315935        initial  <--
     1.5625e+01     1.5625e+02             3.1449e-05        -0.915640250768
     6.2500e+01     6.2500e+02             7.8639e-06        -0.915646155059
     2.5000e+02     2.5000e+03             1.9661e-06        -0.915650706629

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.7992
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557760e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114944e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056494e-02 3 1  ON 60
ci_012                -1.039171e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305213e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696355e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4342e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7194e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2035
    reference variance = 0.232228
====================================================
  Execution time = 2.7274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0480e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8226e-01
  Total weights = 1.966239037e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2313e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274288164083
                                         uncertainty =       0.001555210816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274288164083
                                         uncertainty =       0.001555210816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370335841
  error estimate for blocks of size 2^( 2) =       0.000384673424
  error estimate for blocks of size 2^( 3) =       0.000398001065
  error estimate for blocks of size 2^( 4) =       0.000407531424
  error estimate for blocks of size 2^( 5) =       0.000413215144
  error estimate for blocks of size 2^( 6) =       0.000417288105
  error estimate for blocks of size 2^( 7) =       0.000421429209

      target function =      -0.923037210714
              le_mean =     -17.209557423168
             les_mean =     296.451126158821
             stat err =       0.000414865970
             autocorr =       1.254943389100
   target nu stat err =       0.000414865970
   target dn stat err =       0.001905825449
      target stat err =       0.002577148403
              std dev =       0.523742349070
             le_variance =       0.274306048210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720955742317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923043547129       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923043666460       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923043694804       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923043700831       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923043700509       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923043700589       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923043699902       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923043701086       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923043700870       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923043701100       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923043702439       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923043702723       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923043704321       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923043705475       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923043705068       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923043705479       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923043705705       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923043706098       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923043706370       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923043706425       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923043706534       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923043706895       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923043707154       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.923043707351       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.923043707146       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.923043707102       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.923043707020       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.923043707082       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.923043707122       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.923043707041       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.923043707065       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.923043707146       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.923043707239       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.923043707146       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.923043707159       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.923043707173       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.923043707117       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.923043707085       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.923043707124       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.923043707132       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.923043707142       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+02 is 1.789792e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923043547129       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923043576972       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923043584060       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923043585568       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923043585487       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923043585507       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923043585335       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923043585631       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923043585577       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923043585635       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923043585969       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923043586040       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923043586440       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923043586730       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923043586627       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923043586728       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923043586786       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923043586884       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923043586953       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923043586965       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923043586993       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923043587082       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923043587149       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.923043587201       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.923043587146       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.923043587134       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.923043587117       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.923043587129       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.923043587141       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.923043587121       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.923043587127       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.923043587144       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.923043587168       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.923043587147       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.923043587149       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.923043587153       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.923043587140       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.923043587131       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.923043587140       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.923043587143       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.923043587144       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+02 is 4.474585e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923043547129       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923043554590       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923043556362       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923043556739       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923043556721       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923043556724       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923043556681       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923043556762       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923043556742       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923043556756       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923043556839       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923043556858       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923043556953       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923043557039       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923043557004       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923043557030       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923043557046       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923043557065       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923043557091       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923043557090       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923043557099       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923043557116       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923043557135       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.923043557149       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.923043557127       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.923043557129       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.923043557127       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.923043557137       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.923043557128       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.923043557120       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.923043557124       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.923043557132       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.923043557150       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.923043557131       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.923043557137       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.923043557137       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.923043557140       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.923043557138       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.923043557142       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.923043557127       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.923043557142       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+03 is 1.118653e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.637213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5587e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.085224e-01 1 1  ON 0
  uu_1                 5.234235e-02 1 1  ON 1
  uu_2                -3.707545e-02 1 1  ON 2
  uu_3                -9.031757e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557754e-02 1 1  ON 7
  uu_8                 6.127272e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013138e-01 1 1  ON 10
  ud_1                 7.401119e-02 1 1  ON 11
  ud_2                -2.540209e-02 1 1  ON 12
  ud_3                -7.665092e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322662e-01 1 1  ON 15
  ud_6                -1.279199e-01 1 1  ON 16
  ud_7                -8.886135e-02 1 1  ON 17
  ud_8                -3.543377e-03 1 1  ON 18
  ud_9                 8.507201e-02 1 1  ON 19
  eO_0                -6.939932e-01 1 1  ON 20
  eO_1                -4.135580e-01 1 1  ON 21
  eO_2                -4.114964e-02 1 1  ON 22
  eO_3                 1.790347e-01 1 1  ON 23
  eO_4                 2.510252e-01 1 1  ON 24
  eO_5                 2.753321e-01 1 1  ON 25
  eO_6                 2.475325e-01 1 1  ON 26
  eO_7                 1.360304e-01 1 1  ON 27
  eO_8                 2.899400e-02 1 1  ON 28
  eO_9                 1.933892e-02 1 1  ON 29
 eH1_0                -2.044520e-01 1 1  ON 30
 eH1_1                -9.984136e-02 1 1  ON 31
 eH1_2                -4.893461e-02 1 1  ON 32
 eH1_3                -1.761894e-02 1 1  ON 33
 eH1_4                 1.758567e-02 1 1  ON 34
 eH1_5                 2.530455e-02 1 1  ON 35
 eH1_6                 7.729231e-02 1 1  ON 36
 eH1_7                 1.064269e-01 1 1  ON 37
 eH1_8                 1.024309e-01 1 1  ON 38
 eH1_9                 2.574341e-02 1 1  ON 39
 eH2_0                -2.011053e-01 1 1  ON 40
 eH2_1                -9.666859e-02 1 1  ON 41
 eH2_2                -4.626225e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794282e-02 1 1  ON 44
 eH2_5                 2.168915e-02 1 1  ON 45
 eH2_6                 6.870873e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043345e-01 1 1  ON 48
 eH2_9                 2.822492e-02 1 1  ON 49
ci_001                -4.271287e-02 3 1  ON 50
ci_002                -3.125992e-02 3 1  ON 51
ci_003                -2.592569e-02 3 1  ON 52
ci_004                 2.446780e-02 3 1  ON 53
ci_005                 2.454679e-02 3 1  ON 54
ci_006                -2.040320e-02 3 1  ON 55
ci_007                -2.055564e-02 3 1  ON 56
ci_008                -8.972872e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361107e-03 3 1  ON 59
ci_011                -1.056501e-02 3 1  ON 60
ci_012                -1.039168e-02 3 1  ON 61
ci_013                -1.948802e-02 3 1  ON 62
ci_014                 1.305506e-02 3 1  ON 63
ci_015                 1.351129e-02 3 1  ON 64
ci_016                 1.652850e-02 3 1  ON 65
ci_017                 1.623678e-02 3 1  ON 66
ci_018                 1.036370e-02 3 1  ON 67
ci_019                 1.021836e-02 3 1  ON 68
ci_020                 1.667183e-02 3 1  ON 69
ci_021                 1.651223e-02 3 1  ON 70
ci_022                 1.078742e-02 3 1  ON 71
ci_023                 1.010077e-02 3 1  ON 72
ci_024                 7.658258e-03 3 1  ON 73
ci_025                 7.008421e-03 3 1  ON 74
ci_026                 1.183903e-02 3 1  ON 75
ci_027                 1.160633e-02 3 1  ON 76
ci_028                -1.508898e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850906e-03 3 1  ON 79
ci_031                -4.845037e-03 3 1  ON 80
ci_032                -1.516516e-02 3 1  ON 81
ci_033                 6.838430e-03 3 1  ON 82
ci_034                 7.367451e-03 3 1  ON 83
ci_035                -4.689264e-03 3 1  ON 84
ci_036                -1.283782e-02 3 1  ON 85
ci_037                -1.270350e-02 3 1  ON 86
ci_038                 1.242678e-03 3 1  ON 87
ci_039                 1.512875e-03 3 1  ON 88
ci_040                -2.765139e-03 3 1  ON 89
ci_041                 8.543947e-03 3 1  ON 90
ci_042                 8.305323e-03 3 1  ON 91
ci_043                -3.617356e-03 3 1  ON 92
ci_044                -4.696218e-03 3 1  ON 93
ci_045                -2.845434e-03 3 1  ON 94
ci_046                 5.908350e-03 3 1  ON 95
ci_047                 5.850743e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2661
    reference variance = 0.171776
====================================================
  Execution time = 2.7253e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8259e-01
  Total weights = 1.9666e+06
  Execution time = 2.3898e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274283298050
                                         uncertainty =       0.001806267507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274283298050
                                         uncertainty =       0.001806267507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370347314
  error estimate for blocks of size 2^( 2) =       0.000384927484
  error estimate for blocks of size 2^( 3) =       0.000398391811
  error estimate for blocks of size 2^( 4) =       0.000408091786
  error estimate for blocks of size 2^( 5) =       0.000413761545
  error estimate for blocks of size 2^( 6) =       0.000416854393
  error estimate for blocks of size 2^( 7) =       0.000417398610

      target function =      -0.922622969906
              le_mean =     -17.209652215995
             les_mean =     296.454722401575
             stat err =       0.000414026584
             autocorr =       1.249792905401
   target nu stat err =       0.000414026584
   target dn stat err =       0.002127591716
      target stat err =       0.002859679174
              std dev =       0.523758574465
             le_variance =       0.274323044326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274283127177
                                         uncertainty =       0.001806234028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274283127177
                                         uncertainty =       0.001806234028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370347199
  error estimate for blocks of size 2^( 2) =       0.000384927369
  error estimate for blocks of size 2^( 3) =       0.000398391706
  error estimate for blocks of size 2^( 4) =       0.000408091693
  error estimate for blocks of size 2^( 5) =       0.000413761449
  error estimate for blocks of size 2^( 6) =       0.000416854307
  error estimate for blocks of size 2^( 7) =       0.000417398519

      target function =      -0.922622755509
              le_mean =     -17.209652241667
             les_mean =     296.454723453789
             stat err =       0.000414026492
             autocorr =       1.249793130700
   target nu stat err =       0.000414026492
   target dn stat err =       0.002127566212
      target stat err =       0.002859645139
              std dev =       0.523758411349
             le_variance =       0.274322873459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274283212566
                                         uncertainty =       0.001806250761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274283212566
                                         uncertainty =       0.001806250761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370347256
  error estimate for blocks of size 2^( 2) =       0.000384927426
  error estimate for blocks of size 2^( 3) =       0.000398391759
  error estimate for blocks of size 2^( 4) =       0.000408091740
  error estimate for blocks of size 2^( 5) =       0.000413761497
  error estimate for blocks of size 2^( 6) =       0.000416854350
  error estimate for blocks of size 2^( 7) =       0.000417398564

      target function =      -0.922622863630
              le_mean =     -17.209652228832
             les_mean =     296.454722927024
             stat err =       0.000414026538
             autocorr =       1.249793018103
   target nu stat err =       0.000414026538
   target dn stat err =       0.002127578949
      target stat err =       0.002859662143
              std dev =       0.523758492861
             le_variance =       0.274322958845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274283287361
                                         uncertainty =       0.001806265413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274283287361
                                         uncertainty =       0.001806265413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370347307
  error estimate for blocks of size 2^( 2) =       0.000384927477
  error estimate for blocks of size 2^( 3) =       0.000398391805
  error estimate for blocks of size 2^( 4) =       0.000408091780
  error estimate for blocks of size 2^( 5) =       0.000413761539
  error estimate for blocks of size 2^( 6) =       0.000416854387
  error estimate for blocks of size 2^( 7) =       0.000417398605

      target function =      -0.922622956724
              le_mean =     -17.209652217599
             les_mean =     296.454722467172
             stat err =       0.000414026578
             autocorr =       1.249792919481
   target nu stat err =       0.000414026578
   target dn stat err =       0.002127590119
      target stat err =       0.002859677045
              std dev =       0.523758564262
             le_variance =       0.274323033637


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922622969906        initial  <--
     1.5625e+02     1.5625e+03             1.7898e-06        -0.922622755509
     6.2500e+02     6.2500e+03             4.4746e-07        -0.922622863630
     2.5000e+03     2.5000e+04             1.1187e-07        -0.922622956724

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2869
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557760e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114944e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056494e-02 3 1  ON 60
ci_012                -1.039171e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305213e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696355e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4880e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7195e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2056
    reference variance = 0.622414
====================================================
  Execution time = 2.7171e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0487e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8649e-01
  Total weights = 1.966373209e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3379e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278016146450
                                         uncertainty =       0.001673600437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278016146450
                                         uncertainty =       0.001673600437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372799980
  error estimate for blocks of size 2^( 2) =       0.000386894804
  error estimate for blocks of size 2^( 3) =       0.000400281007
  error estimate for blocks of size 2^( 4) =       0.000410012301
  error estimate for blocks of size 2^( 5) =       0.000415133826
  error estimate for blocks of size 2^( 6) =       0.000418237770
  error estimate for blocks of size 2^( 7) =       0.000417888142

      target function =      -0.917453599810
              le_mean =     -17.209387467963
             les_mean =     296.449508787741
             stat err =       0.000415318010
             autocorr =       1.241108548285
   target nu stat err =       0.000415318010
   target dn stat err =       0.002094432279
      target stat err =       0.002785480555
              std dev =       0.527227223534
             le_variance =       0.277968545235


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720938746796e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917461315560       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917461325655       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917461327786       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917461328213       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917461328511       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917461328527       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917461328580       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917461328685       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917461328651       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917461328721       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917461328763       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917461328763       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917461328842       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917461328846       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917461328944       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917461328989       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917461328977       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917461328991       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917461329045       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917461329038       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917461329042       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917461329049       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917461329065       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917461329065       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917461329074       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917461329086       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917461329079       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917461329100       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917461329108       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917461329098       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917461329108       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917461329099       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917461329115       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917461329102       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917461329098       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917461329100       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917461329107       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917461329102       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917461329111       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917461329106       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+03 is 2.442066e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917461315560       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917461318083       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917461318616       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917461318728       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917461318799       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917461318803       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917461318817       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917461318845       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917461318825       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917461318842       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917461318851       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917461318855       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917461318896       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917461318884       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917461318898       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917461318909       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917461318907       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917461318915       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917461318934       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917461318936       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917461318942       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917461318919       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917461318939       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917461318922       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917461318931       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917461318938       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917461318948       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917461318925       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917461318935       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917461318941       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917461318940       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917461318923       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917461318960       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917461318926       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917461318942       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917461318949       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917461318947       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917461318936       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917461318929       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917461318933       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+03 is 6.105190e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917461315560       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917461316190       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917461316324       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917461316350       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917461316445       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917461316353       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917461316373       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917461316425       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917461316334       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917461316371       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917461316438       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917461316289       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917461316374       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917461316389       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917461316376       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917461316381       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917461316391       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917461316440       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917461316354       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917461316377       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917461316373       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917461316409       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917461316441       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917461316335       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917461316368       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917461316395       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917461316474       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917461316432       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917461316428       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917461316410       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917461316368       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917461316337       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917461316414       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917461316314       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917461316434       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917461316427       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917461316479       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917461316364       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917461316334       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917461316409       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+04 is 1.526299e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.706750 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7529e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031757e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127289e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401119e-02 1 1  ON 11
  ud_2                -2.540208e-02 1 1  ON 12
  ud_3                -7.665086e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886148e-02 1 1  ON 17
  ud_8                -3.543176e-03 1 1  ON 18
  ud_9                 8.507209e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510249e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360300e-01 1 1  ON 27
  eO_8                 2.899397e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893473e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758572e-02 1 1  ON 34
 eH1_5                 2.530477e-02 1 1  ON 35
 eH1_6                 7.729272e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666842e-02 1 1  ON 41
 eH2_2                -4.626214e-02 1 1  ON 42
 eH2_3                -1.568806e-02 1 1  ON 43
 eH2_4                 1.794290e-02 1 1  ON 44
 eH2_5                 2.168910e-02 1 1  ON 45
 eH2_6                 6.870838e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822489e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454683e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055569e-02 3 1  ON 56
ci_008                -8.972852e-03 3 1  ON 57
ci_009                -1.503440e-02 3 1  ON 58
ci_010                -9.361095e-03 3 1  ON 59
ci_011                -1.056494e-02 3 1  ON 60
ci_012                -1.039170e-02 3 1  ON 61
ci_013                -1.948812e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351161e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021840e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078734e-02 3 1  ON 71
ci_023                 1.010077e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008306e-03 3 1  ON 74
ci_026                 1.183910e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508896e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850836e-03 3 1  ON 79
ci_031                -4.845079e-03 3 1  ON 80
ci_032                -1.516515e-02 3 1  ON 81
ci_033                 6.838376e-03 3 1  ON 82
ci_034                 7.367478e-03 3 1  ON 83
ci_035                -4.689277e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270353e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512873e-03 3 1  ON 88
ci_040                -2.765064e-03 3 1  ON 89
ci_041                 8.543875e-03 3 1  ON 90
ci_042                 8.305218e-03 3 1  ON 91
ci_043                -3.617421e-03 3 1  ON 92
ci_044                -4.696362e-03 3 1  ON 93
ci_045                -2.845416e-03 3 1  ON 94
ci_046                 5.908391e-03 3 1  ON 95
ci_047                 5.850735e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2171
    reference variance = 0.354155
====================================================
  Execution time = 2.7173e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9215e-01
  Total weights = 1.9666e+06
  Execution time = 2.3698e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281875503664
                                         uncertainty =       0.002948996424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281875503664
                                         uncertainty =       0.002948996424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375384909
  error estimate for blocks of size 2^( 2) =       0.000389537655
  error estimate for blocks of size 2^( 3) =       0.000402673384
  error estimate for blocks of size 2^( 4) =       0.000412117259
  error estimate for blocks of size 2^( 5) =       0.000417277637
  error estimate for blocks of size 2^( 6) =       0.000420734494
  error estimate for blocks of size 2^( 7) =       0.000422755551

      target function =      -0.910393658474
              le_mean =     -17.210359555050
             les_mean =     296.488623774092
             stat err =       0.000418221235
             autocorr =       1.241247943798
   target nu stat err =       0.000418221235
   target dn stat err =       0.003013063423
      target stat err =       0.003907192679
              std dev =       0.530882923465
             le_variance =       0.281836678427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281875491304
                                         uncertainty =       0.002949000679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281875491304
                                         uncertainty =       0.002949000679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375384901
  error estimate for blocks of size 2^( 2) =       0.000389537650
  error estimate for blocks of size 2^( 3) =       0.000402673381
  error estimate for blocks of size 2^( 4) =       0.000412117258
  error estimate for blocks of size 2^( 5) =       0.000417277635
  error estimate for blocks of size 2^( 6) =       0.000420734496
  error estimate for blocks of size 2^( 7) =       0.000422755549

      target function =      -0.910393568083
              le_mean =     -17.210359554225
             les_mean =     296.488623816007
             stat err =       0.000418221235
             autocorr =       1.241247995225
   target nu stat err =       0.000418221235
   target dn stat err =       0.003013069837
      target stat err =       0.003907200036
              std dev =       0.530882911530
             le_variance =       0.281836665754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281875497484
                                         uncertainty =       0.002948998552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281875497484
                                         uncertainty =       0.002948998552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375384905
  error estimate for blocks of size 2^( 2) =       0.000389537653
  error estimate for blocks of size 2^( 3) =       0.000402673382
  error estimate for blocks of size 2^( 4) =       0.000412117258
  error estimate for blocks of size 2^( 5) =       0.000417277636
  error estimate for blocks of size 2^( 6) =       0.000420734495
  error estimate for blocks of size 2^( 7) =       0.000422755550

      target function =      -0.910393613385
              le_mean =     -17.210359554637
             les_mean =     296.488623794966
             stat err =       0.000418221235
             autocorr =       1.241247969515
   target nu stat err =       0.000418221235
   target dn stat err =       0.003013066629
      target stat err =       0.003907196356
              std dev =       0.530882917497
             le_variance =       0.281836672090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281875502892
                                         uncertainty =       0.002948996690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281875502892
                                         uncertainty =       0.002948996690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375384909
  error estimate for blocks of size 2^( 2) =       0.000389537655
  error estimate for blocks of size 2^( 3) =       0.000402673383
  error estimate for blocks of size 2^( 4) =       0.000412117259
  error estimate for blocks of size 2^( 5) =       0.000417277637
  error estimate for blocks of size 2^( 6) =       0.000420734494
  error estimate for blocks of size 2^( 7) =       0.000422755551

      target function =      -0.910393652849
              le_mean =     -17.210359554998
             les_mean =     296.488623776692
             stat err =       0.000418221235
             autocorr =       1.241247947017
   target nu stat err =       0.000418221235
   target dn stat err =       0.003013063824
      target stat err =       0.003907193138
              std dev =       0.530882922719
             le_variance =       0.281836677635


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910393658474        initial  <--
     1.5625e+03     1.5625e+04             2.4421e-07        -0.910393568083
     6.2500e+03     6.2500e+04             6.1052e-08        -0.910393613385
     2.5000e+04     2.5000e+05             1.5263e-08        -0.910393652849

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1036
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557760e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114944e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056494e-02 3 1  ON 60
ci_012                -1.039171e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305213e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696355e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6638e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2346
    reference variance = 0.225471
====================================================
  Execution time = 2.7343e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0480e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8732e-01
  Total weights = 1.965931839e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5427e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276448585864
                                         uncertainty =       0.001820541588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276448585864
                                         uncertainty =       0.001820541588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371816142
  error estimate for blocks of size 2^( 2) =       0.000386313652
  error estimate for blocks of size 2^( 3) =       0.000399550453
  error estimate for blocks of size 2^( 4) =       0.000408516888
  error estimate for blocks of size 2^( 5) =       0.000414062190
  error estimate for blocks of size 2^( 6) =       0.000416971892
  error estimate for blocks of size 2^( 7) =       0.000419001499

      target function =      -0.916500956709
              le_mean =     -17.209886508554
             les_mean =     296.467515483455
             stat err =       0.000414638117
             autocorr =       1.243603591611
   target nu stat err =       0.000414638117
   target dn stat err =       0.002825807468
      target stat err =       0.003715296392
              std dev =       0.525835843375
             le_variance =       0.276503334178


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720988650855e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916515217140       residual = 8.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916515219376       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916515219661       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916515219725       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916515219741       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916515219759       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916515219768       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916515219755       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916515219761       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916515219852       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916515219874       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916515219829       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916515219872       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916515219864       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916515219880       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916515219872       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916515219929       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916515219893       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916515219930       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916515219879       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916515219925       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916515219917       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916515219923       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916515219921       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916515219899       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916515219874       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916515219905       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916515219933       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916515219975       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916515219820       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916515219857       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916515219958       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916515219982       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916515219978       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916515219893       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916515219905       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916515219911       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916515219935       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916515219938       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916515219892       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+04 is 2.574239e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916515217140       residual = 8.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916515217699       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916515217770       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916515217786       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916515217786       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916515217764       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916515217921       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916515217710       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916515217780       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916515217896       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916515217714       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916515217819       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916515217802       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916515217621       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916515217808       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916515217810       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916515217830       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916515217954       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916515217695       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916515217852       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916515217742       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916515217749       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916515218006       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916515217814       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916515217807       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916515217763       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916515217842       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916515217972       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916515217831       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916515217502       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916515217705       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916515217904       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916515217592       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916515217639       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916515217789       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916515217652       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916515217894       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916515217690       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916515217898       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916515217855       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+04 is 6.435599e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916515217140       residual = 8.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916515217280       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916515217298       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916515217302       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916515217208       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916515217606       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916515217419       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916515217397       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916515217111       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916515217376       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916515216969       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916515217551       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916515217155       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916515217118       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916515217368       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916515216897       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916515217699       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916515217467       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916515216857       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916515217740       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916515216829       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916515217546       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916515217911       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916515218140       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916515217136       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916515217504       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916515217659       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916515216784       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916515217235       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916515217448       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916515218250       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916515217923       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916515216906       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916515217695       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916515217019       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916515217467       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916515217348       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916515216718       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916515217378       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916515217876       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+05 is 1.608900e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.776431 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5963e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886150e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114944e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893473e-02 1 1  ON 32
 eH1_3                -1.761907e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055569e-02 3 1  ON 56
ci_008                -8.972854e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008290e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850837e-03 3 1  ON 79
ci_031                -4.845087e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838371e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689282e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543884e-03 3 1  ON 90
ci_042                 8.305211e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696353e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2457
    reference variance = 0.39818
====================================================
  Execution time = 2.6987e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8542e-01
  Total weights = 1.9663e+06
  Execution time = 2.3669e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277073906001
                                         uncertainty =       0.001779221069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277073906001
                                         uncertainty =       0.001779221069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372180141
  error estimate for blocks of size 2^( 2) =       0.000386254179
  error estimate for blocks of size 2^( 3) =       0.000399426080
  error estimate for blocks of size 2^( 4) =       0.000409012212
  error estimate for blocks of size 2^( 5) =       0.000414031815
  error estimate for blocks of size 2^( 6) =       0.000418872871
  error estimate for blocks of size 2^( 7) =       0.000419989173

      target function =      -0.918913255666
              le_mean =     -17.209612865060
             les_mean =     296.456191146005
             stat err =       0.000415476518
             autocorr =       1.246196636693
   target nu stat err =       0.000415476518
   target dn stat err =       0.002262421335
      target stat err =       0.003009744088
              std dev =       0.526350623845
             le_variance =       0.277044979222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277073906330
                                         uncertainty =       0.001779221200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277073906330
                                         uncertainty =       0.001779221200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372180141
  error estimate for blocks of size 2^( 2) =       0.000386254180
  error estimate for blocks of size 2^( 3) =       0.000399426083
  error estimate for blocks of size 2^( 4) =       0.000409012215
  error estimate for blocks of size 2^( 5) =       0.000414031818
  error estimate for blocks of size 2^( 6) =       0.000418872874
  error estimate for blocks of size 2^( 7) =       0.000419989176

      target function =      -0.918913255298
              le_mean =     -17.209612865094
             les_mean =     296.456191147469
             stat err =       0.000415476521
             autocorr =       1.246196652633
   target nu stat err =       0.000415476521
   target dn stat err =       0.002262421973
      target stat err =       0.003009744902
              std dev =       0.526350624196
             le_variance =       0.277044979592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277073906166
                                         uncertainty =       0.001779221134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277073906166
                                         uncertainty =       0.001779221134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372180141
  error estimate for blocks of size 2^( 2) =       0.000386254179
  error estimate for blocks of size 2^( 3) =       0.000399426082
  error estimate for blocks of size 2^( 4) =       0.000409012214
  error estimate for blocks of size 2^( 5) =       0.000414031816
  error estimate for blocks of size 2^( 6) =       0.000418872872
  error estimate for blocks of size 2^( 7) =       0.000419989174

      target function =      -0.918913255482
              le_mean =     -17.209612865077
             les_mean =     296.456191146737
             stat err =       0.000415476519
             autocorr =       1.246196644657
   target nu stat err =       0.000415476519
   target dn stat err =       0.002262421654
      target stat err =       0.003009744495
              std dev =       0.526350624021
             le_variance =       0.277044979407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277073906021
                                         uncertainty =       0.001779221077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277073906021
                                         uncertainty =       0.001779221077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372180141
  error estimate for blocks of size 2^( 2) =       0.000386254179
  error estimate for blocks of size 2^( 3) =       0.000399426081
  error estimate for blocks of size 2^( 4) =       0.000409012213
  error estimate for blocks of size 2^( 5) =       0.000414031815
  error estimate for blocks of size 2^( 6) =       0.000418872871
  error estimate for blocks of size 2^( 7) =       0.000419989173

      target function =      -0.918913255643
              le_mean =     -17.209612865062
             les_mean =     296.456191146096
             stat err =       0.000415476518
             autocorr =       1.246196637686
   target nu stat err =       0.000415476518
   target dn stat err =       0.002262421375
      target stat err =       0.003009744139
              std dev =       0.526350623867
             le_variance =       0.277044979245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918913255666        initial  <--
     1.5625e+04     1.5625e+05             2.5742e-08        -0.918913255298
     6.2500e+04     6.2500e+05             6.4356e-09        -0.918913255482
     2.5000e+05     2.5000e+06             1.6089e-09        -0.918913255643

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9353
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557760e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114944e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056494e-02 3 1  ON 60
ci_012                -1.039171e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305213e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696355e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4904e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1758
    reference variance = 0.140975
====================================================
  Execution time = 2.7769e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0462e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8794e-01
  Total weights = 1.966263355e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2640e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278931447067
                                         uncertainty =       0.001845323673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278931447067
                                         uncertainty =       0.001845323673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373411386
  error estimate for blocks of size 2^( 2) =       0.000387597520
  error estimate for blocks of size 2^( 3) =       0.000400366466
  error estimate for blocks of size 2^( 4) =       0.000410222290
  error estimate for blocks of size 2^( 5) =       0.000415630630
  error estimate for blocks of size 2^( 6) =       0.000418893988
  error estimate for blocks of size 2^( 7) =       0.000421849699

      target function =      -0.915651486637
              le_mean =     -17.209678647890
             les_mean =     296.460976794709
             stat err =       0.000416649152
             autocorr =       1.244990080088
   target nu stat err =       0.000416649152
   target dn stat err =       0.002448538527
      target stat err =       0.003226175691
              std dev =       0.528091896013
             le_variance =       0.278881050635


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720967864789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915662014641       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915662014820       residual = 9.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915662014840       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915662014848       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915662014847       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915662015144       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915662014849       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915662014851       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915662014850       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915662014855       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915662014817       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915662014718       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915662014505       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915662015144       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915662015015       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915662014307       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915662015108       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915662015170       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915662014997       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915662014984       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915662015649       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915662014655       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915662014490       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915662014818       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915662014909       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915662015190       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915662014849       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915662014513       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915662014898       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915662014907       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915662015077       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915662014822       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915662014422       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915662015041       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915662014275       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915662014526       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915662014398       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915662014720       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915662015033       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915662014112       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+05 is 2.388144e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915662014641       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915662014685       residual = 9.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915662014690       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915662014692       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915662014692       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915662014692       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915662014693       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915662014517       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915662015475       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915662013701       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915662014326       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915662014693       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915662014694       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915662013526       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915662015088       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915662015223       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915662013631       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915662014624       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915662014176       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915662015061       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915662013963       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915662015128       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915662014189       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915662015248       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915662014930       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915662013028       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915662014207       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915662012251       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915662015212       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915662016428       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915662012545       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915662014213       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915662014637       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915662013267       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915662012202       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915662017407       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915662012035       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915662011861       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915662013382       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915662008462       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+05 is 5.970349e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915662014641       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915662014652       residual = 9.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915662014653       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915662014653       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915662014289       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915662014653       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915662017652       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915662014457       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915662016145       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915662022144       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915662011497       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915662012040       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915662014654       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915662007000       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915662007453       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915662014066       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915662011538       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915662014142       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915662010440       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915662013143       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915662011681       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915662019832       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915662010737       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915662018273       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915662012824       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915662014289       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915662017036       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915662015229       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915662011122       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915662006311       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915662004835       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915662020828       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915661996394       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915662005804       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915662017651       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915662016899       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915662025423       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915662011094       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915662006775       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915662008831       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+06 is 1.492573e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.846903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6111e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557760e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114944e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056494e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305213e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2343
    reference variance = 0.163016
====================================================
  Execution time = 2.7120e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8495e-01
  Total weights = 1.9662e+06
  Execution time = 2.3624e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275815612884
                                         uncertainty =       0.001912831284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275815612884
                                         uncertainty =       0.001912831284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371317665
  error estimate for blocks of size 2^( 2) =       0.000385722349
  error estimate for blocks of size 2^( 3) =       0.000399312417
  error estimate for blocks of size 2^( 4) =       0.000408901394
  error estimate for blocks of size 2^( 5) =       0.000414772278
  error estimate for blocks of size 2^( 6) =       0.000418144329
  error estimate for blocks of size 2^( 7) =       0.000420875855

      target function =      -0.919615624216
              le_mean =     -17.209970441872
             les_mean =     296.468033827581
             stat err =       0.000415673464
             autocorr =       1.253179782839
   target nu stat err =       0.000415673464
   target dn stat err =       0.002390837639
      target stat err =       0.003180771338
              std dev =       0.525130879802
             le_variance =       0.275762440922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275815612870
                                         uncertainty =       0.001912831299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275815612870
                                         uncertainty =       0.001912831299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371317665
  error estimate for blocks of size 2^( 2) =       0.000385722349
  error estimate for blocks of size 2^( 3) =       0.000399312417
  error estimate for blocks of size 2^( 4) =       0.000408901394
  error estimate for blocks of size 2^( 5) =       0.000414772278
  error estimate for blocks of size 2^( 6) =       0.000418144330
  error estimate for blocks of size 2^( 7) =       0.000420875855

      target function =      -0.919615625048
              le_mean =     -17.209970441873
             les_mean =     296.468033827005
             stat err =       0.000415673464
             autocorr =       1.253179783650
   target nu stat err =       0.000415673464
   target dn stat err =       0.002390837625
      target stat err =       0.003180771326
              std dev =       0.525130879790
             le_variance =       0.275762440909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275815612877
                                         uncertainty =       0.001912831291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275815612877
                                         uncertainty =       0.001912831291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371317665
  error estimate for blocks of size 2^( 2) =       0.000385722349
  error estimate for blocks of size 2^( 3) =       0.000399312417
  error estimate for blocks of size 2^( 4) =       0.000408901394
  error estimate for blocks of size 2^( 5) =       0.000414772278
  error estimate for blocks of size 2^( 6) =       0.000418144330
  error estimate for blocks of size 2^( 7) =       0.000420875855

      target function =      -0.919615624632
              le_mean =     -17.209970441873
             les_mean =     296.468033827293
             stat err =       0.000415673464
             autocorr =       1.253179783259
   target nu stat err =       0.000415673464
   target dn stat err =       0.002390837632
      target stat err =       0.003180771332
              std dev =       0.525130879796
             le_variance =       0.275762440916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275815612883
                                         uncertainty =       0.001912831285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275815612883
                                         uncertainty =       0.001912831285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371317665
  error estimate for blocks of size 2^( 2) =       0.000385722349
  error estimate for blocks of size 2^( 3) =       0.000399312417
  error estimate for blocks of size 2^( 4) =       0.000408901394
  error estimate for blocks of size 2^( 5) =       0.000414772278
  error estimate for blocks of size 2^( 6) =       0.000418144329
  error estimate for blocks of size 2^( 7) =       0.000420875855

      target function =      -0.919615624268
              le_mean =     -17.209970441872
             les_mean =     296.468033827545
             stat err =       0.000415673464
             autocorr =       1.253179782876
   target nu stat err =       0.000415673464
   target dn stat err =       0.002390837638
      target stat err =       0.003180771338
              std dev =       0.525130879802
             le_variance =       0.275762440921


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919615624216        initial
     1.5625e+05     1.5625e+06             2.3881e-09        -0.919615625048  <--
     6.2500e+05     6.2500e+06             5.9703e-10        -0.919615624632
     2.5000e+06     2.5000e+07             1.4926e-10        -0.919615624268

*****************************************************************************
Applying the update for shift_i =   1.5625e+05     and shift_s =   1.5625e+06
*****************************************************************************

  Execution time = 3.9021e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5138e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2388
    reference variance = 0.221783
====================================================
  Execution time = 2.7364e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0512e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8876e-01
  Total weights = 1.966335511e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1294e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279267925605
                                         uncertainty =       0.002260076602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279267925605
                                         uncertainty =       0.002260076602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373627168
  error estimate for blocks of size 2^( 2) =       0.000387691125
  error estimate for blocks of size 2^( 3) =       0.000400552421
  error estimate for blocks of size 2^( 4) =       0.000410463296
  error estimate for blocks of size 2^( 5) =       0.000416261623
  error estimate for blocks of size 2^( 6) =       0.000419857448
  error estimate for blocks of size 2^( 7) =       0.000421571280

      target function =      -0.914691981948
              le_mean =     -17.210125717242
             les_mean =     296.477188191674
             stat err =       0.000417038412
             autocorr =       1.245877147440
   target nu stat err =       0.000417038412
   target dn stat err =       0.003400325997
      target stat err =       0.004438053510
              std dev =       0.528397062429
             le_variance =       0.279203455584


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721012571724e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914712673069       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914712673514       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914712673603       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914712673630       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914712673636       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914712673615       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914712673657       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914712673671       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914712673653       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914712673633       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914712673603       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914712673691       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914712673587       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914712673673       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914712673663       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914712673664       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914712673566       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914712673695       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914712673746       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914712673702       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914712673688       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914712673697       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914712673679       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914712673846       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914712673721       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914712673610       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914712673603       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914712673539       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914712673693       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914712673473       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914712673719       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914712673646       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914712673836       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914712673626       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914712673728       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914712673647       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914712673555       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914712673606       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914712673623       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+04 is 1.110230e-08

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914712673069       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914712673180       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914712673203       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914712673210       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914712673213       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914712673214       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914712673553       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914712673107       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914712673186       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914712673458       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914712673078       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914712673236       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914712673396       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914712673295       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914712673312       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914712673163       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914712673411       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914712673151       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914712673351       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914712672929       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914712673361       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914712673624       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914712673524       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914712673497       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914712673615       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914712673083       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914712673166       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914712673689       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914712673244       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914712673283       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914712673879       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914712673022       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914712673399       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914712672989       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914712673148       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914712673506       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914712672539       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914712673274       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914712673276       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+05 is 2.775575e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914712673069       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914712673097       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914712673103       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914712673335       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914712673221       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914712672341       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914712673106       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914712673352       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914712672528       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914712672454       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914712672688       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914712673977       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914712672132       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914712673630       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914712673163       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914712672505       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914712672053       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914712672662       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914712673674       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914712674164       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914712674661       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914712672760       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914712675232       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914712672745       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914712676115       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914712671837       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914712674385       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914712675374       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914712674323       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914712674080       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914712671708       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914712674958       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914712672323       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914712672442       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914712672708       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914712670594       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914712672900       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914712665143       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914712672667       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+05 is 6.938926e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.912117 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5565e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893473e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039171e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850838e-03 3 1  ON 79
ci_031                -4.845087e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367476e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765067e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1476
    reference variance = 0.257645
====================================================
  Execution time = 2.6846e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 3.0438e-01
  Total weights = 1.9664e+06
  Execution time = 2.3613e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291864922106
                                         uncertainty =       0.011945974210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291864922106
                                         uncertainty =       0.011945974210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382023957
  error estimate for blocks of size 2^( 2) =       0.000395839603
  error estimate for blocks of size 2^( 3) =       0.000408681574
  error estimate for blocks of size 2^( 4) =       0.000418159168
  error estimate for blocks of size 2^( 5) =       0.000423621483
  error estimate for blocks of size 2^( 6) =       0.000427416483
  error estimate for blocks of size 2^( 7) =       0.000427767009

      target function =      -0.894206107093
              le_mean =     -17.208621276342
             les_mean =     296.441029203203
             stat err =       0.000424241035
             autocorr =       1.233230197333
   target nu stat err =       0.000424241035
   target dn stat err =       0.015459566185
      target stat err =       0.019085661353
              std dev =       0.540272105440
             le_variance =       0.291893947916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291864926415
                                         uncertainty =       0.011945978164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291864926415
                                         uncertainty =       0.011945978164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382023960
  error estimate for blocks of size 2^( 2) =       0.000395839606
  error estimate for blocks of size 2^( 3) =       0.000408681577
  error estimate for blocks of size 2^( 4) =       0.000418159171
  error estimate for blocks of size 2^( 5) =       0.000423621486
  error estimate for blocks of size 2^( 6) =       0.000427416486
  error estimate for blocks of size 2^( 7) =       0.000427767012

      target function =      -0.894206105277
              le_mean =     -17.208621276326
             les_mean =     296.441029203914
             stat err =       0.000424241039
             autocorr =       1.233230198085
   target nu stat err =       0.000424241039
   target dn stat err =       0.015459571220
      target stat err =       0.019085667491
              std dev =       0.540272109442
             le_variance =       0.291893952241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291864924261
                                         uncertainty =       0.011945976187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291864924261
                                         uncertainty =       0.011945976187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382023959
  error estimate for blocks of size 2^( 2) =       0.000395839604
  error estimate for blocks of size 2^( 3) =       0.000408681576
  error estimate for blocks of size 2^( 4) =       0.000418159169
  error estimate for blocks of size 2^( 5) =       0.000423621484
  error estimate for blocks of size 2^( 6) =       0.000427416484
  error estimate for blocks of size 2^( 7) =       0.000427767010

      target function =      -0.894206106185
              le_mean =     -17.208621276334
             les_mean =     296.441029203558
             stat err =       0.000424241037
             autocorr =       1.233230197714
   target nu stat err =       0.000424241037
   target dn stat err =       0.015459568702
      target stat err =       0.019085664422
              std dev =       0.540272107441
             le_variance =       0.291893950079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291864922376
                                         uncertainty =       0.011945974457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291864922376
                                         uncertainty =       0.011945974457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382023957
  error estimate for blocks of size 2^( 2) =       0.000395839603
  error estimate for blocks of size 2^( 3) =       0.000408681574
  error estimate for blocks of size 2^( 4) =       0.000418159168
  error estimate for blocks of size 2^( 5) =       0.000423621483
  error estimate for blocks of size 2^( 6) =       0.000427416483
  error estimate for blocks of size 2^( 7) =       0.000427767009

      target function =      -0.894206106980
              le_mean =     -17.208621276341
             les_mean =     296.441029203247
             stat err =       0.000424241036
             autocorr =       1.233230197383
   target nu stat err =       0.000424241036
   target dn stat err =       0.015459566499
      target stat err =       0.019085661736
              std dev =       0.540272105690
             le_variance =       0.291893948187


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.894206107093        initial  <--
     3.9062e+04     3.9062e+05             1.1102e-08        -0.894206105277
     1.5625e+05     1.5625e+06             2.7756e-09        -0.894206106185
     6.2500e+05     6.2500e+06             6.9389e-10        -0.894206106980

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.7319
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4303e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2178
    reference variance = 0.140321
====================================================
  Execution time = 2.7227e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0487e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8557e-01
  Total weights = 1.966149079e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8030e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276437874423
                                         uncertainty =       0.001597921490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276437874423
                                         uncertainty =       0.001597921490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371748116
  error estimate for blocks of size 2^( 2) =       0.000386384082
  error estimate for blocks of size 2^( 3) =       0.000399537217
  error estimate for blocks of size 2^( 4) =       0.000409371192
  error estimate for blocks of size 2^( 5) =       0.000413658742
  error estimate for blocks of size 2^( 6) =       0.000416880161
  error estimate for blocks of size 2^( 7) =       0.000418363598

      target function =      -0.918940511538
              le_mean =     -17.210448027755
             les_mean =     296.485088239904
             stat err =       0.000414568423
             autocorr =       1.243640587237
   target nu stat err =       0.000414568423
   target dn stat err =       0.002262180415
      target stat err =       0.003013246545
              std dev =       0.525739639212
             le_variance =       0.276402168238


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721044802776e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918949662301       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918949662353       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918949662365       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918949662367       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918949662197       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918949662592       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918949662360       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918949663126       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918949662531       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918949662970       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918949663536       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918949661932       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918949662147       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918949662183       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918949661966       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918949662694       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918949661849       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918949662783       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918949663019       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918949663222       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918949661966       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918949661393       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918949662215       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918949662005       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918949662565       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918949661627       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918949661562       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918949663132       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918949662177       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918949662252       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918949662036       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918949662375       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918949661668       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918949663413       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918949661322       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918949663445       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918949661193       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918949662381       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.918949659686       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.918949661792       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.918949662272       residual = 9.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+05 is 8.822440e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918949662301       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918949662314       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918949662317       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918949662317       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918949662594       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918949661140       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918949663153       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918949662986       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918949661974       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918949664684       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918949661063       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918949661630       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918949657747       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918949662282       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918949659334       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918949663335       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918949662165       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918949662998       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918949662171       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918949665082       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918949664208       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918949661964       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918949665019       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918949661030       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918949664149       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918949664245       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918949661679       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918949656676       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918949663562       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918949664132       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918949660835       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918949661780       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918949660071       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918949661584       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918949665771       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918949662191       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918949660512       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918949662897       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.918949662796       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.918949658951       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.918949663857       residual = 9.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+06 is 2.205612e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918949662301       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918949662304       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918949662305       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918949662305       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918949662263       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918949666442       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918949666530       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918949660345       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918949669287       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918949670331       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918949670383       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918949670189       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918949684639       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918949658249       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918949676329       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918949656259       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918949660780       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918949661716       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918949652998       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918949677199       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918949664707       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918949654878       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918949670931       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918949670469       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918949653516       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918949663764       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918949650658       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918949666612       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918949665005       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918949677002       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918949653905       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918949654984       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918949689066       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918949660577       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918949674914       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918949669101       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918949666092       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918949665352       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.918949669698       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.918949660522       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.918949666850       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+06 is 5.514041e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.988440 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6182e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.0605
    reference variance = 0.531094
====================================================
  Execution time = 2.7134e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8988e-01
  Total weights = 1.9664e+06
  Execution time = 2.3759e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279981048740
                                         uncertainty =       0.001749116406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279981048740
                                         uncertainty =       0.001749116406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374120130
  error estimate for blocks of size 2^( 2) =       0.000388471796
  error estimate for blocks of size 2^( 3) =       0.000401502443
  error estimate for blocks of size 2^( 4) =       0.000410900697
  error estimate for blocks of size 2^( 5) =       0.000415191772
  error estimate for blocks of size 2^( 6) =       0.000417808182
  error estimate for blocks of size 2^( 7) =       0.000421088104

      target function =      -0.913150605543
              le_mean =     -17.209739101658
             les_mean =     296.465004252413
             stat err =       0.000416247189
             autocorr =       1.237885491588
   target nu stat err =       0.000416247189
   target dn stat err =       0.002621383525
      target stat err =       0.003428257922
              std dev =       0.529094227417
             le_variance =       0.279940701486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279981048754
                                         uncertainty =       0.001749116411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279981048754
                                         uncertainty =       0.001749116411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374120130
  error estimate for blocks of size 2^( 2) =       0.000388471796
  error estimate for blocks of size 2^( 3) =       0.000401502443
  error estimate for blocks of size 2^( 4) =       0.000410900697
  error estimate for blocks of size 2^( 5) =       0.000415191772
  error estimate for blocks of size 2^( 6) =       0.000417808182
  error estimate for blocks of size 2^( 7) =       0.000421088104

      target function =      -0.913150605206
              le_mean =     -17.209739101660
             les_mean =     296.465004252754
             stat err =       0.000416247189
             autocorr =       1.237885491510
   target nu stat err =       0.000416247189
   target dn stat err =       0.002621383601
      target stat err =       0.003428258017
              std dev =       0.529094227430
             le_variance =       0.279940701499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279981048747
                                         uncertainty =       0.001749116408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279981048747
                                         uncertainty =       0.001749116408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374120130
  error estimate for blocks of size 2^( 2) =       0.000388471796
  error estimate for blocks of size 2^( 3) =       0.000401502443
  error estimate for blocks of size 2^( 4) =       0.000410900697
  error estimate for blocks of size 2^( 5) =       0.000415191772
  error estimate for blocks of size 2^( 6) =       0.000417808182
  error estimate for blocks of size 2^( 7) =       0.000421088104

      target function =      -0.913150605374
              le_mean =     -17.209739101659
             les_mean =     296.465004252583
             stat err =       0.000416247189
             autocorr =       1.237885491546
   target nu stat err =       0.000416247189
   target dn stat err =       0.002621383563
      target stat err =       0.003428257969
              std dev =       0.529094227423
             le_variance =       0.279940701492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279981048741
                                         uncertainty =       0.001749116406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279981048741
                                         uncertainty =       0.001749116406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374120130
  error estimate for blocks of size 2^( 2) =       0.000388471796
  error estimate for blocks of size 2^( 3) =       0.000401502443
  error estimate for blocks of size 2^( 4) =       0.000410900697
  error estimate for blocks of size 2^( 5) =       0.000415191772
  error estimate for blocks of size 2^( 6) =       0.000417808182
  error estimate for blocks of size 2^( 7) =       0.000421088104

      target function =      -0.913150605522
              le_mean =     -17.209739101658
             les_mean =     296.465004252435
             stat err =       0.000416247189
             autocorr =       1.237885491579
   target nu stat err =       0.000416247189
   target dn stat err =       0.002621383529
      target stat err =       0.003428257928
              std dev =       0.529094227417
             le_variance =       0.279940701487


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913150605543        initial  <--
     3.9062e+05     3.9062e+06             8.8224e-10        -0.913150605206
     1.5625e+06     1.5625e+07             2.2056e-10        -0.913150605374
     6.2500e+06     6.2500e+07             5.5140e-11        -0.913150605522

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1029
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5294e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2644
    reference variance = 0.147939
====================================================
  Execution time = 2.7307e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0477e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9084e-01
  Total weights = 1.966315520e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2074e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276849963334
                                         uncertainty =       0.001869768754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276849963334
                                         uncertainty =       0.001869768754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372060791
  error estimate for blocks of size 2^( 2) =       0.000386285916
  error estimate for blocks of size 2^( 3) =       0.000399598142
  error estimate for blocks of size 2^( 4) =       0.000409341968
  error estimate for blocks of size 2^( 5) =       0.000415301842
  error estimate for blocks of size 2^( 6) =       0.000418638310
  error estimate for blocks of size 2^( 7) =       0.000418987943

      target function =      -0.911914757831
              le_mean =     -17.209826734132
             les_mean =     296.468974480874
             stat err =       0.000415567516
             autocorr =       1.247542570317
   target nu stat err =       0.000415567516
   target dn stat err =       0.004860886593
      target stat err =       0.006274611111
              std dev =       0.526181835175
             le_variance =       0.276867323668


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720982673413e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911957437828       residual = 2.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911957437850       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911957437853       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911957437853       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911957436683       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911957443711       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911957428304       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911957438749       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911957436694       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911957442558       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911957438660       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911957436257       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911957441957       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911957432977       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911957445162       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911957435996       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911957430668       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911957445771       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911957433510       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911957445336       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911957435638       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911957429979       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911957409210       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911957422971       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911957440835       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911957423464       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911957442256       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911957444691       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911957432598       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911957428262       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911957452917       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911957444799       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911957438932       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911957427659       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911957450397       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911957421552       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911957434378       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911957455917       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911957425234       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911957431136       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+06 is 7.903151e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911957437828       residual = 2.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911957437834       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911957437834       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911957443131       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911957437850       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911957398273       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911957442913       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911957419522       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911957414421       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911957424077       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911957457264       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911957406349       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911957447105       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911957413134       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911957416993       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911957456610       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911957403733       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911957437766       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911957446250       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911957397655       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911957444502       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911957452830       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911957412340       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911957424126       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911957466018       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911957440816       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911957436854       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911957485050       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911957481652       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911957501323       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911957450009       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911957367237       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911957428715       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911957442366       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911957433576       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911957411515       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911957416176       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911957562006       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911957449530       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911957365914       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+07 is 1.975802e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911957437828       residual = 2.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911957437829       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911957437830       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911957473679       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911957437830       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911957437830       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911957580324       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911957432632       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911957437830       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911957437830       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911957417451       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911957571478       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911957097184       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911957514465       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911957548357       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911957576614       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911957546695       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911957402500       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911957317406       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911957417691       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911957335290       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911957395043       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911957508412       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911957609235       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911957190716       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911957543982       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911957440897       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911957520606       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911957471250       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911957358241       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911957668357       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911957405762       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911957539380       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911957505725       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911957365523       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911957395199       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911957444058       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911957412529       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911957371895       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911957526479       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+07 is 4.938720e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.058080 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5592e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.177
    reference variance = 0.108238
====================================================
  Execution time = 2.6938e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8537e-01
  Total weights = 1.9665e+06
  Execution time = 2.3717e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277642137129
                                         uncertainty =       0.002374836968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277642137129
                                         uncertainty =       0.002374836968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372597870
  error estimate for blocks of size 2^( 2) =       0.000387387598
  error estimate for blocks of size 2^( 3) =       0.000400702986
  error estimate for blocks of size 2^( 4) =       0.000410117595
  error estimate for blocks of size 2^( 5) =       0.000415721524
  error estimate for blocks of size 2^( 6) =       0.000417296081
  error estimate for blocks of size 2^( 7) =       0.000419428062

      target function =      -0.919073512630
              le_mean =     -17.210001919579
             les_mean =     296.469538485174
             stat err =       0.000415640816
             autocorr =       1.244387503261
   target nu stat err =       0.000415640816
   target dn stat err =       0.002442022138
      target stat err =       0.003242928294
              std dev =       0.526941391836
             le_variance =       0.277667230430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277642137147
                                         uncertainty =       0.002374836970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277642137147
                                         uncertainty =       0.002374836970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372597870
  error estimate for blocks of size 2^( 2) =       0.000387387598
  error estimate for blocks of size 2^( 3) =       0.000400702986
  error estimate for blocks of size 2^( 4) =       0.000410117595
  error estimate for blocks of size 2^( 5) =       0.000415721524
  error estimate for blocks of size 2^( 6) =       0.000417296081
  error estimate for blocks of size 2^( 7) =       0.000419428062

      target function =      -0.919073513085
              le_mean =     -17.210001919580
             les_mean =     296.469538484837
             stat err =       0.000415640816
             autocorr =       1.244387503306
   target nu stat err =       0.000415640816
   target dn stat err =       0.002442022134
      target stat err =       0.003242928292
              std dev =       0.526941391852
             le_variance =       0.277667230447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277642137138
                                         uncertainty =       0.002374836969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277642137138
                                         uncertainty =       0.002374836969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372597870
  error estimate for blocks of size 2^( 2) =       0.000387387598
  error estimate for blocks of size 2^( 3) =       0.000400702986
  error estimate for blocks of size 2^( 4) =       0.000410117595
  error estimate for blocks of size 2^( 5) =       0.000415721524
  error estimate for blocks of size 2^( 6) =       0.000417296081
  error estimate for blocks of size 2^( 7) =       0.000419428062

      target function =      -0.919073512858
              le_mean =     -17.210001919579
             les_mean =     296.469538485005
             stat err =       0.000415640816
             autocorr =       1.244387503284
   target nu stat err =       0.000415640816
   target dn stat err =       0.002442022136
      target stat err =       0.003242928293
              std dev =       0.526941391844
             le_variance =       0.277667230438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277642137130
                                         uncertainty =       0.002374836968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277642137130
                                         uncertainty =       0.002374836968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372597870
  error estimate for blocks of size 2^( 2) =       0.000387387598
  error estimate for blocks of size 2^( 3) =       0.000400702986
  error estimate for blocks of size 2^( 4) =       0.000410117595
  error estimate for blocks of size 2^( 5) =       0.000415721524
  error estimate for blocks of size 2^( 6) =       0.000417296081
  error estimate for blocks of size 2^( 7) =       0.000419428062

      target function =      -0.919073512659
              le_mean =     -17.210001919579
             les_mean =     296.469538485153
             stat err =       0.000415640816
             autocorr =       1.244387503267
   target nu stat err =       0.000415640816
   target dn stat err =       0.002442022138
      target stat err =       0.003242928293
              std dev =       0.526941391837
             le_variance =       0.277667230431


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919073512630        initial
     3.9062e+06     3.9062e+07             7.9032e-11        -0.919073513085  <--
     1.5625e+07     1.5625e+08             1.9758e-11        -0.919073512858
     6.2500e+07     6.2500e+08             4.9387e-12        -0.919073512659

*****************************************************************************
Applying the update for shift_i =   3.9062e+06     and shift_s =   3.9062e+07
*****************************************************************************

  Execution time = 3.8858e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4456e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1424
    reference variance = 0.366379
====================================================
  Execution time = 2.7100e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0463e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8807e-01
  Total weights = 1.966209331e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.0946e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278624347324
                                         uncertainty =       0.001925999248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278624347324
                                         uncertainty =       0.001925999248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373290001
  error estimate for blocks of size 2^( 2) =       0.000387543858
  error estimate for blocks of size 2^( 3) =       0.000400443684
  error estimate for blocks of size 2^( 4) =       0.000410345237
  error estimate for blocks of size 2^( 5) =       0.000415621733
  error estimate for blocks of size 2^( 6) =       0.000419183076
  error estimate for blocks of size 2^( 7) =       0.000421488694

      target function =      -0.915559262387
              le_mean =     -17.209992684921
             les_mean =     296.471920803466
             stat err =       0.000416659685
             autocorr =       1.245862886919
   target nu stat err =       0.000416659685
   target dn stat err =       0.002384455937
      target stat err =       0.003145501365
              std dev =       0.527920228350
             le_variance =       0.278699767501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720999268492e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915569341447       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915569341476       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915569341481       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915569341378       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915569341224       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915569341400       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915569342463       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915569343492       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915569339648       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915569341115       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915569342887       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915569340117       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915569342036       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915569342703       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915569341271       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915569341372       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915569340154       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915569340829       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915569340897       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915569343266       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915569340121       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915569340607       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915569339085       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915569342233       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915569339159       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915569339818       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915569343307       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915569342627       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915569340264       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915569342816       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915569339686       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915569339758       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915569343486       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915569339740       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915569343173       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915569342825       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915569342218       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915569341646       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915569341508       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915569340701       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+05 is 4.352310e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915569341447       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915569341454       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915569341455       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915569341456       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915569341456       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915569341456       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915569341456       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915569340363       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915569334558       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915569343270       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915569341456       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915569333134       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915569348354       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915569343396       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915569338234       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915569344746       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915569344518       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915569351599       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915569340160       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915569341489       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915569335228       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915569344942       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915569329656       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915569330978       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915569345654       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915569335014       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915569332228       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915569344454       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915569338598       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915569343927       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915569345185       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915569344224       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915569358799       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915569350386       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915569333517       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915569326563       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915569351128       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915569336972       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915569345934       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915569347080       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+06 is 1.088075e-10

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915569341447       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915569341449       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915569341449       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915569341449       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915569341413       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915569341916       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915569305268       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915569324697       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915569341449       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915569370953       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915569337526       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915569304271       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915569357321       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915569307070       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915569345137       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915569276718       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915569319371       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915569314248       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915569321660       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915569367518       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915569349960       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915569291266       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915569339073       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915569326347       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915569326239       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915569315132       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915569358248       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915569284403       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915569355476       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915569303453       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915569329572       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915569360373       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915569383237       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915569314829       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915569290239       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915569380051       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915569346125       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915569282390       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915569382561       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915569253196       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+07 is 2.720202e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.128833 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5273e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2273
    reference variance = 0.160858
====================================================
  Execution time = 2.7025e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8271e-01
  Total weights = 1.9663e+06
  Execution time = 2.3669e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274996661085
                                         uncertainty =       0.001402762157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274996661085
                                         uncertainty =       0.001402762157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370783112
  error estimate for blocks of size 2^( 2) =       0.000385284634
  error estimate for blocks of size 2^( 3) =       0.000398450070
  error estimate for blocks of size 2^( 4) =       0.000408251494
  error estimate for blocks of size 2^( 5) =       0.000413518615
  error estimate for blocks of size 2^( 6) =       0.000417428822
  error estimate for blocks of size 2^( 7) =       0.000418943744

      target function =      -0.922442042317
              le_mean =     -17.209533983924
             les_mean =     296.450766722812
             stat err =       0.000414535669
             autocorr =       1.249924903205
   target nu stat err =       0.000414535669
   target dn stat err =       0.001939577435
      target stat err =       0.002616912372
              std dev =       0.524374895220
             le_variance =       0.274969030737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274996661049
                                         uncertainty =       0.001402762157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274996661049
                                         uncertainty =       0.001402762157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370783112
  error estimate for blocks of size 2^( 2) =       0.000385284634
  error estimate for blocks of size 2^( 3) =       0.000398450070
  error estimate for blocks of size 2^( 4) =       0.000408251494
  error estimate for blocks of size 2^( 5) =       0.000413518615
  error estimate for blocks of size 2^( 6) =       0.000417428822
  error estimate for blocks of size 2^( 7) =       0.000418943744

      target function =      -0.922442041464
              le_mean =     -17.209533983926
             les_mean =     296.450766723507
             stat err =       0.000414535669
             autocorr =       1.249924903369
   target nu stat err =       0.000414535669
   target dn stat err =       0.001939577436
      target stat err =       0.002616912368
              std dev =       0.524374895186
             le_variance =       0.274969030701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274996661067
                                         uncertainty =       0.001402762157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274996661067
                                         uncertainty =       0.001402762157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370783112
  error estimate for blocks of size 2^( 2) =       0.000385284634
  error estimate for blocks of size 2^( 3) =       0.000398450070
  error estimate for blocks of size 2^( 4) =       0.000408251494
  error estimate for blocks of size 2^( 5) =       0.000413518615
  error estimate for blocks of size 2^( 6) =       0.000417428822
  error estimate for blocks of size 2^( 7) =       0.000418943744

      target function =      -0.922442041890
              le_mean =     -17.209533983925
             les_mean =     296.450766723160
             stat err =       0.000414535669
             autocorr =       1.249924903288
   target nu stat err =       0.000414535669
   target dn stat err =       0.001939577435
      target stat err =       0.002616912370
              std dev =       0.524374895203
             le_variance =       0.274969030719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274996661083
                                         uncertainty =       0.001402762157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274996661083
                                         uncertainty =       0.001402762157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370783112
  error estimate for blocks of size 2^( 2) =       0.000385284634
  error estimate for blocks of size 2^( 3) =       0.000398450070
  error estimate for blocks of size 2^( 4) =       0.000408251494
  error estimate for blocks of size 2^( 5) =       0.000413518615
  error estimate for blocks of size 2^( 6) =       0.000417428822
  error estimate for blocks of size 2^( 7) =       0.000418943744

      target function =      -0.922442042263
              le_mean =     -17.209533983925
             les_mean =     296.450766722855
             stat err =       0.000414535669
             autocorr =       1.249924903213
   target nu stat err =       0.000414535669
   target dn stat err =       0.001939577435
      target stat err =       0.002616912372
              std dev =       0.524374895218
             le_variance =       0.274969030735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922442042317        initial  <--
     9.7656e+05     9.7656e+06             4.3523e-10        -0.922442041464
     3.9062e+06     3.9062e+07             1.0881e-10        -0.922442041890
     1.5625e+07     1.5625e+08             2.7202e-11        -0.922442042263

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9549
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4234e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1867
    reference variance = 0.318626
====================================================
  Execution time = 2.7166e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0478e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8692e-01
  Total weights = 1.966182499e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4023e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277337110135
                                         uncertainty =       0.002240964645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277337110135
                                         uncertainty =       0.002240964645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372360293
  error estimate for blocks of size 2^( 2) =       0.000386440557
  error estimate for blocks of size 2^( 3) =       0.000399469386
  error estimate for blocks of size 2^( 4) =       0.000409615541
  error estimate for blocks of size 2^( 5) =       0.000415078189
  error estimate for blocks of size 2^( 6) =       0.000418186193
  error estimate for blocks of size 2^( 7) =       0.000420328205

      target function =      -0.917132305314
              le_mean =     -17.210290479048
             les_mean =     296.481016283327
             stat err =       0.000415802032
             autocorr =       1.246942676665
   target nu stat err =       0.000415802032
   target dn stat err =       0.002825055747
      target stat err =       0.003721973227
              std dev =       0.526605401289
             le_variance =       0.277313248667


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721029047905e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917146688008       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917146688011       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917146688011       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917146688011       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917146688254       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917146698340       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917146694043       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917146674704       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917146668952       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917146672866       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917146684454       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917146687868       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917146690517       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917146713388       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917146687926       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917146699114       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917146699573       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917146683607       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917146686364       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917146672106       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917146699150       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917146655781       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917146699355       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917146684117       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917146681201       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917146670360       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917146678698       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917146686380       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917146639359       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917146702324       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917146715401       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917146669084       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917146662124       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917146650994       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917146686959       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917146694480       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917146689362       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917146690191       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917146678497       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917146670022       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+06 is 4.115539e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917146688008       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917146688009       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917146688009       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917146688009       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917146688009       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917146714749       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917146636357       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917146728133       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917146696410       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917146689608       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917146787175       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917146660962       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917146670900       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917146715882       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917146722544       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917146728013       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917146701136       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917146729005       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917146709766       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917146707476       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917146747058       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917146779972       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917146580321       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917146610518       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917146694205       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917146641773       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917146856708       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917146784644       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917146776517       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917146571021       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917146779983       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917146654402       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917146700288       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917146794232       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917146651069       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917146606482       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917146579583       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917146570550       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917146503072       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917146757283       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+07 is 1.028903e-11

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917146688008       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917146688008       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917146688008       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917146740776       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917146687917       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917146626719       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917147025205       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917146252953       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917146492149       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917146628737       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917147025154       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917146650084       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917146776085       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917146662002       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917146931936       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917146888207       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917146688662       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917146953576       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917146874085       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917146630080       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917146589086       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917146211736       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917146435548       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917146637091       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917146246257       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917146345570       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917147089033       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917146882832       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917146543354       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917146503172       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917146650031       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917146430762       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917146175910       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917146375261       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917146507159       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917147100048       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917146035846       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917146224395       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917146145667       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917146834412       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+08 is 2.572832e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.199072 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5646e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.152
    reference variance = 0.164454
====================================================
  Execution time = 2.6899e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8686e-01
  Total weights = 1.9667e+06
  Execution time = 2.3718e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278397399092
                                         uncertainty =       0.001863125479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278397399092
                                         uncertainty =       0.001863125479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373090377
  error estimate for blocks of size 2^( 2) =       0.000387449377
  error estimate for blocks of size 2^( 3) =       0.000400887498
  error estimate for blocks of size 2^( 4) =       0.000410947297
  error estimate for blocks of size 2^( 5) =       0.000416852014
  error estimate for blocks of size 2^( 6) =       0.000420876364
  error estimate for blocks of size 2^( 7) =       0.000423433740

      target function =      -0.916971002502
              le_mean =     -17.209391100384
             les_mean =     296.450002668652
             stat err =       0.000418027354
             autocorr =       1.255397637929
   target nu stat err =       0.000418027354
   target dn stat err =       0.002591677387
      target stat err =       0.003417156156
              std dev =       0.527637913016
             le_variance =       0.278401767252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278397399091
                                         uncertainty =       0.001863125478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278397399091
                                         uncertainty =       0.001863125478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373090377
  error estimate for blocks of size 2^( 2) =       0.000387449377
  error estimate for blocks of size 2^( 3) =       0.000400887498
  error estimate for blocks of size 2^( 4) =       0.000410947297
  error estimate for blocks of size 2^( 5) =       0.000416852014
  error estimate for blocks of size 2^( 6) =       0.000420876364
  error estimate for blocks of size 2^( 7) =       0.000423433740

      target function =      -0.916971002524
              le_mean =     -17.209391100384
             les_mean =     296.450002668631
             stat err =       0.000418027354
             autocorr =       1.255397637923
   target nu stat err =       0.000418027354
   target dn stat err =       0.002591677384
      target stat err =       0.003417156153
              std dev =       0.527637913016
             le_variance =       0.278401767251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278397399091
                                         uncertainty =       0.001863125479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278397399091
                                         uncertainty =       0.001863125479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373090377
  error estimate for blocks of size 2^( 2) =       0.000387449377
  error estimate for blocks of size 2^( 3) =       0.000400887498
  error estimate for blocks of size 2^( 4) =       0.000410947297
  error estimate for blocks of size 2^( 5) =       0.000416852014
  error estimate for blocks of size 2^( 6) =       0.000420876364
  error estimate for blocks of size 2^( 7) =       0.000423433740

      target function =      -0.916971002513
              le_mean =     -17.209391100384
             les_mean =     296.450002668642
             stat err =       0.000418027354
             autocorr =       1.255397637922
   target nu stat err =       0.000418027354
   target dn stat err =       0.002591677385
      target stat err =       0.003417156154
              std dev =       0.527637913015
             le_variance =       0.278401767251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278397399092
                                         uncertainty =       0.001863125479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278397399092
                                         uncertainty =       0.001863125479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373090377
  error estimate for blocks of size 2^( 2) =       0.000387449377
  error estimate for blocks of size 2^( 3) =       0.000400887498
  error estimate for blocks of size 2^( 4) =       0.000410947297
  error estimate for blocks of size 2^( 5) =       0.000416852014
  error estimate for blocks of size 2^( 6) =       0.000420876364
  error estimate for blocks of size 2^( 7) =       0.000423433740

      target function =      -0.916971002503
              le_mean =     -17.209391100384
             les_mean =     296.450002668651
             stat err =       0.000418027354
             autocorr =       1.255397637937
   target nu stat err =       0.000418027354
   target dn stat err =       0.002591677387
      target stat err =       0.003417156156
              std dev =       0.527637913016
             le_variance =       0.278401767252


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916971002502        initial
     9.7656e+06     9.7656e+07             4.1155e-11        -0.916971002524  <--
     3.9062e+07     3.9062e+08             1.0289e-11        -0.916971002513
     1.5625e+08     1.5625e+09             2.5728e-12        -0.916971002503

*****************************************************************************
Applying the update for shift_i =   9.7656e+06     and shift_s =   9.7656e+07
*****************************************************************************

  Execution time = 3.8831e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4485e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7195e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2342
    reference variance = 0.175424
====================================================
  Execution time = 2.7156e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0494e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8320e-01
  Total weights = 1.966397839e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5459e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275512011554
                                         uncertainty =       0.001638515437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275512011554
                                         uncertainty =       0.001638515437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371171993
  error estimate for blocks of size 2^( 2) =       0.000385317528
  error estimate for blocks of size 2^( 3) =       0.000398549906
  error estimate for blocks of size 2^( 4) =       0.000407392712
  error estimate for blocks of size 2^( 5) =       0.000412904158
  error estimate for blocks of size 2^( 6) =       0.000417056079
  error estimate for blocks of size 2^( 7) =       0.000420565588

      target function =      -0.921773248610
              le_mean =     -17.209479538459
             les_mean =     296.449389554238
             stat err =       0.000414479635
             autocorr =       1.246969971471
   target nu stat err =       0.000414479635
   target dn stat err =       0.002107329019
      target stat err =       0.002827885428
              std dev =       0.524924864923
             le_variance =       0.275546113814


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720947953846e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921781162424       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921781162431       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921781162432       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921781162202       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921781162487       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921781163846       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921781165700       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921781164790       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921781162982       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921781162610       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921781159464       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921781162078       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921781166589       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921781168518       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921781163658       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921781167136       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921781163835       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921781155641       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921781163039       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921781161161       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921781169414       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921781157408       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921781166088       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921781158422       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921781171049       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921781158364       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921781158756       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921781162679       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921781165035       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921781151299       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921781166594       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921781161481       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.921781158073       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921781164104       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921781149087       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921781168676       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.921781164387       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921781163219       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.921781166382       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.921781170427       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+06 is 1.313186e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921781162424       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921781162425       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921781162426       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921781162428       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921781162377       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921781166473       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921781144645       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921781173197       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921781164628       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921781165874       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921781168502       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921781173476       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921781166998       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921781167172       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921781155851       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921781169550       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921781170853       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921781153378       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921781163170       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921781173109       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921781182951       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921781169714       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921781171855       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921781165107       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921781185121       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921781172553       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921781144461       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921781150027       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921781162622       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921781168090       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921781181636       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921781153735       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.921781150119       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921781176209       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921781128880       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921781146738       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.921781192863       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921781163359       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.921781144803       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.921781154665       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+06 is 3.282954e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921781162424       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921781162424       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921781162424       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921781162424       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921781169085       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921781225247       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921781099465       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921781183840       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921781225137       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921781110369       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921781092151       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921781171399       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921781101807       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921781180379       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921781167750       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921781146236       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921781098937       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921781130421       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921781163892       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921781211843       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921781132342       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921781155102       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921781190162       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921781167828       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921781088158       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921781102235       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921781307138       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921781248397       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921781096089       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921781107549       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921781227985       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921781188146       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.921781220031       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921781192616       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921781141855       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921781169618       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.921781117355       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921781073622       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.921781168479       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.921781022779       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+07 is 8.207378e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.269031 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7792e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1865
    reference variance = 0.132303
====================================================
  Execution time = 2.7453e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8595e-01
  Total weights = 1.9664e+06
  Execution time = 2.3693e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277185721703
                                         uncertainty =       0.001879146258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277185721703
                                         uncertainty =       0.001879146258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372232605
  error estimate for blocks of size 2^( 2) =       0.000386667394
  error estimate for blocks of size 2^( 3) =       0.000399617116
  error estimate for blocks of size 2^( 4) =       0.000408797380
  error estimate for blocks of size 2^( 5) =       0.000415301814
  error estimate for blocks of size 2^( 6) =       0.000419362517
  error estimate for blocks of size 2^( 7) =       0.000422485788

      target function =      -0.918225887935
              le_mean =     -17.209639730226
             les_mean =     296.457648479894
             stat err =       0.000416486875
             autocorr =       1.251912034596
   target nu stat err =       0.000416486875
   target dn stat err =       0.002296775049
      target stat err =       0.003049626066
              std dev =       0.526424821641
             le_variance =       0.277123092840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277185721714
                                         uncertainty =       0.001879146259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277185721714
                                         uncertainty =       0.001879146259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372232606
  error estimate for blocks of size 2^( 2) =       0.000386667394
  error estimate for blocks of size 2^( 3) =       0.000399617116
  error estimate for blocks of size 2^( 4) =       0.000408797380
  error estimate for blocks of size 2^( 5) =       0.000415301814
  error estimate for blocks of size 2^( 6) =       0.000419362517
  error estimate for blocks of size 2^( 7) =       0.000422485788

      target function =      -0.918225887983
              le_mean =     -17.209639730225
             les_mean =     296.457648479851
             stat err =       0.000416486875
             autocorr =       1.251912034566
   target nu stat err =       0.000416486875
   target dn stat err =       0.002296775038
      target stat err =       0.003049626051
              std dev =       0.526424821652
             le_variance =       0.277123092851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277185721709
                                         uncertainty =       0.001879146259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277185721709
                                         uncertainty =       0.001879146259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372232605
  error estimate for blocks of size 2^( 2) =       0.000386667394
  error estimate for blocks of size 2^( 3) =       0.000399617116
  error estimate for blocks of size 2^( 4) =       0.000408797380
  error estimate for blocks of size 2^( 5) =       0.000415301814
  error estimate for blocks of size 2^( 6) =       0.000419362517
  error estimate for blocks of size 2^( 7) =       0.000422485788

      target function =      -0.918225887959
              le_mean =     -17.209639730226
             les_mean =     296.457648479873
             stat err =       0.000416486875
             autocorr =       1.251912034578
   target nu stat err =       0.000416486875
   target dn stat err =       0.002296775043
      target stat err =       0.003049626058
              std dev =       0.526424821647
             le_variance =       0.277123092846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277185721704
                                         uncertainty =       0.001879146258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277185721704
                                         uncertainty =       0.001879146258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372232605
  error estimate for blocks of size 2^( 2) =       0.000386667394
  error estimate for blocks of size 2^( 3) =       0.000399617116
  error estimate for blocks of size 2^( 4) =       0.000408797380
  error estimate for blocks of size 2^( 5) =       0.000415301814
  error estimate for blocks of size 2^( 6) =       0.000419362517
  error estimate for blocks of size 2^( 7) =       0.000422485788

      target function =      -0.918225887938
              le_mean =     -17.209639730226
             les_mean =     296.457648479892
             stat err =       0.000416486875
             autocorr =       1.251912034592
   target nu stat err =       0.000416486875
   target dn stat err =       0.002296775048
      target stat err =       0.003049626065
              std dev =       0.526424821642
             le_variance =       0.277123092841


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918225887935        initial
     2.4414e+06     2.4414e+07             1.3132e-10        -0.918225887983  <--
     9.7656e+06     9.7656e+07             3.2830e-11        -0.918225887959
     3.9062e+07     3.9062e+08             8.2074e-12        -0.918225887938

*****************************************************************************
Applying the update for shift_i =   2.4414e+06     and shift_s =   2.4414e+07
*****************************************************************************

  Execution time = 3.9367e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7166e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2196
    reference variance = 0.219794
====================================================
  Execution time = 2.7142e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0453e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8717e-01
  Total weights = 1.966456616e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4509e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277550792279
                                         uncertainty =       0.001628972146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277550792279
                                         uncertainty =       0.001628972146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372499979
  error estimate for blocks of size 2^( 2) =       0.000386487330
  error estimate for blocks of size 2^( 3) =       0.000399099431
  error estimate for blocks of size 2^( 4) =       0.000408959255
  error estimate for blocks of size 2^( 5) =       0.000415111393
  error estimate for blocks of size 2^( 6) =       0.000418490148
  error estimate for blocks of size 2^( 7) =       0.000418806758

      target function =      -0.916771392131
              le_mean =     -17.210144883108
             les_mean =     296.476256969675
             stat err =       0.000415341888
             autocorr =       1.243251409870
   target nu stat err =       0.000415341888
   target dn stat err =       0.002266747170
      target stat err =       0.003003938049
              std dev =       0.526802951252
             le_variance =       0.277521349447


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721014488311e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916780433130       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916780433173       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916780433185       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916780433189       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916780432973       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916780433299       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916780433357       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916780431611       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916780434123       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916780433154       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916780432513       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916780431684       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916780432908       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916780432034       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916780432969       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916780433976       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916780431080       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916780434108       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916780432381       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916780432835       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916780432614       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916780423919       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916780433276       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916780434141       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916780435159       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916780433110       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916780433720       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916780432737       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916780431868       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916780432743       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916780433605       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916780434220       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916780433694       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916780431853       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916780434674       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916780434011       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916780433369       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916780432567       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916780432956       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916780432725       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.1035e+05 is 7.285863e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916780433130       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916780433141       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916780433143       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916780433144       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916780433146       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916780433356       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916780431504       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916780433160       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916780430247       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916780435547       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916780431849       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916780437169       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916780436502       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916780434754       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916780428433       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916780430350       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916780430290       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916780432229       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916780434794       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916780434299       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916780434534       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916780431872       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916780427528       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916780436043       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916780426663       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916780428374       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916780434307       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916780427980       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916780435835       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916780428993       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916780438630       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916780431078       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916780441504       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916780433294       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916780426871       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916780434220       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916780433502       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916780438454       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916780425263       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916780430364       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+06 is 1.821469e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916780433130       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916780433132       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916780433133       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916780433133       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916780433577       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916780450635       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916780452947       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916780425391       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916780428592       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916780436719       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916780428462       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916780442453       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916780426526       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916780449306       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916780445697       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916780414155       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916780433715       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916780435987       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916780417304       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916780438464       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916780433772       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916780438640       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916780413054       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916780445546       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916780453340       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916780430113       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916780450674       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916780441692       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916780445570       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916780433173       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916780432639       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916780432980       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916780440676       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916780437344       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916780438398       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916780463812       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916780428245       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916780456127       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916780412411       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916780397524       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+06 is 4.553690e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.339366 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5671e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1546
    reference variance = 0.145738
====================================================
  Execution time = 2.6885e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.9034e-01
  Total weights = 1.9659e+06
  Execution time = 2.3651e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278206355405
                                         uncertainty =       0.001658348594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278206355405
                                         uncertainty =       0.001658348594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372935508
  error estimate for blocks of size 2^( 2) =       0.000387011384
  error estimate for blocks of size 2^( 3) =       0.000399758561
  error estimate for blocks of size 2^( 4) =       0.000409454138
  error estimate for blocks of size 2^( 5) =       0.000414652762
  error estimate for blocks of size 2^( 6) =       0.000419061501
  error estimate for blocks of size 2^( 7) =       0.000421291098

      target function =      -0.912861809488
              le_mean =     -17.210890346079
             les_mean =     296.505082579798
             stat err =       0.000416114875
             autocorr =       1.244970357667
   target nu stat err =       0.000416114875
   target dn stat err =       0.002622690875
      target stat err =       0.003433857078
              std dev =       0.527418891413
             le_variance =       0.278170687019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278206355356
                                         uncertainty =       0.001658348592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278206355356
                                         uncertainty =       0.001658348592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372935508
  error estimate for blocks of size 2^( 2) =       0.000387011384
  error estimate for blocks of size 2^( 3) =       0.000399758561
  error estimate for blocks of size 2^( 4) =       0.000409454138
  error estimate for blocks of size 2^( 5) =       0.000414652762
  error estimate for blocks of size 2^( 6) =       0.000419061501
  error estimate for blocks of size 2^( 7) =       0.000421291098

      target function =      -0.912861809208
              le_mean =     -17.210890346075
             les_mean =     296.505082579868
             stat err =       0.000416114875
             autocorr =       1.244970357836
   target nu stat err =       0.000416114875
   target dn stat err =       0.002622690947
      target stat err =       0.003433857166
              std dev =       0.527418891366
             le_variance =       0.278170686970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278206355381
                                         uncertainty =       0.001658348593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278206355381
                                         uncertainty =       0.001658348593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372935508
  error estimate for blocks of size 2^( 2) =       0.000387011384
  error estimate for blocks of size 2^( 3) =       0.000399758561
  error estimate for blocks of size 2^( 4) =       0.000409454138
  error estimate for blocks of size 2^( 5) =       0.000414652762
  error estimate for blocks of size 2^( 6) =       0.000419061501
  error estimate for blocks of size 2^( 7) =       0.000421291098

      target function =      -0.912861809348
              le_mean =     -17.210890346077
             les_mean =     296.505082579833
             stat err =       0.000416114875
             autocorr =       1.244970357753
   target nu stat err =       0.000416114875
   target dn stat err =       0.002622690911
      target stat err =       0.003433857122
              std dev =       0.527418891389
             le_variance =       0.278170686994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278206355402
                                         uncertainty =       0.001658348594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278206355402
                                         uncertainty =       0.001658348594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372935508
  error estimate for blocks of size 2^( 2) =       0.000387011384
  error estimate for blocks of size 2^( 3) =       0.000399758561
  error estimate for blocks of size 2^( 4) =       0.000409454138
  error estimate for blocks of size 2^( 5) =       0.000414652762
  error estimate for blocks of size 2^( 6) =       0.000419061501
  error estimate for blocks of size 2^( 7) =       0.000421291098

      target function =      -0.912861809470
              le_mean =     -17.210890346079
             les_mean =     296.505082579803
             stat err =       0.000416114875
             autocorr =       1.244970357687
   target nu stat err =       0.000416114875
   target dn stat err =       0.002622690880
      target stat err =       0.003433857083
              std dev =       0.527418891409
             le_variance =       0.278170687015


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912861809488        initial  <--
     6.1035e+05     6.1035e+06             7.2859e-10        -0.912861809208
     2.4414e+06     2.4414e+07             1.8215e-10        -0.912861809348
     9.7656e+06     9.7656e+07             4.5537e-11        -0.912861809470

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.7804
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4458e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1556
    reference variance = 0.258461
====================================================
  Execution time = 2.7228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0485e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8759e-01
  Total weights = 1.966427886e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3087e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277859679014
                                         uncertainty =       0.002314614452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277859679014
                                         uncertainty =       0.002314614452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372707401
  error estimate for blocks of size 2^( 2) =       0.000386812094
  error estimate for blocks of size 2^( 3) =       0.000400019501
  error estimate for blocks of size 2^( 4) =       0.000409592274
  error estimate for blocks of size 2^( 5) =       0.000414393074
  error estimate for blocks of size 2^( 6) =       0.000416328919
  error estimate for blocks of size 2^( 7) =       0.000417266245

      target function =      -0.916109508037
              le_mean =     -17.209700459382
             les_mean =     296.461378211887
             stat err =       0.000414395128
             autocorr =       1.236212836775
   target nu stat err =       0.000414395128
   target dn stat err =       0.002496735502
      target stat err =       0.003290358706
              std dev =       0.527096294046
             le_variance =       0.277830503197


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720970045938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916120496087       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916120496094       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916120496094       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916120496095       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916120498103       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916120496462       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916120489105       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916120497658       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916120492577       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916120496997       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916120502634       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916120489986       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916120490321       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916120500717       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916120505051       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916120490483       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916120486122       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916120516529       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916120496726       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916120491975       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916120478046       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916120444071       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916120502104       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916120483714       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916120508817       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916120506617       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916120509352       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916120484739       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916120496568       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916120527381       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916120483814       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916120494744       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916120504446       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916120505260       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916120492074       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916120474942       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916120475424       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916120465498       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916120501388       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916120529345       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.916120472619       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.916120475018       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.916120494097       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.1035e+06 is 7.250383e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916120496087       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916120496088       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916120496089       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916120496089       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916120481883       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916120484816       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916120486202       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916120478402       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916120487088       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916120510735       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916120468285       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916120484012       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916120462540       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916120448078       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916120519524       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916120475912       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916120529319       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916120523780       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916120451824       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916120515752       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916120464459       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916120569583       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916120467269       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916120478116       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916120453212       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916120501341       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916120452807       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916120644244       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916120433174       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916120524124       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916120320596       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916120549257       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916120414523       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916120482241       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916120440947       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916120488020       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916120488249       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916120514998       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916120494820       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916120429293       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.916120520425       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.916120483844       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.916120609245       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+07 is 1.812578e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916120496087       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916120496087       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916120496087       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916120506454       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916120496100       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916120510546       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916120596963       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916120532290       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916120552003       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916120496087       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916120413005       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916120304389       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916120423698       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916120726349       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916120070044       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916120494508       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916120407991       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916120598018       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916120540747       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916120371804       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916120735398       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916120331245       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916120363653       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916120481601       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916120518223       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916120365342       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916120408726       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916120673000       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916120452056       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916120647883       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916120620180       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916120178147       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916120347032       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916120348045       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916120424326       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916120565785       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916120511549       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916120587207       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916120426112       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916120210072       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.916120482262       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.916120236582       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.916119961023       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+07 is 4.531937e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.427702 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5632e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2294
    reference variance = 0.391572
====================================================
  Execution time = 2.6977e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9351e-01
  Total weights = 1.9662e+06
  Execution time = 2.3679e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282890126639
                                         uncertainty =       0.002462028564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282890126639
                                         uncertainty =       0.002462028564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376051743
  error estimate for blocks of size 2^( 2) =       0.000390236903
  error estimate for blocks of size 2^( 3) =       0.000403660653
  error estimate for blocks of size 2^( 4) =       0.000413097883
  error estimate for blocks of size 2^( 5) =       0.000418929706
  error estimate for blocks of size 2^( 6) =       0.000422205578
  error estimate for blocks of size 2^( 7) =       0.000423592999

      target function =      -0.908612636784
              le_mean =     -17.210235665393
             les_mean =     296.485723204619
             stat err =       0.000419456542
             autocorr =       1.244167152278
   target nu stat err =       0.000419456542
   target dn stat err =       0.003569748133
      target stat err =       0.004595410867
              std dev =       0.531825984624
             le_variance =       0.282838877922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282890126638
                                         uncertainty =       0.002462028563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282890126638
                                         uncertainty =       0.002462028563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376051743
  error estimate for blocks of size 2^( 2) =       0.000390236903
  error estimate for blocks of size 2^( 3) =       0.000403660653
  error estimate for blocks of size 2^( 4) =       0.000413097883
  error estimate for blocks of size 2^( 5) =       0.000418929706
  error estimate for blocks of size 2^( 6) =       0.000422205578
  error estimate for blocks of size 2^( 7) =       0.000423592999

      target function =      -0.908612636795
              le_mean =     -17.210235665393
             les_mean =     296.485723204604
             stat err =       0.000419456542
             autocorr =       1.244167152276
   target nu stat err =       0.000419456542
   target dn stat err =       0.003569748130
      target stat err =       0.004595410863
              std dev =       0.531825984624
             le_variance =       0.282838877921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282890126639
                                         uncertainty =       0.002462028563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282890126639
                                         uncertainty =       0.002462028563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376051743
  error estimate for blocks of size 2^( 2) =       0.000390236903
  error estimate for blocks of size 2^( 3) =       0.000403660653
  error estimate for blocks of size 2^( 4) =       0.000413097883
  error estimate for blocks of size 2^( 5) =       0.000418929706
  error estimate for blocks of size 2^( 6) =       0.000422205578
  error estimate for blocks of size 2^( 7) =       0.000423592999

      target function =      -0.908612636789
              le_mean =     -17.210235665393
             les_mean =     296.485723204611
             stat err =       0.000419456542
             autocorr =       1.244167152264
   target nu stat err =       0.000419456542
   target dn stat err =       0.003569748132
      target stat err =       0.004595410865
              std dev =       0.531825984624
             le_variance =       0.282838877921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282890126639
                                         uncertainty =       0.002462028564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282890126639
                                         uncertainty =       0.002462028564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376051743
  error estimate for blocks of size 2^( 2) =       0.000390236903
  error estimate for blocks of size 2^( 3) =       0.000403660653
  error estimate for blocks of size 2^( 4) =       0.000413097883
  error estimate for blocks of size 2^( 5) =       0.000418929706
  error estimate for blocks of size 2^( 6) =       0.000422205578
  error estimate for blocks of size 2^( 7) =       0.000423592999

      target function =      -0.908612636785
              le_mean =     -17.210235665393
             les_mean =     296.485723204618
             stat err =       0.000419456542
             autocorr =       1.244167152269
   target nu stat err =       0.000419456542
   target dn stat err =       0.003569748133
      target stat err =       0.004595410866
              std dev =       0.531825984625
             le_variance =       0.282838877922


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908612636784        initial
     6.1035e+06     6.1035e+07             7.2504e-11        -0.908612636795  <--
     2.4414e+07     2.4414e+08             1.8126e-11        -0.908612636789
     9.7656e+07     9.7656e+08             4.5319e-12        -0.908612636785

*****************************************************************************
Applying the update for shift_i =   6.1035e+06     and shift_s =   6.1035e+07
*****************************************************************************

  Execution time = 3.8871e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4510e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7195e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.165
    reference variance = 0.208844
====================================================
  Execution time = 2.7701e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0480e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8306e-01
  Total weights = 1.966468816e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1784e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275233410608
                                         uncertainty =       0.001454206166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275233410608
                                         uncertainty =       0.001454206166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370992420
  error estimate for blocks of size 2^( 2) =       0.000385325705
  error estimate for blocks of size 2^( 3) =       0.000398294229
  error estimate for blocks of size 2^( 4) =       0.000407825242
  error estimate for blocks of size 2^( 5) =       0.000413105379
  error estimate for blocks of size 2^( 6) =       0.000417097372
  error estimate for blocks of size 2^( 7) =       0.000421301104

      target function =      -0.921970413175
              le_mean =     -17.209508434255
             les_mean =     296.450240902663
             stat err =       0.000414832274
             autocorr =       1.250302219409
   target nu stat err =       0.000414832274
   target dn stat err =       0.001957285820
      target stat err =       0.002636952654
              std dev =       0.524670906305
             le_variance =       0.275279559923


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720950843426e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921977131082       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921977131095       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921977131098       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921977130472       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921977130959       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921977130252       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921977131423       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921977132047       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921977129400       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921977130178       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921977130843       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921977129778       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921977128293       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921977131596       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921977129532       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921977130283       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921977133315       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921977129292       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921977130830       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921977131684       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921977131498       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921977131078       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921977132872       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921977131796       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921977128242       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921977139812       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921977125308       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921977131290       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921977131957       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921977132196       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921977129723       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921977134947       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.921977130095       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921977133942       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921977132571       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921977128997       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.921977128585       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921977131745       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.921977131261       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.921977122387       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5259e+06 is 2.343973e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921977131082       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921977131085       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921977131086       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921977131086       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921977131086       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921977129307       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921977131086       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921977116854       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921977131882       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921977139777       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921977132435       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921977127695       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921977137061       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921977130570       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921977129566       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921977130782       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921977133035       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921977146324       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921977124963       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921977132087       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921977159863       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921977155072       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921977146950       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921977131925       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921977123564       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921977141404       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921977148708       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921977123443       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921977134401       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921977158595       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921977130616       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921977156410       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.921977118776       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921977142807       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921977109322       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921977117043       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.921977170280       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921977116571       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.921977089825       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.921977153084       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.1035e+06 is 5.860088e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921977131082       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921977131083       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921977131083       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921977131083       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921977131083       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921977131083       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921977133855       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921977116209       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921977122549       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921977131083       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921977209971       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921977127351       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921977133582       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921977127002       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921977140718       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921977166323       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921977118559       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921977129209       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921977164582       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921977125642       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921977159905       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921977069802       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921977217970       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921977032218       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921977067818       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921977091211       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921977131890       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921977067814       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921977168774       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921977141453       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921977123739       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921977157000       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.921977150103       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921977157679       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921977160935       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921977078404       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.921977213552       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921977111592       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.921977121900       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.921977059939       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+07 is 1.464930e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.498643 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5957e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1626
    reference variance = 0.277734
====================================================
  Execution time = 2.7175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8741e-01
  Total weights = 1.9663e+06
  Execution time = 2.3770e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278313534893
                                         uncertainty =       0.002135872767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278313534893
                                         uncertainty =       0.002135872767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373026023
  error estimate for blocks of size 2^( 2) =       0.000387366897
  error estimate for blocks of size 2^( 3) =       0.000400160340
  error estimate for blocks of size 2^( 4) =       0.000410290201
  error estimate for blocks of size 2^( 5) =       0.000415481344
  error estimate for blocks of size 2^( 6) =       0.000419109002
  error estimate for blocks of size 2^( 7) =       0.000421319100

      target function =      -0.916484372923
              le_mean =     -17.210233047545
             les_mean =     296.479527008758
             stat err =       0.000416549912
             autocorr =       1.246969507891
   target nu stat err =       0.000416549912
   target dn stat err =       0.002734177887
      target stat err =       0.003600123766
              std dev =       0.527546901018
             le_variance =       0.278305732773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278313534891
                                         uncertainty =       0.002135872774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278313534891
                                         uncertainty =       0.002135872774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373026023
  error estimate for blocks of size 2^( 2) =       0.000387366897
  error estimate for blocks of size 2^( 3) =       0.000400160340
  error estimate for blocks of size 2^( 4) =       0.000410290201
  error estimate for blocks of size 2^( 5) =       0.000415481344
  error estimate for blocks of size 2^( 6) =       0.000419109002
  error estimate for blocks of size 2^( 7) =       0.000421319100

      target function =      -0.916484372803
              le_mean =     -17.210233047547
             les_mean =     296.479527008907
             stat err =       0.000416549912
             autocorr =       1.246969507815
   target nu stat err =       0.000416549912
   target dn stat err =       0.002734177894
      target stat err =       0.003600123774
              std dev =       0.527546901016
             le_variance =       0.278305732772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278313534892
                                         uncertainty =       0.002135872770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278313534892
                                         uncertainty =       0.002135872770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373026023
  error estimate for blocks of size 2^( 2) =       0.000387366897
  error estimate for blocks of size 2^( 3) =       0.000400160340
  error estimate for blocks of size 2^( 4) =       0.000410290201
  error estimate for blocks of size 2^( 5) =       0.000415481344
  error estimate for blocks of size 2^( 6) =       0.000419109002
  error estimate for blocks of size 2^( 7) =       0.000421319100

      target function =      -0.916484372863
              le_mean =     -17.210233047546
             les_mean =     296.479527008833
             stat err =       0.000416549912
             autocorr =       1.246969507850
   target nu stat err =       0.000416549912
   target dn stat err =       0.002734177891
      target stat err =       0.003600123770
              std dev =       0.527546901017
             le_variance =       0.278305732773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278313534893
                                         uncertainty =       0.002135872767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278313534893
                                         uncertainty =       0.002135872767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373026023
  error estimate for blocks of size 2^( 2) =       0.000387366897
  error estimate for blocks of size 2^( 3) =       0.000400160340
  error estimate for blocks of size 2^( 4) =       0.000410290201
  error estimate for blocks of size 2^( 5) =       0.000415481344
  error estimate for blocks of size 2^( 6) =       0.000419109002
  error estimate for blocks of size 2^( 7) =       0.000421319100

      target function =      -0.916484372916
              le_mean =     -17.210233047545
             les_mean =     296.479527008767
             stat err =       0.000416549912
             autocorr =       1.246969507878
   target nu stat err =       0.000416549912
   target dn stat err =       0.002734177887
      target stat err =       0.003600123766
              std dev =       0.527546901018
             le_variance =       0.278305732773


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916484372923        initial  <--
     1.5259e+06     1.5259e+07             2.3440e-10        -0.916484372803
     6.1035e+06     6.1035e+07             5.8601e-11        -0.916484372863
     2.4414e+07     2.4414e+08             1.4649e-11        -0.916484372916

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1164
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5080e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7195e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1843
    reference variance = 0.182665
====================================================
  Execution time = 2.7177e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0494e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8759e-01
  Total weights = 1.966478145e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7367e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277107741075
                                         uncertainty =       0.001821962210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277107741075
                                         uncertainty =       0.001821962210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372255478
  error estimate for blocks of size 2^( 2) =       0.000386342375
  error estimate for blocks of size 2^( 3) =       0.000399604793
  error estimate for blocks of size 2^( 4) =       0.000408354189
  error estimate for blocks of size 2^( 5) =       0.000414744864
  error estimate for blocks of size 2^( 6) =       0.000417722879
  error estimate for blocks of size 2^( 7) =       0.000418363439

      target function =      -0.916222932470
              le_mean =     -17.210122992504
             les_mean =     296.475919114184
             stat err =       0.000414796343
             autocorr =       1.241616977990
   target nu stat err =       0.000414796343
   target dn stat err =       0.002593818047
      target stat err =       0.003417473387
              std dev =       0.526457168697
             le_variance =       0.277157150472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721012299250e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916234889958       residual = 3.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916234889959       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916234889959       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916234889959       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916234889959       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916234889959       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916234889959       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916234889959       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916234894235       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916234909351       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916234889959       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916234849813       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916234881927       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916234900739       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916234913927       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916234848001       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916234914235       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916234906862       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916234866788       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916234898761       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916234896085       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916234857957       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916234888009       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916234898811       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916234793750       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916234843038       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916234914660       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916234841958       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916234887534       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916234874270       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916234818750       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916234834322       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916234973963       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916234810065       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916234874707       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916234868833       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916234876228       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916234861582       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916234884208       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916234899214       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5259e+07 is 2.735023e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916234889958       residual = 3.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916234889958       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916234889958       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916234889958       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916234889958       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916234889958       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916234889958       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916234889958       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916234810619       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916234914767       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916234992853       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916234951970       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916234936460       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916234981827       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916234889958       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916235041772       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916234739667       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916234872072       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916234767289       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916234816212       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916235082126       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916234763822       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916235041822       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916235209011       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916234810369       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916234875570       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916235034726       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916234970252       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916234554495       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916234910655       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916234786120       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916235091829       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916235038318       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916234877685       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916234908882       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916234941151       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916234709835       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916234835870       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916234946136       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916234801194       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.1035e+07 is 6.837153e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916234889958       residual = 3.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916234889958       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916234889958       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916234889958       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916234889958       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916234889958       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916235310735       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916234266786       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916234889958       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916234297092       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916234889958       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916234889958       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916234935833       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916235081515       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916234770770       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916234889958       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916235216164       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916234490955       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916234477882       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916234145680       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916233555455       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916234477539       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916232750666       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916233772438       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916234009240       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916234378581       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916235782401       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916236122072       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916236449556       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916233754546       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916235139923       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916234780055       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916234872341       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916234458643       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916235422202       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916234929713       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916234803656       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916233983351       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916234695893       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916234715086       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+08 is 1.709004e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.568916 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6526e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1938
    reference variance = 0.211021
====================================================
  Execution time = 2.7051e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8714e-01
  Total weights = 1.9662e+06
  Execution time = 2.3732e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277003036641
                                         uncertainty =       0.001328951671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277003036641
                                         uncertainty =       0.001328951671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372123993
  error estimate for blocks of size 2^( 2) =       0.000386346192
  error estimate for blocks of size 2^( 3) =       0.000398969751
  error estimate for blocks of size 2^( 4) =       0.000408555970
  error estimate for blocks of size 2^( 5) =       0.000413914894
  error estimate for blocks of size 2^( 6) =       0.000416737077
  error estimate for blocks of size 2^( 7) =       0.000419612875

      target function =      -0.916659900046
              le_mean =     -17.209585873624
             les_mean =     296.456989351896
             stat err =       0.000414705204
             autocorr =       1.241948608787
   target nu stat err =       0.000414705204
   target dn stat err =       0.002090096854
      target stat err =       0.002775938683
              std dev =       0.526271218163
             le_variance =       0.276961395067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277003036640
                                         uncertainty =       0.001328951671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277003036640
                                         uncertainty =       0.001328951671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372123993
  error estimate for blocks of size 2^( 2) =       0.000386346192
  error estimate for blocks of size 2^( 3) =       0.000398969751
  error estimate for blocks of size 2^( 4) =       0.000408555970
  error estimate for blocks of size 2^( 5) =       0.000413914894
  error estimate for blocks of size 2^( 6) =       0.000416737077
  error estimate for blocks of size 2^( 7) =       0.000419612875

      target function =      -0.916659900042
              le_mean =     -17.209585873624
             les_mean =     296.456989351897
             stat err =       0.000414705204
             autocorr =       1.241948608780
   target nu stat err =       0.000414705204
   target dn stat err =       0.002090096855
      target stat err =       0.002775938685
              std dev =       0.526271218162
             le_variance =       0.276961395066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277003036641
                                         uncertainty =       0.001328951671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277003036641
                                         uncertainty =       0.001328951671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372123993
  error estimate for blocks of size 2^( 2) =       0.000386346192
  error estimate for blocks of size 2^( 3) =       0.000398969751
  error estimate for blocks of size 2^( 4) =       0.000408555970
  error estimate for blocks of size 2^( 5) =       0.000413914894
  error estimate for blocks of size 2^( 6) =       0.000416737077
  error estimate for blocks of size 2^( 7) =       0.000419612875

      target function =      -0.916659900044
              le_mean =     -17.209585873624
             les_mean =     296.456989351896
             stat err =       0.000414705204
             autocorr =       1.241948608790
   target nu stat err =       0.000414705204
   target dn stat err =       0.002090096854
      target stat err =       0.002775938684
              std dev =       0.526271218162
             le_variance =       0.276961395066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277003036641
                                         uncertainty =       0.001328951671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277003036641
                                         uncertainty =       0.001328951671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372123993
  error estimate for blocks of size 2^( 2) =       0.000386346192
  error estimate for blocks of size 2^( 3) =       0.000398969751
  error estimate for blocks of size 2^( 4) =       0.000408555970
  error estimate for blocks of size 2^( 5) =       0.000413914894
  error estimate for blocks of size 2^( 6) =       0.000416737077
  error estimate for blocks of size 2^( 7) =       0.000419612875

      target function =      -0.916659900045
              le_mean =     -17.209585873624
             les_mean =     296.456989351896
             stat err =       0.000414705204
             autocorr =       1.241948608789
   target nu stat err =       0.000414705204
   target dn stat err =       0.002090096854
      target stat err =       0.002775938684
              std dev =       0.526271218163
             le_variance =       0.276961395067


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916659900046        initial  <--
     1.5259e+07     1.5259e+08             2.7350e-11        -0.916659900042
     6.1035e+07     6.1035e+08             6.8372e-12        -0.916659900044
     2.4414e+08     2.4414e+09             1.7090e-12        -0.916659900045

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0014
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5534e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7194e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2013
    reference variance = 0.34747
====================================================
  Execution time = 2.7112e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0485e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8855e-01
  Total weights = 1.966245577e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1430e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277058745656
                                         uncertainty =       0.001510893622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277058745656
                                         uncertainty =       0.001510893622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372176498
  error estimate for blocks of size 2^( 2) =       0.000386483741
  error estimate for blocks of size 2^( 3) =       0.000399693772
  error estimate for blocks of size 2^( 4) =       0.000409180878
  error estimate for blocks of size 2^( 5) =       0.000415422060
  error estimate for blocks of size 2^( 6) =       0.000419125851
  error estimate for blocks of size 2^( 7) =       0.000421341086

      target function =      -0.914883918986
              le_mean =     -17.209767507500
             les_mean =     296.464645721618
             stat err =       0.000416267469
             autocorr =       1.250970459281
   target nu stat err =       0.000416267469
   target dn stat err =       0.002510162457
      target stat err =       0.003299601521
              std dev =       0.526345472513
             le_variance =       0.277039556435


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720976750750e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914895066596       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914895066596       residual = 8.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914895066596       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914895077023       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914895066811       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914895115277       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914894912044       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914894968773       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914894683191       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914895109788       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914894888894       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914895015497       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914895140851       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914894853896       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914895024918       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914894977115       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914895582314       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914895206142       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914894902892       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914894952956       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914895059020       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914894721242       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914895268730       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914895280451       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914894883219       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914894936594       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914895467990       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914894652917       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914895101904       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914895547755       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914895037508       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914894605485       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914895014298       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914894397861       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914895033992       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914894568677       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914895494428       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914894467481       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914895627098       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914894602412       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914895705412       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5259e+08 is 2.646408e-12

solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914895066596       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914895066596       residual = 8.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914895066596       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914895066596       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914895066466       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914895066580       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914895086119       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914894549285       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914894078623       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914895340727       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914895036344       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914894630365       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914895386147       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914896924208       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914895053671       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914894642048       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914896885204       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914895883085       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914895728780       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914894546690       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914894403646       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914893715590       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914895068633       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914893188284       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914895527707       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914896293379       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914892523075       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914895745171       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914896149631       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914896530488       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914894073003       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914896375472       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914893484012       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914894115258       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914892824391       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914892570039       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914894246595       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914897966190       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914896707610       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914895896952       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914893806166       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.1035e+08 is 6.611716e-13

solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914895066596       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914895066596       residual = 8.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914895066596       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914894517246       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914895194247       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914895066596       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914897932220       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914895131869       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914891414652       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914900020663       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914897085576       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914892162244       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914902998565       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914900101767       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914892248701       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914894262432       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914892101744       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914895671976       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914892901257       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914891494658       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914901265947       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914894960654       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914898640369       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914893172294       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914902072874       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914899829668       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914893410125       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914890960541       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914895995917       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914896459422       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914888621710       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914887687996       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914885443683       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914889169512       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914896978578       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914895406129       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914889640237       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914891835075       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914889722653       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914901070751       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914896433127       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+09 is 1.662295e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.643721 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5337e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.157
    reference variance = 0.205917
====================================================
  Execution time = 2.7048e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8627e-01
  Total weights = 1.9662e+06
  Execution time = 2.3656e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275165287548
                                         uncertainty =       0.001551420078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275165287548
                                         uncertainty =       0.001551420078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370927679
  error estimate for blocks of size 2^( 2) =       0.000385020606
  error estimate for blocks of size 2^( 3) =       0.000398407773
  error estimate for blocks of size 2^( 4) =       0.000408199454
  error estimate for blocks of size 2^( 5) =       0.000414190973
  error estimate for blocks of size 2^( 6) =       0.000418446564
  error estimate for blocks of size 2^( 7) =       0.000422642385

      target function =      -0.917957150459
              le_mean =     -17.210200144049
             les_mean =     296.477255647187
             stat err =       0.000415869844
             autocorr =       1.257003173687
   target nu stat err =       0.000415869844
   target dn stat err =       0.002739320571
      target stat err =       0.003617817547
              std dev =       0.524579347923
             le_variance =       0.275183492267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275165287548
                                         uncertainty =       0.001551420078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275165287548
                                         uncertainty =       0.001551420078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370927679
  error estimate for blocks of size 2^( 2) =       0.000385020606
  error estimate for blocks of size 2^( 3) =       0.000398407773
  error estimate for blocks of size 2^( 4) =       0.000408199454
  error estimate for blocks of size 2^( 5) =       0.000414190973
  error estimate for blocks of size 2^( 6) =       0.000418446564
  error estimate for blocks of size 2^( 7) =       0.000422642385

      target function =      -0.917957150460
              le_mean =     -17.210200144049
             les_mean =     296.477255647187
             stat err =       0.000415869844
             autocorr =       1.257003173684
   target nu stat err =       0.000415869844
   target dn stat err =       0.002739320571
      target stat err =       0.003617817547
              std dev =       0.524579347923
             le_variance =       0.275183492267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275165287548
                                         uncertainty =       0.001551420078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275165287548
                                         uncertainty =       0.001551420078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370927679
  error estimate for blocks of size 2^( 2) =       0.000385020606
  error estimate for blocks of size 2^( 3) =       0.000398407773
  error estimate for blocks of size 2^( 4) =       0.000408199454
  error estimate for blocks of size 2^( 5) =       0.000414190973
  error estimate for blocks of size 2^( 6) =       0.000418446564
  error estimate for blocks of size 2^( 7) =       0.000422642385

      target function =      -0.917957150459
              le_mean =     -17.210200144049
             les_mean =     296.477255647187
             stat err =       0.000415869844
             autocorr =       1.257003173674
   target nu stat err =       0.000415869844
   target dn stat err =       0.002739320571
      target stat err =       0.003617817547
              std dev =       0.524579347923
             le_variance =       0.275183492267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275165287548
                                         uncertainty =       0.001551420078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275165287548
                                         uncertainty =       0.001551420078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370927679
  error estimate for blocks of size 2^( 2) =       0.000385020606
  error estimate for blocks of size 2^( 3) =       0.000398407773
  error estimate for blocks of size 2^( 4) =       0.000408199454
  error estimate for blocks of size 2^( 5) =       0.000414190973
  error estimate for blocks of size 2^( 6) =       0.000418446564
  error estimate for blocks of size 2^( 7) =       0.000422642385

      target function =      -0.917957150459
              le_mean =     -17.210200144049
             les_mean =     296.477255647187
             stat err =       0.000415869844
             autocorr =       1.257003173672
   target nu stat err =       0.000415869844
   target dn stat err =       0.002739320571
      target stat err =       0.003617817547
              std dev =       0.524579347923
             le_variance =       0.275183492267


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917957150459        initial
     1.5259e+08     1.5259e+09             2.6464e-12        -0.917957150460  <--
     6.1035e+08     6.1035e+09             6.6117e-13        -0.917957150459
     2.4414e+09     2.4414e+10             1.6623e-13        -0.917957150459

*****************************************************************************
Applying the update for shift_i =   1.5259e+08     and shift_s =   1.5259e+09
*****************************************************************************

  Execution time = 3.8964e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4308e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7194e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2472
    reference variance = 0.380459
====================================================
  Execution time = 2.7350e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0465e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9068e-01
  Total weights = 1.966424396e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3204e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280257300498
                                         uncertainty =       0.001673386667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280257300498
                                         uncertainty =       0.001673386667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374280881
  error estimate for blocks of size 2^( 2) =       0.000388468042
  error estimate for blocks of size 2^( 3) =       0.000401752838
  error estimate for blocks of size 2^( 4) =       0.000411060875
  error estimate for blocks of size 2^( 5) =       0.000416664936
  error estimate for blocks of size 2^( 6) =       0.000419256143
  error estimate for blocks of size 2^( 7) =       0.000421977981

      target function =      -0.912236469462
              le_mean =     -17.210162690175
             les_mean =     296.480375012834
             stat err =       0.000417239983
             autocorr =       1.242729344460
   target nu stat err =       0.000417239983
   target dn stat err =       0.003001025953
      target stat err =       0.003906127045
              std dev =       0.529321566677
             le_variance =       0.280181320950


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721016269017e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912252462074       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912252462074       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912252462074       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912252462074       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912252462074       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912252462074       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912252462075       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912252462075       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912252462075       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912252462075       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912252462075       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912252402179       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912252462075       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912252365454       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912252462075       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912252447929       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912252462075       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912252294074       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912252382165       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912252453468       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912252563297       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912252535279       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912252389859       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912252393159       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912252535389       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912252495600       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912252399929       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912252344524       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912252375906       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912252202869       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912252449502       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912252443780       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912252455893       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912252406036       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912252405086       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912252424773       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912252527248       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912252412951       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912252473204       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912252538446       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.8147e+07 is 1.115065e-11

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912252462074       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912252462074       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912252462074       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912252472669       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912252462074       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912252462074       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912252462074       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912252462074       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912252462074       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912252462074       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912252901378       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912252462074       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912252291976       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912252462074       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912252462074       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912252462074       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912252462074       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912252462074       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912252462074       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912252544363       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912252364090       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912252286156       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912252239918       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912252375458       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912252349414       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912252861438       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912252629898       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912252207387       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912252156506       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912251583764       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912251910426       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912252603121       residual = 9.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912252432633       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912252340093       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912252299683       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912252557635       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912252381202       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912252819833       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912252249370       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912252516273       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5259e+08 is 2.787583e-12

solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912252462074       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912252462074       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912252462074       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912252462074       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912252062665       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912252462074       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912252462074       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912252462074       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912252462074       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912252462074       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912251470625       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912252462074       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912252462074       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912252462074       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912252462074       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912252462074       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912250316449       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912252287977       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912251558871       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912252462074       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912247724687       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912246055944       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912252981462       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912249982507       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912253015458       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912251578145       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912253251177       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912251522667       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912251189067       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912252911951       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912252523987       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912251615086       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912254281289       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912252907823       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912251355506       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912253936361       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912250124916       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912249852387       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912250838784       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912249949746       residual = 8.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.1035e+08 is 6.971508e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.713389 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5747e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.224
    reference variance = 0.703562
====================================================
  Execution time = 2.7232e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8967e-01
  Total weights = 1.9666e+06
  Execution time = 2.3698e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279799162173
                                         uncertainty =       0.001760191315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279799162173
                                         uncertainty =       0.001760191315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374031091
  error estimate for blocks of size 2^( 2) =       0.000388133147
  error estimate for blocks of size 2^( 3) =       0.000401183083
  error estimate for blocks of size 2^( 4) =       0.000410930285
  error estimate for blocks of size 2^( 5) =       0.000416538465
  error estimate for blocks of size 2^( 6) =       0.000418708540
  error estimate for blocks of size 2^( 7) =       0.000420246095

      target function =      -0.913652782432
              le_mean =     -17.210606710973
             les_mean =     296.494650212633
             stat err =       0.000416605846
             autocorr =       1.240610099862
   target nu stat err =       0.000416605846
   target dn stat err =       0.002703818506
      target stat err =       0.003541617459
              std dev =       0.528968304752
             le_variance =       0.279807467432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279799162172
                                         uncertainty =       0.001760191315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279799162172
                                         uncertainty =       0.001760191315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374031091
  error estimate for blocks of size 2^( 2) =       0.000388133147
  error estimate for blocks of size 2^( 3) =       0.000401183083
  error estimate for blocks of size 2^( 4) =       0.000410930285
  error estimate for blocks of size 2^( 5) =       0.000416538465
  error estimate for blocks of size 2^( 6) =       0.000418708540
  error estimate for blocks of size 2^( 7) =       0.000420246095

      target function =      -0.913652782433
              le_mean =     -17.210606710973
             les_mean =     296.494650212632
             stat err =       0.000416605846
             autocorr =       1.240610099867
   target nu stat err =       0.000416605846
   target dn stat err =       0.002703818506
      target stat err =       0.003541617459
              std dev =       0.528968304751
             le_variance =       0.279807467431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279799162173
                                         uncertainty =       0.001760191315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279799162173
                                         uncertainty =       0.001760191315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374031091
  error estimate for blocks of size 2^( 2) =       0.000388133147
  error estimate for blocks of size 2^( 3) =       0.000401183083
  error estimate for blocks of size 2^( 4) =       0.000410930285
  error estimate for blocks of size 2^( 5) =       0.000416538465
  error estimate for blocks of size 2^( 6) =       0.000418708540
  error estimate for blocks of size 2^( 7) =       0.000420246095

      target function =      -0.913652782433
              le_mean =     -17.210606710973
             les_mean =     296.494650212633
             stat err =       0.000416605846
             autocorr =       1.240610099872
   target nu stat err =       0.000416605846
   target dn stat err =       0.002703818506
      target stat err =       0.003541617459
              std dev =       0.528968304751
             le_variance =       0.279807467431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279799162173
                                         uncertainty =       0.001760191315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279799162173
                                         uncertainty =       0.001760191315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374031091
  error estimate for blocks of size 2^( 2) =       0.000388133147
  error estimate for blocks of size 2^( 3) =       0.000401183083
  error estimate for blocks of size 2^( 4) =       0.000410930285
  error estimate for blocks of size 2^( 5) =       0.000416538465
  error estimate for blocks of size 2^( 6) =       0.000418708540
  error estimate for blocks of size 2^( 7) =       0.000420246095

      target function =      -0.913652782432
              le_mean =     -17.210606710973
             les_mean =     296.494650212633
             stat err =       0.000416605846
             autocorr =       1.240610099867
   target nu stat err =       0.000416605846
   target dn stat err =       0.002703818506
      target stat err =       0.003541617459
              std dev =       0.528968304752
             le_variance =       0.279807467432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913652782432        initial
     3.8147e+07     3.8147e+08             1.1151e-11        -0.913652782433  <--
     1.5259e+08     1.5259e+09             2.7876e-12        -0.913652782433
     6.1035e+08     6.1035e+09             6.9715e-13        -0.913652782432

*****************************************************************************
Applying the update for shift_i =   3.8147e+07     and shift_s =   3.8147e+08
*****************************************************************************

  Execution time = 3.9182e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4936e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7195e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2862
    reference variance = 0.301773
====================================================
  Execution time = 2.7284e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0489e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9053e-01
  Total weights = 1.966358549e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4699e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278295509582
                                         uncertainty =       0.001976193298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278295509582
                                         uncertainty =       0.001976193298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372972633
  error estimate for blocks of size 2^( 2) =       0.000386714433
  error estimate for blocks of size 2^( 3) =       0.000399619477
  error estimate for blocks of size 2^( 4) =       0.000408802959
  error estimate for blocks of size 2^( 5) =       0.000414593006
  error estimate for blocks of size 2^( 6) =       0.000416518273
  error estimate for blocks of size 2^( 7) =       0.000418099011

      target function =      -0.912369622599
              le_mean =     -17.209968587824
             les_mean =     296.473548598791
             stat err =       0.000414503312
             autocorr =       1.235099875180
   target nu stat err =       0.000414503312
   target dn stat err =       0.003400867094
      target stat err =       0.004414887245
              std dev =       0.527471395114
             le_variance =       0.278226072664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720996858782e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912390190511       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912390190513       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912390190513       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912390190513       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912390190513       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912390206886       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912390190513       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912390190513       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912390206811       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912390210780       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912390189951       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912390190513       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912390190513       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912390190513       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912390190513       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912390171416       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912390185492       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912390212541       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912390181993       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912390181360       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912390150352       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912390195540       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912390220244       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912390218321       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912390169478       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912390176539       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912390147627       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912390244932       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912390172005       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912390176739       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912390210820       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912390173243       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912390206450       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912390248286       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912390191329       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912390188244       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912390261531       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912390235498       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912390181426       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912390183786       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.912390178497       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.912390155539       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912390183321       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+06 is 4.168993e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912390190511       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912390190511       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912390190511       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912390190511       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912390190511       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912390190511       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912390203772       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912390144482       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912390190511       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912390190511       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912390150003       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912390247122       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912390210956       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912390101789       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912390176888       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912390187733       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912390154261       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912390028334       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912390185209       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912390139137       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912390162960       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912390253307       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912390153140       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912390221442       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912390156486       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912390251274       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912390216380       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912390232590       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912390148260       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912390098458       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912390259544       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912390207959       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912390184077       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912390335102       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912390172540       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912390309179       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912390269002       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912390163015       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912390365993       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912390244182       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.912390068700       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.912390154599       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912390064867       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.8147e+07 is 1.042250e-11

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912390190511       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912390190511       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912390190511       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912390216979       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912390224416       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912390072941       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912390405989       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912390422446       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912390322824       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912390094285       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912390187013       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912389890054       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912390089626       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912390320407       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912390081613       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912390395076       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912389821745       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912390399367       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912390199529       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912388922458       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912389169005       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912390370441       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912389785619       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912390751657       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912389838549       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912389765911       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912390289549       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912389837801       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912390804561       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912389596828       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912390283702       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912389725169       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912390322430       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912390039094       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912390574970       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912389381536       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912389849188       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912389989231       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912390336851       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912390464535       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.912390305323       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.912390761596       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912390045241       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5259e+08 is 2.605824e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.798224 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5846e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.1514
    reference variance = 0.209681
====================================================
  Execution time = 2.7450e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8787e-01
  Total weights = 1.9661e+06
  Execution time = 2.3627e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278804178555
                                         uncertainty =       0.001619428122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278804178555
                                         uncertainty =       0.001619428122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373358786
  error estimate for blocks of size 2^( 2) =       0.000387452778
  error estimate for blocks of size 2^( 3) =       0.000400298122
  error estimate for blocks of size 2^( 4) =       0.000408817712
  error estimate for blocks of size 2^( 5) =       0.000414296977
  error estimate for blocks of size 2^( 6) =       0.000418723698
  error estimate for blocks of size 2^( 7) =       0.000419338802

      target function =      -0.915774017430
              le_mean =     -17.209780577607
             les_mean =     296.464413592369
             stat err =       0.000415294297
             autocorr =       1.237254901693
   target nu stat err =       0.000415294297
   target dn stat err =       0.002068734739
      target stat err =       0.002744656985
              std dev =       0.528017507232
             le_variance =       0.278802487943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278804178553
                                         uncertainty =       0.001619428122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278804178553
                                         uncertainty =       0.001619428122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373358786
  error estimate for blocks of size 2^( 2) =       0.000387452778
  error estimate for blocks of size 2^( 3) =       0.000400298122
  error estimate for blocks of size 2^( 4) =       0.000408817712
  error estimate for blocks of size 2^( 5) =       0.000414296977
  error estimate for blocks of size 2^( 6) =       0.000418723698
  error estimate for blocks of size 2^( 7) =       0.000419338802

      target function =      -0.915774017467
              le_mean =     -17.209780577607
             les_mean =     296.464413592345
             stat err =       0.000415294297
             autocorr =       1.237254901708
   target nu stat err =       0.000415294297
   target dn stat err =       0.002068734739
      target stat err =       0.002744656986
              std dev =       0.528017507231
             le_variance =       0.278802487942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278804178554
                                         uncertainty =       0.001619428122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278804178554
                                         uncertainty =       0.001619428122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373358786
  error estimate for blocks of size 2^( 2) =       0.000387452778
  error estimate for blocks of size 2^( 3) =       0.000400298122
  error estimate for blocks of size 2^( 4) =       0.000408817712
  error estimate for blocks of size 2^( 5) =       0.000414296977
  error estimate for blocks of size 2^( 6) =       0.000418723698
  error estimate for blocks of size 2^( 7) =       0.000419338802

      target function =      -0.915774017448
              le_mean =     -17.209780577607
             les_mean =     296.464413592357
             stat err =       0.000415294297
             autocorr =       1.237254901704
   target nu stat err =       0.000415294297
   target dn stat err =       0.002068734739
      target stat err =       0.002744656985
              std dev =       0.528017507231
             le_variance =       0.278802487942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278804178555
                                         uncertainty =       0.001619428122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278804178555
                                         uncertainty =       0.001619428122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373358786
  error estimate for blocks of size 2^( 2) =       0.000387452778
  error estimate for blocks of size 2^( 3) =       0.000400298122
  error estimate for blocks of size 2^( 4) =       0.000408817712
  error estimate for blocks of size 2^( 5) =       0.000414296977
  error estimate for blocks of size 2^( 6) =       0.000418723698
  error estimate for blocks of size 2^( 7) =       0.000419338802

      target function =      -0.915774017432
              le_mean =     -17.209780577607
             les_mean =     296.464413592368
             stat err =       0.000415294297
             autocorr =       1.237254901702
   target nu stat err =       0.000415294297
   target dn stat err =       0.002068734739
      target stat err =       0.002744656985
              std dev =       0.528017507232
             le_variance =       0.278802487943


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915774017430        initial
     9.5367e+06     9.5367e+07             4.1690e-11        -0.915774017467  <--
     3.8147e+07     3.8147e+08             1.0423e-11        -0.915774017448
     1.5259e+08     1.5259e+09             2.6058e-12        -0.915774017432

*****************************************************************************
Applying the update for shift_i =   9.5367e+06     and shift_s =   9.5367e+07
*****************************************************************************

  Execution time = 3.9357e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5209e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2403
    reference variance = 0.191973
====================================================
  Execution time = 2.8156e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0495e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8872e-01
  Total weights = 1.966157838e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7285e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276952962291
                                         uncertainty =       0.001688014385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276952962291
                                         uncertainty =       0.001688014385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372107190
  error estimate for blocks of size 2^( 2) =       0.000386136592
  error estimate for blocks of size 2^( 3) =       0.000399396864
  error estimate for blocks of size 2^( 4) =       0.000409045694
  error estimate for blocks of size 2^( 5) =       0.000414304371
  error estimate for blocks of size 2^( 6) =       0.000417236564
  error estimate for blocks of size 2^( 7) =       0.000421128585

      target function =      -0.914579621475
              le_mean =     -17.209512863348
             les_mean =     296.456056622190
             stat err =       0.000415428803
             autocorr =       1.246398985007
   target nu stat err =       0.000415428803
   target dn stat err =       0.003526544454
      target stat err =       0.004594175936
              std dev =       0.526247454168
             le_variance =       0.276936383019


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720951286335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914601817689       residual = 5.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914601817699       residual = 9.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914601817701       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914601817702       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914601817702       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914601815862       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914601817702       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914601814131       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914601824985       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914601814985       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914601818444       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914601817941       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914601818104       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914601817209       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914601813371       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914601825501       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914601823668       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914601822430       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914601814522       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914601828102       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914601818576       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914601816108       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914601811705       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914601822598       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914601818685       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914601818025       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914601808880       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914601817058       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914601818910       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914601817765       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914601816021       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914601825552       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914601813105       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914601817950       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914601829471       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914601822214       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914601819165       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914601817717       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914601822271       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914601814299       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914601815603       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+06 is 1.552765e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914601817689       residual = 5.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914601817692       residual = 9.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914601817692       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914601817692       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914601817692       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914601817692       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914601812716       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914601817692       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914601810770       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914601815835       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914601799486       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914601828860       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914601820775       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914601824447       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914601811068       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914601824357       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914601787433       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914601827146       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914601794185       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914601813644       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914601813762       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914601790998       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914601839560       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914601821612       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914601818380       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914601829540       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914601810452       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914601826646       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914601819244       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914601843059       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914601825672       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914601809126       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914601829399       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914601844590       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914601806710       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914601838628       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914601787511       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914601817975       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914601797237       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914601800621       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914601788923       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+06 is 3.881934e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914601817689       residual = 5.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914601817690       residual = 9.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914601817690       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914601817691       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914601825909       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914601808077       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914601841526       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914601723120       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914601895064       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914601884431       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914601781775       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914601800810       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914601837773       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914601816705       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914601849060       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914601755145       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914601728785       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914601802280       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914601849232       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914601776506       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914601782234       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914601843662       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914601735830       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914601925061       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914601782792       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914601848379       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914601711017       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914601680161       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914601702167       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914601783029       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914601785089       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914601710109       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914601874668       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914601848690       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914601758916       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914601830920       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914601827001       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914601888504       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914601828164       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914601755725       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914601840102       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.8147e+07 is 9.704462e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.873768 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6968e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2538
    reference variance = 0.15798
====================================================
  Execution time = 2.7342e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8775e-01
  Total weights = 1.9666e+06
  Execution time = 2.3648e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277205816726
                                         uncertainty =       0.001568414171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277205816726
                                         uncertainty =       0.001568414171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372306947
  error estimate for blocks of size 2^( 2) =       0.000386230039
  error estimate for blocks of size 2^( 3) =       0.000399590947
  error estimate for blocks of size 2^( 4) =       0.000409318420
  error estimate for blocks of size 2^( 5) =       0.000415267110
  error estimate for blocks of size 2^( 6) =       0.000419381428
  error estimate for blocks of size 2^( 7) =       0.000421231470

      target function =      -0.915972393204
              le_mean =     -17.209974350582
             les_mean =     296.470966952234
             stat err =       0.000416299607
             autocorr =       1.250287018666
   target nu stat err =       0.000416299607
   target dn stat err =       0.002447660574
      target stat err =       0.003228665690
              std dev =       0.526529957865
             le_variance =       0.277233796529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277205816736
                                         uncertainty =       0.001568414171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277205816736
                                         uncertainty =       0.001568414171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372306947
  error estimate for blocks of size 2^( 2) =       0.000386230039
  error estimate for blocks of size 2^( 3) =       0.000399590947
  error estimate for blocks of size 2^( 4) =       0.000409318420
  error estimate for blocks of size 2^( 5) =       0.000415267110
  error estimate for blocks of size 2^( 6) =       0.000419381428
  error estimate for blocks of size 2^( 7) =       0.000421231470

      target function =      -0.915972393242
              le_mean =     -17.209974350581
             les_mean =     296.470966952175
             stat err =       0.000416299607
             autocorr =       1.250287018638
   target nu stat err =       0.000416299607
   target dn stat err =       0.002447660570
      target stat err =       0.003228665685
              std dev =       0.526529957875
             le_variance =       0.277233796539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277205816731
                                         uncertainty =       0.001568414171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277205816731
                                         uncertainty =       0.001568414171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372306947
  error estimate for blocks of size 2^( 2) =       0.000386230039
  error estimate for blocks of size 2^( 3) =       0.000399590947
  error estimate for blocks of size 2^( 4) =       0.000409318420
  error estimate for blocks of size 2^( 5) =       0.000415267110
  error estimate for blocks of size 2^( 6) =       0.000419381428
  error estimate for blocks of size 2^( 7) =       0.000421231470

      target function =      -0.915972393223
              le_mean =     -17.209974350581
             les_mean =     296.470966952204
             stat err =       0.000416299607
             autocorr =       1.250287018647
   target nu stat err =       0.000416299607
   target dn stat err =       0.002447660572
      target stat err =       0.003228665688
              std dev =       0.526529957870
             le_variance =       0.277233796535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277205816726
                                         uncertainty =       0.001568414171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277205816726
                                         uncertainty =       0.001568414171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372306947
  error estimate for blocks of size 2^( 2) =       0.000386230039
  error estimate for blocks of size 2^( 3) =       0.000399590947
  error estimate for blocks of size 2^( 4) =       0.000409318420
  error estimate for blocks of size 2^( 5) =       0.000415267110
  error estimate for blocks of size 2^( 6) =       0.000419381428
  error estimate for blocks of size 2^( 7) =       0.000421231470

      target function =      -0.915972393207
              le_mean =     -17.209974350582
             les_mean =     296.470966952231
             stat err =       0.000416299607
             autocorr =       1.250287018657
   target nu stat err =       0.000416299607
   target dn stat err =       0.002447660574
      target stat err =       0.003228665690
              std dev =       0.526529957866
             le_variance =       0.277233796530


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915972393204        initial
     2.3842e+06     2.3842e+07             1.5528e-10        -0.915972393242  <--
     9.5367e+06     9.5367e+07             3.8819e-11        -0.915972393223
     3.8147e+07     3.8147e+08             9.7045e-12        -0.915972393207

*****************************************************************************
Applying the update for shift_i =   2.3842e+06     and shift_s =   2.3842e+07
*****************************************************************************

  Execution time = 3.9208e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6182e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.193
    reference variance = 0.186852
====================================================
  Execution time = 2.7078e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0490e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9193e-01
  Total weights = 1.966164839e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1369e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279668694325
                                         uncertainty =       0.002140723770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279668694325
                                         uncertainty =       0.002140723770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373927123
  error estimate for blocks of size 2^( 2) =       0.000388307676
  error estimate for blocks of size 2^( 3) =       0.000401400840
  error estimate for blocks of size 2^( 4) =       0.000410905037
  error estimate for blocks of size 2^( 5) =       0.000416283269
  error estimate for blocks of size 2^( 6) =       0.000417919553
  error estimate for blocks of size 2^( 7) =       0.000420837537

      target function =      -0.910540744656
              le_mean =     -17.209830045900
             les_mean =     296.470178727383
             stat err =       0.000416486349
             autocorr =       1.240588088097
   target nu stat err =       0.000416486349
   target dn stat err =       0.003220994011
      target stat err =       0.004168477584
              std dev =       0.528821269796
             le_variance =       0.279651935388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720983004590e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910559154822       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910559154938       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910559154948       residual = 5.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910559154952       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910559154753       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910559155043       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910559154149       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910559155535       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910559155657       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910559154001       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910559154443       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910559154226       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910559154013       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910559154869       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910559154821       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910559155795       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910559155506       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910559153826       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910559154411       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910559154921       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910559155066       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910559155868       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910559153995       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910559155186       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910559155572       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910559157189       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910559156078       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910559154311       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910559154522       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910559152911       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910559156361       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910559154762       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910559155213       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910559153849       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910559153675       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910559153429       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.910559155014       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.910559157244       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.910559153945       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.910559153730       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+05 is 5.794845e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910559154822       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910559154851       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910559154853       residual = 5.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910559154855       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910559154409       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910559149660       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910559150935       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910559155154       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910559150998       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910559154744       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910559158409       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910559158937       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910559155121       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910559147952       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910559158488       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910559156885       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910559153973       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910559154719       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910559154878       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910559153297       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910559157657       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910559158401       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910559150416       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910559151273       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910559149632       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910559154463       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910559153435       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910559158846       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910559151085       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910559156700       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910559144831       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910559151191       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910559151851       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910559157628       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910559154768       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910559156448       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.910559157097       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.910559146989       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.910559153812       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.910559160835       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+06 is 1.448707e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910559154822       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910559154829       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910559154830       residual = 5.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910559154831       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910559157496       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910559153800       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910559166756       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910559147804       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910559155312       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910559146680       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910559145396       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910559150412       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910559147378       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910559146014       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910559149348       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910559153781       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910559132942       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910559137914       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910559164075       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910559151118       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910559181121       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910559160672       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910559148726       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910559139213       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910559159360       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910559151431       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910559152248       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910559179418       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910559152389       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910559155458       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910559138957       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910559164039       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910559122907       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910559210452       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910559122112       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910559175317       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.910559161820       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.910559205949       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.910559148503       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.910559169011       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+06 is 3.621824e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.943528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5292e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361102e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850731e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1895
    reference variance = 0.244217
====================================================
  Execution time = 2.6818e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9009e-01
  Total weights = 1.9664e+06
  Execution time = 2.3588e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279571885369
                                         uncertainty =       0.002002085624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279571885369
                                         uncertainty =       0.002002085624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373857389
  error estimate for blocks of size 2^( 2) =       0.000388117346
  error estimate for blocks of size 2^( 3) =       0.000401430471
  error estimate for blocks of size 2^( 4) =       0.000410542773
  error estimate for blocks of size 2^( 5) =       0.000416380213
  error estimate for blocks of size 2^( 6) =       0.000419027592
  error estimate for blocks of size 2^( 7) =       0.000418183103

      target function =      -0.912912415297
              le_mean =     -17.209873343688
             les_mean =     296.469833683978
             stat err =       0.000416033420
             autocorr =       1.238353116582
   target nu stat err =       0.000416033420
   target dn stat err =       0.002952470083
      target stat err =       0.003848022106
              std dev =       0.528722649202
             le_variance =       0.279547639779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279571885316
                                         uncertainty =       0.002002085633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279571885316
                                         uncertainty =       0.002002085633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373857389
  error estimate for blocks of size 2^( 2) =       0.000388117346
  error estimate for blocks of size 2^( 3) =       0.000401430471
  error estimate for blocks of size 2^( 4) =       0.000410542773
  error estimate for blocks of size 2^( 5) =       0.000416380213
  error estimate for blocks of size 2^( 6) =       0.000419027592
  error estimate for blocks of size 2^( 7) =       0.000418183103

      target function =      -0.912912415369
              le_mean =     -17.209873343687
             les_mean =     296.469833683896
             stat err =       0.000416033420
             autocorr =       1.238353116828
   target nu stat err =       0.000416033420
   target dn stat err =       0.002952470104
      target stat err =       0.003848022134
              std dev =       0.528722649152
             le_variance =       0.279547639726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279571885342
                                         uncertainty =       0.002002085629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279571885342
                                         uncertainty =       0.002002085629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373857389
  error estimate for blocks of size 2^( 2) =       0.000388117346
  error estimate for blocks of size 2^( 3) =       0.000401430471
  error estimate for blocks of size 2^( 4) =       0.000410542773
  error estimate for blocks of size 2^( 5) =       0.000416380213
  error estimate for blocks of size 2^( 6) =       0.000419027592
  error estimate for blocks of size 2^( 7) =       0.000418183103

      target function =      -0.912912415333
              le_mean =     -17.209873343688
             les_mean =     296.469833683937
             stat err =       0.000416033420
             autocorr =       1.238353116696
   target nu stat err =       0.000416033420
   target dn stat err =       0.002952470093
      target stat err =       0.003848022120
              std dev =       0.528722649177
             le_variance =       0.279547639752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279571885365
                                         uncertainty =       0.002002085625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279571885365
                                         uncertainty =       0.002002085625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373857389
  error estimate for blocks of size 2^( 2) =       0.000388117346
  error estimate for blocks of size 2^( 3) =       0.000401430471
  error estimate for blocks of size 2^( 4) =       0.000410542773
  error estimate for blocks of size 2^( 5) =       0.000416380213
  error estimate for blocks of size 2^( 6) =       0.000419027592
  error estimate for blocks of size 2^( 7) =       0.000418183103

      target function =      -0.912912415301
              le_mean =     -17.209873343688
             les_mean =     296.469833683973
             stat err =       0.000416033420
             autocorr =       1.238353116583
   target nu stat err =       0.000416033420
   target dn stat err =       0.002952470084
      target stat err =       0.003848022108
              std dev =       0.528722649198
             le_variance =       0.279547639775


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912912415297        initial
     5.9605e+05     5.9605e+06             5.7948e-10        -0.912912415369  <--
     2.3842e+06     2.3842e+07             1.4487e-10        -0.912912415333
     9.5367e+06     9.5367e+07             3.6218e-11        -0.912912415301

*****************************************************************************
Applying the update for shift_i =   5.9605e+05     and shift_s =   5.9605e+06
*****************************************************************************

  Execution time = 3.8714e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4012e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.207
    reference variance = 0.166071
====================================================
  Execution time = 2.7166e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0483e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8657e-01
  Total weights = 1.966473867e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2313e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275575698572
                                         uncertainty =       0.001655041035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275575698572
                                         uncertainty =       0.001655041035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371169897
  error estimate for blocks of size 2^( 2) =       0.000385321818
  error estimate for blocks of size 2^( 3) =       0.000398260692
  error estimate for blocks of size 2^( 4) =       0.000407815612
  error estimate for blocks of size 2^( 5) =       0.000412132003
  error estimate for blocks of size 2^( 6) =       0.000417705981
  error estimate for blocks of size 2^( 7) =       0.000417135871

      target function =      -0.917329533008
              le_mean =     -17.209307253725
             les_mean =     296.446824122840
             stat err =       0.000413697367
             autocorr =       1.242281509013
   target nu stat err =       0.000413697367
   target dn stat err =       0.002526233718
      target stat err =       0.003334538578
              std dev =       0.524921900347
             le_variance =       0.275543001463


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720930725373e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917340891366       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917340891473       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917340891494       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917340891514       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917340891506       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917340891512       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917340891511       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917340891576       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917340891788       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917340891452       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917340891869       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917340891912       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917340891686       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917340891544       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917340891698       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917340891084       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917340891726       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917340891567       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917340890915       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917340891083       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917340891531       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917340891667       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917340891874       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917340891639       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917340891655       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917340891218       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917340891580       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917340892030       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917340891026       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917340891147       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917340891383       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917340891219       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917340892229       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917340891478       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917340891212       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917340891772       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917340891325       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917340890898       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917340891235       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917340891696       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+05 is 2.538737e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917340891366       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917340891393       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917340891398       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917340891401       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917340891401       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917340891403       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917340891403       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917340890545       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917340891686       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917340891287       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917340893211       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917340891667       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917340889433       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917340891447       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917340889398       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917340889879       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917340892567       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917340891516       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917340892599       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917340892135       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917340890248       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917340893968       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917340890171       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917340890639       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917340888002       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917340891238       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917340892591       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917340891403       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917340891147       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917340893289       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917340892039       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917340889960       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917340890168       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917340893415       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917340892889       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917340893669       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917340891007       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917340891862       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917340890165       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917340891338       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+05 is 6.346839e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917340891366       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917340891373       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917340891374       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917340892177       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917340891166       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917340893523       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917340887077       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917340889710       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917340894360       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917340891812       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917340890992       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917340889301       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917340888260       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917340891376       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917340892777       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917340891478       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917340895515       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917340889280       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917340893326       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917340886615       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917340891111       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917340887640       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917340886133       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917340884752       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917340879695       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917340890763       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917340891611       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917340888456       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917340887767       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917340887632       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917340889615       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917340891858       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917340890797       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917340896254       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917340898819       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917340904421       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917340890136       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917340891872       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917340885737       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917340889587       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+06 is 1.586701e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.013857 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5475e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543189e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893473e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845087e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838374e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2663
    reference variance = 0.278234
====================================================
  Execution time = 2.7415e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8313e-01
  Total weights = 1.9665e+06
  Execution time = 2.3502e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275013565789
                                         uncertainty =       0.001681560222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275013565789
                                         uncertainty =       0.001681560222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370822950
  error estimate for blocks of size 2^( 2) =       0.000384720951
  error estimate for blocks of size 2^( 3) =       0.000397726567
  error estimate for blocks of size 2^( 4) =       0.000407331513
  error estimate for blocks of size 2^( 5) =       0.000413073331
  error estimate for blocks of size 2^( 6) =       0.000416982808
  error estimate for blocks of size 2^( 7) =       0.000420011472

      target function =      -0.922049641284
              le_mean =     -17.210110433524
             les_mean =     296.471027633174
             stat err =       0.000414349781
             autocorr =       1.248535855813
   target nu stat err =       0.000414349781
   target dn stat err =       0.001897766407
      target stat err =       0.002563502571
              std dev =       0.524431235402
             le_variance =       0.275028120665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275013565822
                                         uncertainty =       0.001681560224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275013565822
                                         uncertainty =       0.001681560224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370822950
  error estimate for blocks of size 2^( 2) =       0.000384720951
  error estimate for blocks of size 2^( 3) =       0.000397726567
  error estimate for blocks of size 2^( 4) =       0.000407331513
  error estimate for blocks of size 2^( 5) =       0.000413073331
  error estimate for blocks of size 2^( 6) =       0.000416982808
  error estimate for blocks of size 2^( 7) =       0.000420011472

      target function =      -0.922049640378
              le_mean =     -17.210110433533
             les_mean =     296.471027634161
             stat err =       0.000414349781
             autocorr =       1.248535856323
   target nu stat err =       0.000414349781
   target dn stat err =       0.001897766413
      target stat err =       0.002563502574
              std dev =       0.524431235439
             le_variance =       0.275028120704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275013565806
                                         uncertainty =       0.001681560223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275013565806
                                         uncertainty =       0.001681560223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370822950
  error estimate for blocks of size 2^( 2) =       0.000384720951
  error estimate for blocks of size 2^( 3) =       0.000397726567
  error estimate for blocks of size 2^( 4) =       0.000407331513
  error estimate for blocks of size 2^( 5) =       0.000413073331
  error estimate for blocks of size 2^( 6) =       0.000416982808
  error estimate for blocks of size 2^( 7) =       0.000420011472

      target function =      -0.922049640831
              le_mean =     -17.210110433529
             les_mean =     296.471027633667
             stat err =       0.000414349781
             autocorr =       1.248535856069
   target nu stat err =       0.000414349781
   target dn stat err =       0.001897766410
      target stat err =       0.002563502572
              std dev =       0.524431235421
             le_variance =       0.275028120685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275013565791
                                         uncertainty =       0.001681560222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275013565791
                                         uncertainty =       0.001681560222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370822950
  error estimate for blocks of size 2^( 2) =       0.000384720951
  error estimate for blocks of size 2^( 3) =       0.000397726567
  error estimate for blocks of size 2^( 4) =       0.000407331513
  error estimate for blocks of size 2^( 5) =       0.000413073331
  error estimate for blocks of size 2^( 6) =       0.000416982808
  error estimate for blocks of size 2^( 7) =       0.000420011472

      target function =      -0.922049641227
              le_mean =     -17.210110433525
             les_mean =     296.471027633236
             stat err =       0.000414349781
             autocorr =       1.248535855838
   target nu stat err =       0.000414349781
   target dn stat err =       0.001897766407
      target stat err =       0.002563502571
              std dev =       0.524431235404
             le_variance =       0.275028120668


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922049641284        initial  <--
     1.4901e+05     1.4901e+06             2.5387e-09        -0.922049640378
     5.9605e+05     5.9605e+06             6.3468e-10        -0.922049640831
     2.3842e+06     2.3842e+07             1.5867e-10        -0.922049641227

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2398
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4723e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.3487
    reference variance = 0.228561
====================================================
  Execution time = 2.7043e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0487e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8332e-01
  Total weights = 1.966246532e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2877e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274527984635
                                         uncertainty =       0.001736365792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274527984635
                                         uncertainty =       0.001736365792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370464823
  error estimate for blocks of size 2^( 2) =       0.000384386367
  error estimate for blocks of size 2^( 3) =       0.000397229973
  error estimate for blocks of size 2^( 4) =       0.000406263988
  error estimate for blocks of size 2^( 5) =       0.000412616194
  error estimate for blocks of size 2^( 6) =       0.000417488928
  error estimate for blocks of size 2^( 7) =       0.000421460584

      target function =      -0.921656522283
              le_mean =     -17.209627874128
             les_mean =     296.454614097069
             stat err =       0.000414457424
             autocorr =       1.251600975499
   target nu stat err =       0.000414457424
   target dn stat err =       0.002277883587
      target stat err =       0.003047088407
              std dev =       0.523924759755
             le_variance =       0.274497153885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720962787413e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921665877260       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921665877272       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921665877274       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921665877271       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921665876553       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921665879952       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921665879415       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921665877951       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921665877032       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921665876555       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921665877322       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921665876120       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921665876473       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921665874810       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921665878831       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921665877254       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921665879418       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921665878302       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921665876425       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921665876205       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921665880090       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921665876384       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921665874304       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921665879518       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921665875925       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921665875351       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921665879144       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921665879267       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921665874360       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921665881364       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921665877506       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921665880395       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.921665878048       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921665876364       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921665876418       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921665878570       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.921665875101       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921665875247       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.921665880880       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.921665871108       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.921665881978       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+06 is 2.541673e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921665877260       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921665877263       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921665877263       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921665877264       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921665877167       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921665887910       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921665876137       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921665883747       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921665882487       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921665879489       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921665875003       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921665876714       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921665864300       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921665874949       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921665863297       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921665882173       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921665888181       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921665880219       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921665885361       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921665873056       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921665871590       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921665865046       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921665886362       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921665870094       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921665891445       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921665888730       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921665872725       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921665877223       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921665875613       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921665876697       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921665869770       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921665867012       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.921665879424       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921665883205       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921665876840       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921665882533       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.921665873623       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921665861305       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.921665878454       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.921665878100       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.921665859720       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+06 is 6.354157e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921665877260       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921665877261       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921665877261       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921665886308       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921665879105       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921665874487       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921665825258       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921665856319       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921665914095       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921665836473       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921665859179       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921665890763       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921665900182       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921665892028       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921665853321       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921665798065       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921665894312       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921665910096       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921665827169       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921665914548       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921665849685       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921665845081       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921666020361       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921665842990       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921665929110       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921665883631       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921665869907       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921665837380       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921665855858       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921665759870       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921665876237       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921665885690       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.921665911118       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921665861977       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921665792903       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921665926321       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.921665852217       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921665799954       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.921665793167       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.921665867460       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.921665885025       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+07 is 1.588528e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.088929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5414e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2769
    reference variance = 0.416823
====================================================
  Execution time = 2.6993e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8252e-01
  Total weights = 1.9665e+06
  Execution time = 2.3750e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274459804495
                                         uncertainty =       0.001470085906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274459804495
                                         uncertainty =       0.001470085906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370439644
  error estimate for blocks of size 2^( 2) =       0.000384460039
  error estimate for blocks of size 2^( 3) =       0.000397853639
  error estimate for blocks of size 2^( 4) =       0.000406650817
  error estimate for blocks of size 2^( 5) =       0.000412076688
  error estimate for blocks of size 2^( 6) =       0.000415189468
  error estimate for blocks of size 2^( 7) =       0.000418120997

      target function =      -0.922620543284
              le_mean =     -17.209311960846
             les_mean =     296.442942591220
             stat err =       0.000413009492
             autocorr =       1.243040133673
   target nu stat err =       0.000413009492
   target dn stat err =       0.001882498231
      target stat err =       0.002543460674
              std dev =       0.523889150296
             le_variance =       0.274459841798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274459804489
                                         uncertainty =       0.001470085906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274459804489
                                         uncertainty =       0.001470085906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370439644
  error estimate for blocks of size 2^( 2) =       0.000384460039
  error estimate for blocks of size 2^( 3) =       0.000397853639
  error estimate for blocks of size 2^( 4) =       0.000406650817
  error estimate for blocks of size 2^( 5) =       0.000412076688
  error estimate for blocks of size 2^( 6) =       0.000415189468
  error estimate for blocks of size 2^( 7) =       0.000418120997

      target function =      -0.922620543127
              le_mean =     -17.209311960847
             les_mean =     296.442942591364
             stat err =       0.000413009492
             autocorr =       1.243040133691
   target nu stat err =       0.000413009492
   target dn stat err =       0.001882498234
      target stat err =       0.002543460678
              std dev =       0.523889150290
             le_variance =       0.274459841792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274459804492
                                         uncertainty =       0.001470085906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274459804492
                                         uncertainty =       0.001470085906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370439644
  error estimate for blocks of size 2^( 2) =       0.000384460039
  error estimate for blocks of size 2^( 3) =       0.000397853639
  error estimate for blocks of size 2^( 4) =       0.000406650817
  error estimate for blocks of size 2^( 5) =       0.000412076688
  error estimate for blocks of size 2^( 6) =       0.000415189468
  error estimate for blocks of size 2^( 7) =       0.000418120997

      target function =      -0.922620543206
              le_mean =     -17.209311960846
             les_mean =     296.442942591292
             stat err =       0.000413009492
             autocorr =       1.243040133689
   target nu stat err =       0.000413009492
   target dn stat err =       0.001882498233
      target stat err =       0.002543460676
              std dev =       0.523889150293
             le_variance =       0.274459841795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274459804495
                                         uncertainty =       0.001470085906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274459804495
                                         uncertainty =       0.001470085906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370439644
  error estimate for blocks of size 2^( 2) =       0.000384460039
  error estimate for blocks of size 2^( 3) =       0.000397853639
  error estimate for blocks of size 2^( 4) =       0.000406650817
  error estimate for blocks of size 2^( 5) =       0.000412076688
  error estimate for blocks of size 2^( 6) =       0.000415189468
  error estimate for blocks of size 2^( 7) =       0.000418120997

      target function =      -0.922620543274
              le_mean =     -17.209311960846
             les_mean =     296.442942591229
             stat err =       0.000413009492
             autocorr =       1.243040133676
   target nu stat err =       0.000413009492
   target dn stat err =       0.001882498231
      target stat err =       0.002543460675
              std dev =       0.523889150296
             le_variance =       0.274459841798


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922620543284        initial  <--
     1.4901e+06     1.4901e+07             2.5417e-10        -0.922620543127
     5.9605e+06     5.9605e+07             6.3542e-11        -0.922620543206
     2.3842e+07     2.3842e+08             1.5885e-11        -0.922620543274

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9538
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4373e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2948
    reference variance = 0.184651
====================================================
  Execution time = 2.7261e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0462e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8477e-01
  Total weights = 1.966296496e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5672e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275806374573
                                         uncertainty =       0.001318917022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275806374573
                                         uncertainty =       0.001318917022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371303240
  error estimate for blocks of size 2^( 2) =       0.000385699128
  error estimate for blocks of size 2^( 3) =       0.000398916283
  error estimate for blocks of size 2^( 4) =       0.000408340347
  error estimate for blocks of size 2^( 5) =       0.000413712583
  error estimate for blocks of size 2^( 6) =       0.000416805903
  error estimate for blocks of size 2^( 7) =       0.000418252206

      target function =      -0.919714314704
              le_mean =     -17.209462833604
             les_mean =     296.450383812603
             stat err =       0.000414277760
             autocorr =       1.244875046244
   target nu stat err =       0.000414277760
   target dn stat err =       0.002065976249
      target stat err =       0.002762596674
              std dev =       0.525110478682
             le_variance =       0.275741014822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720946283360e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919721779959       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919721779960       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919721779960       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919721779961       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919721779961       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919721738971       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919721757043       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919721795650       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919721773322       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919721776105       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919721818810       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919721782209       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919721790671       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919721800051       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919721789861       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919721840323       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919721802069       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919721768800       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919721746903       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919721785041       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919721774058       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919721766482       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919721776747       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919721799588       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919721727079       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919721780481       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919721777420       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919721741946       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919721753456       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919721735404       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919721799515       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919721764312       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919721786485       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919721795993       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919721749993       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919721788234       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919721753319       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919721803963       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919721774585       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919721765985       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+07 is 2.679530e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919721779959       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919721779959       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919721779960       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919721779960       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919721769384       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919721779960       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919721771532       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919721721915       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919721812572       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919721717353       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919721793322       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919721921859       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919721820255       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919721601872       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919721853342       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919721680609       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919721835226       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919721844286       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919721480028       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919722027680       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919721142266       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919721478766       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919721544398       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919721903079       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919721778588       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919721836741       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919721622177       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919722152099       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919721927465       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919721588866       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919721867929       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919721852237       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919721567793       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919721911216       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919721858832       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919721838004       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919721744937       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919721766739       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919721086571       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919721689903       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+07 is 6.699203e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919721779959       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919721779959       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919721779959       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919721699484       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919721943469       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919721689022       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919722292689       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919721692969       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919720836265       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919721321916       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919721638830       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919722025691       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919721629394       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919722675639       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919721912276       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919722345267       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919721852474       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919722261930       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919721156648       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919721330264       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919721751266       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919721462685       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919721221092       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919721466110       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919721843110       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919720942671       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919721306953       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919721230449       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919722334365       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919721550351       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919721110198       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919721504371       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919721214700       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919721870093       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919721738415       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919721256971       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919722273369       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919721621134       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919722001529       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919722584384       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+08 is 1.674993e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.158694 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7609e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.0845
    reference variance = 0.182943
====================================================
  Execution time = 2.7384e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9069e-01
  Total weights = 1.9660e+06
  Execution time = 2.3487e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281274185574
                                         uncertainty =       0.003235143406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281274185574
                                         uncertainty =       0.003235143406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375019897
  error estimate for blocks of size 2^( 2) =       0.000389248082
  error estimate for blocks of size 2^( 3) =       0.000402131334
  error estimate for blocks of size 2^( 4) =       0.000412387149
  error estimate for blocks of size 2^( 5) =       0.000416991814
  error estimate for blocks of size 2^( 6) =       0.000418279695
  error estimate for blocks of size 2^( 7) =       0.000418784184

      target function =      -0.912192785794
              le_mean =     -17.210138599027
             les_mean =     296.479561402600
             stat err =       0.000416610711
             autocorr =       1.234105368115
   target nu stat err =       0.000416610711
   target dn stat err =       0.004300747107
      target stat err =       0.005564419842
              std dev =       0.530366710134
             le_variance =       0.281288847218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281274185582
                                         uncertainty =       0.003235143413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281274185582
                                         uncertainty =       0.003235143413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375019897
  error estimate for blocks of size 2^( 2) =       0.000389248082
  error estimate for blocks of size 2^( 3) =       0.000402131334
  error estimate for blocks of size 2^( 4) =       0.000412387149
  error estimate for blocks of size 2^( 5) =       0.000416991814
  error estimate for blocks of size 2^( 6) =       0.000418279695
  error estimate for blocks of size 2^( 7) =       0.000418784184

      target function =      -0.912192785767
              le_mean =     -17.210138599027
             les_mean =     296.479561402619
             stat err =       0.000416610711
             autocorr =       1.234105368112
   target nu stat err =       0.000416610711
   target dn stat err =       0.004300747118
      target stat err =       0.005564419856
              std dev =       0.530366710142
             le_variance =       0.281288847227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281274185578
                                         uncertainty =       0.003235143410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281274185578
                                         uncertainty =       0.003235143410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375019897
  error estimate for blocks of size 2^( 2) =       0.000389248082
  error estimate for blocks of size 2^( 3) =       0.000402131334
  error estimate for blocks of size 2^( 4) =       0.000412387149
  error estimate for blocks of size 2^( 5) =       0.000416991814
  error estimate for blocks of size 2^( 6) =       0.000418279695
  error estimate for blocks of size 2^( 7) =       0.000418784184

      target function =      -0.912192785781
              le_mean =     -17.210138599027
             les_mean =     296.479561402609
             stat err =       0.000416610711
             autocorr =       1.234105368122
   target nu stat err =       0.000416610711
   target dn stat err =       0.004300747112
      target stat err =       0.005564419849
              std dev =       0.530366710138
             le_variance =       0.281288847222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281274185574
                                         uncertainty =       0.003235143406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281274185574
                                         uncertainty =       0.003235143406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375019897
  error estimate for blocks of size 2^( 2) =       0.000389248082
  error estimate for blocks of size 2^( 3) =       0.000402131334
  error estimate for blocks of size 2^( 4) =       0.000412387149
  error estimate for blocks of size 2^( 5) =       0.000416991814
  error estimate for blocks of size 2^( 6) =       0.000418279695
  error estimate for blocks of size 2^( 7) =       0.000418784184

      target function =      -0.912192785792
              le_mean =     -17.210138599027
             les_mean =     296.479561402601
             stat err =       0.000416610711
             autocorr =       1.234105368110
   target nu stat err =       0.000416610711
   target dn stat err =       0.004300747108
      target stat err =       0.005564419843
              std dev =       0.530366710135
             le_variance =       0.281288847219


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912192785794        initial  <--
     1.4901e+07     1.4901e+08             2.6795e-11        -0.912192785767
     5.9605e+07     5.9605e+08             6.6992e-12        -0.912192785781
     2.3842e+08     2.3842e+09             1.6750e-12        -0.912192785792

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2007
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6816e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2567
    reference variance = 0.258128
====================================================
  Execution time = 2.7096e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0468e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9493e-01
  Total weights = 1.965954750e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2275e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280826002599
                                         uncertainty =       0.002543626708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280826002599
                                         uncertainty =       0.002543626708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374705421
  error estimate for blocks of size 2^( 2) =       0.000389048324
  error estimate for blocks of size 2^( 3) =       0.000402546442
  error estimate for blocks of size 2^( 4) =       0.000412816017
  error estimate for blocks of size 2^( 5) =       0.000418015596
  error estimate for blocks of size 2^( 6) =       0.000420969746
  error estimate for blocks of size 2^( 7) =       0.000423098560

      target function =      -0.906603888994
              le_mean =     -17.209499165077
             les_mean =     296.461792366773
             stat err =       0.000418724980
             autocorr =       1.248756574553
   target nu stat err =       0.000418724980
   target dn stat err =       0.004902953195
      target stat err =       0.006252517126
              std dev =       0.529921967128
             le_variance =       0.280817291245


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720949916508e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906647846502       residual = 9.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906647846502       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906647846502       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906647846502       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906647846527       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906647750661       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906647859153       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906648310042       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906647732354       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906647943271       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906647953726       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906647702892       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906648129254       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906648158688       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906648552831       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906647662785       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906648029735       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906647922218       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906647961420       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906647493723       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906647967510       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906647757143       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906647779073       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906648317385       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906647847410       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906648275791       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906648561363       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906647522325       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.906647985834       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.906648172262       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.906648191055       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.906648108491       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.906647920589       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906647776564       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906648180004       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.906647687501       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.906648018065       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.906647532894       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.906648468566       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.906648217417       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.906647115097       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.906648048240       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.906647790331       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.906648445307       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+08 is 9.006596e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906647846502       residual = 9.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906647846502       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906647846502       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906647846502       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906647846502       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906647239986       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906648166020       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906648154950       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906647959924       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906648710454       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906647711295       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906648028399       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906647842621       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906648647164       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906647260897       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906646682450       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906647644694       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906648509700       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906647275986       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906646030252       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906649415586       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906647420635       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906647559481       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906646787760       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906648171136       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906647118030       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906649885655       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906651098441       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.906647018230       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.906647879490       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.906650366811       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.906649221397       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.906648889217       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906650919852       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906647970955       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.906648302928       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.906649515502       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.906649276586       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.906648112078       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.906647970837       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.906646704238       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.906648224708       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.906646850645       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.906648279932       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+08 is 2.252646e-12

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906647846502       residual = 9.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906647846502       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906647846502       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906647846502       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906647846502       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906649065060       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906647846502       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906645306257       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906652670230       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906655461994       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906647846502       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906645930918       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906646029438       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906647800836       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906652460423       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906640444213       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906644178249       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906644946982       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906653086559       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906643722333       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906649428622       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906642778940       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906645119985       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906656500860       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906652374572       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906639429007       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906648836255       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906642714266       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.906649691808       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.906652059842       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.906657726171       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.906653026437       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.906642345671       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906644208534       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906655296797       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.906639704536       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.906643518036       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.906653272212       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.906641244105       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.906640294971       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.906647898643       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.906647527081       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.906636766234       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.906658801726       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.906643616864       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.906637165156       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.906658729347       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.906640075609       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.906660887357       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.906647740062       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         49 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+09 is 5.616151e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.262494 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5435e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2081
    reference variance = 0.168646
====================================================
  Execution time = 2.7321e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8348e-01
  Total weights = 1.9664e+06
  Execution time = 2.3728e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275607359821
                                         uncertainty =       0.001536294742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275607359821
                                         uncertainty =       0.001536294742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371162508
  error estimate for blocks of size 2^( 2) =       0.000385213335
  error estimate for blocks of size 2^( 3) =       0.000397624414
  error estimate for blocks of size 2^( 4) =       0.000407303846
  error estimate for blocks of size 2^( 5) =       0.000412952801
  error estimate for blocks of size 2^( 6) =       0.000415854992
  error estimate for blocks of size 2^( 7) =       0.000418830636

      target function =      -0.921604877809
              le_mean =     -17.210173991933
             les_mean =     296.473567423349
             stat err =       0.000413735569
             autocorr =       1.242560423243
   target nu stat err =       0.000413735569
   target dn stat err =       0.001841544576
      target stat err =       0.002489348963
              std dev =       0.524911450479
             le_variance =       0.275532030844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275607359821
                                         uncertainty =       0.001536294742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275607359821
                                         uncertainty =       0.001536294742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371162508
  error estimate for blocks of size 2^( 2) =       0.000385213335
  error estimate for blocks of size 2^( 3) =       0.000397624414
  error estimate for blocks of size 2^( 4) =       0.000407303846
  error estimate for blocks of size 2^( 5) =       0.000412952801
  error estimate for blocks of size 2^( 6) =       0.000415854992
  error estimate for blocks of size 2^( 7) =       0.000418830636

      target function =      -0.921604877813
              le_mean =     -17.210173991933
             les_mean =     296.473567423346
             stat err =       0.000413735569
             autocorr =       1.242560423249
   target nu stat err =       0.000413735569
   target dn stat err =       0.001841544576
      target stat err =       0.002489348963
              std dev =       0.524911450479
             le_variance =       0.275532030843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275607359821
                                         uncertainty =       0.001536294742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275607359821
                                         uncertainty =       0.001536294742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371162508
  error estimate for blocks of size 2^( 2) =       0.000385213335
  error estimate for blocks of size 2^( 3) =       0.000397624414
  error estimate for blocks of size 2^( 4) =       0.000407303846
  error estimate for blocks of size 2^( 5) =       0.000412952801
  error estimate for blocks of size 2^( 6) =       0.000415854992
  error estimate for blocks of size 2^( 7) =       0.000418830636

      target function =      -0.921604877811
              le_mean =     -17.210173991933
             les_mean =     296.473567423348
             stat err =       0.000413735569
             autocorr =       1.242560423243
   target nu stat err =       0.000413735569
   target dn stat err =       0.001841544576
      target stat err =       0.002489348963
              std dev =       0.524911450479
             le_variance =       0.275532030844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275607359821
                                         uncertainty =       0.001536294742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275607359821
                                         uncertainty =       0.001536294742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371162508
  error estimate for blocks of size 2^( 2) =       0.000385213335
  error estimate for blocks of size 2^( 3) =       0.000397624414
  error estimate for blocks of size 2^( 4) =       0.000407303846
  error estimate for blocks of size 2^( 5) =       0.000412952801
  error estimate for blocks of size 2^( 6) =       0.000415854992
  error estimate for blocks of size 2^( 7) =       0.000418830636

      target function =      -0.921604877809
              le_mean =     -17.210173991933
             les_mean =     296.473567423349
             stat err =       0.000413735569
             autocorr =       1.242560423245
   target nu stat err =       0.000413735569
   target dn stat err =       0.001841544576
      target stat err =       0.002489348963
              std dev =       0.524911450479
             le_variance =       0.275532030844


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921604877809        initial
     1.4901e+08     1.4901e+09             9.0066e-12        -0.921604877813  <--
     5.9605e+08     5.9605e+09             2.2526e-12        -0.921604877811
     2.3842e+09     2.3842e+10             5.6162e-13        -0.921604877809

*****************************************************************************
Applying the update for shift_i =   1.4901e+08     and shift_s =   1.4901e+09
*****************************************************************************

  Execution time = 3.9273e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4715e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.136
    reference variance = 0.197675
====================================================
  Execution time = 2.7317e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0478e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8834e-01
  Total weights = 1.966286157e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3715e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276451676833
                                         uncertainty =       0.001777019040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276451676833
                                         uncertainty =       0.001777019040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371820731
  error estimate for blocks of size 2^( 2) =       0.000386045998
  error estimate for blocks of size 2^( 3) =       0.000399217110
  error estimate for blocks of size 2^( 4) =       0.000408862375
  error estimate for blocks of size 2^( 5) =       0.000414928033
  error estimate for blocks of size 2^( 6) =       0.000419606628
  error estimate for blocks of size 2^( 7) =       0.000421113490

      target function =      -0.915163693151
              le_mean =     -17.209836998226
             les_mean =     296.466829942573
             stat err =       0.000416127631
             autocorr =       1.252523569900
   target nu stat err =       0.000416127631
   target dn stat err =       0.003184162118
      target stat err =       0.004163265711
              std dev =       0.525842334398
             le_variance =       0.276510160645


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720983699823e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915181816420       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915181816420       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915181816420       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915181816420       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915181816420       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915181754710       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915181816420       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915181733822       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915181825861       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915181685379       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915181842559       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915181844811       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915181816040       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915181807409       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915181828917       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915181804863       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915181691517       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915181846424       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915181746940       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915181857076       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915181718667       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915181825853       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915181686183       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915182016828       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915181794705       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915181842955       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915181730583       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915181720799       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915181668689       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915181616985       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915181878410       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915181601355       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915181919926       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915181812761       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915181683149       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915181863493       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915181895710       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915181712840       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915181909591       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915181791055       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+07 is 9.323884e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915181816420       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915181816420       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915181816420       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915181816420       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915181816420       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915181816420       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915181816420       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915181816420       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915181858469       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915181816420       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915181582661       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915181809444       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915181816420       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915181816420       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915181642655       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915182508776       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915181680734       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915181923143       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915181855529       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915182103410       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915181944150       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915181760046       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915181601367       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915181841231       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915181702974       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915181607373       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915182270113       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915181602185       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915180927556       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915181362551       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915181585793       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915181707416       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915182354699       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915181214220       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915181362387       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915180846225       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915182107359       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915181327601       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915182122281       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915182045508       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+08 is 2.331208e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915181816420       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915181816420       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915181816420       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915181816420       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915181816420       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915181816420       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915181816420       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915181816420       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915181816420       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915181816420       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915181730463       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915183183200       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915181923786       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915180113568       residual = 9.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915182360328       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915182326757       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915181807159       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915183150407       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915179622274       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915182102511       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915182929132       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915183528954       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915183064107       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915180798944       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915181926451       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915179415917       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915179963159       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915182319895       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915185253923       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915182432227       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915181436621       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915179696939       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915182002452       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915182731531       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915182606033       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915181972339       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915181178684       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915181988051       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915181371647       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915181682477       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+08 is 5.831814e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.332797 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5766e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.3004
    reference variance = 0.119841
====================================================
  Execution time = 2.7457e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8925e-01
  Total weights = 1.9662e+06
  Execution time = 2.3501e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279313204018
                                         uncertainty =       0.002060300656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279313204018
                                         uncertainty =       0.002060300656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373658950
  error estimate for blocks of size 2^( 2) =       0.000387693329
  error estimate for blocks of size 2^( 3) =       0.000400764253
  error estimate for blocks of size 2^( 4) =       0.000409860814
  error estimate for blocks of size 2^( 5) =       0.000415079947
  error estimate for blocks of size 2^( 6) =       0.000419527287
  error estimate for blocks of size 2^( 7) =       0.000422127778

      target function =      -0.914067106571
              le_mean =     -17.210128877371
             les_mean =     296.477783836329
             stat err =       0.000416648956
             autocorr =       1.243339748605
   target nu stat err =       0.000416648956
   target dn stat err =       0.003084796620
      target stat err =       0.004028339640
              std dev =       0.528442009992
             le_variance =       0.279250957924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279313204018
                                         uncertainty =       0.002060300656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279313204018
                                         uncertainty =       0.002060300656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373658950
  error estimate for blocks of size 2^( 2) =       0.000387693329
  error estimate for blocks of size 2^( 3) =       0.000400764253
  error estimate for blocks of size 2^( 4) =       0.000409860814
  error estimate for blocks of size 2^( 5) =       0.000415079947
  error estimate for blocks of size 2^( 6) =       0.000419527287
  error estimate for blocks of size 2^( 7) =       0.000422127778

      target function =      -0.914067106540
              le_mean =     -17.210128877371
             les_mean =     296.477783836353
             stat err =       0.000416648956
             autocorr =       1.243339748591
   target nu stat err =       0.000416648956
   target dn stat err =       0.003084796629
      target stat err =       0.004028339651
              std dev =       0.528442009992
             le_variance =       0.279250957925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279313204018
                                         uncertainty =       0.002060300656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279313204018
                                         uncertainty =       0.002060300656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373658950
  error estimate for blocks of size 2^( 2) =       0.000387693329
  error estimate for blocks of size 2^( 3) =       0.000400764253
  error estimate for blocks of size 2^( 4) =       0.000409860814
  error estimate for blocks of size 2^( 5) =       0.000415079947
  error estimate for blocks of size 2^( 6) =       0.000419527287
  error estimate for blocks of size 2^( 7) =       0.000422127778

      target function =      -0.914067106556
              le_mean =     -17.210128877371
             les_mean =     296.477783836341
             stat err =       0.000416648956
             autocorr =       1.243339748597
   target nu stat err =       0.000416648956
   target dn stat err =       0.003084796624
      target stat err =       0.004028339646
              std dev =       0.528442009992
             le_variance =       0.279250957924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279313204018
                                         uncertainty =       0.002060300656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279313204018
                                         uncertainty =       0.002060300656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373658950
  error estimate for blocks of size 2^( 2) =       0.000387693329
  error estimate for blocks of size 2^( 3) =       0.000400764253
  error estimate for blocks of size 2^( 4) =       0.000409860814
  error estimate for blocks of size 2^( 5) =       0.000415079947
  error estimate for blocks of size 2^( 6) =       0.000419527287
  error estimate for blocks of size 2^( 7) =       0.000422127778

      target function =      -0.914067106569
              le_mean =     -17.210128877371
             les_mean =     296.477783836331
             stat err =       0.000416648956
             autocorr =       1.243339748599
   target nu stat err =       0.000416648956
   target dn stat err =       0.003084796621
      target stat err =       0.004028339641
              std dev =       0.528442009992
             le_variance =       0.279250957924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914067106571        initial  <--
     3.7253e+07     3.7253e+08             9.3239e-12        -0.914067106540
     1.4901e+08     1.4901e+09             2.3312e-12        -0.914067106556
     5.9605e+08     5.9605e+09             5.8318e-13        -0.914067106569

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.3109
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5084e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2217
    reference variance = 0.114634
====================================================
  Execution time = 2.7288e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0502e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8559e-01
  Total weights = 1.966264027e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2779e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276189496041
                                         uncertainty =       0.001485996569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276189496041
                                         uncertainty =       0.001485996569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371609652
  error estimate for blocks of size 2^( 2) =       0.000386200313
  error estimate for blocks of size 2^( 3) =       0.000399545233
  error estimate for blocks of size 2^( 4) =       0.000409414654
  error estimate for blocks of size 2^( 5) =       0.000415092907
  error estimate for blocks of size 2^( 6) =       0.000418710487
  error estimate for blocks of size 2^( 7) =       0.000420489639

      target function =      -0.918859443768
              le_mean =     -17.210243323622
             les_mean =     296.478062517374
             stat err =       0.000415926922
             autocorr =       1.252737539497
   target nu stat err =       0.000415926922
   target dn stat err =       0.002234660591
      target stat err =       0.002976924396
              std dev =       0.525543818966
             le_variance =       0.276196305654


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721024332362e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918868334032       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918868334032       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918868334032       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918868334032       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918868334032       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918868399643       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918867938786       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918868240933       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918868743547       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918867800161       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918868036381       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918867273295       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918868596357       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918868746576       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918868050612       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918867931286       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918867883378       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918869444392       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918868029216       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918869043862       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918868911035       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918869052006       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918868241773       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918868166257       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918867640029       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918868478701       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918867269359       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918868362039       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918868972368       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918869095675       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918868192042       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918867116283       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918868611201       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918869221829       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918869528651       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918867373414       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918867735636       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918867736811       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.918868768992       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+08 is 6.297669e-13

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918868334032       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918868334032       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918868334032       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918868334031       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918867411773       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918868447435       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918864878441       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918867654651       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918868334032       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918867179811       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918866283660       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918867543888       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918867318980       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918869628357       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918870642683       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918869233972       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918868216546       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918863517544       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918870094140       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918873817053       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918873167764       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918870088941       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918867327551       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918867201677       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918868102887       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918863886884       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918867151771       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918874030088       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918868544994       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918864960816       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918868635831       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918868084698       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918869816598       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918866408890       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918870317527       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918870709002       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918860386779       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918867533728       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.918872483539       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+09 is 1.579448e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918868334032       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918868334032       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918868334032       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918873513462       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918868333951       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918868334032       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918876228672       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918856820498       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918866308321       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918865357803       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918875757729       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918863905074       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918857001584       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918855835430       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918876354000       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918858096704       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918847538692       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918884546639       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918852898159       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918881198813       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918867771793       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918875657314       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918843442786       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918855051702       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918858997993       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918856245922       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918875365972       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918867323863       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918878318865       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918867687700       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918848722161       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918857955339       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918843368710       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918892514536       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918853047877       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918870421208       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918856084559       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918870791625       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.918864149275       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.918869450972       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.918846708959       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.918855950574       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.918888766415       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.918874511775       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.918878125790       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.918872558626       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.918841825482       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.918880137144       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.918800095745       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.918887694510       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.918920408012       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.918746115327       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.918928319998       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.918810151311       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.918854934000       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.918818726694       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.918888996968       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.919003531234       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.918826888950       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.918760450300       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.918921360103       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.918934815124       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.918917015722       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.918760180520       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.918833183274       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.919114474568       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.918868710477       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.918791307694       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.918753050197       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.918327349960       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.918890977099       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.918902037642       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.919358849818       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.918744746369       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.918787155928       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.918499158879       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.919532401760       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.918308588582       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.919184257050       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.917915740845       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.918965859734       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.924456196204       residual = 5.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.919156834371       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.918425641619       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.920631632486       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.919012574622       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.921313560459       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.919336158944       residual = 7.19e-05           smallest_sin_value = 9.95e-01
davidson iteration   88 stopping due to small subspace S singular value of 7.79e-01
davidson solver did not converge after         88 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+09 is 3.922786e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.633559 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5874e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2162
    reference variance = 0.284603
====================================================
  Execution time = 2.7001e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9324e-01
  Total weights = 1.9663e+06
  Execution time = 2.3670e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278002445573
                                         uncertainty =       0.002057136102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278002445573
                                         uncertainty =       0.002057136102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372798981
  error estimate for blocks of size 2^( 2) =       0.000387164950
  error estimate for blocks of size 2^( 3) =       0.000400101090
  error estimate for blocks of size 2^( 4) =       0.000409789852
  error estimate for blocks of size 2^( 5) =       0.000415257265
  error estimate for blocks of size 2^( 6) =       0.000417737034
  error estimate for blocks of size 2^( 7) =       0.000419550465

      target function =      -0.908734661166
              le_mean =     -17.209500558943
             les_mean =     296.460147229814
             stat err =       0.000415583654
             autocorr =       1.242703382065
   target nu stat err =       0.000415583654
   target dn stat err =       0.006182156514
      target stat err =       0.007907794210
              std dev =       0.527225810942
             le_variance =       0.277967055724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278002445573
                                         uncertainty =       0.002057136102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278002445573
                                         uncertainty =       0.002057136102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372798981
  error estimate for blocks of size 2^( 2) =       0.000387164950
  error estimate for blocks of size 2^( 3) =       0.000400101090
  error estimate for blocks of size 2^( 4) =       0.000409789852
  error estimate for blocks of size 2^( 5) =       0.000415257265
  error estimate for blocks of size 2^( 6) =       0.000417737034
  error estimate for blocks of size 2^( 7) =       0.000419550465

      target function =      -0.908734661165
              le_mean =     -17.209500558943
             les_mean =     296.460147229815
             stat err =       0.000415583654
             autocorr =       1.242703382071
   target nu stat err =       0.000415583654
   target dn stat err =       0.006182156514
      target stat err =       0.007907794211
              std dev =       0.527225810942
             le_variance =       0.277967055724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278002445573
                                         uncertainty =       0.002057136102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278002445573
                                         uncertainty =       0.002057136102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372798981
  error estimate for blocks of size 2^( 2) =       0.000387164950
  error estimate for blocks of size 2^( 3) =       0.000400101090
  error estimate for blocks of size 2^( 4) =       0.000409789852
  error estimate for blocks of size 2^( 5) =       0.000415257265
  error estimate for blocks of size 2^( 6) =       0.000417737034
  error estimate for blocks of size 2^( 7) =       0.000419550465

      target function =      -0.908734661165
              le_mean =     -17.209500558943
             les_mean =     296.460147229815
             stat err =       0.000415583654
             autocorr =       1.242703382069
   target nu stat err =       0.000415583654
   target dn stat err =       0.006182156514
      target stat err =       0.007907794210
              std dev =       0.527225810942
             le_variance =       0.277967055724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278002445573
                                         uncertainty =       0.002057136102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278002445573
                                         uncertainty =       0.002057136102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372798981
  error estimate for blocks of size 2^( 2) =       0.000387164950
  error estimate for blocks of size 2^( 3) =       0.000400101090
  error estimate for blocks of size 2^( 4) =       0.000409789852
  error estimate for blocks of size 2^( 5) =       0.000415257265
  error estimate for blocks of size 2^( 6) =       0.000417737034
  error estimate for blocks of size 2^( 7) =       0.000419550465

      target function =      -0.908734661166
              le_mean =     -17.209500558943
             les_mean =     296.460147229814
             stat err =       0.000415583654
             autocorr =       1.242703382066
   target nu stat err =       0.000415583654
   target dn stat err =       0.006182156514
      target stat err =       0.007907794210
              std dev =       0.527225810942
             le_variance =       0.277967055724


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908734661166        initial  <--
     3.7253e+08     3.7253e+09             6.2977e-13        -0.908734661165
     1.4901e+09     1.4901e+10             1.5794e-13        -0.908734661165
     5.9605e+09     5.9605e+10             3.9228e-14        -0.908734661166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9257
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4807e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1531
    reference variance = 0.175517
====================================================
  Execution time = 2.7188e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0507e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9077e-01
  Total weights = 1.966291229e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9344e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279580299339
                                         uncertainty =       0.002505160817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279580299339
                                         uncertainty =       0.002505160817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373901054
  error estimate for blocks of size 2^( 2) =       0.000388037607
  error estimate for blocks of size 2^( 3) =       0.000401316225
  error estimate for blocks of size 2^( 4) =       0.000411363693
  error estimate for blocks of size 2^( 5) =       0.000417342186
  error estimate for blocks of size 2^( 6) =       0.000420062002
  error estimate for blocks of size 2^( 7) =       0.000423096835

      target function =      -0.912162164127
              le_mean =     -17.210383206052
             les_mean =     296.488062168618
             stat err =       0.000417966179
             autocorr =       1.249593921649
   target nu stat err =       0.000417966179
   target dn stat err =       0.003464480890
      target stat err =       0.004497531301
              std dev =       0.528784401431
             le_variance =       0.279612943197


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721038320605e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912183704544       residual = 6.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912183704544       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912183704544       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912183934127       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912183704544       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912183704544       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912183704544       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912183704544       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912181055464       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912193944349       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912181035464       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912183361622       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912188914818       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912183704544       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912187433422       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912190583837       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912180488828       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912179561168       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912185782238       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912197228768       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912165444861       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912180919020       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912181626191       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912182609777       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912171073114       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912178399582       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912190768722       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912178386625       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912187671958       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912177682614       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912172866213       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912194386479       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912199756351       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912183976229       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912185343789       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912190627040       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912180203551       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912175139512       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912178661188       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912166912946       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.912177521186       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.912206019144       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912189217260       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.912154977938       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.912162674499       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.912128570213       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.912168830750       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.912195173410       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.912179964886       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.912212336012       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.912195022575       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.912103093830       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.912164451675       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.912197214821       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.912195192220       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.912149362586       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.912164063438       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.912115409384       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.912210385181       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.912094742420       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.912142121387       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.912132982173       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.912245785806       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.912119773962       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.912211046443       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.912164934649       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.912157161886       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.912084534545       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.912338855698       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.912290129494       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.912118309914       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.912247346974       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.912185657998       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.912408673902       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.912199932037       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.912360659465       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.912099541331       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.912276568739       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.912160053310       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.912521192619       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.912005215952       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.912188341936       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.913246662111       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.911288465893       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.910653732523       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.911307984170       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.912315101162       residual = 2.24e-05           smallest_sin_value = 9.99e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+09 is 1.061422e-13

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912183704544       residual = 6.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912183704544       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912183704544       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912183704544       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912183704544       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912184783890       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912183704544       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912183704544       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912183704544       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912183704544       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912191265307       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912202250711       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912183498331       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912211022013       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912161369707       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912185624050       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912160769969       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912172592359       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912158863991       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912168836870       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912213483739       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912129418678       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912209629011       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912196061220       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912221680564       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912186168797       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912197084152       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912240903085       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912174585703       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912204399496       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912189469365       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912188874219       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912200078874       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912213862558       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912141685341       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912178014827       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912218427648       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912160096037       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912091626064       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912142218292       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.912177403052       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.912226703414       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912154256511       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.912175873314       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.912176317934       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.912198553209       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.912166351659       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.912061725991       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.912211658327       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.912242146931       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.912150124915       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.912221827277       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.912162530050       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.912297664847       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.911950434262       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.912239044288       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.912252945595       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.912213917697       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.911864597537       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.912395362088       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.912171718877       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.912083412920       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.912178227880       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.912066718751       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.912008814891       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.912510580896       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.912109459998       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.912271747565       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.912258182960       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.912098687974       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.912153291382       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.912367778363       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.912204356767       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.911096089214       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.911945971566       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.913188293369       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.909603357897       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.912179157249       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.914785077606       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.908629244154       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.911570715269       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.912440627718       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.912112032078       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.912606341866       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.910274068595       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.917002291106       residual = 3.50e-03           smallest_sin_value = 9.94e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+10 is 2.589396e-14

solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912183704544       residual = 6.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912183704544       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912183704544       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912183003540       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912183704544       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912183704544       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912144796698       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912268307749       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912083887574       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912198055904       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912169665116       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912138188528       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912098021873       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912160413705       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912122075703       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912157574775       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912096775456       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912299207923       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912176809275       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912184714638       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912207837866       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912233023998       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912575481164       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912102837546       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912017277569       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912158963275       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912147408116       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912221854881       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912162828975       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912189027384       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912153009361       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912001911583       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912280822745       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912128451045       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912240057378       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912308099962       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912147708626       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911778404198       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912063491401       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912128834988       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.912434168564       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.912006643201       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912277140318       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.912348780473       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.912154374521       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.912203548476       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.911969854570       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.912432323919       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.911761572118       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.912193027176       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.912070615599       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.911936400080       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.911773757438       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.912230166148       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.912115757368       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.911661068834       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.912245786358       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.912192627267       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.912406187795       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.912473056604       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.911824783496       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.912237009566       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.911406581563       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.912174086598       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.912540831792       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.911717797114       residual = 9.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.915825006294       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.916618272247       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.909969764298       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.909230857069       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.918443032934       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.910632826129       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.909893622021       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.913036803725       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.914113387085       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.912521458198       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.912131215486       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.908719733695       residual = 5.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.918028365074       residual = 7.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.908747469165       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.929597968390       residual = 3.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.918859891297       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.917345632539       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.909061766327       residual = 7.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.950811602041       residual = 1.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.900218892453       residual = 8.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.907255210544       residual = 1.09e-01           smallest_sin_value = 9.98e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+10 is 6.189657e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               6.345028 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6843e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1696
    reference variance = 0.21134
====================================================
  Execution time = 2.6868e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9036e-01
  Total weights = 1.9662e+06
  Execution time = 2.3580e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295442132
                                         uncertainty =       0.001842051348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295442132
                                         uncertainty =       0.001842051348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373682274
  error estimate for blocks of size 2^( 2) =       0.000387842526
  error estimate for blocks of size 2^( 3) =       0.000400675257
  error estimate for blocks of size 2^( 4) =       0.000409290919
  error estimate for blocks of size 2^( 5) =       0.000414433700
  error estimate for blocks of size 2^( 6) =       0.000417535460
  error estimate for blocks of size 2^( 7) =       0.000417833771

      target function =      -0.912593314696
              le_mean =     -17.209968378270
             les_mean =     296.473371489295
             stat err =       0.000414773462
             autocorr =       1.232017649562
   target nu stat err =       0.000414773462
   target dn stat err =       0.002961961125
      target stat err =       0.003857734054
              std dev =       0.528474995552
             le_variance =       0.279285820924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295442132
                                         uncertainty =       0.001842051348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295442132
                                         uncertainty =       0.001842051348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373682274
  error estimate for blocks of size 2^( 2) =       0.000387842526
  error estimate for blocks of size 2^( 3) =       0.000400675257
  error estimate for blocks of size 2^( 4) =       0.000409290919
  error estimate for blocks of size 2^( 5) =       0.000414433700
  error estimate for blocks of size 2^( 6) =       0.000417535460
  error estimate for blocks of size 2^( 7) =       0.000417833771

      target function =      -0.912593314696
              le_mean =     -17.209968378270
             les_mean =     296.473371489295
             stat err =       0.000414773462
             autocorr =       1.232017649566
   target nu stat err =       0.000414773462
   target dn stat err =       0.002961961125
      target stat err =       0.003857734054
              std dev =       0.528474995552
             le_variance =       0.279285820924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295442132
                                         uncertainty =       0.001842051348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295442132
                                         uncertainty =       0.001842051348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373682274
  error estimate for blocks of size 2^( 2) =       0.000387842526
  error estimate for blocks of size 2^( 3) =       0.000400675257
  error estimate for blocks of size 2^( 4) =       0.000409290919
  error estimate for blocks of size 2^( 5) =       0.000414433700
  error estimate for blocks of size 2^( 6) =       0.000417535460
  error estimate for blocks of size 2^( 7) =       0.000417833771

      target function =      -0.912593314696
              le_mean =     -17.209968378270
             les_mean =     296.473371489295
             stat err =       0.000414773462
             autocorr =       1.232017649564
   target nu stat err =       0.000414773462
   target dn stat err =       0.002961961125
      target stat err =       0.003857734054
              std dev =       0.528474995552
             le_variance =       0.279285820924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295442132
                                         uncertainty =       0.001842051348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295442132
                                         uncertainty =       0.001842051348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373682274
  error estimate for blocks of size 2^( 2) =       0.000387842526
  error estimate for blocks of size 2^( 3) =       0.000400675257
  error estimate for blocks of size 2^( 4) =       0.000409290919
  error estimate for blocks of size 2^( 5) =       0.000414433700
  error estimate for blocks of size 2^( 6) =       0.000417535460
  error estimate for blocks of size 2^( 7) =       0.000417833771

      target function =      -0.912593314696
              le_mean =     -17.209968378270
             les_mean =     296.473371489295
             stat err =       0.000414773462
             autocorr =       1.232017649563
   target nu stat err =       0.000414773462
   target dn stat err =       0.002961961125
      target stat err =       0.003857734054
              std dev =       0.528474995552
             le_variance =       0.279285820924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912593314696        initial  <--
     3.7253e+09     3.7253e+10             1.0614e-13        -0.912593314696
     1.4901e+10     1.4901e+11             2.5894e-14        -0.912593314696
     5.9605e+10     5.9605e+11             6.1897e-15        -0.912593314696

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.7339
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5583e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1564
    reference variance = 0.204786
====================================================
  Execution time = 2.7601e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0468e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8877e-01
  Total weights = 1.966149964e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4120e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277391877069
                                         uncertainty =       0.001954483365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277391877069
                                         uncertainty =       0.001954483365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372415015
  error estimate for blocks of size 2^( 2) =       0.000386217323
  error estimate for blocks of size 2^( 3) =       0.000399378034
  error estimate for blocks of size 2^( 4) =       0.000408852015
  error estimate for blocks of size 2^( 5) =       0.000414342425
  error estimate for blocks of size 2^( 6) =       0.000416778479
  error estimate for blocks of size 2^( 7) =       0.000418287564

      target function =      -0.914676024212
              le_mean =     -17.210072871887
             les_mean =     296.475375471800
             stat err =       0.000414565121
             autocorr =       1.239170753873
   target nu stat err =       0.000414565121
   target dn stat err =       0.002883712296
      target stat err =       0.003775722985
              std dev =       0.526682791971
             le_variance =       0.277394763358


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721007287189e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914690919618       residual = 5.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914690919618       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914690919618       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914690919618       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914690904482       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914718168776       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914773003775       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914667020241       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914720677250       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914604517516       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914637298373       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914681855196       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914674022145       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914565388935       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914697973389       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914650537538       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914629677980       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914699157407       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914799588792       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914525039870       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914673185079       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914678296917       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914614097741       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914746400546       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914674582455       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914667222587       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914561323185       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914690035932       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914626073056       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914642014594       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914654678691       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914682472480       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914775589642       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914719840014       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914750332353       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914551200670       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914775163325       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914759130359       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914561424288       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914531394411       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914735700278       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.914633160337       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914807061434       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.914888416557       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.914735155420       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.915039185672       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.914524546281       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.914655871333       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.914413384641       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.914436286135       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.914480520884       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.914690152528       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.914661853727       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.914898923314       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.914930882108       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.914952153103       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.914479704237       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.915059951207       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.915095438127       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.915775121360       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.914900067247       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.914874513515       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.915387759714       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.915397044326       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.913151369395       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.918595887445       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.913546194876       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.913379109381       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.917225963035       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.915817837637       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.917305999684       residual = 8.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.913626144756       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.913303919346       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.913650456919       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.913075001630       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.913526915282       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.913350385035       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.913569513459       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.913065161801       residual = 6.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.917430722580       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.909499922340       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.907842688133       residual = 8.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.922674391166       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.909110565621       residual = 9.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.907604505897       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.910443859673       residual = 8.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.911695248516       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.925771842007       residual = 2.41e-02           smallest_sin_value = 9.97e-01
davidson iteration   88 stopping due to small subspace S singular value of 8.37e-01
davidson solver did not converge after         88 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+10 is 1.216477e-14

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914690919618       residual = 5.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914690919618       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914690919618       residual = 7.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914690919618       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914690919618       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914690919618       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914588691925       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914765368949       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914707441072       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915229786746       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914412052540       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914690919618       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914690919618       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914809817313       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914924881756       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914635965155       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914407822717       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914640641413       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914748167177       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914389760428       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914510260197       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914750683721       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914536341920       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914695927099       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914769318153       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914371387360       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914699240086       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914097219028       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914417280898       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915210886169       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914064253970       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916549024715       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913201056992       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912857726814       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914532594126       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914739462947       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913765019563       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914712118057       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915156733857       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915034915624       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914496105596       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.912822206712       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.913739137735       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913536598309       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.915806913072       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.912477063261       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.914697015919       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.914836163759       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.916485601766       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.912651784083       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.911563177484       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.914626007423       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.911867081592       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.914357726479       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.915836413967       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.911719297644       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.917359529929       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.914169508517       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.910247153416       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.915555113719       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.921038783624       residual = 5.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.912436707156       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.914172490361       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.918711187599       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.911018858800       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.912250697641       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.901489396618       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.912608543537       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.899643885918       residual = 2.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.909317652210       residual = 7.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.928555132154       residual = 3.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.928900331333       residual = 3.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.925091091649       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.880722725327       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.906623143040       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.922445001845       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.927509628511       residual = 5.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.916084434425       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.903968346287       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.918472185911       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.933565785922       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.950699175682       residual = 2.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.918730991765       residual = 5.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.924418461271       residual = 7.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.915223656983       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.887927616145       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.916941401406       residual = 8.96e-02           smallest_sin_value = 9.92e-01
davidson iteration   87 stopping due to small subspace S singular value of 8.99e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+11 is 2.584532e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914690919618       residual = 5.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914690919618       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914690919618       residual = 7.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914690919617       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914690918994       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914480459992       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914735077505       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914690919618       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913078689574       residual = 5.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914565020162       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915820173193       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913621012943       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914319041451       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916532706784       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916095835758       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914574055178       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915688114520       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913933439909       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914605568710       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915611600948       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916098153153       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913307335651       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913253783390       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910253507859       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913256236581       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909343907954       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917918024727       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913948846083       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911954944262       residual = 8.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910147028916       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912485065193       residual = 6.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917586218189       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914986342697       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914221166535       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921035158428       residual = 4.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918191001066       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909342482335       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918060700315       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912762879285       residual = 6.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916154492008       residual = 5.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.918261024281       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.909572323965       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.917500990277       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.918834957095       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.911277964596       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.912368841327       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.914537932168       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.909401004710       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.911503147053       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.920278121075       residual = 5.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.919756352529       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.904406410975       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.913169346514       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.912958161760       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.910332230907       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.907887936627       residual = 8.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.909745293223       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.912537666038       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.916253844491       residual = 4.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.915492606892       residual = 4.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.908735874177       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.915365670027       residual = 5.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.901522064952       residual = 4.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.919619068848       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.921743477615       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.918842158696       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.901926874897       residual = 2.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.955485625147       residual = 2.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.928213308432       residual = 3.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.918863361859       residual = 3.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.867081357212       residual = 3.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.912106431139       residual = 7.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.924801269630       residual = 5.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.897783589399       residual = 7.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.965089503093       residual = 5.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.859554874129       residual = 7.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.970454029705       residual = 6.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.025062774431       residual = 1.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.874863202235       residual = 2.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.889258532850       residual = 3.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.976960167398       residual = 9.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.959055547607       residual = 3.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.895605546748       residual = 4.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.814706914430       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.117626438596       residual = 6.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.679666204879       residual = 1.33e+01           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.30e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+11 is 4.951617e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.084278 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6760e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2806
    reference variance = 0.246795
====================================================
  Execution time = 2.7296e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8468e-01
  Total weights = 1.9667e+06
  Execution time = 2.3542e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275140756674
                                         uncertainty =       0.001435590164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275140756674
                                         uncertainty =       0.001435590164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370889514
  error estimate for blocks of size 2^( 2) =       0.000384909677
  error estimate for blocks of size 2^( 3) =       0.000397924454
  error estimate for blocks of size 2^( 4) =       0.000407250525
  error estimate for blocks of size 2^( 5) =       0.000413186883
  error estimate for blocks of size 2^( 6) =       0.000415475904
  error estimate for blocks of size 2^( 7) =       0.000416421030

      target function =      -0.920061569738
              le_mean =     -17.210301232922
             les_mean =     296.479145249196
             stat err =       0.000413083586
             autocorr =       1.240471433773
   target nu stat err =       0.000413083586
   target dn stat err =       0.002672649058
      target stat err =       0.003548017193
              std dev =       0.524525372345
             le_variance =       0.275126866233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275140756674
                                         uncertainty =       0.001435590164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275140756674
                                         uncertainty =       0.001435590164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370889514
  error estimate for blocks of size 2^( 2) =       0.000384909677
  error estimate for blocks of size 2^( 3) =       0.000397924454
  error estimate for blocks of size 2^( 4) =       0.000407250525
  error estimate for blocks of size 2^( 5) =       0.000413186883
  error estimate for blocks of size 2^( 6) =       0.000415475904
  error estimate for blocks of size 2^( 7) =       0.000416421030

      target function =      -0.920061569738
              le_mean =     -17.210301232922
             les_mean =     296.479145249197
             stat err =       0.000413083586
             autocorr =       1.240471433773
   target nu stat err =       0.000413083586
   target dn stat err =       0.002672649058
      target stat err =       0.003548017193
              std dev =       0.524525372345
             le_variance =       0.275126866233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275140756674
                                         uncertainty =       0.001435590164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275140756674
                                         uncertainty =       0.001435590164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370889514
  error estimate for blocks of size 2^( 2) =       0.000384909677
  error estimate for blocks of size 2^( 3) =       0.000397924454
  error estimate for blocks of size 2^( 4) =       0.000407250525
  error estimate for blocks of size 2^( 5) =       0.000413186883
  error estimate for blocks of size 2^( 6) =       0.000415475904
  error estimate for blocks of size 2^( 7) =       0.000416421030

      target function =      -0.920061569738
              le_mean =     -17.210301232922
             les_mean =     296.479145249197
             stat err =       0.000413083586
             autocorr =       1.240471433773
   target nu stat err =       0.000413083586
   target dn stat err =       0.002672649058
      target stat err =       0.003548017193
              std dev =       0.524525372345
             le_variance =       0.275126866233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275140756674
                                         uncertainty =       0.001435590164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275140756674
                                         uncertainty =       0.001435590164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370889514
  error estimate for blocks of size 2^( 2) =       0.000384909677
  error estimate for blocks of size 2^( 3) =       0.000397924454
  error estimate for blocks of size 2^( 4) =       0.000407250525
  error estimate for blocks of size 2^( 5) =       0.000413186883
  error estimate for blocks of size 2^( 6) =       0.000415475904
  error estimate for blocks of size 2^( 7) =       0.000416421030

      target function =      -0.920061569738
              le_mean =     -17.210301232922
             les_mean =     296.479145249197
             stat err =       0.000413083586
             autocorr =       1.240471433774
   target nu stat err =       0.000413083586
   target dn stat err =       0.002672649058
      target stat err =       0.003548017193
              std dev =       0.524525372345
             le_variance =       0.275126866233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920061569738        initial
     3.7253e+10     3.7253e+11             1.2165e-14        -0.920061569738
     1.4901e+11     1.4901e+12             2.5845e-15        -0.920061569738
     5.9605e+11     5.9605e+12             4.9516e-16        -0.920061569738  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e+11     and shift_s =   5.9605e+12
*****************************************************************************

  Execution time = 3.9155e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5921e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2501
    reference variance = 0.227708
====================================================
  Execution time = 2.7037e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0492e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8563e-01
  Total weights = 1.966550247e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3709e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274572595388
                                         uncertainty =       0.001447200318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274572595388
                                         uncertainty =       0.001447200318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370533491
  error estimate for blocks of size 2^( 2) =       0.000384556079
  error estimate for blocks of size 2^( 3) =       0.000397879762
  error estimate for blocks of size 2^( 4) =       0.000408313875
  error estimate for blocks of size 2^( 5) =       0.000413808190
  error estimate for blocks of size 2^( 6) =       0.000416534508
  error estimate for blocks of size 2^( 7) =       0.000417390603

      target function =      -0.918550289175
              le_mean =     -17.209280556336
             les_mean =     296.444963085747
             stat err =       0.000414011794
             autocorr =       1.248448089029
   target nu stat err =       0.000414011794
   target dn stat err =       0.002291244302
      target stat err =       0.003042299921
              std dev =       0.524021872659
             le_variance =       0.274598923025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720928055634e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918559608456       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918559608456       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918559608456       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918559608456       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918512915705       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918533080684       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918554226341       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918559608456       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918859259223       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918469820763       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918761224857       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918573614467       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918690126366       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919079885572       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918159695437       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919602243734       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918781989329       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918310618088       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919394296024       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918399143543       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918320049878       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917898887934       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918166702925       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917978217852       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918938229121       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918098571090       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919872253352       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919080026067       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917549598691       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918766940398       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918367854823       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917275691697       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919011886777       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917865041837       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919699608279       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919923603779       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918865519265       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919838684405       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919595806848       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.918713585513       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.918007679373       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.917648393157       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.918493709875       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.918907952985       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.918986170670       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.919383946499       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.920136792398       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.918365063298       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.918765254202       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.918902191873       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.919171603246       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.920258946368       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.916725902997       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.918018657683       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.920574722088       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.914620623521       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.915162159863       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.913566879416       residual = 4.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.921350729543       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.917547059057       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.921136895845       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.926479704706       residual = 9.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.911101597477       residual = 7.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.924342678153       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.922826408970       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.913598815874       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.917771170727       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.922895243483       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.913657052308       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.928454162041       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.933326027245       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.927608029741       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.919813838766       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.901370392416       residual = 5.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.915357965704       residual = 7.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.911724118842       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.947026264143       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.885632720054       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.930262923191       residual = 4.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.976780438765       residual = 3.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.916937885094       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.933697712587       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.903737553961       residual = 3.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.912532205753       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.916162152277       residual = 2.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.906582271227       residual = 7.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.926537204424       residual = 1.34e-01           smallest_sin_value = 9.92e-01
davidson iteration   87 stopping due to small subspace S singular value of 8.95e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+11 is 1.493990e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918559608456       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918559608456       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918559608456       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918559608457       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918559608456       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918284851689       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917981949751       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918784004135       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919163625877       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918867811558       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917386790320       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918174479681       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918466857087       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916316461514       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918843073163       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918924266375       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917745544344       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922250579665       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917379681195       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925262777838       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917329106850       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917575900741       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915743436859       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919143515026       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918628229742       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918906016681       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917509974021       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920583005187       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917005026457       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915918332102       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916897362924       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918937877491       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917090575950       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915042475229       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.921796295842       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919661682325       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.920170146323       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917833817769       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914918719996       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919188966409       residual = 6.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.919099777815       residual = 9.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913787841660       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.919895932638       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.923023594983       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.917625135086       residual = 6.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.920173950293       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.922580095505       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.920150228570       residual = 7.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.915721173541       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.918000387604       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.920034902344       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.918989833956       residual = 3.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.918027340407       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.927286447725       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.937817955862       residual = 4.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.925997481776       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.916041670180       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.922265002251       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.920956828832       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.922932922825       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.926282914505       residual = 8.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.922579093310       residual = 9.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.925757382360       residual = 9.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.912340910423       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.880275228050       residual = 1.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.929075304645       residual = 2.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.921104359124       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.926325360907       residual = 3.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.905737212903       residual = 3.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.905080467989       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.896321405760       residual = 9.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.889241089114       residual = 2.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.941790934100       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.965820630178       residual = 5.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.868041212464       residual = 3.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.853347202293       residual = 7.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.874324502558       residual = 2.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.948251887570       residual = 4.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.931916721154       residual = 4.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.944806990060       residual = 3.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.862789384972       residual = 6.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.054904934330       residual = 2.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.020629908135       residual = 6.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.958685360809       residual = 2.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.850305744754       residual = 1.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.014275790189       residual = 3.21e+00           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.70e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+11 is 2.497182e-16

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918559608456       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918559608456       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918559608456       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918559608454       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918559608456       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921026885608       residual = 6.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918957759063       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914938188885       residual = 6.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919505856348       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917762311262       residual = 7.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914270177644       residual = 5.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918232917258       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920533022207       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919842494524       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916775540978       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933068784442       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.903302404006       residual = 2.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916749405751       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930927320872       residual = 2.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.926210257228       residual = 8.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910539391009       residual = 8.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908204899947       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923855977309       residual = 5.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908845530530       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928724067106       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908294878211       residual = 2.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915215242955       residual = 6.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921642778232       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937526379511       residual = 4.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908049470885       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919568866270       residual = 3.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917263779122       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.925063037551       residual = 9.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913586087976       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.897602458806       residual = 7.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.943794006642       residual = 8.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.905995195631       residual = 4.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921990001125       residual = 5.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.943299124281       residual = 1.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919236354346       residual = 9.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.049671831095       residual = 2.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.823572955507       residual = 1.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929326750781       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.891578244515       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.898035601478       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.902464407862       residual = 3.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.865594654877       residual = 5.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.959940370320       residual = 3.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.964576546481       residual = 4.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.942875555036       residual = 4.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.986340902879       residual = 9.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.950460890170       residual = 2.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.958306761804       residual = 3.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.873533477917       residual = 5.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.910793524687       residual = 6.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.957889612703       residual = 6.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.904171082917       residual = 6.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.029299477779       residual = 1.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -1.026756495835       residual = 1.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.119597899108       residual = 6.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.890573232402       residual = 8.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.850479705390       residual = 1.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.921699636472       residual = 6.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.860116639266       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.901466308307       residual = 3.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.823508395670       residual = 2.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.934653517542       residual = 9.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.978165209114       residual = 1.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.081194780447       residual = 3.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.048510713497       residual = 4.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.861820144103       residual = 1.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.884405182593       residual = 2.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.937899410813       residual = 2.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.797513633266       residual = 1.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.841802721971       residual = 5.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.847219803646       residual = 5.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.098595425077       residual = 7.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.148351231757       residual = 6.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.854445712615       residual = 4.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.753680543969       residual = 5.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.075209291322       residual = 4.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.349363477522       residual = 2.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.918463947660       residual = 3.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.331164890160       residual = 4.73e+01           smallest_sin_value = 9.96e-01
davidson iteration   84 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         84 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+12 is 6.242956e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.802955 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6147e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2426
    reference variance = 0.226994
====================================================
  Execution time = 2.6968e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8492e-01
  Total weights = 1.9664e+06
  Execution time = 2.3672e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277545129297
                                         uncertainty =       0.001659588278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277545129297
                                         uncertainty =       0.001659588278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372471064
  error estimate for blocks of size 2^( 2) =       0.000386860508
  error estimate for blocks of size 2^( 3) =       0.000400040078
  error estimate for blocks of size 2^( 4) =       0.000409458126
  error estimate for blocks of size 2^( 5) =       0.000415490513
  error estimate for blocks of size 2^( 6) =       0.000419602414
  error estimate for blocks of size 2^( 7) =       0.000421615081

      target function =      -0.919726493472
              le_mean =     -17.210203218807
             les_mean =     296.476012343829
             stat err =       0.000416541534
             autocorr =       1.250637782164
   target nu stat err =       0.000416541534
   target dn stat err =       0.001912131571
      target stat err =       0.002570311684
              std dev =       0.526762058045
             le_variance =       0.277478265796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277545129297
                                         uncertainty =       0.001659588278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277545129297
                                         uncertainty =       0.001659588278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372471064
  error estimate for blocks of size 2^( 2) =       0.000386860508
  error estimate for blocks of size 2^( 3) =       0.000400040078
  error estimate for blocks of size 2^( 4) =       0.000409458126
  error estimate for blocks of size 2^( 5) =       0.000415490513
  error estimate for blocks of size 2^( 6) =       0.000419602414
  error estimate for blocks of size 2^( 7) =       0.000421615081

      target function =      -0.919726493472
              le_mean =     -17.210203218807
             les_mean =     296.476012343829
             stat err =       0.000416541534
             autocorr =       1.250637782165
   target nu stat err =       0.000416541534
   target dn stat err =       0.001912131571
      target stat err =       0.002570311684
              std dev =       0.526762058045
             le_variance =       0.277478265796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277545129297
                                         uncertainty =       0.001659588278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277545129297
                                         uncertainty =       0.001659588278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372471064
  error estimate for blocks of size 2^( 2) =       0.000386860508
  error estimate for blocks of size 2^( 3) =       0.000400040078
  error estimate for blocks of size 2^( 4) =       0.000409458126
  error estimate for blocks of size 2^( 5) =       0.000415490513
  error estimate for blocks of size 2^( 6) =       0.000419602414
  error estimate for blocks of size 2^( 7) =       0.000421615081

      target function =      -0.919726493472
              le_mean =     -17.210203218807
             les_mean =     296.476012343829
             stat err =       0.000416541534
             autocorr =       1.250637782160
   target nu stat err =       0.000416541534
   target dn stat err =       0.001912131571
      target stat err =       0.002570311684
              std dev =       0.526762058045
             le_variance =       0.277478265796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277545129297
                                         uncertainty =       0.001659588278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277545129297
                                         uncertainty =       0.001659588278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372471064
  error estimate for blocks of size 2^( 2) =       0.000386860508
  error estimate for blocks of size 2^( 3) =       0.000400040078
  error estimate for blocks of size 2^( 4) =       0.000409458126
  error estimate for blocks of size 2^( 5) =       0.000415490513
  error estimate for blocks of size 2^( 6) =       0.000419602414
  error estimate for blocks of size 2^( 7) =       0.000421615081

      target function =      -0.919726493472
              le_mean =     -17.210203218807
             les_mean =     296.476012343829
             stat err =       0.000416541534
             autocorr =       1.250637782165
   target nu stat err =       0.000416541534
   target dn stat err =       0.001912131571
      target stat err =       0.002570311684
              std dev =       0.526762058045
             le_variance =       0.277478265796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919726493472        initial  <--
     1.4901e+11     1.4901e+12             1.4940e-15        -0.919726493472
     5.9605e+11     5.9605e+12             2.4972e-16        -0.919726493472
     2.3842e+12     2.3842e+13             6.2430e-17        -0.919726493472

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8993
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5053e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2399
    reference variance = 0.334823
====================================================
  Execution time = 2.7370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0484e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8606e-01
  Total weights = 1.966437754e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1990e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276214007442
                                         uncertainty =       0.001680737206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276214007442
                                         uncertainty =       0.001680737206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371652770
  error estimate for blocks of size 2^( 2) =       0.000386201632
  error estimate for blocks of size 2^( 3) =       0.000399140955
  error estimate for blocks of size 2^( 4) =       0.000408607325
  error estimate for blocks of size 2^( 5) =       0.000413884119
  error estimate for blocks of size 2^( 6) =       0.000416081285
  error estimate for blocks of size 2^( 7) =       0.000419525999

      target function =      -0.918034275652
              le_mean =     -17.209471871145
             les_mean =     296.451979504844
             stat err =       0.000414524682
             autocorr =       1.244016213818
   target nu stat err =       0.000414524682
   target dn stat err =       0.002856625722
      target stat err =       0.003764792007
              std dev =       0.525604797572
             le_variance =       0.276260403231


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720947187115e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918048879800       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918048879800       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918048879800       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918048879800       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917978939706       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919458450207       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917391277739       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916828375858       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916944327215       residual = 5.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917143368742       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918837813427       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915685586259       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917238506047       residual = 7.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916993584143       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922827679592       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916687028767       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922988278373       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918140959501       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921328865163       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912987984901       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919853266674       residual = 7.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919358136195       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916063669054       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917254853810       residual = 8.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912003933147       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927551360144       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912256959262       residual = 4.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909767908893       residual = 8.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921122642457       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917988100959       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915487574882       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919823830563       residual = 9.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.901602632718       residual = 3.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.922053928639       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.927338456127       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911566111369       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.899544007483       residual = 4.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918299838096       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919549960589       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.907322569401       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.907606119231       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.920730344309       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.931617203544       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913521207520       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.922135274024       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.906488504675       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.925449404248       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.926401798393       residual = 2.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.920198944423       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.943568472127       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.945420055854       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.932740499878       residual = 4.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.931259776290       residual = 5.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.913130340296       residual = 4.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.909591261864       residual = 7.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.949208504251       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.938904911480       residual = 1.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.871752275107       residual = 3.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.906938473510       residual = 1.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.944924549799       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.892394316419       residual = 1.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.880301526719       residual = 3.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.931432660423       residual = 4.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.896082437308       residual = 3.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.906716195009       residual = 7.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.896903021182       residual = 1.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.809707839973       residual = 1.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.895875083916       residual = 1.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.980380524248       residual = 1.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.917839059131       residual = 5.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.971036665096       residual = 6.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.859244549034       residual = 4.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.858491471914       residual = 2.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.936049953120       residual = 4.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.027152340682       residual = 1.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.864345725888       residual = 1.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.862769126295       residual = 3.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.232288565516       residual = 1.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.030487338884       residual = 8.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.882787309184       residual = 3.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.542634019793       residual = 1.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.079185824028       residual = 3.79e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.617924662824       residual = 3.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.084221522340       residual = 4.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.541385424245       residual = 2.48e+01           smallest_sin_value = 9.99e-01
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.119532477546       residual = 9.49e+00           smallest_sin_value = 9.96e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+12 is 7.427069e-17

solving harmonic davidson linear method for identity shift 5.9605e+12, overlap shift 5.9605e+13 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918048879800       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918048879800       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.61e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918048879800       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918048879800       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.61e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.048774 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5822e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2
    reference variance = 0.166793
====================================================
  Execution time = 2.6969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8396e-01
  Total weights = 1.9665e+06
  Execution time = 2.3672e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276711829707
                                         uncertainty =       0.001555335908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276711829707
                                         uncertainty =       0.001555335908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371959950
  error estimate for blocks of size 2^( 2) =       0.000385931772
  error estimate for blocks of size 2^( 3) =       0.000398729003
  error estimate for blocks of size 2^( 4) =       0.000408934016
  error estimate for blocks of size 2^( 5) =       0.000414779941
  error estimate for blocks of size 2^( 6) =       0.000419593294
  error estimate for blocks of size 2^( 7) =       0.000422424970

      target function =      -0.920848676603
              le_mean =     -17.209709601228
             les_mean =     296.458063091870
             stat err =       0.000416433055
             autocorr =       1.253424068201
   target nu stat err =       0.000416433055
   target dn stat err =       0.001802544833
      target stat err =       0.002434915037
              std dev =       0.526039222133
             le_variance =       0.276717263222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276711829707
                                         uncertainty =       0.001555335908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276711829707
                                         uncertainty =       0.001555335908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371959950
  error estimate for blocks of size 2^( 2) =       0.000385931772
  error estimate for blocks of size 2^( 3) =       0.000398729003
  error estimate for blocks of size 2^( 4) =       0.000408934016
  error estimate for blocks of size 2^( 5) =       0.000414779941
  error estimate for blocks of size 2^( 6) =       0.000419593294
  error estimate for blocks of size 2^( 7) =       0.000422424970

      target function =      -0.920848676603
              le_mean =     -17.209709601228
             les_mean =     296.458063091870
             stat err =       0.000416433055
             autocorr =       1.253424068200
   target nu stat err =       0.000416433055
   target dn stat err =       0.001802544833
      target stat err =       0.002434915037
              std dev =       0.526039222133
             le_variance =       0.276717263222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276711829707
                                         uncertainty =       0.001555335908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276711829707
                                         uncertainty =       0.001555335908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371959950
  error estimate for blocks of size 2^( 2) =       0.000385931772
  error estimate for blocks of size 2^( 3) =       0.000398729003
  error estimate for blocks of size 2^( 4) =       0.000408934016
  error estimate for blocks of size 2^( 5) =       0.000414779941
  error estimate for blocks of size 2^( 6) =       0.000419593294
  error estimate for blocks of size 2^( 7) =       0.000422424970

      target function =      -0.920848676603
              le_mean =     -17.209709601228
             les_mean =     296.458063091870
             stat err =       0.000416433055
             autocorr =       1.253424068201
   target nu stat err =       0.000416433055
   target dn stat err =       0.001802544833
      target stat err =       0.002434915037
              std dev =       0.526039222133
             le_variance =       0.276717263222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276711829707
                                         uncertainty =       0.001555335908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276711829707
                                         uncertainty =       0.001555335908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371959950
  error estimate for blocks of size 2^( 2) =       0.000385931772
  error estimate for blocks of size 2^( 3) =       0.000398729003
  error estimate for blocks of size 2^( 4) =       0.000408934016
  error estimate for blocks of size 2^( 5) =       0.000414779941
  error estimate for blocks of size 2^( 6) =       0.000419593294
  error estimate for blocks of size 2^( 7) =       0.000422424970

      target function =      -0.920848676603
              le_mean =     -17.209709601228
             les_mean =     296.458063091870
             stat err =       0.000416433055
             autocorr =       1.253424068201
   target nu stat err =       0.000416433055
   target dn stat err =       0.001802544833
      target stat err =       0.002434915037
              std dev =       0.526039222133
             le_variance =       0.276717263222


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920848676603        initial  <--
     1.4901e+12     1.4901e+13             7.4271e-17        -0.920848676603
     5.9605e+12     5.9605e+13             0.0000e+00        -0.920848676603
     2.3842e+13     2.3842e+14             0.0000e+00        -0.920848676603

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8939
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4722e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2702
    reference variance = 0.278959
====================================================
  Execution time = 2.7660e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0495e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8835e-01
  Total weights = 1.966459953e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6562e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278282553437
                                         uncertainty =       0.001736357300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278282553437
                                         uncertainty =       0.001736357300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373002584
  error estimate for blocks of size 2^( 2) =       0.000387204688
  error estimate for blocks of size 2^( 3) =       0.000399622459
  error estimate for blocks of size 2^( 4) =       0.000409122127
  error estimate for blocks of size 2^( 5) =       0.000414177510
  error estimate for blocks of size 2^( 6) =       0.000416629037
  error estimate for blocks of size 2^( 7) =       0.000417711294

      target function =      -0.915140729897
              le_mean =     -17.209763264703
             les_mean =     296.464301587603
             stat err =       0.000414409992
             autocorr =       1.234345552224
   target nu stat err =       0.000414409992
   target dn stat err =       0.002337888564
      target stat err =       0.003081779855
              std dev =       0.527513753029
             le_variance =       0.278270759635


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720976326470e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+13, overlap shift 1.4901e+14 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915150261030       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915150261030       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915150261030       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915150261030       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915150252899       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915150028302       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914171260205       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912834054216       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914806265738       residual = 3.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909857714292       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919377636888       residual = 3.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915919291803       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909655961562       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.963289696760       residual = 3.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.956877882763       residual = 3.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935343115390       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921045799047       residual = 7.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.871058149885       residual = 2.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.900368436447       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914805128754       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.882289061972       residual = 3.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.852949187280       residual = 9.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938253890441       residual = 2.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.006820501767       residual = 1.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.848143694388       residual = 8.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932624853070       residual = 1.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.961877833727       residual = 5.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902966150007       residual = 9.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.991577597847       residual = 1.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.892601204683       residual = 2.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912065453216       residual = 7.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.891066867560       residual = 3.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.881986563177       residual = 6.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.830478045444       residual = 1.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.984677056725       residual = 1.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.073084127768       residual = 2.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.959619305130       residual = 9.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947982575871       residual = 4.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.665570401288       residual = 6.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.011370925572       residual = 2.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.634247365721       residual = 9.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.646301788899       residual = 8.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.883454379869       residual = 9.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.871225652994       residual = 1.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.981027359860       residual = 8.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.872537912366       residual = 1.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.946540920378       residual = 1.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -1.128927904303       residual = 1.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.586251966573       residual = 1.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.911729271811       residual = 1.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.927439486443       residual = 7.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.356237796122       residual = 2.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -1.006252272808       residual = 9.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.865642597784       residual = 2.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.757179485864       residual = 6.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.652985120445       residual = 9.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.686761407020       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.461054764849       residual = 4.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.575384671454       residual = 1.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.271937607729       residual = 5.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.906737420541       residual = 1.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =       0.072399414099       residual = 1.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.486693734810       residual = 1.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.459844779063       residual = 8.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.279523032415       residual = 4.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =       0.241360907663       residual = 1.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.753284473385       residual = 5.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.612501416355       residual = 4.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.187087289582       residual = 7.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.354958340526       residual = 4.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.632191344269       residual = 8.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -1.433989387626       residual = 1.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =       0.300926744211       residual = 2.84e+02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -1.541161954403       residual = 7.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.984569132328       residual = 2.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =       0.072282688263       residual = 1.15e+02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =       1.747685277835       residual = 1.09e+03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -2.318830164149       residual = 3.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.384835303659       residual = 2.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.457624754091       residual = 1.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =       0.324909037356       residual = 2.94e+02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -2.418642334727       residual = 1.25e+03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.774393022936       residual = 1.20e+03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -2.274249062281       residual = 1.59e+03           smallest_sin_value = 9.98e-01
davidson iteration   84 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         84 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+13 is 8.090680e-18

solving harmonic davidson linear method for identity shift 5.9605e+13, overlap shift 5.9605e+14 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915150261030       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915150261030       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915150261030       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915150261030       residual = 2.07e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915150261030       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951521061995       residual = 4.81e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915141222997       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915776809149       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.666559187193       residual = 6.53e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925324291514       residual = 1.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.811732157110       residual = 1.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932515778481       residual = 3.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910403799833       residual = 4.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.866410835093       residual = 5.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.787307645297       residual = 2.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.063038911337       residual = 2.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -1.392730538002       residual = 2.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -1.009021242417       residual = 6.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.815624295310       residual = 2.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.857803353786       residual = 2.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906052415894       residual = 2.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.965384601484       residual = 6.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.018009632688       residual = 3.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.876650603886       residual = 2.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.073629532688       residual = 1.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.876349686049       residual = 4.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.972589954485       residual = 4.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.771754613625       residual = 4.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.786819334891       residual = 5.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.900640993703       residual = 8.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943064431016       residual = 2.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.003413606453       residual = 2.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.680997223559       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.955518525004       residual = 6.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.692516173109       residual = 1.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.757711798410       residual = 1.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.022756866251       residual = 5.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.275599443443       residual = 2.87e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.572120901525       residual = 6.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.274945598668       residual = 5.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.819035944864       residual = 1.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.183859201171       residual = 2.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.588821885032       residual = 7.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.707123014067       residual = 1.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -2.039111105487       residual = 1.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.076379413128       residual = 1.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.929127936715       residual = 1.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.382339121959       residual = 1.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.959517868134       residual = 4.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -2.643424643663       residual = 4.73e+02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.158820823925       residual = 1.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -3.204609438678       residual = 6.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -1.847058346561       residual = 1.37e+02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.620599754577       residual = 1.67e+02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.317263226221       residual = 9.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =       0.907990543235       residual = 5.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.901815796940       residual = 6.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =       0.449649201706       residual = 2.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =       1.594336958602       residual = 8.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.695881927386       residual = 1.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.253351811277       residual = 2.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.349374846372       residual = 1.35e+02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.576187052433       residual = 2.73e+02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =       0.118414556069       residual = 5.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =       0.000233804691       residual = 5.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -2.412784298649       residual = 2.29e+03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =       0.751257209608       residual = 1.39e+03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.091509310143       residual = 1.62e+03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -5.574193317979       residual = 6.00e+03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -2.335448017061       residual = 9.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -3.800009256270       residual = 1.94e+03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.562619521542       residual = 2.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -3.195132163526       residual = 1.96e+03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =       1.065874263091       residual = 4.68e+03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.816956510767       residual = 2.43e+03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =       1.006739425814       residual = 1.88e+03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.245335882268       residual = 2.13e+03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.501107834480       residual = 8.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.298779867649       residual = 1.41e+03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.372093995149       residual = 6.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =       3.490756704643       residual = 5.10e+03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.007618253280       residual = 1.36e+03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -7.305122342145       residual = 1.11e+04           smallest_sin_value = 1.00e+00
davidson iteration   83 stopping due to too large eigenvalue change
davidson solver did not converge after         83 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+13 is 2.247607e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915150261030       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915150261030       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915150261030       residual = 2.07e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915150261029       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.691205614835       residual = 5.54e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -1.071891107883       residual = 2.60e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.733034741649       residual = 3.67e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.151532500476       residual = 2.19e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.279229233682       residual = 6.85e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -1.047487455592       residual = 1.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705136598379       residual = 1.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.536512259339       residual = 1.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.779418906712       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.217156041065       residual = 1.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.782132855241       residual = 1.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =       0.294319542271       residual = 1.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -1.719200983620       residual = 5.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =       0.028679966360       residual = 9.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.694912318771       residual = 1.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749141599884       residual = 4.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -2.288100162718       residual = 2.43e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.869511651729       residual = 3.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.333536237440       residual = 1.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.625218865093       residual = 6.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.268172344939       residual = 4.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.372507311327       residual = 6.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.224234895876       residual = 7.87e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.933443146300       residual = 1.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.866772815878       residual = 1.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.180525847278       residual = 8.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.175734384295       residual = 3.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       3.164657829286       residual = 2.46e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -2.913918974307       residual = 4.41e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.012084543302       residual = 2.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -3.085721149644       residual = 4.64e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -2.276538149173       residual = 3.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.213954524984       residual = 1.60e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -5.203200113907       residual = 1.85e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -5.024098307719       residual = 1.68e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       0.974367241168       residual = 4.75e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -3.813381828687       residual = 1.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =       0.680167967434       residual = 4.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.259128030160       residual = 3.43e+02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =       0.166884814148       residual = 5.94e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =       3.434155372169       residual = 2.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =       3.146337481862       residual = 1.83e+03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -3.033559214989       residual = 5.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -3.010167864005       residual = 7.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -2.751780103961       residual = 6.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =       4.177048347242       residual = 2.85e+03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.499723804866       residual = 1.14e+03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -4.186557387759       residual = 1.63e+03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.274262907216       residual = 1.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -2.259974349407       residual = 6.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -7.219970593811       residual = 4.99e+03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.174635024101       residual = 6.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =       0.948982712580       residual = 2.23e+03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -2.640188609948       residual = 2.38e+03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -3.311192194000       residual = 2.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -4.296125772409       residual = 1.72e+03           smallest_sin_value = 1.00e+00
davidson iteration   60 stopping due to too large eigenvalue change
davidson solver did not converge after         60 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+14 is 2.981770e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.568277 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6843e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2237
    reference variance = 0.230083
====================================================
  Execution time = 2.6875e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8701e-01
  Total weights = 1.9660e+06
  Execution time = 2.3467e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306912331
                                         uncertainty =       0.001694571796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306912331
                                         uncertainty =       0.001694571796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373030803
  error estimate for blocks of size 2^( 2) =       0.000387281268
  error estimate for blocks of size 2^( 3) =       0.000400033287
  error estimate for blocks of size 2^( 4) =       0.000409595861
  error estimate for blocks of size 2^( 5) =       0.000416519630
  error estimate for blocks of size 2^( 6) =       0.000419655340
  error estimate for blocks of size 2^( 7) =       0.000423330495

      target function =      -0.916773260163
              le_mean =     -17.209377603459
             les_mean =     296.449690618548
             stat err =       0.000417275332
             autocorr =       1.251284408847
   target nu stat err =       0.000417275332
   target dn stat err =       0.002156233267
      target stat err =       0.002860427065
              std dev =       0.527553660753
             le_variance =       0.278312864974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306912331
                                         uncertainty =       0.001694571796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306912331
                                         uncertainty =       0.001694571796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373030803
  error estimate for blocks of size 2^( 2) =       0.000387281268
  error estimate for blocks of size 2^( 3) =       0.000400033287
  error estimate for blocks of size 2^( 4) =       0.000409595861
  error estimate for blocks of size 2^( 5) =       0.000416519630
  error estimate for blocks of size 2^( 6) =       0.000419655340
  error estimate for blocks of size 2^( 7) =       0.000423330495

      target function =      -0.916773260163
              le_mean =     -17.209377603459
             les_mean =     296.449690618548
             stat err =       0.000417275332
             autocorr =       1.251284408850
   target nu stat err =       0.000417275332
   target dn stat err =       0.002156233267
      target stat err =       0.002860427065
              std dev =       0.527553660753
             le_variance =       0.278312864974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306912331
                                         uncertainty =       0.001694571796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306912331
                                         uncertainty =       0.001694571796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373030803
  error estimate for blocks of size 2^( 2) =       0.000387281268
  error estimate for blocks of size 2^( 3) =       0.000400033287
  error estimate for blocks of size 2^( 4) =       0.000409595861
  error estimate for blocks of size 2^( 5) =       0.000416519630
  error estimate for blocks of size 2^( 6) =       0.000419655340
  error estimate for blocks of size 2^( 7) =       0.000423330495

      target function =      -0.916773260163
              le_mean =     -17.209377603459
             les_mean =     296.449690618548
             stat err =       0.000417275332
             autocorr =       1.251284408850
   target nu stat err =       0.000417275332
   target dn stat err =       0.002156233267
      target stat err =       0.002860427065
              std dev =       0.527553660753
             le_variance =       0.278312864974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306912331
                                         uncertainty =       0.001694571796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306912331
                                         uncertainty =       0.001694571796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373030803
  error estimate for blocks of size 2^( 2) =       0.000387281268
  error estimate for blocks of size 2^( 3) =       0.000400033287
  error estimate for blocks of size 2^( 4) =       0.000409595861
  error estimate for blocks of size 2^( 5) =       0.000416519630
  error estimate for blocks of size 2^( 6) =       0.000419655340
  error estimate for blocks of size 2^( 7) =       0.000423330495

      target function =      -0.916773260163
              le_mean =     -17.209377603459
             les_mean =     296.449690618548
             stat err =       0.000417275332
             autocorr =       1.251284408849
   target nu stat err =       0.000417275332
   target dn stat err =       0.002156233267
      target stat err =       0.002860427065
              std dev =       0.527553660753
             le_variance =       0.278312864974


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916773260163        initial
     1.4901e+13     1.4901e+14             8.0907e-18        -0.916773260163
     5.9605e+13     5.9605e+14             2.2476e-18        -0.916773260163
     2.3842e+14     2.3842e+15             2.9818e-19        -0.916773260163  <--

*****************************************************************************
Applying the update for shift_i =   2.3842e+14     and shift_s =   2.3842e+15
*****************************************************************************

  Execution time = 3.8693e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5542e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1686
    reference variance = 0.189711
====================================================
  Execution time = 2.7497e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0506e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8357e-01
  Total weights = 1.966139239e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1384e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275367672048
                                         uncertainty =       0.001605509680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275367672048
                                         uncertainty =       0.001605509680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371040856
  error estimate for blocks of size 2^( 2) =       0.000385342820
  error estimate for blocks of size 2^( 3) =       0.000399008414
  error estimate for blocks of size 2^( 4) =       0.000408836235
  error estimate for blocks of size 2^( 5) =       0.000414238791
  error estimate for blocks of size 2^( 6) =       0.000416207430
  error estimate for blocks of size 2^( 7) =       0.000418473365

      target function =      -0.921364262788
              le_mean =     -17.209757979331
             les_mean =     296.459342893818
             stat err =       0.000414438955
             autocorr =       1.247606631968
   target nu stat err =       0.000414438955
   target dn stat err =       0.002180730678
      target stat err =       0.002920871576
              std dev =       0.524739406067
             le_variance =       0.275351444280


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720975797933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+13, overlap shift 5.9605e+14 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921372719392       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921372719392       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.16e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921372719392       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921372719392       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.16e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921372719392       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921372719392       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.16e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.569561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5644e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.3177
    reference variance = 0.148315
====================================================
  Execution time = 2.6911e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9047e-01
  Total weights = 1.9662e+06
  Execution time = 2.3434e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278815018118
                                         uncertainty =       0.001916932225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278815018118
                                         uncertainty =       0.001916932225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373451060
  error estimate for blocks of size 2^( 2) =       0.000387782312
  error estimate for blocks of size 2^( 3) =       0.000400677162
  error estimate for blocks of size 2^( 4) =       0.000410074626
  error estimate for blocks of size 2^( 5) =       0.000415379155
  error estimate for blocks of size 2^( 6) =       0.000418614197
  error estimate for blocks of size 2^( 7) =       0.000420815100

      target function =      -0.912446127460
              le_mean =     -17.209953255413
             les_mean =     296.472963025897
             stat err =       0.000416220769
             autocorr =       1.242167331031
   target nu stat err =       0.000416220769
   target dn stat err =       0.002874672393
      target stat err =       0.003745735323
              std dev =       0.528148003555
             le_variance =       0.278940313659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278815018118
                                         uncertainty =       0.001916932225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278815018118
                                         uncertainty =       0.001916932225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373451060
  error estimate for blocks of size 2^( 2) =       0.000387782312
  error estimate for blocks of size 2^( 3) =       0.000400677162
  error estimate for blocks of size 2^( 4) =       0.000410074626
  error estimate for blocks of size 2^( 5) =       0.000415379155
  error estimate for blocks of size 2^( 6) =       0.000418614197
  error estimate for blocks of size 2^( 7) =       0.000420815100

      target function =      -0.912446127460
              le_mean =     -17.209953255413
             les_mean =     296.472963025897
             stat err =       0.000416220769
             autocorr =       1.242167331031
   target nu stat err =       0.000416220769
   target dn stat err =       0.002874672393
      target stat err =       0.003745735323
              std dev =       0.528148003555
             le_variance =       0.278940313659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278815018118
                                         uncertainty =       0.001916932225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278815018118
                                         uncertainty =       0.001916932225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373451060
  error estimate for blocks of size 2^( 2) =       0.000387782312
  error estimate for blocks of size 2^( 3) =       0.000400677162
  error estimate for blocks of size 2^( 4) =       0.000410074626
  error estimate for blocks of size 2^( 5) =       0.000415379155
  error estimate for blocks of size 2^( 6) =       0.000418614197
  error estimate for blocks of size 2^( 7) =       0.000420815100

      target function =      -0.912446127460
              le_mean =     -17.209953255413
             les_mean =     296.472963025897
             stat err =       0.000416220769
             autocorr =       1.242167331031
   target nu stat err =       0.000416220769
   target dn stat err =       0.002874672393
      target stat err =       0.003745735323
              std dev =       0.528148003555
             le_variance =       0.278940313659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278815018118
                                         uncertainty =       0.001916932225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278815018118
                                         uncertainty =       0.001916932225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373451060
  error estimate for blocks of size 2^( 2) =       0.000387782312
  error estimate for blocks of size 2^( 3) =       0.000400677162
  error estimate for blocks of size 2^( 4) =       0.000410074626
  error estimate for blocks of size 2^( 5) =       0.000415379155
  error estimate for blocks of size 2^( 6) =       0.000418614197
  error estimate for blocks of size 2^( 7) =       0.000420815100

      target function =      -0.912446127460
              le_mean =     -17.209953255413
             les_mean =     296.472963025897
             stat err =       0.000416220769
             autocorr =       1.242167331031
   target nu stat err =       0.000416220769
   target dn stat err =       0.002874672393
      target stat err =       0.003745735323
              std dev =       0.528148003555
             le_variance =       0.278940313659


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912446127460        initial  <--
     5.9605e+13     5.9605e+14             0.0000e+00        -0.912446127460
     2.3842e+14     2.3842e+15             0.0000e+00        -0.912446127460
     9.5367e+14     9.5367e+15             0.0000e+00        -0.912446127460

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.7099
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4360e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1757
    reference variance = 0.221114
====================================================
  Execution time = 2.7178e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0499e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8824e-01
  Total weights = 1.966343237e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2636e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279297271739
                                         uncertainty =       0.002985758169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279297271739
                                         uncertainty =       0.002985758169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373705958
  error estimate for blocks of size 2^( 2) =       0.000388001883
  error estimate for blocks of size 2^( 3) =       0.000400974537
  error estimate for blocks of size 2^( 4) =       0.000410166054
  error estimate for blocks of size 2^( 5) =       0.000416802282
  error estimate for blocks of size 2^( 6) =       0.000419756754
  error estimate for blocks of size 2^( 7) =       0.000420882713

      target function =      -0.915222608646
              le_mean =     -17.209568593191
             les_mean =     296.457491375544
             stat err =       0.000416901951
             autocorr =       1.244536991933
   target nu stat err =       0.000416901951
   target dn stat err =       0.003228793361
      target stat err =       0.004219406413
              std dev =       0.528508490502
             le_variance =       0.279321224533


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720956859319e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+14, overlap shift 5.9605e+15 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915241443643       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915241443643       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915241443643       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915241443643       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915241443643       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915241443643       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.570822 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5451e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2351
    reference variance = 0.24229
====================================================
  Execution time = 2.7266e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8855e-01
  Total weights = 1.9663e+06
  Execution time = 2.3493e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278375176524
                                         uncertainty =       0.001677221852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278375176524
                                         uncertainty =       0.001677221852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373070353
  error estimate for blocks of size 2^( 2) =       0.000387095224
  error estimate for blocks of size 2^( 3) =       0.000399869643
  error estimate for blocks of size 2^( 4) =       0.000409712143
  error estimate for blocks of size 2^( 5) =       0.000414669826
  error estimate for blocks of size 2^( 6) =       0.000416979565
  error estimate for blocks of size 2^( 7) =       0.000418714415

      target function =      -0.914904512292
              le_mean =     -17.209840681421
             les_mean =     296.467162955987
             stat err =       0.000415018987
             autocorr =       1.237526350834
   target nu stat err =       0.000415018987
   target dn stat err =       0.002531065674
      target stat err =       0.003326420741
              std dev =       0.527609594962
             le_variance =       0.278371884696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278375176524
                                         uncertainty =       0.001677221852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278375176524
                                         uncertainty =       0.001677221852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373070353
  error estimate for blocks of size 2^( 2) =       0.000387095224
  error estimate for blocks of size 2^( 3) =       0.000399869643
  error estimate for blocks of size 2^( 4) =       0.000409712143
  error estimate for blocks of size 2^( 5) =       0.000414669826
  error estimate for blocks of size 2^( 6) =       0.000416979565
  error estimate for blocks of size 2^( 7) =       0.000418714415

      target function =      -0.914904512292
              le_mean =     -17.209840681421
             les_mean =     296.467162955987
             stat err =       0.000415018987
             autocorr =       1.237526350834
   target nu stat err =       0.000415018987
   target dn stat err =       0.002531065674
      target stat err =       0.003326420741
              std dev =       0.527609594962
             le_variance =       0.278371884696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278375176524
                                         uncertainty =       0.001677221852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278375176524
                                         uncertainty =       0.001677221852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373070353
  error estimate for blocks of size 2^( 2) =       0.000387095224
  error estimate for blocks of size 2^( 3) =       0.000399869643
  error estimate for blocks of size 2^( 4) =       0.000409712143
  error estimate for blocks of size 2^( 5) =       0.000414669826
  error estimate for blocks of size 2^( 6) =       0.000416979565
  error estimate for blocks of size 2^( 7) =       0.000418714415

      target function =      -0.914904512292
              le_mean =     -17.209840681421
             les_mean =     296.467162955987
             stat err =       0.000415018987
             autocorr =       1.237526350834
   target nu stat err =       0.000415018987
   target dn stat err =       0.002531065674
      target stat err =       0.003326420741
              std dev =       0.527609594962
             le_variance =       0.278371884696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278375176524
                                         uncertainty =       0.001677221852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278375176524
                                         uncertainty =       0.001677221852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373070353
  error estimate for blocks of size 2^( 2) =       0.000387095224
  error estimate for blocks of size 2^( 3) =       0.000399869643
  error estimate for blocks of size 2^( 4) =       0.000409712143
  error estimate for blocks of size 2^( 5) =       0.000414669826
  error estimate for blocks of size 2^( 6) =       0.000416979565
  error estimate for blocks of size 2^( 7) =       0.000418714415

      target function =      -0.914904512292
              le_mean =     -17.209840681421
             les_mean =     296.467162955987
             stat err =       0.000415018987
             autocorr =       1.237526350834
   target nu stat err =       0.000415018987
   target dn stat err =       0.002531065674
      target stat err =       0.003326420741
              std dev =       0.527609594962
             le_variance =       0.278371884696


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914904512292        initial  <--
     5.9605e+14     5.9605e+15             0.0000e+00        -0.914904512292
     2.3842e+15     2.3842e+16             0.0000e+00        -0.914904512292
     9.5367e+15     9.5367e+16             0.0000e+00        -0.914904512292

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0839
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4542e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2569
    reference variance = 0.353943
====================================================
  Execution time = 2.7250e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0480e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8541e-01
  Total weights = 1.966060898e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2354e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275562999245
                                         uncertainty =       0.001696838340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275562999245
                                         uncertainty =       0.001696838340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371166139
  error estimate for blocks of size 2^( 2) =       0.000385634342
  error estimate for blocks of size 2^( 3) =       0.000399098319
  error estimate for blocks of size 2^( 4) =       0.000408522348
  error estimate for blocks of size 2^( 5) =       0.000414555778
  error estimate for blocks of size 2^( 6) =       0.000418062432
  error estimate for blocks of size 2^( 7) =       0.000422164176

      target function =      -0.919061312404
              le_mean =     -17.210147227345
             les_mean =     296.474579426416
             stat err =       0.000415826183
             autocorr =       1.255124959516
   target nu stat err =       0.000415826183
   target dn stat err =       0.002411490984
      target stat err =       0.003204420275
              std dev =       0.524916585848
             le_variance =       0.275537422099


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721014722735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+15, overlap shift 5.9605e+16 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919071649150       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919071649150       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.46e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919071649150       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919071649150       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919071649150       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919071649150       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.572099 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5494e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2434
    reference variance = 0.228911
====================================================
  Execution time = 2.6842e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8609e-01
  Total weights = 1.9665e+06
  Execution time = 2.3426e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277577361143
                                         uncertainty =       0.001540781855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277577361143
                                         uncertainty =       0.001540781855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372526989
  error estimate for blocks of size 2^( 2) =       0.000386970796
  error estimate for blocks of size 2^( 3) =       0.000400118903
  error estimate for blocks of size 2^( 4) =       0.000409710966
  error estimate for blocks of size 2^( 5) =       0.000415661555
  error estimate for blocks of size 2^( 6) =       0.000417696396
  error estimate for blocks of size 2^( 7) =       0.000420076488

      target function =      -0.917835240871
              le_mean =     -17.208890060300
             les_mean =     296.431992079080
             stat err =       0.000415786351
             autocorr =       1.245733012566
   target nu stat err =       0.000415786351
   target dn stat err =       0.002231407449
      target stat err =       0.002960034746
              std dev =       0.526841149324
             le_variance =       0.277561596621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277577361143
                                         uncertainty =       0.001540781855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277577361143
                                         uncertainty =       0.001540781855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372526989
  error estimate for blocks of size 2^( 2) =       0.000386970796
  error estimate for blocks of size 2^( 3) =       0.000400118903
  error estimate for blocks of size 2^( 4) =       0.000409710966
  error estimate for blocks of size 2^( 5) =       0.000415661555
  error estimate for blocks of size 2^( 6) =       0.000417696396
  error estimate for blocks of size 2^( 7) =       0.000420076488

      target function =      -0.917835240871
              le_mean =     -17.208890060300
             les_mean =     296.431992079080
             stat err =       0.000415786351
             autocorr =       1.245733012566
   target nu stat err =       0.000415786351
   target dn stat err =       0.002231407449
      target stat err =       0.002960034746
              std dev =       0.526841149324
             le_variance =       0.277561596621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277577361143
                                         uncertainty =       0.001540781855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277577361143
                                         uncertainty =       0.001540781855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372526989
  error estimate for blocks of size 2^( 2) =       0.000386970796
  error estimate for blocks of size 2^( 3) =       0.000400118903
  error estimate for blocks of size 2^( 4) =       0.000409710966
  error estimate for blocks of size 2^( 5) =       0.000415661555
  error estimate for blocks of size 2^( 6) =       0.000417696396
  error estimate for blocks of size 2^( 7) =       0.000420076488

      target function =      -0.917835240871
              le_mean =     -17.208890060300
             les_mean =     296.431992079080
             stat err =       0.000415786351
             autocorr =       1.245733012566
   target nu stat err =       0.000415786351
   target dn stat err =       0.002231407449
      target stat err =       0.002960034746
              std dev =       0.526841149324
             le_variance =       0.277561596621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277577361143
                                         uncertainty =       0.001540781855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277577361143
                                         uncertainty =       0.001540781855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372526989
  error estimate for blocks of size 2^( 2) =       0.000386970796
  error estimate for blocks of size 2^( 3) =       0.000400118903
  error estimate for blocks of size 2^( 4) =       0.000409710966
  error estimate for blocks of size 2^( 5) =       0.000415661555
  error estimate for blocks of size 2^( 6) =       0.000417696396
  error estimate for blocks of size 2^( 7) =       0.000420076488

      target function =      -0.917835240871
              le_mean =     -17.208890060300
             les_mean =     296.431992079080
             stat err =       0.000415786351
             autocorr =       1.245733012566
   target nu stat err =       0.000415786351
   target dn stat err =       0.002231407449
      target stat err =       0.002960034746
              std dev =       0.526841149324
             le_variance =       0.277561596621


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917835240871        initial  <--
     5.9605e+15     5.9605e+16             0.0000e+00        -0.917835240871
     2.3842e+16     2.3842e+17             0.0000e+00        -0.917835240871
     9.5367e+16     9.5367e+17             0.0000e+00        -0.917835240871

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.6923
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4193e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1668
    reference variance = 0.153885
====================================================
  Execution time = 2.7219e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0501e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8862e-01
  Total weights = 1.966369611e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7235e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277387331581
                                         uncertainty =       0.001847911801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277387331581
                                         uncertainty =       0.001847911801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372396820
  error estimate for blocks of size 2^( 2) =       0.000386770903
  error estimate for blocks of size 2^( 3) =       0.000399635594
  error estimate for blocks of size 2^( 4) =       0.000409704073
  error estimate for blocks of size 2^( 5) =       0.000415408459
  error estimate for blocks of size 2^( 6) =       0.000419324661
  error estimate for blocks of size 2^( 7) =       0.000419828150

      target function =      -0.914700820488
              le_mean =     -17.209431342879
             les_mean =     296.453145076949
             stat err =       0.000416066336
             autocorr =       1.248283498831
   target nu stat err =       0.000416066336
   target dn stat err =       0.003026580157
      target stat err =       0.003954989140
              std dev =       0.526657059335
             le_variance =       0.277367658147


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720943134288e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+16, overlap shift 5.9605e+17 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914717164768       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914717164768       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914717164768       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914717164768       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914717164768       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914717164768       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.573342 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5951e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1289
    reference variance = 0.342801
====================================================
  Execution time = 2.6643e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8643e-01
  Total weights = 1.9662e+06
  Execution time = 2.4142e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275465220710
                                         uncertainty =       0.001969678281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275465220710
                                         uncertainty =       0.001969678281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371072089
  error estimate for blocks of size 2^( 2) =       0.000385271502
  error estimate for blocks of size 2^( 3) =       0.000397886136
  error estimate for blocks of size 2^( 4) =       0.000408005826
  error estimate for blocks of size 2^( 5) =       0.000413480039
  error estimate for blocks of size 2^( 6) =       0.000417056805
  error estimate for blocks of size 2^( 7) =       0.000418884965

      target function =      -0.917594694843
              le_mean =     -17.209621149608
             les_mean =     296.457485137167
             stat err =       0.000414356909
             autocorr =       1.246902772901
   target nu stat err =       0.000414356909
   target dn stat err =       0.002959567383
      target stat err =       0.003894387370
              std dev =       0.524783576934
             le_variance =       0.275397802619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275465220710
                                         uncertainty =       0.001969678281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275465220710
                                         uncertainty =       0.001969678281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371072089
  error estimate for blocks of size 2^( 2) =       0.000385271502
  error estimate for blocks of size 2^( 3) =       0.000397886136
  error estimate for blocks of size 2^( 4) =       0.000408005826
  error estimate for blocks of size 2^( 5) =       0.000413480039
  error estimate for blocks of size 2^( 6) =       0.000417056805
  error estimate for blocks of size 2^( 7) =       0.000418884965

      target function =      -0.917594694843
              le_mean =     -17.209621149608
             les_mean =     296.457485137167
             stat err =       0.000414356909
             autocorr =       1.246902772902
   target nu stat err =       0.000414356909
   target dn stat err =       0.002959567383
      target stat err =       0.003894387370
              std dev =       0.524783576934
             le_variance =       0.275397802619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275465220710
                                         uncertainty =       0.001969678281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275465220710
                                         uncertainty =       0.001969678281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371072089
  error estimate for blocks of size 2^( 2) =       0.000385271502
  error estimate for blocks of size 2^( 3) =       0.000397886136
  error estimate for blocks of size 2^( 4) =       0.000408005826
  error estimate for blocks of size 2^( 5) =       0.000413480039
  error estimate for blocks of size 2^( 6) =       0.000417056805
  error estimate for blocks of size 2^( 7) =       0.000418884965

      target function =      -0.917594694843
              le_mean =     -17.209621149608
             les_mean =     296.457485137167
             stat err =       0.000414356909
             autocorr =       1.246902772902
   target nu stat err =       0.000414356909
   target dn stat err =       0.002959567383
      target stat err =       0.003894387370
              std dev =       0.524783576934
             le_variance =       0.275397802619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275465220710
                                         uncertainty =       0.001969678281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275465220710
                                         uncertainty =       0.001969678281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371072089
  error estimate for blocks of size 2^( 2) =       0.000385271502
  error estimate for blocks of size 2^( 3) =       0.000397886136
  error estimate for blocks of size 2^( 4) =       0.000408005826
  error estimate for blocks of size 2^( 5) =       0.000413480039
  error estimate for blocks of size 2^( 6) =       0.000417056805
  error estimate for blocks of size 2^( 7) =       0.000418884965

      target function =      -0.917594694843
              le_mean =     -17.209621149608
             les_mean =     296.457485137167
             stat err =       0.000414356909
             autocorr =       1.246902772902
   target nu stat err =       0.000414356909
   target dn stat err =       0.002959567383
      target stat err =       0.003894387370
              std dev =       0.524783576934
             le_variance =       0.275397802619


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917594694843        initial  <--
     5.9605e+16     5.9605e+17             0.0000e+00        -0.917594694843
     2.3842e+17     2.3842e+18             0.0000e+00        -0.917594694843
     9.5367e+17     9.5367e+18             0.0000e+00        -0.917594694843

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8749
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4832e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.185
    reference variance = 0.315561
====================================================
  Execution time = 2.7110e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0474e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8603e-01
  Total weights = 1.966303480e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2668e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277012684076
                                         uncertainty =       0.001726028458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277012684076
                                         uncertainty =       0.001726028458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372124933
  error estimate for blocks of size 2^( 2) =       0.000386360074
  error estimate for blocks of size 2^( 3) =       0.000399250621
  error estimate for blocks of size 2^( 4) =       0.000408876945
  error estimate for blocks of size 2^( 5) =       0.000414535437
  error estimate for blocks of size 2^( 6) =       0.000417560119
  error estimate for blocks of size 2^( 7) =       0.000421848373

      target function =      -0.918398093174
              le_mean =     -17.210657944147
             les_mean =     296.492771948019
             stat err =       0.000415705218
             autocorr =       1.247939163503
   target nu stat err =       0.000415705218
   target dn stat err =       0.002302914104
      target stat err =       0.003063201910
              std dev =       0.526272547022
             le_variance =       0.276962793749


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721065794415e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+17, overlap shift 5.9605e+18 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918407398571       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918407398571       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918407398571       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918407398571       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918407398571       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918407398571       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.574612 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5386e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.1073
    reference variance = 0.250242
====================================================
  Execution time = 2.7206e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8357e-01
  Total weights = 1.9664e+06
  Execution time = 2.4171e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275114995638
                                         uncertainty =       0.001274388448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275114995638
                                         uncertainty =       0.001274388448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370924264
  error estimate for blocks of size 2^( 2) =       0.000385093327
  error estimate for blocks of size 2^( 3) =       0.000398003802
  error estimate for blocks of size 2^( 4) =       0.000407769815
  error estimate for blocks of size 2^( 5) =       0.000413828285
  error estimate for blocks of size 2^( 6) =       0.000418256870
  error estimate for blocks of size 2^( 7) =       0.000419161455

      target function =      -0.921577236565
              le_mean =     -17.210523746522
             les_mean =     296.485696312337
             stat err =       0.000414754106
             autocorr =       1.250290413893
   target nu stat err =       0.000414754106
   target dn stat err =       0.002447009528
      target stat err =       0.003269175939
              std dev =       0.524574517434
             le_variance =       0.275178424342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275114995638
                                         uncertainty =       0.001274388448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275114995638
                                         uncertainty =       0.001274388448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370924264
  error estimate for blocks of size 2^( 2) =       0.000385093327
  error estimate for blocks of size 2^( 3) =       0.000398003802
  error estimate for blocks of size 2^( 4) =       0.000407769815
  error estimate for blocks of size 2^( 5) =       0.000413828285
  error estimate for blocks of size 2^( 6) =       0.000418256870
  error estimate for blocks of size 2^( 7) =       0.000419161455

      target function =      -0.921577236565
              le_mean =     -17.210523746522
             les_mean =     296.485696312337
             stat err =       0.000414754106
             autocorr =       1.250290413893
   target nu stat err =       0.000414754106
   target dn stat err =       0.002447009528
      target stat err =       0.003269175939
              std dev =       0.524574517434
             le_variance =       0.275178424342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275114995638
                                         uncertainty =       0.001274388448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275114995638
                                         uncertainty =       0.001274388448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370924264
  error estimate for blocks of size 2^( 2) =       0.000385093327
  error estimate for blocks of size 2^( 3) =       0.000398003802
  error estimate for blocks of size 2^( 4) =       0.000407769815
  error estimate for blocks of size 2^( 5) =       0.000413828285
  error estimate for blocks of size 2^( 6) =       0.000418256870
  error estimate for blocks of size 2^( 7) =       0.000419161455

      target function =      -0.921577236565
              le_mean =     -17.210523746522
             les_mean =     296.485696312337
             stat err =       0.000414754106
             autocorr =       1.250290413893
   target nu stat err =       0.000414754106
   target dn stat err =       0.002447009528
      target stat err =       0.003269175939
              std dev =       0.524574517434
             le_variance =       0.275178424342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275114995638
                                         uncertainty =       0.001274388448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275114995638
                                         uncertainty =       0.001274388448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370924264
  error estimate for blocks of size 2^( 2) =       0.000385093327
  error estimate for blocks of size 2^( 3) =       0.000398003802
  error estimate for blocks of size 2^( 4) =       0.000407769815
  error estimate for blocks of size 2^( 5) =       0.000413828285
  error estimate for blocks of size 2^( 6) =       0.000418256870
  error estimate for blocks of size 2^( 7) =       0.000419161455

      target function =      -0.921577236565
              le_mean =     -17.210523746522
             les_mean =     296.485696312337
             stat err =       0.000414754106
             autocorr =       1.250290413893
   target nu stat err =       0.000414754106
   target dn stat err =       0.002447009528
      target stat err =       0.003269175939
              std dev =       0.524574517434
             le_variance =       0.275178424342


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921577236565        initial  <--
     5.9605e+17     5.9605e+18             0.0000e+00        -0.921577236565
     2.3842e+18     2.3842e+19             0.0000e+00        -0.921577236565
     9.5367e+18     9.5367e+19             0.0000e+00        -0.921577236565

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.4557
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4848e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2771
    reference variance = 0.175684
====================================================
  Execution time = 2.7023e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0473e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8432e-01
  Total weights = 1.966385575e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3445e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274387154719
                                         uncertainty =       0.001465873640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274387154719
                                         uncertainty =       0.001465873640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370346284
  error estimate for blocks of size 2^( 2) =       0.000384763577
  error estimate for blocks of size 2^( 3) =       0.000397736681
  error estimate for blocks of size 2^( 4) =       0.000407411613
  error estimate for blocks of size 2^( 5) =       0.000413555839
  error estimate for blocks of size 2^( 6) =       0.000415369810
  error estimate for blocks of size 2^( 7) =       0.000415048740

      target function =      -0.920319333021
              le_mean =     -17.209505871350
             les_mean =     296.451409164662
             stat err =       0.000412846501
             autocorr =       1.242685507944
   target nu stat err =       0.000412846501
   target dn stat err =       0.002497008683
      target stat err =       0.003319148253
              std dev =       0.523757116872
             le_variance =       0.274321517474


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720950587135e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+18, overlap shift 5.9605e+19 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920329609884       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920329609884       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+19, overlap shift 2.3842e+20 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920329609884       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920329609884       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920329609884       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920329609884       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.575876 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5376e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.1283
    reference variance = 0.226701
====================================================
  Execution time = 2.7096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8212e-01
  Total weights = 1.9662e+06
  Execution time = 2.4211e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275122058375
                                         uncertainty =       0.001685028870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275122058375
                                         uncertainty =       0.001685028870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370859688
  error estimate for blocks of size 2^( 2) =       0.000384969922
  error estimate for blocks of size 2^( 3) =       0.000398094726
  error estimate for blocks of size 2^( 4) =       0.000408277530
  error estimate for blocks of size 2^( 5) =       0.000413954724
  error estimate for blocks of size 2^( 6) =       0.000417435544
  error estimate for blocks of size 2^( 7) =       0.000419765697

      target function =      -0.923140337141
              le_mean =     -17.209278955478
             les_mean =     296.441403873965
             stat err =       0.000414858373
             autocorr =       1.251354801970
   target nu stat err =       0.000414858373
   target dn stat err =       0.001988346022
      target stat err =       0.002682403635
              std dev =       0.524483191355
             le_variance =       0.275082618014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275122058375
                                         uncertainty =       0.001685028870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275122058375
                                         uncertainty =       0.001685028870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370859688
  error estimate for blocks of size 2^( 2) =       0.000384969922
  error estimate for blocks of size 2^( 3) =       0.000398094726
  error estimate for blocks of size 2^( 4) =       0.000408277530
  error estimate for blocks of size 2^( 5) =       0.000413954724
  error estimate for blocks of size 2^( 6) =       0.000417435544
  error estimate for blocks of size 2^( 7) =       0.000419765697

      target function =      -0.923140337141
              le_mean =     -17.209278955478
             les_mean =     296.441403873965
             stat err =       0.000414858373
             autocorr =       1.251354801970
   target nu stat err =       0.000414858373
   target dn stat err =       0.001988346022
      target stat err =       0.002682403635
              std dev =       0.524483191355
             le_variance =       0.275082618014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275122058375
                                         uncertainty =       0.001685028870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275122058375
                                         uncertainty =       0.001685028870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370859688
  error estimate for blocks of size 2^( 2) =       0.000384969922
  error estimate for blocks of size 2^( 3) =       0.000398094726
  error estimate for blocks of size 2^( 4) =       0.000408277530
  error estimate for blocks of size 2^( 5) =       0.000413954724
  error estimate for blocks of size 2^( 6) =       0.000417435544
  error estimate for blocks of size 2^( 7) =       0.000419765697

      target function =      -0.923140337141
              le_mean =     -17.209278955478
             les_mean =     296.441403873965
             stat err =       0.000414858373
             autocorr =       1.251354801970
   target nu stat err =       0.000414858373
   target dn stat err =       0.001988346022
      target stat err =       0.002682403635
              std dev =       0.524483191355
             le_variance =       0.275082618014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275122058375
                                         uncertainty =       0.001685028870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275122058375
                                         uncertainty =       0.001685028870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370859688
  error estimate for blocks of size 2^( 2) =       0.000384969922
  error estimate for blocks of size 2^( 3) =       0.000398094726
  error estimate for blocks of size 2^( 4) =       0.000408277530
  error estimate for blocks of size 2^( 5) =       0.000413954724
  error estimate for blocks of size 2^( 6) =       0.000417435544
  error estimate for blocks of size 2^( 7) =       0.000419765697

      target function =      -0.923140337141
              le_mean =     -17.209278955478
             les_mean =     296.441403873965
             stat err =       0.000414858373
             autocorr =       1.251354801970
   target nu stat err =       0.000414858373
   target dn stat err =       0.001988346022
      target stat err =       0.002682403635
              std dev =       0.524483191355
             le_variance =       0.275082618014


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923140337141        initial  <--
     5.9605e+18     5.9605e+19             0.0000e+00        -0.923140337141
     2.3842e+19     2.3842e+20             0.0000e+00        -0.923140337141
     9.5367e+19     9.5367e+20             0.0000e+00        -0.923140337141

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.3527
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4735e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.0937
    reference variance = 0.381895
====================================================
  Execution time = 2.7089e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0481e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9246e-01
  Total weights = 1.966006780e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1282e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277623567637
                                         uncertainty =       0.001563075762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277623567637
                                         uncertainty =       0.001563075762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372545009
  error estimate for blocks of size 2^( 2) =       0.000387190472
  error estimate for blocks of size 2^( 3) =       0.000400296710
  error estimate for blocks of size 2^( 4) =       0.000410030926
  error estimate for blocks of size 2^( 5) =       0.000415831924
  error estimate for blocks of size 2^( 6) =       0.000419093487
  error estimate for blocks of size 2^( 7) =       0.000419417700

      target function =      -0.909813255558
              le_mean =     -17.209700174666
             les_mean =     296.466237675598
             stat err =       0.000416093509
             autocorr =       1.247453551465
   target nu stat err =       0.000416093509
   target dn stat err =       0.004492988374
      target stat err =       0.005776339876
              std dev =       0.526866633613
             le_variance =       0.277588449614


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720970017467e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+19, overlap shift 5.9605e+20 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909849330083       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909849330083       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909849330083       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+19 is 2.439688e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+20, overlap shift 2.3842e+21 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909849330083       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909849330083       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909849330083       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+20 is 6.552200e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909849330083       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909849330083       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909849330083       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+20 is 1.638050e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.577486 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5226e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2397
    reference variance = 0.263015
====================================================
  Execution time = 2.6647e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8558e-01
  Total weights = 1.9664e+06
  Execution time = 2.4166e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276749195360
                                         uncertainty =       0.002114763340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276749195360
                                         uncertainty =       0.002114763340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371954957
  error estimate for blocks of size 2^( 2) =       0.000386292571
  error estimate for blocks of size 2^( 3) =       0.000399577346
  error estimate for blocks of size 2^( 4) =       0.000408958832
  error estimate for blocks of size 2^( 5) =       0.000414038316
  error estimate for blocks of size 2^( 6) =       0.000415989902
  error estimate for blocks of size 2^( 7) =       0.000416878046

      target function =      -0.918509393657
              le_mean =     -17.208963559962
             les_mean =     296.434010554986
             stat err =       0.000413966274
             autocorr =       1.238651743932
   target nu stat err =       0.000413966274
   target dn stat err =       0.003304909609
      target stat err =       0.004343108152
              std dev =       0.526032161566
             le_variance =       0.276709835002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276749195360
                                         uncertainty =       0.002114763340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276749195360
                                         uncertainty =       0.002114763340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371954957
  error estimate for blocks of size 2^( 2) =       0.000386292571
  error estimate for blocks of size 2^( 3) =       0.000399577346
  error estimate for blocks of size 2^( 4) =       0.000408958832
  error estimate for blocks of size 2^( 5) =       0.000414038316
  error estimate for blocks of size 2^( 6) =       0.000415989902
  error estimate for blocks of size 2^( 7) =       0.000416878046

      target function =      -0.918509393657
              le_mean =     -17.208963559962
             les_mean =     296.434010554986
             stat err =       0.000413966274
             autocorr =       1.238651743932
   target nu stat err =       0.000413966274
   target dn stat err =       0.003304909609
      target stat err =       0.004343108152
              std dev =       0.526032161566
             le_variance =       0.276709835002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276749195360
                                         uncertainty =       0.002114763340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276749195360
                                         uncertainty =       0.002114763340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371954957
  error estimate for blocks of size 2^( 2) =       0.000386292571
  error estimate for blocks of size 2^( 3) =       0.000399577346
  error estimate for blocks of size 2^( 4) =       0.000408958832
  error estimate for blocks of size 2^( 5) =       0.000414038316
  error estimate for blocks of size 2^( 6) =       0.000415989902
  error estimate for blocks of size 2^( 7) =       0.000416878046

      target function =      -0.918509393657
              le_mean =     -17.208963559962
             les_mean =     296.434010554986
             stat err =       0.000413966274
             autocorr =       1.238651743932
   target nu stat err =       0.000413966274
   target dn stat err =       0.003304909609
      target stat err =       0.004343108152
              std dev =       0.526032161566
             le_variance =       0.276709835002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276749195360
                                         uncertainty =       0.002114763340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276749195360
                                         uncertainty =       0.002114763340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371954957
  error estimate for blocks of size 2^( 2) =       0.000386292571
  error estimate for blocks of size 2^( 3) =       0.000399577346
  error estimate for blocks of size 2^( 4) =       0.000408958832
  error estimate for blocks of size 2^( 5) =       0.000414038316
  error estimate for blocks of size 2^( 6) =       0.000415989902
  error estimate for blocks of size 2^( 7) =       0.000416878046

      target function =      -0.918509393657
              le_mean =     -17.208963559962
             les_mean =     296.434010554986
             stat err =       0.000413966274
             autocorr =       1.238651743932
   target nu stat err =       0.000413966274
   target dn stat err =       0.003304909609
      target stat err =       0.004343108152
              std dev =       0.526032161566
             le_variance =       0.276709835002


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918509393657        initial  <--
     5.9605e+19     5.9605e+20             2.4397e-24        -0.918509393657
     2.3842e+20     2.3842e+21             6.5522e-25        -0.918509393657
     9.5367e+20     9.5367e+21             1.6381e-25        -0.918509393657

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8877
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4120e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2807
    reference variance = 0.181845
====================================================
  Execution time = 2.7066e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0477e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8560e-01
  Total weights = 1.966116006e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0992e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276497666532
                                         uncertainty =       0.002086745395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276497666532
                                         uncertainty =       0.002086745395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371759396
  error estimate for blocks of size 2^( 2) =       0.000385902109
  error estimate for blocks of size 2^( 3) =       0.000399318650
  error estimate for blocks of size 2^( 4) =       0.000409254913
  error estimate for blocks of size 2^( 5) =       0.000414665568
  error estimate for blocks of size 2^( 6) =       0.000419040543
  error estimate for blocks of size 2^( 7) =       0.000420988775

      target function =      -0.918720905132
              le_mean =     -17.209774989954
             les_mean =     296.461950385754
             stat err =       0.000415987450
             autocorr =       1.252092886035
   target nu stat err =       0.000415987450
   target dn stat err =       0.002528783864
      target stat err =       0.003350769400
              std dev =       0.525755592195
             le_variance =       0.276418942724


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720977498995e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+20, overlap shift 5.9605e+21 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918732450699       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918732450699       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+21, overlap shift 2.3842e+22 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918732450699       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918732450699       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918732450699       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918732450699       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.578724 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6431e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2687
    reference variance = 0.450917
====================================================
  Execution time = 2.6905e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8501e-01
  Total weights = 1.9666e+06
  Execution time = 2.4126e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276431621342
                                         uncertainty =       0.001541697432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276431621342
                                         uncertainty =       0.001541697432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371751464
  error estimate for blocks of size 2^( 2) =       0.000385725159
  error estimate for blocks of size 2^( 3) =       0.000398563699
  error estimate for blocks of size 2^( 4) =       0.000408250508
  error estimate for blocks of size 2^( 5) =       0.000413632981
  error estimate for blocks of size 2^( 6) =       0.000416725036
  error estimate for blocks of size 2^( 7) =       0.000418660737

      target function =      -0.919595796654
              le_mean =     -17.210186844449
             les_mean =     296.475542794144
             stat err =       0.000414317316
             autocorr =       1.242112104265
   target nu stat err =       0.000414317316
   target dn stat err =       0.002309600570
      target stat err =       0.003077013438
              std dev =       0.525744373787
             le_variance =       0.276407146569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276431621342
                                         uncertainty =       0.001541697432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276431621342
                                         uncertainty =       0.001541697432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371751464
  error estimate for blocks of size 2^( 2) =       0.000385725159
  error estimate for blocks of size 2^( 3) =       0.000398563699
  error estimate for blocks of size 2^( 4) =       0.000408250508
  error estimate for blocks of size 2^( 5) =       0.000413632981
  error estimate for blocks of size 2^( 6) =       0.000416725036
  error estimate for blocks of size 2^( 7) =       0.000418660737

      target function =      -0.919595796654
              le_mean =     -17.210186844449
             les_mean =     296.475542794144
             stat err =       0.000414317316
             autocorr =       1.242112104265
   target nu stat err =       0.000414317316
   target dn stat err =       0.002309600570
      target stat err =       0.003077013438
              std dev =       0.525744373787
             le_variance =       0.276407146569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276431621342
                                         uncertainty =       0.001541697432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276431621342
                                         uncertainty =       0.001541697432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371751464
  error estimate for blocks of size 2^( 2) =       0.000385725159
  error estimate for blocks of size 2^( 3) =       0.000398563699
  error estimate for blocks of size 2^( 4) =       0.000408250508
  error estimate for blocks of size 2^( 5) =       0.000413632981
  error estimate for blocks of size 2^( 6) =       0.000416725036
  error estimate for blocks of size 2^( 7) =       0.000418660737

      target function =      -0.919595796654
              le_mean =     -17.210186844449
             les_mean =     296.475542794144
             stat err =       0.000414317316
             autocorr =       1.242112104265
   target nu stat err =       0.000414317316
   target dn stat err =       0.002309600570
      target stat err =       0.003077013438
              std dev =       0.525744373787
             le_variance =       0.276407146569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276431621342
                                         uncertainty =       0.001541697432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276431621342
                                         uncertainty =       0.001541697432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371751464
  error estimate for blocks of size 2^( 2) =       0.000385725159
  error estimate for blocks of size 2^( 3) =       0.000398563699
  error estimate for blocks of size 2^( 4) =       0.000408250508
  error estimate for blocks of size 2^( 5) =       0.000413632981
  error estimate for blocks of size 2^( 6) =       0.000416725036
  error estimate for blocks of size 2^( 7) =       0.000418660737

      target function =      -0.919595796654
              le_mean =     -17.210186844449
             les_mean =     296.475542794144
             stat err =       0.000414317316
             autocorr =       1.242112104265
   target nu stat err =       0.000414317316
   target dn stat err =       0.002309600570
      target stat err =       0.003077013438
              std dev =       0.525744373787
             le_variance =       0.276407146569


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919595796654        initial  <--
     5.9605e+20     5.9605e+21             0.0000e+00        -0.919595796654
     2.3842e+21     2.3842e+22             0.0000e+00        -0.919595796654
     9.5367e+21     9.5367e+22             0.0000e+00        -0.919595796654

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1209
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5557e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2502
    reference variance = 0.168572
====================================================
  Execution time = 2.7556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0493e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8430e-01
  Total weights = 1.966535164e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1337e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274755561376
                                         uncertainty =       0.001425874268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274755561376
                                         uncertainty =       0.001425874268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370625935
  error estimate for blocks of size 2^( 2) =       0.000384872065
  error estimate for blocks of size 2^( 3) =       0.000398266433
  error estimate for blocks of size 2^( 4) =       0.000407457300
  error estimate for blocks of size 2^( 5) =       0.000414318857
  error estimate for blocks of size 2^( 6) =       0.000417101472
  error estimate for blocks of size 2^( 7) =       0.000420738798

      target function =      -0.920363417571
              le_mean =     -17.209603512485
             les_mean =     296.454757820905
             stat err =       0.000414904107
             autocorr =       1.253210007186
   target nu stat err =       0.000414904107
   target dn stat err =       0.002200697982
      target stat err =       0.002939690888
              std dev =       0.524152610454
             le_variance =       0.274735959046


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720960351248e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+21, overlap shift 5.9605e+22 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920371991379       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920371991379       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920371991379       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920371991379       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920362795418       residual = 2.61e+04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+21 is 1.668688e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+22, overlap shift 2.3842e+23 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920371991379       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920371991379       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920371991379       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920371991379       residual = 8.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920388614557       residual = 9.05e+05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920371991582       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+22 is 4.375080e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920371991379       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920371991379       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920371991379       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920371991379       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+22 is 1.131154e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.581133 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5699e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2667
    reference variance = 0.251944
====================================================
  Execution time = 2.6640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8778e-01
  Total weights = 1.9661e+06
  Execution time = 2.4273e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275897942386
                                         uncertainty =       0.001476775139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275897942386
                                         uncertainty =       0.001476775139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371389048
  error estimate for blocks of size 2^( 2) =       0.000385768659
  error estimate for blocks of size 2^( 3) =       0.000398891603
  error estimate for blocks of size 2^( 4) =       0.000408389063
  error estimate for blocks of size 2^( 5) =       0.000413761095
  error estimate for blocks of size 2^( 6) =       0.000419238593
  error estimate for blocks of size 2^( 7) =       0.000421086010

      target function =      -0.915752719922
              le_mean =     -17.209332536439
             les_mean =     296.448909337427
             stat err =       0.000415618690
             autocorr =       1.252367973937
   target nu stat err =       0.000415618690
   target dn stat err =       0.003236429266
      target stat err =       0.004232247129
              std dev =       0.525231832684
             le_variance =       0.275868478064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275897942386
                                         uncertainty =       0.001476775139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275897942386
                                         uncertainty =       0.001476775139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371389048
  error estimate for blocks of size 2^( 2) =       0.000385768659
  error estimate for blocks of size 2^( 3) =       0.000398891603
  error estimate for blocks of size 2^( 4) =       0.000408389063
  error estimate for blocks of size 2^( 5) =       0.000413761095
  error estimate for blocks of size 2^( 6) =       0.000419238593
  error estimate for blocks of size 2^( 7) =       0.000421086010

      target function =      -0.915752719922
              le_mean =     -17.209332536439
             les_mean =     296.448909337427
             stat err =       0.000415618690
             autocorr =       1.252367973937
   target nu stat err =       0.000415618690
   target dn stat err =       0.003236429266
      target stat err =       0.004232247129
              std dev =       0.525231832684
             le_variance =       0.275868478064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275897942386
                                         uncertainty =       0.001476775139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275897942386
                                         uncertainty =       0.001476775139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371389048
  error estimate for blocks of size 2^( 2) =       0.000385768659
  error estimate for blocks of size 2^( 3) =       0.000398891603
  error estimate for blocks of size 2^( 4) =       0.000408389063
  error estimate for blocks of size 2^( 5) =       0.000413761095
  error estimate for blocks of size 2^( 6) =       0.000419238593
  error estimate for blocks of size 2^( 7) =       0.000421086010

      target function =      -0.915752719922
              le_mean =     -17.209332536439
             les_mean =     296.448909337427
             stat err =       0.000415618690
             autocorr =       1.252367973937
   target nu stat err =       0.000415618690
   target dn stat err =       0.003236429266
      target stat err =       0.004232247129
              std dev =       0.525231832684
             le_variance =       0.275868478064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275897942386
                                         uncertainty =       0.001476775139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275897942386
                                         uncertainty =       0.001476775139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371389048
  error estimate for blocks of size 2^( 2) =       0.000385768659
  error estimate for blocks of size 2^( 3) =       0.000398891603
  error estimate for blocks of size 2^( 4) =       0.000408389063
  error estimate for blocks of size 2^( 5) =       0.000413761095
  error estimate for blocks of size 2^( 6) =       0.000419238593
  error estimate for blocks of size 2^( 7) =       0.000421086010

      target function =      -0.915752719922
              le_mean =     -17.209332536439
             les_mean =     296.448909337427
             stat err =       0.000415618690
             autocorr =       1.252367973937
   target nu stat err =       0.000415618690
   target dn stat err =       0.003236429266
      target stat err =       0.004232247129
              std dev =       0.525231832684
             le_variance =       0.275868478064


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915752719922        initial  <--
     5.9605e+21     5.9605e+22             1.6687e-26        -0.915752719922
     2.3842e+22     2.3842e+23             4.3751e-27        -0.915752719922
     9.5367e+22     9.5367e+23             1.1312e-27        -0.915752719922

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9286
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4635e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2336
    reference variance = 0.262724
====================================================
  Execution time = 2.7178e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0477e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8787e-01
  Total weights = 1.966334696e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6130e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278112633186
                                         uncertainty =       0.001537464426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278112633186
                                         uncertainty =       0.001537464426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372919601
  error estimate for blocks of size 2^( 2) =       0.000387010053
  error estimate for blocks of size 2^( 3) =       0.000400217643
  error estimate for blocks of size 2^( 4) =       0.000409648340
  error estimate for blocks of size 2^( 5) =       0.000415769752
  error estimate for blocks of size 2^( 6) =       0.000419303979
  error estimate for blocks of size 2^( 7) =       0.000420413407

      target function =      -0.915805656815
              le_mean =     -17.209946157998
             les_mean =     296.470120305978
             stat err =       0.000416283869
             autocorr =       1.246088085005
   target nu stat err =       0.000416283869
   target dn stat err =       0.002313211516
      target stat err =       0.003056159493
              std dev =       0.527396395838
             le_variance =       0.278146958343


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720994615800e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+22, overlap shift 5.9605e+23 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915815151577       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915815151577       residual = 6.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915815151577       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+22 is 2.309696e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+23, overlap shift 2.3842e+24 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915815151577       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915815151577       residual = 6.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915815151577       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915816307068       residual = 1.15e+06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+23 is 7.839049e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+23, overlap shift 9.5367e+24 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915815151577       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915815151577       residual = 6.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915815151577       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915815151572       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915815232978       residual = 1.41e+04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914073090696       residual = 1.32e+07           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+23 is 2.049553e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.583234 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5801e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.1944
    reference variance = 0.396813
====================================================
  Execution time = 2.6906e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8629e-01
  Total weights = 1.9661e+06
  Execution time = 2.4251e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277070094405
                                         uncertainty =       0.001796409529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277070094405
                                         uncertainty =       0.001796409529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372160457
  error estimate for blocks of size 2^( 2) =       0.000386867084
  error estimate for blocks of size 2^( 3) =       0.000400303863
  error estimate for blocks of size 2^( 4) =       0.000410298128
  error estimate for blocks of size 2^( 5) =       0.000416781764
  error estimate for blocks of size 2^( 6) =       0.000419448752
  error estimate for blocks of size 2^( 7) =       0.000423924974

      target function =      -0.917793457765
              le_mean =     -17.209694746774
             les_mean =     296.459885026065
             stat err =       0.000417613405
             autocorr =       1.259181710197
   target nu stat err =       0.000417613405
   target dn stat err =       0.002358861747
      target stat err =       0.003126684860
              std dev =       0.526322787105
             le_variance =       0.277015676226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277070094405
                                         uncertainty =       0.001796409529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277070094405
                                         uncertainty =       0.001796409529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372160457
  error estimate for blocks of size 2^( 2) =       0.000386867084
  error estimate for blocks of size 2^( 3) =       0.000400303863
  error estimate for blocks of size 2^( 4) =       0.000410298128
  error estimate for blocks of size 2^( 5) =       0.000416781764
  error estimate for blocks of size 2^( 6) =       0.000419448752
  error estimate for blocks of size 2^( 7) =       0.000423924974

      target function =      -0.917793457765
              le_mean =     -17.209694746774
             les_mean =     296.459885026065
             stat err =       0.000417613405
             autocorr =       1.259181710197
   target nu stat err =       0.000417613405
   target dn stat err =       0.002358861747
      target stat err =       0.003126684860
              std dev =       0.526322787105
             le_variance =       0.277015676226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277070094405
                                         uncertainty =       0.001796409529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277070094405
                                         uncertainty =       0.001796409529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372160457
  error estimate for blocks of size 2^( 2) =       0.000386867084
  error estimate for blocks of size 2^( 3) =       0.000400303863
  error estimate for blocks of size 2^( 4) =       0.000410298128
  error estimate for blocks of size 2^( 5) =       0.000416781764
  error estimate for blocks of size 2^( 6) =       0.000419448752
  error estimate for blocks of size 2^( 7) =       0.000423924974

      target function =      -0.917793457765
              le_mean =     -17.209694746774
             les_mean =     296.459885026065
             stat err =       0.000417613405
             autocorr =       1.259181710197
   target nu stat err =       0.000417613405
   target dn stat err =       0.002358861747
      target stat err =       0.003126684860
              std dev =       0.526322787105
             le_variance =       0.277015676226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277070094405
                                         uncertainty =       0.001796409529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277070094405
                                         uncertainty =       0.001796409529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372160457
  error estimate for blocks of size 2^( 2) =       0.000386867084
  error estimate for blocks of size 2^( 3) =       0.000400303863
  error estimate for blocks of size 2^( 4) =       0.000410298128
  error estimate for blocks of size 2^( 5) =       0.000416781764
  error estimate for blocks of size 2^( 6) =       0.000419448752
  error estimate for blocks of size 2^( 7) =       0.000423924974

      target function =      -0.917793457765
              le_mean =     -17.209694746774
             les_mean =     296.459885026065
             stat err =       0.000417613405
             autocorr =       1.259181710197
   target nu stat err =       0.000417613405
   target dn stat err =       0.002358861747
      target stat err =       0.003126684860
              std dev =       0.526322787105
             le_variance =       0.277015676226


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917793457765        initial  <--
     5.9605e+22     5.9605e+23             2.3097e-27        -0.917793457765
     2.3842e+23     2.3842e+24             7.8390e-28        -0.917793457765
     9.5367e+23     9.5367e+24             2.0496e-28        -0.917793457765

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1683
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4976e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.1677
    reference variance = 0.505255
====================================================
  Execution time = 2.7171e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0487e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8281e-01
  Total weights = 1.966472517e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1008e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273792050890
                                         uncertainty =       0.001435231776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273792050890
                                         uncertainty =       0.001435231776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369981663
  error estimate for blocks of size 2^( 2) =       0.000384773634
  error estimate for blocks of size 2^( 3) =       0.000398123996
  error estimate for blocks of size 2^( 4) =       0.000408688686
  error estimate for blocks of size 2^( 5) =       0.000414669079
  error estimate for blocks of size 2^( 6) =       0.000417866228
  error estimate for blocks of size 2^( 7) =       0.000420366288

      target function =      -0.922543323299
              le_mean =     -17.210385243791
             les_mean =     296.480166708878
             stat err =       0.000415397570
             autocorr =       1.260571557757
   target nu stat err =       0.000415397570
   target dn stat err =       0.002276542266
      target stat err =       0.003054948466
              std dev =       0.523241456608
             le_variance =       0.273781621914


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721038524379e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+23, overlap shift 5.9605e+24 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922552573234       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922552573234       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922552573234       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922552573234       residual = 9.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922119140625       residual = 3.61e+08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922552573200       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+23 is 2.459152e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+24, overlap shift 2.3842e+25 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922552573234       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922552573234       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922552573234       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922552573234       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922552108765       residual = 3.13e+07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922555259745       residual = 7.29e+07           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+24 is 5.442486e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+24, overlap shift 9.5367e+25 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922552573234       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922552573234       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922552573234       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+24 is 1.190899e-29

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.585639 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5282e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2888
    reference variance = 0.1721
====================================================
  Execution time = 2.6926e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8859e-01
  Total weights = 1.9662e+06
  Execution time = 2.4206e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278005530507
                                         uncertainty =       0.002034976699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278005530507
                                         uncertainty =       0.002034976699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372831099
  error estimate for blocks of size 2^( 2) =       0.000386931147
  error estimate for blocks of size 2^( 3) =       0.000400150675
  error estimate for blocks of size 2^( 4) =       0.000410096069
  error estimate for blocks of size 2^( 5) =       0.000415568556
  error estimate for blocks of size 2^( 6) =       0.000418944738
  error estimate for blocks of size 2^( 7) =       0.000420742721

      target function =      -0.914894543676
              le_mean =     -17.210059682361
             les_mean =     296.474748745930
             stat err =       0.000416338021
             autocorr =       1.247004111063
   target nu stat err =       0.000416338021
   target dn stat err =       0.003050047389
      target stat err =       0.003990579635
              std dev =       0.527271232759
             le_variance =       0.278014952895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278005530507
                                         uncertainty =       0.002034976699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278005530507
                                         uncertainty =       0.002034976699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372831099
  error estimate for blocks of size 2^( 2) =       0.000386931147
  error estimate for blocks of size 2^( 3) =       0.000400150675
  error estimate for blocks of size 2^( 4) =       0.000410096069
  error estimate for blocks of size 2^( 5) =       0.000415568556
  error estimate for blocks of size 2^( 6) =       0.000418944738
  error estimate for blocks of size 2^( 7) =       0.000420742721

      target function =      -0.914894543676
              le_mean =     -17.210059682361
             les_mean =     296.474748745930
             stat err =       0.000416338021
             autocorr =       1.247004111070
   target nu stat err =       0.000416338021
   target dn stat err =       0.003050047389
      target stat err =       0.003990579635
              std dev =       0.527271232759
             le_variance =       0.278014952895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278005530507
                                         uncertainty =       0.002034976699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278005530507
                                         uncertainty =       0.002034976699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372831099
  error estimate for blocks of size 2^( 2) =       0.000386931147
  error estimate for blocks of size 2^( 3) =       0.000400150675
  error estimate for blocks of size 2^( 4) =       0.000410096069
  error estimate for blocks of size 2^( 5) =       0.000415568556
  error estimate for blocks of size 2^( 6) =       0.000418944738
  error estimate for blocks of size 2^( 7) =       0.000420742721

      target function =      -0.914894543676
              le_mean =     -17.210059682361
             les_mean =     296.474748745930
             stat err =       0.000416338021
             autocorr =       1.247004111070
   target nu stat err =       0.000416338021
   target dn stat err =       0.003050047389
      target stat err =       0.003990579635
              std dev =       0.527271232759
             le_variance =       0.278014952895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278005530507
                                         uncertainty =       0.002034976699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278005530507
                                         uncertainty =       0.002034976699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372831099
  error estimate for blocks of size 2^( 2) =       0.000386931147
  error estimate for blocks of size 2^( 3) =       0.000400150675
  error estimate for blocks of size 2^( 4) =       0.000410096069
  error estimate for blocks of size 2^( 5) =       0.000415568556
  error estimate for blocks of size 2^( 6) =       0.000418944738
  error estimate for blocks of size 2^( 7) =       0.000420742721

      target function =      -0.914894543676
              le_mean =     -17.210059682361
             les_mean =     296.474748745930
             stat err =       0.000416338021
             autocorr =       1.247004111070
   target nu stat err =       0.000416338021
   target dn stat err =       0.003050047389
      target stat err =       0.003990579635
              std dev =       0.527271232759
             le_variance =       0.278014952895


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914894543676        initial  <--
     5.9605e+23     5.9605e+24             2.4592e-28        -0.914894543676
     2.3842e+24     2.3842e+25             5.4425e-29        -0.914894543676
     9.5367e+24     9.5367e+25             1.1909e-29        -0.914894543676

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1735
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4461e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1876
    reference variance = 0.133391
====================================================
  Execution time = 2.6849e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0480e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8527e-01
  Total weights = 1.966287215e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5980e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274766579288
                                         uncertainty =       0.001275325589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274766579288
                                         uncertainty =       0.001275325589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370684859
  error estimate for blocks of size 2^( 2) =       0.000384972464
  error estimate for blocks of size 2^( 3) =       0.000397684044
  error estimate for blocks of size 2^( 4) =       0.000406687602
  error estimate for blocks of size 2^( 5) =       0.000412420029
  error estimate for blocks of size 2^( 6) =       0.000416271178
  error estimate for blocks of size 2^( 7) =       0.000417608338

      target function =      -0.919204256646
              le_mean =     -17.210004506122
             les_mean =     296.469528785389
             stat err =       0.000413246786
             autocorr =       1.242822985781
   target nu stat err =       0.000413246786
   target dn stat err =       0.002299076789
      target stat err =       0.003059792727
              std dev =       0.524235941868
             le_variance =       0.274823322746


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721000450612e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+24, overlap shift 5.9605e+25 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919213750309       residual = 5.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919213750309       residual = 5.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+25, overlap shift 2.3842e+26 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919213750309       residual = 5.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919213750309       residual = 5.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+25, overlap shift 9.5367e+26 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919213750309       residual = 5.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919213750309       residual = 5.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.586901 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7592e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1855
    reference variance = 0.279532
====================================================
  Execution time = 2.6971e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8227e-01
  Total weights = 1.9664e+06
  Execution time = 2.4186e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273653858609
                                         uncertainty =       0.001593946305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273653858609
                                         uncertainty =       0.001593946305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369899782
  error estimate for blocks of size 2^( 2) =       0.000384002226
  error estimate for blocks of size 2^( 3) =       0.000397154115
  error estimate for blocks of size 2^( 4) =       0.000406530946
  error estimate for blocks of size 2^( 5) =       0.000412331990
  error estimate for blocks of size 2^( 6) =       0.000416394152
  error estimate for blocks of size 2^( 7) =       0.000417074872

      target function =      -0.923133888622
              le_mean =     -17.209948593351
             les_mean =     296.464598696370
             stat err =       0.000413082990
             autocorr =       1.247114914753
   target nu stat err =       0.000413082990
   target dn stat err =       0.001978582627
      target stat err =       0.002672040964
              std dev =       0.523125658305
             le_variance =       0.273660454377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273653858609
                                         uncertainty =       0.001593946305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273653858609
                                         uncertainty =       0.001593946305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369899782
  error estimate for blocks of size 2^( 2) =       0.000384002226
  error estimate for blocks of size 2^( 3) =       0.000397154115
  error estimate for blocks of size 2^( 4) =       0.000406530946
  error estimate for blocks of size 2^( 5) =       0.000412331990
  error estimate for blocks of size 2^( 6) =       0.000416394152
  error estimate for blocks of size 2^( 7) =       0.000417074872

      target function =      -0.923133888622
              le_mean =     -17.209948593351
             les_mean =     296.464598696370
             stat err =       0.000413082990
             autocorr =       1.247114914753
   target nu stat err =       0.000413082990
   target dn stat err =       0.001978582627
      target stat err =       0.002672040964
              std dev =       0.523125658305
             le_variance =       0.273660454377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273653858609
                                         uncertainty =       0.001593946305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273653858609
                                         uncertainty =       0.001593946305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369899782
  error estimate for blocks of size 2^( 2) =       0.000384002226
  error estimate for blocks of size 2^( 3) =       0.000397154115
  error estimate for blocks of size 2^( 4) =       0.000406530946
  error estimate for blocks of size 2^( 5) =       0.000412331990
  error estimate for blocks of size 2^( 6) =       0.000416394152
  error estimate for blocks of size 2^( 7) =       0.000417074872

      target function =      -0.923133888622
              le_mean =     -17.209948593351
             les_mean =     296.464598696370
             stat err =       0.000413082990
             autocorr =       1.247114914753
   target nu stat err =       0.000413082990
   target dn stat err =       0.001978582627
      target stat err =       0.002672040964
              std dev =       0.523125658305
             le_variance =       0.273660454377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273653858609
                                         uncertainty =       0.001593946305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273653858609
                                         uncertainty =       0.001593946305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369899782
  error estimate for blocks of size 2^( 2) =       0.000384002226
  error estimate for blocks of size 2^( 3) =       0.000397154115
  error estimate for blocks of size 2^( 4) =       0.000406530946
  error estimate for blocks of size 2^( 5) =       0.000412331990
  error estimate for blocks of size 2^( 6) =       0.000416394152
  error estimate for blocks of size 2^( 7) =       0.000417074872

      target function =      -0.923133888622
              le_mean =     -17.209948593351
             les_mean =     296.464598696370
             stat err =       0.000413082990
             autocorr =       1.247114914753
   target nu stat err =       0.000413082990
   target dn stat err =       0.001978582627
      target stat err =       0.002672040964
              std dev =       0.523125658305
             le_variance =       0.273660454377


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923133888622        initial  <--
     5.9605e+24     5.9605e+25             0.0000e+00        -0.923133888622
     2.3842e+25     2.3842e+26             0.0000e+00        -0.923133888622
     9.5367e+25     9.5367e+26             0.0000e+00        -0.923133888622

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2160
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6815e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2559
    reference variance = 0.197702
====================================================
  Execution time = 2.6889e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0496e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8693e-01
  Total weights = 1.966537907e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1818e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276811127382
                                         uncertainty =       0.001911872147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276811127382
                                         uncertainty =       0.001911872147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372058858
  error estimate for blocks of size 2^( 2) =       0.000386557614
  error estimate for blocks of size 2^( 3) =       0.000400033172
  error estimate for blocks of size 2^( 4) =       0.000409467741
  error estimate for blocks of size 2^( 5) =       0.000415137555
  error estimate for blocks of size 2^( 6) =       0.000418369410
  error estimate for blocks of size 2^( 7) =       0.000421304069

      target function =      -0.916864540634
              le_mean =     -17.209302389170
             les_mean =     296.447014831438
             stat err =       0.000416069694
             autocorr =       1.250572484039
   target nu stat err =       0.000416069694
   target dn stat err =       0.002369071900
      target stat err =       0.003131184182
              std dev =       0.526179102016
             le_variance =       0.276864447399


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720930238917e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+25, overlap shift 5.9605e+26 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916874455912       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916874455912       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+26, overlap shift 2.3842e+27 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916874455912       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916874455912       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+26, overlap shift 9.5367e+27 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916874455912       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916874455912       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.588186 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5080e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2803
    reference variance = 0.387825
====================================================
  Execution time = 2.6887e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8486e-01
  Total weights = 1.9662e+06
  Execution time = 2.4087e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275956763375
                                         uncertainty =       0.001446216450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275956763375
                                         uncertainty =       0.001446216450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371427008
  error estimate for blocks of size 2^( 2) =       0.000385684941
  error estimate for blocks of size 2^( 3) =       0.000398923045
  error estimate for blocks of size 2^( 4) =       0.000409030133
  error estimate for blocks of size 2^( 5) =       0.000415707183
  error estimate for blocks of size 2^( 6) =       0.000418540116
  error estimate for blocks of size 2^( 7) =       0.000421413688

      target function =      -0.919698508293
              le_mean =     -17.209843383854
             les_mean =     296.463572335246
             stat err =       0.000416172780
             autocorr =       1.255452782007
   target nu stat err =       0.000416172780
   target dn stat err =       0.002176514563
      target stat err =       0.002906022460
              std dev =       0.525285516579
             le_variance =       0.275924873928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275956763375
                                         uncertainty =       0.001446216450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275956763375
                                         uncertainty =       0.001446216450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371427008
  error estimate for blocks of size 2^( 2) =       0.000385684941
  error estimate for blocks of size 2^( 3) =       0.000398923045
  error estimate for blocks of size 2^( 4) =       0.000409030133
  error estimate for blocks of size 2^( 5) =       0.000415707183
  error estimate for blocks of size 2^( 6) =       0.000418540116
  error estimate for blocks of size 2^( 7) =       0.000421413688

      target function =      -0.919698508293
              le_mean =     -17.209843383854
             les_mean =     296.463572335246
             stat err =       0.000416172780
             autocorr =       1.255452782007
   target nu stat err =       0.000416172780
   target dn stat err =       0.002176514563
      target stat err =       0.002906022460
              std dev =       0.525285516579
             le_variance =       0.275924873928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275956763375
                                         uncertainty =       0.001446216450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275956763375
                                         uncertainty =       0.001446216450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371427008
  error estimate for blocks of size 2^( 2) =       0.000385684941
  error estimate for blocks of size 2^( 3) =       0.000398923045
  error estimate for blocks of size 2^( 4) =       0.000409030133
  error estimate for blocks of size 2^( 5) =       0.000415707183
  error estimate for blocks of size 2^( 6) =       0.000418540116
  error estimate for blocks of size 2^( 7) =       0.000421413688

      target function =      -0.919698508293
              le_mean =     -17.209843383854
             les_mean =     296.463572335246
             stat err =       0.000416172780
             autocorr =       1.255452782007
   target nu stat err =       0.000416172780
   target dn stat err =       0.002176514563
      target stat err =       0.002906022460
              std dev =       0.525285516579
             le_variance =       0.275924873928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275956763375
                                         uncertainty =       0.001446216450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275956763375
                                         uncertainty =       0.001446216450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371427008
  error estimate for blocks of size 2^( 2) =       0.000385684941
  error estimate for blocks of size 2^( 3) =       0.000398923045
  error estimate for blocks of size 2^( 4) =       0.000409030133
  error estimate for blocks of size 2^( 5) =       0.000415707183
  error estimate for blocks of size 2^( 6) =       0.000418540116
  error estimate for blocks of size 2^( 7) =       0.000421413688

      target function =      -0.919698508293
              le_mean =     -17.209843383854
             les_mean =     296.463572335246
             stat err =       0.000416172780
             autocorr =       1.255452782007
   target nu stat err =       0.000416172780
   target dn stat err =       0.002176514563
      target stat err =       0.002906022460
              std dev =       0.525285516579
             le_variance =       0.275924873928


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919698508293        initial  <--
     5.9605e+25     5.9605e+26             0.0000e+00        -0.919698508293
     2.3842e+26     2.3842e+27             0.0000e+00        -0.919698508293
     9.5367e+26     9.5367e+27             0.0000e+00        -0.919698508293

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0800
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4166e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.3513
    reference variance = 0.452895
====================================================
  Execution time = 2.7037e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0474e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8704e-01
  Total weights = 1.966173836e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3195e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278067396354
                                         uncertainty =       0.002733279024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278067396354
                                         uncertainty =       0.002733279024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372918728
  error estimate for blocks of size 2^( 2) =       0.000387109181
  error estimate for blocks of size 2^( 3) =       0.000400357842
  error estimate for blocks of size 2^( 4) =       0.000410102046
  error estimate for blocks of size 2^( 5) =       0.000416079139
  error estimate for blocks of size 2^( 6) =       0.000417743263
  error estimate for blocks of size 2^( 7) =       0.000420417067

      target function =      -0.916742732739
              le_mean =     -17.209446890657
             les_mean =     296.452106384028
             stat err =       0.000416085379
             autocorr =       1.244905888125
   target nu stat err =       0.000416085379
   target dn stat err =       0.003056024780
      target stat err =       0.004010374708
              std dev =       0.527395161098
             le_variance =       0.278145655950


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720944689066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+26, overlap shift 5.9605e+27 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916759620168       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916759620168       residual = 9.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916759620168       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916759620168       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906250000000       residual = 8.27e+10           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916015625000       residual = 2.91e+10           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+26 is 1.730538e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+27, overlap shift 2.3842e+28 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916759620168       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916759620168       residual = 9.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916759620168       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916759620168       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916759620168       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916759612840       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916133531441       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+27 is 5.324064e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+27, overlap shift 9.5367e+28 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916759620168       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916759620168       residual = 9.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916759620168       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916759620168       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916759620168       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+27 is 1.230304e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.591011 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5367e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.1761
    reference variance = 0.256349
====================================================
  Execution time = 2.6774e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8743e-01
  Total weights = 1.9665e+06
  Execution time = 2.4156e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276296237184
                                         uncertainty =       0.002649005111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276296237184
                                         uncertainty =       0.002649005111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371641584
  error estimate for blocks of size 2^( 2) =       0.000385666768
  error estimate for blocks of size 2^( 3) =       0.000398848008
  error estimate for blocks of size 2^( 4) =       0.000408116819
  error estimate for blocks of size 2^( 5) =       0.000413875777
  error estimate for blocks of size 2^( 6) =       0.000416527051
  error estimate for blocks of size 2^( 7) =       0.000417832635

      target function =      -0.916267989716
              le_mean =     -17.209581088695
             les_mean =     296.457106939079
             stat err =       0.000414088070
             autocorr =       1.241471727580
   target nu stat err =       0.000414088070
   target dn stat err =       0.004185309376
      target stat err =       0.005459871853
              std dev =       0.525588977252
             le_variance =       0.276243773009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276296237184
                                         uncertainty =       0.002649005111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276296237184
                                         uncertainty =       0.002649005111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371641584
  error estimate for blocks of size 2^( 2) =       0.000385666768
  error estimate for blocks of size 2^( 3) =       0.000398848008
  error estimate for blocks of size 2^( 4) =       0.000408116819
  error estimate for blocks of size 2^( 5) =       0.000413875777
  error estimate for blocks of size 2^( 6) =       0.000416527051
  error estimate for blocks of size 2^( 7) =       0.000417832635

      target function =      -0.916267989716
              le_mean =     -17.209581088695
             les_mean =     296.457106939079
             stat err =       0.000414088070
             autocorr =       1.241471727580
   target nu stat err =       0.000414088070
   target dn stat err =       0.004185309376
      target stat err =       0.005459871853
              std dev =       0.525588977252
             le_variance =       0.276243773009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276296237184
                                         uncertainty =       0.002649005111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276296237184
                                         uncertainty =       0.002649005111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371641584
  error estimate for blocks of size 2^( 2) =       0.000385666768
  error estimate for blocks of size 2^( 3) =       0.000398848008
  error estimate for blocks of size 2^( 4) =       0.000408116819
  error estimate for blocks of size 2^( 5) =       0.000413875777
  error estimate for blocks of size 2^( 6) =       0.000416527051
  error estimate for blocks of size 2^( 7) =       0.000417832635

      target function =      -0.916267989716
              le_mean =     -17.209581088695
             les_mean =     296.457106939079
             stat err =       0.000414088070
             autocorr =       1.241471727580
   target nu stat err =       0.000414088070
   target dn stat err =       0.004185309376
      target stat err =       0.005459871853
              std dev =       0.525588977252
             le_variance =       0.276243773009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276296237184
                                         uncertainty =       0.002649005111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276296237184
                                         uncertainty =       0.002649005111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371641584
  error estimate for blocks of size 2^( 2) =       0.000385666768
  error estimate for blocks of size 2^( 3) =       0.000398848008
  error estimate for blocks of size 2^( 4) =       0.000408116819
  error estimate for blocks of size 2^( 5) =       0.000413875777
  error estimate for blocks of size 2^( 6) =       0.000416527051
  error estimate for blocks of size 2^( 7) =       0.000417832635

      target function =      -0.916267989716
              le_mean =     -17.209581088695
             les_mean =     296.457106939079
             stat err =       0.000414088070
             autocorr =       1.241471727580
   target nu stat err =       0.000414088070
   target dn stat err =       0.004185309376
      target stat err =       0.005459871853
              std dev =       0.525588977252
             le_variance =       0.276243773009


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916267989716        initial  <--
     5.9605e+26     5.9605e+27             1.7305e-31        -0.916267989716
     2.3842e+27     2.3842e+28             5.3241e-32        -0.916267989716
     9.5367e+27     9.5367e+28             1.2303e-32        -0.916267989716

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9913
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.2093
    reference variance = 0.606669
====================================================
  Execution time = 2.7047e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0508e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8826e-01
  Total weights = 1.966388628e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1821e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277781910601
                                         uncertainty =       0.001671787512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277781910601
                                         uncertainty =       0.001671787512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372741487
  error estimate for blocks of size 2^( 2) =       0.000387022953
  error estimate for blocks of size 2^( 3) =       0.000399910141
  error estimate for blocks of size 2^( 4) =       0.000409764417
  error estimate for blocks of size 2^( 5) =       0.000415636059
  error estimate for blocks of size 2^( 6) =       0.000416773768
  error estimate for blocks of size 2^( 7) =       0.000419920493

      target function =      -0.915387236681
              le_mean =     -17.210258857642
             les_mean =     296.481265620439
             stat err =       0.000415523684
             autocorr =       1.242728044102
   target nu stat err =       0.000415523684
   target dn stat err =       0.002820025430
      target stat err =       0.003701320462
              std dev =       0.527144500467
             le_variance =       0.277881324373


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721025885764e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+27, overlap shift 5.9605e+28 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915401506511       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915401506511       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+28, overlap shift 2.3842e+29 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915401506511       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915401506511       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+28, overlap shift 9.5367e+29 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915401506511       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915401506511       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.592260 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5238e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1645
    reference variance = 0.20161
====================================================
  Execution time = 2.6850e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8951e-01
  Total weights = 1.9663e+06
  Execution time = 2.4218e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278979956476
                                         uncertainty =       0.001782293206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278979956476
                                         uncertainty =       0.001782293206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373437034
  error estimate for blocks of size 2^( 2) =       0.000388014080
  error estimate for blocks of size 2^( 3) =       0.000401223867
  error estimate for blocks of size 2^( 4) =       0.000411484972
  error estimate for blocks of size 2^( 5) =       0.000416531158
  error estimate for blocks of size 2^( 6) =       0.000419509296
  error estimate for blocks of size 2^( 7) =       0.000421080331

      target function =      -0.913509768838
              le_mean =     -17.209245970345
             les_mean =     296.447654688160
             stat err =       0.000417151439
             autocorr =       1.247822245188
   target nu stat err =       0.000417151439
   target dn stat err =       0.002509084331
      target stat err =       0.003286060969
              std dev =       0.528128167402
             le_variance =       0.278919361203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278979956476
                                         uncertainty =       0.001782293206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278979956476
                                         uncertainty =       0.001782293206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373437034
  error estimate for blocks of size 2^( 2) =       0.000388014080
  error estimate for blocks of size 2^( 3) =       0.000401223867
  error estimate for blocks of size 2^( 4) =       0.000411484972
  error estimate for blocks of size 2^( 5) =       0.000416531158
  error estimate for blocks of size 2^( 6) =       0.000419509296
  error estimate for blocks of size 2^( 7) =       0.000421080331

      target function =      -0.913509768838
              le_mean =     -17.209245970345
             les_mean =     296.447654688160
             stat err =       0.000417151439
             autocorr =       1.247822245188
   target nu stat err =       0.000417151439
   target dn stat err =       0.002509084331
      target stat err =       0.003286060969
              std dev =       0.528128167402
             le_variance =       0.278919361203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278979956476
                                         uncertainty =       0.001782293206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278979956476
                                         uncertainty =       0.001782293206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373437034
  error estimate for blocks of size 2^( 2) =       0.000388014080
  error estimate for blocks of size 2^( 3) =       0.000401223867
  error estimate for blocks of size 2^( 4) =       0.000411484972
  error estimate for blocks of size 2^( 5) =       0.000416531158
  error estimate for blocks of size 2^( 6) =       0.000419509296
  error estimate for blocks of size 2^( 7) =       0.000421080331

      target function =      -0.913509768838
              le_mean =     -17.209245970345
             les_mean =     296.447654688160
             stat err =       0.000417151439
             autocorr =       1.247822245188
   target nu stat err =       0.000417151439
   target dn stat err =       0.002509084331
      target stat err =       0.003286060969
              std dev =       0.528128167402
             le_variance =       0.278919361203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278979956476
                                         uncertainty =       0.001782293206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278979956476
                                         uncertainty =       0.001782293206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373437034
  error estimate for blocks of size 2^( 2) =       0.000388014080
  error estimate for blocks of size 2^( 3) =       0.000401223867
  error estimate for blocks of size 2^( 4) =       0.000411484972
  error estimate for blocks of size 2^( 5) =       0.000416531158
  error estimate for blocks of size 2^( 6) =       0.000419509296
  error estimate for blocks of size 2^( 7) =       0.000421080331

      target function =      -0.913509768838
              le_mean =     -17.209245970345
             les_mean =     296.447654688160
             stat err =       0.000417151439
             autocorr =       1.247822245188
   target nu stat err =       0.000417151439
   target dn stat err =       0.002509084331
      target stat err =       0.003286060969
              std dev =       0.528128167402
             le_variance =       0.278919361203


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913509768838        initial  <--
     5.9605e+27     5.9605e+28             0.0000e+00        -0.913509768838
     2.3842e+28     2.3842e+29             0.0000e+00        -0.913509768838
     9.5367e+28     9.5367e+29             0.0000e+00        -0.913509768838

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1058
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4350e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2575
    reference variance = 0.251364
====================================================
  Execution time = 2.7272e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0467e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8874e-01
  Total weights = 1.966489835e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6020e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279496672639
                                         uncertainty =       0.001839116282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279496672639
                                         uncertainty =       0.001839116282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373841283
  error estimate for blocks of size 2^( 2) =       0.000387974918
  error estimate for blocks of size 2^( 3) =       0.000400965322
  error estimate for blocks of size 2^( 4) =       0.000411085207
  error estimate for blocks of size 2^( 5) =       0.000416626608
  error estimate for blocks of size 2^( 6) =       0.000420358522
  error estimate for blocks of size 2^( 7) =       0.000422018969

      target function =      -0.914687917991
              le_mean =     -17.209943773519
             les_mean =     296.470901259140
             stat err =       0.000417522327
             autocorr =       1.247340117089
   target nu stat err =       0.000417522327
   target dn stat err =       0.002288800026
      target stat err =       0.003018202838
              std dev =       0.528699871793
             le_variance =       0.279523554434


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720994377352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+28, overlap shift 5.9605e+29 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914697072403       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914697072403       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+29, overlap shift 2.3842e+30 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914697072403       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914697072403       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+29, overlap shift 9.5367e+30 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914697072403       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914697072403       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.593515 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7548e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2052
    reference variance = 0.172456
====================================================
  Execution time = 2.6893e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9033e-01
  Total weights = 1.9664e+06
  Execution time = 2.4156e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280686225294
                                         uncertainty =       0.002138536565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280686225294
                                         uncertainty =       0.002138536565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374603725
  error estimate for blocks of size 2^( 2) =       0.000388829480
  error estimate for blocks of size 2^( 3) =       0.000401737138
  error estimate for blocks of size 2^( 4) =       0.000411751669
  error estimate for blocks of size 2^( 5) =       0.000416812500
  error estimate for blocks of size 2^( 6) =       0.000420166346
  error estimate for blocks of size 2^( 7) =       0.000421581196

      target function =      -0.912554793148
              le_mean =     -17.209667527804
             les_mean =     296.462989423533
             stat err =       0.000417577928
             autocorr =       1.242598674096
   target nu stat err =       0.000417577928
   target dn stat err =       0.002595251092
      target stat err =       0.003390676455
              std dev =       0.529778144754
             le_variance =       0.280664882659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280686225294
                                         uncertainty =       0.002138536565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280686225294
                                         uncertainty =       0.002138536565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374603725
  error estimate for blocks of size 2^( 2) =       0.000388829480
  error estimate for blocks of size 2^( 3) =       0.000401737138
  error estimate for blocks of size 2^( 4) =       0.000411751669
  error estimate for blocks of size 2^( 5) =       0.000416812500
  error estimate for blocks of size 2^( 6) =       0.000420166346
  error estimate for blocks of size 2^( 7) =       0.000421581196

      target function =      -0.912554793148
              le_mean =     -17.209667527804
             les_mean =     296.462989423533
             stat err =       0.000417577928
             autocorr =       1.242598674096
   target nu stat err =       0.000417577928
   target dn stat err =       0.002595251092
      target stat err =       0.003390676455
              std dev =       0.529778144754
             le_variance =       0.280664882659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280686225294
                                         uncertainty =       0.002138536565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280686225294
                                         uncertainty =       0.002138536565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374603725
  error estimate for blocks of size 2^( 2) =       0.000388829480
  error estimate for blocks of size 2^( 3) =       0.000401737138
  error estimate for blocks of size 2^( 4) =       0.000411751669
  error estimate for blocks of size 2^( 5) =       0.000416812500
  error estimate for blocks of size 2^( 6) =       0.000420166346
  error estimate for blocks of size 2^( 7) =       0.000421581196

      target function =      -0.912554793148
              le_mean =     -17.209667527804
             les_mean =     296.462989423533
             stat err =       0.000417577928
             autocorr =       1.242598674096
   target nu stat err =       0.000417577928
   target dn stat err =       0.002595251092
      target stat err =       0.003390676455
              std dev =       0.529778144754
             le_variance =       0.280664882659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280686225294
                                         uncertainty =       0.002138536565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280686225294
                                         uncertainty =       0.002138536565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374603725
  error estimate for blocks of size 2^( 2) =       0.000388829480
  error estimate for blocks of size 2^( 3) =       0.000401737138
  error estimate for blocks of size 2^( 4) =       0.000411751669
  error estimate for blocks of size 2^( 5) =       0.000416812500
  error estimate for blocks of size 2^( 6) =       0.000420166346
  error estimate for blocks of size 2^( 7) =       0.000421581196

      target function =      -0.912554793148
              le_mean =     -17.209667527804
             les_mean =     296.462989423533
             stat err =       0.000417577928
             autocorr =       1.242598674096
   target nu stat err =       0.000417577928
   target dn stat err =       0.002595251092
      target stat err =       0.003390676455
              std dev =       0.529778144754
             le_variance =       0.280664882659


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912554793148        initial  <--
     5.9605e+28     5.9605e+29             0.0000e+00        -0.912554793148
     2.3842e+29     2.3842e+30             0.0000e+00        -0.912554793148
     9.5367e+29     9.5367e+30             0.0000e+00        -0.912554793148

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1358
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6694e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.256
    reference variance = 0.202618
====================================================
  Execution time = 2.7237e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0474e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9132e-01
  Total weights = 1.966221870e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2896e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277720795857
                                         uncertainty =       0.001902977984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277720795857
                                         uncertainty =       0.001902977984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372579805
  error estimate for blocks of size 2^( 2) =       0.000386485692
  error estimate for blocks of size 2^( 3) =       0.000399232410
  error estimate for blocks of size 2^( 4) =       0.000408767727
  error estimate for blocks of size 2^( 5) =       0.000415576066
  error estimate for blocks of size 2^( 6) =       0.000418890148
  error estimate for blocks of size 2^( 7) =       0.000423742932

      target function =      -0.911228175904
              le_mean =     -17.209471918786
             les_mean =     296.457240400056
             stat err =       0.000416744218
             autocorr =       1.251124546920
   target nu stat err =       0.000416744218
   target dn stat err =       0.003756652754
      target stat err =       0.004853625619
              std dev =       0.526915843223
             le_variance =       0.277640305840


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720947191879e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+29, overlap shift 5.9605e+30 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911253199857       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911253199857       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+29 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+30, overlap shift 2.3842e+31 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911253199857       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911253199857       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+30 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+30, overlap shift 9.5367e+31 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911253199857       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911253199857       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.594731 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5536e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1967
    reference variance = 0.207053
====================================================
  Execution time = 2.6877e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9183e-01
  Total weights = 1.9663e+06
  Execution time = 2.4179e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280196923341
                                         uncertainty =       0.002849725580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280196923341
                                         uncertainty =       0.002849725580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374264197
  error estimate for blocks of size 2^( 2) =       0.000388345905
  error estimate for blocks of size 2^( 3) =       0.000401453964
  error estimate for blocks of size 2^( 4) =       0.000411527466
  error estimate for blocks of size 2^( 5) =       0.000416747710
  error estimate for blocks of size 2^( 6) =       0.000419686512
  error estimate for blocks of size 2^( 7) =       0.000421804272

      target function =      -0.910663857723
              le_mean =     -17.209841395265
             les_mean =     296.470467562028
             stat err =       0.000417441490
             autocorr =       1.244040892450
   target nu stat err =       0.000417441490
   target dn stat err =       0.004026210312
      target stat err =       0.005193679098
              std dev =       0.529297972036
             le_variance =       0.280156343202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280196923341
                                         uncertainty =       0.002849725580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280196923341
                                         uncertainty =       0.002849725580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374264197
  error estimate for blocks of size 2^( 2) =       0.000388345905
  error estimate for blocks of size 2^( 3) =       0.000401453964
  error estimate for blocks of size 2^( 4) =       0.000411527466
  error estimate for blocks of size 2^( 5) =       0.000416747710
  error estimate for blocks of size 2^( 6) =       0.000419686512
  error estimate for blocks of size 2^( 7) =       0.000421804272

      target function =      -0.910663857723
              le_mean =     -17.209841395265
             les_mean =     296.470467562028
             stat err =       0.000417441490
             autocorr =       1.244040892448
   target nu stat err =       0.000417441490
   target dn stat err =       0.004026210312
      target stat err =       0.005193679098
              std dev =       0.529297972036
             le_variance =       0.280156343202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280196923341
                                         uncertainty =       0.002849725580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280196923341
                                         uncertainty =       0.002849725580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374264197
  error estimate for blocks of size 2^( 2) =       0.000388345905
  error estimate for blocks of size 2^( 3) =       0.000401453964
  error estimate for blocks of size 2^( 4) =       0.000411527466
  error estimate for blocks of size 2^( 5) =       0.000416747710
  error estimate for blocks of size 2^( 6) =       0.000419686512
  error estimate for blocks of size 2^( 7) =       0.000421804272

      target function =      -0.910663857723
              le_mean =     -17.209841395265
             les_mean =     296.470467562028
             stat err =       0.000417441490
             autocorr =       1.244040892448
   target nu stat err =       0.000417441490
   target dn stat err =       0.004026210312
      target stat err =       0.005193679098
              std dev =       0.529297972036
             le_variance =       0.280156343202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280196923341
                                         uncertainty =       0.002849725580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280196923341
                                         uncertainty =       0.002849725580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374264197
  error estimate for blocks of size 2^( 2) =       0.000388345905
  error estimate for blocks of size 2^( 3) =       0.000401453964
  error estimate for blocks of size 2^( 4) =       0.000411527466
  error estimate for blocks of size 2^( 5) =       0.000416747710
  error estimate for blocks of size 2^( 6) =       0.000419686512
  error estimate for blocks of size 2^( 7) =       0.000421804272

      target function =      -0.910663857723
              le_mean =     -17.209841395265
             les_mean =     296.470467562028
             stat err =       0.000417441490
             autocorr =       1.244040892448
   target nu stat err =       0.000417441490
   target dn stat err =       0.004026210312
      target stat err =       0.005193679098
              std dev =       0.529297972036
             le_variance =       0.280156343202


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910663857723        initial  <--
     5.9605e+29     5.9605e+30             0.0000e+00        -0.910663857723
     2.3842e+30     2.3842e+31             0.0000e+00        -0.910663857723
     9.5367e+30     9.5367e+31             0.0000e+00        -0.910663857723

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1046
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4647e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1577
    reference variance = 0.214549
====================================================
  Execution time = 2.7328e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0492e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9325e-01
  Total weights = 1.966526731e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3111e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279654243822
                                         uncertainty =       0.002978917233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279654243822
                                         uncertainty =       0.002978917233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373906259
  error estimate for blocks of size 2^( 2) =       0.000388134070
  error estimate for blocks of size 2^( 3) =       0.000401445533
  error estimate for blocks of size 2^( 4) =       0.000411029496
  error estimate for blocks of size 2^( 5) =       0.000417258928
  error estimate for blocks of size 2^( 6) =       0.000420015875
  error estimate for blocks of size 2^( 7) =       0.000422744343

      target function =      -0.908593368988
              le_mean =     -17.208855919202
             les_mean =     296.437967291355
             stat err =       0.000417762161
             autocorr =       1.248339550548
   target nu stat err =       0.000417762161
   target dn stat err =       0.004772207299
      target stat err =       0.006107664267
              std dev =       0.528791763351
             le_variance =       0.279620728988


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720885591920e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+30, overlap shift 5.9605e+31 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908633216438       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908633216438       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+31, overlap shift 2.3842e+32 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908633216438       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908633216438       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+31, overlap shift 9.5367e+32 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908633216438       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908633216438       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.595986 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5648e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2252
    reference variance = 0.467925
====================================================
  Execution time = 2.7082e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8829e-01
  Total weights = 1.9664e+06
  Execution time = 2.4197e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276919273928
                                         uncertainty =       0.001672336327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276919273928
                                         uncertainty =       0.001672336327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372118487
  error estimate for blocks of size 2^( 2) =       0.000386511015
  error estimate for blocks of size 2^( 3) =       0.000399583400
  error estimate for blocks of size 2^( 4) =       0.000408939249
  error estimate for blocks of size 2^( 5) =       0.000414813834
  error estimate for blocks of size 2^( 6) =       0.000417432115
  error estimate for blocks of size 2^( 7) =       0.000418453309

      target function =      -0.915272487064
              le_mean =     -17.209966295135
             les_mean =     296.471226870165
             stat err =       0.000414909627
             autocorr =       1.243210098250
   target nu stat err =       0.000414909627
   target dn stat err =       0.002618986445
      target stat err =       0.003441803172
              std dev =       0.526263431786
             le_variance =       0.276953199636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276919273928
                                         uncertainty =       0.001672336327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276919273928
                                         uncertainty =       0.001672336327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372118487
  error estimate for blocks of size 2^( 2) =       0.000386511015
  error estimate for blocks of size 2^( 3) =       0.000399583400
  error estimate for blocks of size 2^( 4) =       0.000408939249
  error estimate for blocks of size 2^( 5) =       0.000414813834
  error estimate for blocks of size 2^( 6) =       0.000417432115
  error estimate for blocks of size 2^( 7) =       0.000418453309

      target function =      -0.915272487064
              le_mean =     -17.209966295135
             les_mean =     296.471226870165
             stat err =       0.000414909627
             autocorr =       1.243210098250
   target nu stat err =       0.000414909627
   target dn stat err =       0.002618986445
      target stat err =       0.003441803172
              std dev =       0.526263431786
             le_variance =       0.276953199636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276919273928
                                         uncertainty =       0.001672336327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276919273928
                                         uncertainty =       0.001672336327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372118487
  error estimate for blocks of size 2^( 2) =       0.000386511015
  error estimate for blocks of size 2^( 3) =       0.000399583400
  error estimate for blocks of size 2^( 4) =       0.000408939249
  error estimate for blocks of size 2^( 5) =       0.000414813834
  error estimate for blocks of size 2^( 6) =       0.000417432115
  error estimate for blocks of size 2^( 7) =       0.000418453309

      target function =      -0.915272487064
              le_mean =     -17.209966295135
             les_mean =     296.471226870165
             stat err =       0.000414909627
             autocorr =       1.243210098250
   target nu stat err =       0.000414909627
   target dn stat err =       0.002618986445
      target stat err =       0.003441803172
              std dev =       0.526263431786
             le_variance =       0.276953199636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276919273928
                                         uncertainty =       0.001672336327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276919273928
                                         uncertainty =       0.001672336327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372118487
  error estimate for blocks of size 2^( 2) =       0.000386511015
  error estimate for blocks of size 2^( 3) =       0.000399583400
  error estimate for blocks of size 2^( 4) =       0.000408939249
  error estimate for blocks of size 2^( 5) =       0.000414813834
  error estimate for blocks of size 2^( 6) =       0.000417432115
  error estimate for blocks of size 2^( 7) =       0.000418453309

      target function =      -0.915272487064
              le_mean =     -17.209966295135
             les_mean =     296.471226870165
             stat err =       0.000414909627
             autocorr =       1.243210098250
   target nu stat err =       0.000414909627
   target dn stat err =       0.002618986445
      target stat err =       0.003441803172
              std dev =       0.526263431786
             le_variance =       0.276953199636


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915272487064        initial  <--
     5.9605e+30     5.9605e+31             0.0000e+00        -0.915272487064
     2.3842e+31     2.3842e+32             0.0000e+00        -0.915272487064
     9.5367e+31     9.5367e+32             0.0000e+00        -0.915272487064

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.3259
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.3034
    reference variance = 0.361239
====================================================
  Execution time = 2.7183e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0485e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8862e-01
  Total weights = 1.966244630e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2547e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279605390187
                                         uncertainty =       0.002117853114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279605390187
                                         uncertainty =       0.002117853114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373886999
  error estimate for blocks of size 2^( 2) =       0.000388236486
  error estimate for blocks of size 2^( 3) =       0.000401135455
  error estimate for blocks of size 2^( 4) =       0.000410293628
  error estimate for blocks of size 2^( 5) =       0.000415898480
  error estimate for blocks of size 2^( 6) =       0.000418543783
  error estimate for blocks of size 2^( 7) =       0.000420238689

      target function =      -0.914779751456
              le_mean =     -17.209710034758
             les_mean =     296.462735090517
             stat err =       0.000416243645
             autocorr =       1.239408599164
   target nu stat err =       0.000416243645
   target dn stat err =       0.002715098808
      target stat err =       0.003559620066
              std dev =       0.528764524336
             le_variance =       0.279591922196


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720971003476e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+31, overlap shift 5.9605e+32 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914792751117       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914792751117       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+32, overlap shift 2.3842e+33 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914792751117       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914792751117       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+32, overlap shift 9.5367e+33 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914792751117       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914792751117       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.597259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5446e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2238
    reference variance = 0.224865
====================================================
  Execution time = 2.6893e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8830e-01
  Total weights = 1.9661e+06
  Execution time = 2.4244e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276913083141
                                         uncertainty =       0.001726381570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276913083141
                                         uncertainty =       0.001726381570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372110783
  error estimate for blocks of size 2^( 2) =       0.000386302302
  error estimate for blocks of size 2^( 3) =       0.000399316410
  error estimate for blocks of size 2^( 4) =       0.000408134673
  error estimate for blocks of size 2^( 5) =       0.000413351981
  error estimate for blocks of size 2^( 6) =       0.000416046639
  error estimate for blocks of size 2^( 7) =       0.000419319389

      target function =      -0.915394530781
              le_mean =     -17.210490262931
             les_mean =     296.489270701933
             stat err =       0.000414213171
             autocorr =       1.239091268495
   target nu stat err =       0.000414213171
   target dn stat err =       0.002948716651
      target stat err =       0.003867221974
              std dev =       0.526252536423
             le_variance =       0.276941732092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276913083141
                                         uncertainty =       0.001726381570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276913083141
                                         uncertainty =       0.001726381570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372110783
  error estimate for blocks of size 2^( 2) =       0.000386302302
  error estimate for blocks of size 2^( 3) =       0.000399316410
  error estimate for blocks of size 2^( 4) =       0.000408134673
  error estimate for blocks of size 2^( 5) =       0.000413351981
  error estimate for blocks of size 2^( 6) =       0.000416046639
  error estimate for blocks of size 2^( 7) =       0.000419319389

      target function =      -0.915394530781
              le_mean =     -17.210490262931
             les_mean =     296.489270701933
             stat err =       0.000414213171
             autocorr =       1.239091268496
   target nu stat err =       0.000414213171
   target dn stat err =       0.002948716651
      target stat err =       0.003867221974
              std dev =       0.526252536423
             le_variance =       0.276941732092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276913083141
                                         uncertainty =       0.001726381570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276913083141
                                         uncertainty =       0.001726381570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372110783
  error estimate for blocks of size 2^( 2) =       0.000386302302
  error estimate for blocks of size 2^( 3) =       0.000399316410
  error estimate for blocks of size 2^( 4) =       0.000408134673
  error estimate for blocks of size 2^( 5) =       0.000413351981
  error estimate for blocks of size 2^( 6) =       0.000416046639
  error estimate for blocks of size 2^( 7) =       0.000419319389

      target function =      -0.915394530781
              le_mean =     -17.210490262931
             les_mean =     296.489270701933
             stat err =       0.000414213171
             autocorr =       1.239091268496
   target nu stat err =       0.000414213171
   target dn stat err =       0.002948716651
      target stat err =       0.003867221974
              std dev =       0.526252536423
             le_variance =       0.276941732092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276913083141
                                         uncertainty =       0.001726381570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276913083141
                                         uncertainty =       0.001726381570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372110783
  error estimate for blocks of size 2^( 2) =       0.000386302302
  error estimate for blocks of size 2^( 3) =       0.000399316410
  error estimate for blocks of size 2^( 4) =       0.000408134673
  error estimate for blocks of size 2^( 5) =       0.000413351981
  error estimate for blocks of size 2^( 6) =       0.000416046639
  error estimate for blocks of size 2^( 7) =       0.000419319389

      target function =      -0.915394530781
              le_mean =     -17.210490262931
             les_mean =     296.489270701933
             stat err =       0.000414213171
             autocorr =       1.239091268496
   target nu stat err =       0.000414213171
   target dn stat err =       0.002948716651
      target stat err =       0.003867221974
              std dev =       0.526252536423
             le_variance =       0.276941732092


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915394530781        initial  <--
     5.9605e+31     5.9605e+32             0.0000e+00        -0.915394530781
     2.3842e+32     2.3842e+33             0.0000e+00        -0.915394530781
     9.5367e+32     9.5367e+33             0.0000e+00        -0.915394530781

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1675
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4622e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.0632
    reference variance = 0.23014
====================================================
  Execution time = 2.7227e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0505e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8863e-01
  Total weights = 1.966402396e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5696e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277269457861
                                         uncertainty =       0.001711801818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277269457861
                                         uncertainty =       0.001711801818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372316218
  error estimate for blocks of size 2^( 2) =       0.000386556721
  error estimate for blocks of size 2^( 3) =       0.000399336951
  error estimate for blocks of size 2^( 4) =       0.000408857063
  error estimate for blocks of size 2^( 5) =       0.000414785260
  error estimate for blocks of size 2^( 6) =       0.000417344426
  error estimate for blocks of size 2^( 7) =       0.000418595189

      target function =      -0.914852238628
              le_mean =     -17.210092147663
             les_mean =     296.475904566441
             stat err =       0.000414895485
             autocorr =       1.241805299162
   target nu stat err =       0.000414895485
   target dn stat err =       0.003120641605
      target stat err =       0.004080495991
              std dev =       0.526543069115
             le_variance =       0.277247603633


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721009214766e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+32, overlap shift 5.9605e+33 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914869773509       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914869773509       residual = 9.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914869773509       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914869773509       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+32 is 2.972518e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+33, overlap shift 2.3842e+34 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914869773509       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914869773509       residual = 9.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914869773509       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914869773509       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+33 is 7.431294e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+33, overlap shift 9.5367e+34 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914869773509       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914869773509       residual = 9.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914869773509       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914869773509       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+33 is 1.857823e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.599203 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7033e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.1998
    reference variance = 0.148192
====================================================
  Execution time = 2.7172e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8269e-01
  Total weights = 1.9662e+06
  Execution time = 2.4209e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274196375739
                                         uncertainty =       0.001532950547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274196375739
                                         uncertainty =       0.001532950547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370425075
  error estimate for blocks of size 2^( 2) =       0.000384751334
  error estimate for blocks of size 2^( 3) =       0.000397586406
  error estimate for blocks of size 2^( 4) =       0.000407251155
  error estimate for blocks of size 2^( 5) =       0.000412966041
  error estimate for blocks of size 2^( 6) =       0.000416165777
  error estimate for blocks of size 2^( 7) =       0.000418723662

      target function =      -0.922612072125
              le_mean =     -17.210084253621
             les_mean =     296.469694041376
             stat err =       0.000413776659
             autocorr =       1.247760465230
   target nu stat err =       0.000413776659
   target dn stat err =       0.001752915580
      target stat err =       0.002381143259
              std dev =       0.523868547235
             le_variance =       0.274438254782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274196375739
                                         uncertainty =       0.001532950547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274196375739
                                         uncertainty =       0.001532950547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370425075
  error estimate for blocks of size 2^( 2) =       0.000384751334
  error estimate for blocks of size 2^( 3) =       0.000397586406
  error estimate for blocks of size 2^( 4) =       0.000407251155
  error estimate for blocks of size 2^( 5) =       0.000412966041
  error estimate for blocks of size 2^( 6) =       0.000416165777
  error estimate for blocks of size 2^( 7) =       0.000418723662

      target function =      -0.922612072125
              le_mean =     -17.210084253621
             les_mean =     296.469694041376
             stat err =       0.000413776659
             autocorr =       1.247760465230
   target nu stat err =       0.000413776659
   target dn stat err =       0.001752915580
      target stat err =       0.002381143259
              std dev =       0.523868547235
             le_variance =       0.274438254782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274196375739
                                         uncertainty =       0.001532950547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274196375739
                                         uncertainty =       0.001532950547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370425075
  error estimate for blocks of size 2^( 2) =       0.000384751334
  error estimate for blocks of size 2^( 3) =       0.000397586406
  error estimate for blocks of size 2^( 4) =       0.000407251155
  error estimate for blocks of size 2^( 5) =       0.000412966041
  error estimate for blocks of size 2^( 6) =       0.000416165777
  error estimate for blocks of size 2^( 7) =       0.000418723662

      target function =      -0.922612072125
              le_mean =     -17.210084253621
             les_mean =     296.469694041376
             stat err =       0.000413776659
             autocorr =       1.247760465230
   target nu stat err =       0.000413776659
   target dn stat err =       0.001752915580
      target stat err =       0.002381143259
              std dev =       0.523868547235
             le_variance =       0.274438254782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274196375739
                                         uncertainty =       0.001532950547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274196375739
                                         uncertainty =       0.001532950547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370425075
  error estimate for blocks of size 2^( 2) =       0.000384751334
  error estimate for blocks of size 2^( 3) =       0.000397586406
  error estimate for blocks of size 2^( 4) =       0.000407251155
  error estimate for blocks of size 2^( 5) =       0.000412966041
  error estimate for blocks of size 2^( 6) =       0.000416165777
  error estimate for blocks of size 2^( 7) =       0.000418723662

      target function =      -0.922612072125
              le_mean =     -17.210084253621
             les_mean =     296.469694041376
             stat err =       0.000413776659
             autocorr =       1.247760465230
   target nu stat err =       0.000413776659
   target dn stat err =       0.001752915580
      target stat err =       0.002381143259
              std dev =       0.523868547235
             le_variance =       0.274438254782


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922612072125        initial  <--
     5.9605e+32     5.9605e+33             2.9725e-37        -0.922612072125
     2.3842e+33     2.3842e+34             7.4313e-38        -0.922612072125
     9.5367e+33     9.5367e+34             1.8578e-38        -0.922612072125

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.4404
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6480e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.3028
    reference variance = 0.317175
====================================================
  Execution time = 2.7162e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0448e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8288e-01
  Total weights = 1.966379623e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1931e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275344863151
                                         uncertainty =       0.001601263588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275344863151
                                         uncertainty =       0.001601263588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371033147
  error estimate for blocks of size 2^( 2) =       0.000385247806
  error estimate for blocks of size 2^( 3) =       0.000398190450
  error estimate for blocks of size 2^( 4) =       0.000407842061
  error estimate for blocks of size 2^( 5) =       0.000413405658
  error estimate for blocks of size 2^( 6) =       0.000415044828
  error estimate for blocks of size 2^( 7) =       0.000414697739

      target function =      -0.922325317427
              le_mean =     -17.209910860961
             les_mean =     296.463906943318
             stat err =       0.000412747571
             autocorr =       1.237495514966
   target nu stat err =       0.000412747571
   target dn stat err =       0.001895060933
      target stat err =       0.002560216129
              std dev =       0.524728503865
             le_variance =       0.275340002769


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720991086096e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+33, overlap shift 5.9605e+34 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922331566452       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922331566452       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922331571579       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+33 is 1.757611e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+34, overlap shift 2.3842e+35 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922331566452       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922331566452       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922331571579       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+34 is 4.394027e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+34, overlap shift 9.5367e+35 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922331566452       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922331566452       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922331571579       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+34 is 1.098507e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.600792 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5366e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.1311
    reference variance = 0.179258
====================================================
  Execution time = 2.6911e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8180e-01
  Total weights = 1.9661e+06
  Execution time = 2.4175e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273930295676
                                         uncertainty =       0.001447522877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273930295676
                                         uncertainty =       0.001447522877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370036266
  error estimate for blocks of size 2^( 2) =       0.000384512844
  error estimate for blocks of size 2^( 3) =       0.000397432506
  error estimate for blocks of size 2^( 4) =       0.000406859566
  error estimate for blocks of size 2^( 5) =       0.000411866112
  error estimate for blocks of size 2^( 6) =       0.000415526140
  error estimate for blocks of size 2^( 7) =       0.000418132794

      target function =      -0.923635695348
              le_mean =     -17.209552713709
             les_mean =     296.450509092572
             stat err =       0.000413096153
             autocorr =       1.246274537629
   target nu stat err =       0.000413096153
   target dn stat err =       0.001806031475
      target stat err =       0.002451954818
              std dev =       0.523318678353
             le_variance =       0.273862439113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273930295676
                                         uncertainty =       0.001447522877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273930295676
                                         uncertainty =       0.001447522877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370036266
  error estimate for blocks of size 2^( 2) =       0.000384512844
  error estimate for blocks of size 2^( 3) =       0.000397432506
  error estimate for blocks of size 2^( 4) =       0.000406859566
  error estimate for blocks of size 2^( 5) =       0.000411866112
  error estimate for blocks of size 2^( 6) =       0.000415526140
  error estimate for blocks of size 2^( 7) =       0.000418132794

      target function =      -0.923635695348
              le_mean =     -17.209552713709
             les_mean =     296.450509092572
             stat err =       0.000413096153
             autocorr =       1.246274537630
   target nu stat err =       0.000413096153
   target dn stat err =       0.001806031475
      target stat err =       0.002451954818
              std dev =       0.523318678353
             le_variance =       0.273862439113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273930295676
                                         uncertainty =       0.001447522877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273930295676
                                         uncertainty =       0.001447522877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370036266
  error estimate for blocks of size 2^( 2) =       0.000384512844
  error estimate for blocks of size 2^( 3) =       0.000397432506
  error estimate for blocks of size 2^( 4) =       0.000406859566
  error estimate for blocks of size 2^( 5) =       0.000411866112
  error estimate for blocks of size 2^( 6) =       0.000415526140
  error estimate for blocks of size 2^( 7) =       0.000418132794

      target function =      -0.923635695348
              le_mean =     -17.209552713709
             les_mean =     296.450509092572
             stat err =       0.000413096153
             autocorr =       1.246274537630
   target nu stat err =       0.000413096153
   target dn stat err =       0.001806031475
      target stat err =       0.002451954818
              std dev =       0.523318678353
             le_variance =       0.273862439113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273930295676
                                         uncertainty =       0.001447522877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273930295676
                                         uncertainty =       0.001447522877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370036266
  error estimate for blocks of size 2^( 2) =       0.000384512844
  error estimate for blocks of size 2^( 3) =       0.000397432506
  error estimate for blocks of size 2^( 4) =       0.000406859566
  error estimate for blocks of size 2^( 5) =       0.000411866112
  error estimate for blocks of size 2^( 6) =       0.000415526140
  error estimate for blocks of size 2^( 7) =       0.000418132794

      target function =      -0.923635695348
              le_mean =     -17.209552713709
             les_mean =     296.450509092572
             stat err =       0.000413096153
             autocorr =       1.246274537630
   target nu stat err =       0.000413096153
   target dn stat err =       0.001806031475
      target stat err =       0.002451954818
              std dev =       0.523318678353
             le_variance =       0.273862439113


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923635695348        initial  <--
     5.9605e+33     5.9605e+34             1.7576e-38        -0.923635695348
     2.3842e+34     2.3842e+35             4.3940e-39        -0.923635695348
     9.5367e+34     9.5367e+35             1.0985e-39        -0.923635695348

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1441
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4516e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2237
    reference variance = 0.378423
====================================================
  Execution time = 2.7190e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0467e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8703e-01
  Total weights = 1.966208475e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3324e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277056287583
                                         uncertainty =       0.002209357500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277056287583
                                         uncertainty =       0.002209357500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372260970
  error estimate for blocks of size 2^( 2) =       0.000386525706
  error estimate for blocks of size 2^( 3) =       0.000399202304
  error estimate for blocks of size 2^( 4) =       0.000408943800
  error estimate for blocks of size 2^( 5) =       0.000413488361
  error estimate for blocks of size 2^( 6) =       0.000416166969
  error estimate for blocks of size 2^( 7) =       0.000417043656

      target function =      -0.916705500810
              le_mean =     -17.209258326437
             les_mean =     296.445606470932
             stat err =       0.000413910696
             autocorr =       1.236284117364
   target nu stat err =       0.000413910696
   target dn stat err =       0.003079363948
      target stat err =       0.004038394861
              std dev =       0.526464935925
             le_variance =       0.277165328758


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720925832644e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+34, overlap shift 5.9605e+35 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916722314392       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916722314392       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916722314392       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+34 is 3.214531e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+35, overlap shift 2.3842e+36 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916722314392       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916722314392       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916722314392       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+35 is 8.036327e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+35, overlap shift 9.5367e+36 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916722314392       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916722314392       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916722314392       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+35 is 2.009082e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.602369 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5538e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2251
    reference variance = 0.400393
====================================================
  Execution time = 2.6942e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9091e-01
  Total weights = 1.9665e+06
  Execution time = 2.4153e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278951596464
                                         uncertainty =       0.002857697881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278951596464
                                         uncertainty =       0.002857697881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373451203
  error estimate for blocks of size 2^( 2) =       0.000387692640
  error estimate for blocks of size 2^( 3) =       0.000401280130
  error estimate for blocks of size 2^( 4) =       0.000411005145
  error estimate for blocks of size 2^( 5) =       0.000416993091
  error estimate for blocks of size 2^( 6) =       0.000421645829
  error estimate for blocks of size 2^( 7) =       0.000421758592

      target function =      -0.911876979525
              le_mean =     -17.210008574109
             les_mean =     296.475304935555
             stat err =       0.000417850664
             autocorr =       1.251913915273
   target nu stat err =       0.000417850664
   target dn stat err =       0.004383995342
      target stat err =       0.005666083562
              std dev =       0.528148206989
             le_variance =       0.278940528546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278951596464
                                         uncertainty =       0.002857697881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278951596464
                                         uncertainty =       0.002857697881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373451203
  error estimate for blocks of size 2^( 2) =       0.000387692640
  error estimate for blocks of size 2^( 3) =       0.000401280130
  error estimate for blocks of size 2^( 4) =       0.000411005145
  error estimate for blocks of size 2^( 5) =       0.000416993091
  error estimate for blocks of size 2^( 6) =       0.000421645829
  error estimate for blocks of size 2^( 7) =       0.000421758592

      target function =      -0.911876979525
              le_mean =     -17.210008574109
             les_mean =     296.475304935555
             stat err =       0.000417850664
             autocorr =       1.251913915273
   target nu stat err =       0.000417850664
   target dn stat err =       0.004383995342
      target stat err =       0.005666083562
              std dev =       0.528148206989
             le_variance =       0.278940528546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278951596464
                                         uncertainty =       0.002857697881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278951596464
                                         uncertainty =       0.002857697881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373451203
  error estimate for blocks of size 2^( 2) =       0.000387692640
  error estimate for blocks of size 2^( 3) =       0.000401280130
  error estimate for blocks of size 2^( 4) =       0.000411005145
  error estimate for blocks of size 2^( 5) =       0.000416993091
  error estimate for blocks of size 2^( 6) =       0.000421645829
  error estimate for blocks of size 2^( 7) =       0.000421758592

      target function =      -0.911876979525
              le_mean =     -17.210008574109
             les_mean =     296.475304935555
             stat err =       0.000417850664
             autocorr =       1.251913915273
   target nu stat err =       0.000417850664
   target dn stat err =       0.004383995342
      target stat err =       0.005666083562
              std dev =       0.528148206989
             le_variance =       0.278940528546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278951596464
                                         uncertainty =       0.002857697881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278951596464
                                         uncertainty =       0.002857697881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373451203
  error estimate for blocks of size 2^( 2) =       0.000387692640
  error estimate for blocks of size 2^( 3) =       0.000401280130
  error estimate for blocks of size 2^( 4) =       0.000411005145
  error estimate for blocks of size 2^( 5) =       0.000416993091
  error estimate for blocks of size 2^( 6) =       0.000421645829
  error estimate for blocks of size 2^( 7) =       0.000421758592

      target function =      -0.911876979525
              le_mean =     -17.210008574109
             les_mean =     296.475304935555
             stat err =       0.000417850664
             autocorr =       1.251913915273
   target nu stat err =       0.000417850664
   target dn stat err =       0.004383995342
      target stat err =       0.005666083562
              std dev =       0.528148206989
             le_variance =       0.278940528546


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911876979525        initial  <--
     5.9605e+34     5.9605e+35             3.2145e-39        -0.911876979525
     2.3842e+35     2.3842e+36             8.0363e-40        -0.911876979525
     9.5367e+35     9.5367e+36             2.0091e-40        -0.911876979525

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1577
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4702e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1618
    reference variance = 0.169733
====================================================
  Execution time = 2.7060e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0505e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8612e-01
  Total weights = 1.966488799e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4859e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274981399795
                                         uncertainty =       0.001689690123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274981399795
                                         uncertainty =       0.001689690123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370745417
  error estimate for blocks of size 2^( 2) =       0.000385087073
  error estimate for blocks of size 2^( 3) =       0.000397839941
  error estimate for blocks of size 2^( 4) =       0.000407112602
  error estimate for blocks of size 2^( 5) =       0.000412518516
  error estimate for blocks of size 2^( 6) =       0.000414388470
  error estimate for blocks of size 2^( 7) =       0.000415815026

      target function =      -0.918006552899
              le_mean =     -17.209648663484
             les_mean =     296.458125258880
             stat err =       0.000412458653
             autocorr =       1.237682516977
   target nu stat err =       0.000412458653
   target dn stat err =       0.002438127597
      target stat err =       0.003227955275
              std dev =       0.524321586050
             le_variance =       0.274913125598


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720964866348e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+35, overlap shift 5.9605e+36 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918017108419       residual = 5.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918017108419       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918017108419       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917968750000       residual = 4.20e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917968750000       residual = 3.90e+03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921875000000       residual = 1.22e+08           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+35 is 2.514876e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+36, overlap shift 2.3842e+37 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918017108419       residual = 5.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918017108419       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918017108419       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917968750000       residual = 4.20e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917968750000       residual = 3.90e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+36 is 6.287191e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+36, overlap shift 9.5367e+37 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918017108419       residual = 5.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918017108419       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918017108419       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917968750000       residual = 4.20e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918017108419       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -1.000000000000       residual = 9.18e+07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.000002881089       residual = 9.50e+20           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.000000071377       residual = 5.97e+20           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+36 is 1.422628e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.605346 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5557e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2231
    reference variance = 0.137073
====================================================
  Execution time = 2.6962e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8572e-01
  Total weights = 1.9661e+06
  Execution time = 2.4109e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276058432694
                                         uncertainty =       0.001411474205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276058432694
                                         uncertainty =       0.001411474205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371525078
  error estimate for blocks of size 2^( 2) =       0.000385666575
  error estimate for blocks of size 2^( 3) =       0.000398650571
  error estimate for blocks of size 2^( 4) =       0.000408400664
  error estimate for blocks of size 2^( 5) =       0.000414405842
  error estimate for blocks of size 2^( 6) =       0.000416822049
  error estimate for blocks of size 2^( 7) =       0.000418962339

      target function =      -0.918455480894
              le_mean =     -17.209391191284
             les_mean =     296.448865393668
             stat err =       0.000414647724
             autocorr =       1.245610623523
   target nu stat err =       0.000414647724
   target dn stat err =       0.002475717387
      target stat err =       0.003278506434
              std dev =       0.525424210154
             le_variance =       0.276070600616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276058432694
                                         uncertainty =       0.001411474205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276058432694
                                         uncertainty =       0.001411474205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371525078
  error estimate for blocks of size 2^( 2) =       0.000385666575
  error estimate for blocks of size 2^( 3) =       0.000398650571
  error estimate for blocks of size 2^( 4) =       0.000408400664
  error estimate for blocks of size 2^( 5) =       0.000414405842
  error estimate for blocks of size 2^( 6) =       0.000416822049
  error estimate for blocks of size 2^( 7) =       0.000418962339

      target function =      -0.918455480894
              le_mean =     -17.209391191284
             les_mean =     296.448865393668
             stat err =       0.000414647724
             autocorr =       1.245610623523
   target nu stat err =       0.000414647724
   target dn stat err =       0.002475717387
      target stat err =       0.003278506434
              std dev =       0.525424210154
             le_variance =       0.276070600616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276058432694
                                         uncertainty =       0.001411474205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276058432694
                                         uncertainty =       0.001411474205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371525078
  error estimate for blocks of size 2^( 2) =       0.000385666575
  error estimate for blocks of size 2^( 3) =       0.000398650571
  error estimate for blocks of size 2^( 4) =       0.000408400664
  error estimate for blocks of size 2^( 5) =       0.000414405842
  error estimate for blocks of size 2^( 6) =       0.000416822049
  error estimate for blocks of size 2^( 7) =       0.000418962339

      target function =      -0.918455480894
              le_mean =     -17.209391191284
             les_mean =     296.448865393668
             stat err =       0.000414647724
             autocorr =       1.245610623523
   target nu stat err =       0.000414647724
   target dn stat err =       0.002475717387
      target stat err =       0.003278506434
              std dev =       0.525424210154
             le_variance =       0.276070600616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276058432694
                                         uncertainty =       0.001411474205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276058432694
                                         uncertainty =       0.001411474205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371525078
  error estimate for blocks of size 2^( 2) =       0.000385666575
  error estimate for blocks of size 2^( 3) =       0.000398650571
  error estimate for blocks of size 2^( 4) =       0.000408400664
  error estimate for blocks of size 2^( 5) =       0.000414405842
  error estimate for blocks of size 2^( 6) =       0.000416822049
  error estimate for blocks of size 2^( 7) =       0.000418962339

      target function =      -0.918455480894
              le_mean =     -17.209391191284
             les_mean =     296.448865393668
             stat err =       0.000414647724
             autocorr =       1.245610623523
   target nu stat err =       0.000414647724
   target dn stat err =       0.002475717387
      target stat err =       0.003278506434
              std dev =       0.525424210154
             le_variance =       0.276070600616


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918455480894        initial  <--
     5.9605e+35     5.9605e+36             2.5149e-40        -0.918455480894
     2.3842e+36     2.3842e+37             6.2872e-41        -0.918455480894
     9.5367e+36     9.5367e+37             1.4226e-41        -0.918455480894

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1727
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4736e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2654
    reference variance = 0.256137
====================================================
  Execution time = 2.7495e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0473e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8880e-01
  Total weights = 1.966145494e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7112e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279078843858
                                         uncertainty =       0.001736542721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279078843858
                                         uncertainty =       0.001736542721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373550560
  error estimate for blocks of size 2^( 2) =       0.000387775224
  error estimate for blocks of size 2^( 3) =       0.000400676376
  error estimate for blocks of size 2^( 4) =       0.000409642857
  error estimate for blocks of size 2^( 5) =       0.000416125952
  error estimate for blocks of size 2^( 6) =       0.000419190581
  error estimate for blocks of size 2^( 7) =       0.000420865801

      target function =      -0.914671771583
              le_mean =     -17.210188988647
             les_mean =     296.479400418680
             stat err =       0.000416456298
             autocorr =       1.242911153611
   target nu stat err =       0.000416456298
   target dn stat err =       0.002694842291
      target stat err =       0.003535634112
              std dev =       0.528288719935
             le_variance =       0.279088971610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721018898865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+36, overlap shift 5.9605e+37 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914684554227       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914684554227       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+37, overlap shift 2.3842e+38 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914684554227       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914684554227       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+37, overlap shift 9.5367e+38 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914684554227       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914684554227       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.606606 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6215e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2832
    reference variance = 0.475612
====================================================
  Execution time = 2.6824e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8112e-01
  Total weights = 1.9661e+06
  Execution time = 2.3608e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272233790263
                                         uncertainty =       0.001376613740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272233790263
                                         uncertainty =       0.001376613740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368904894
  error estimate for blocks of size 2^( 2) =       0.000383379448
  error estimate for blocks of size 2^( 3) =       0.000396621783
  error estimate for blocks of size 2^( 4) =       0.000406820710
  error estimate for blocks of size 2^( 5) =       0.000411794618
  error estimate for blocks of size 2^( 6) =       0.000415015589
  error estimate for blocks of size 2^( 7) =       0.000414549746

      target function =      -0.924672571826
              le_mean =     -17.210035576755
             les_mean =     296.466445529895
             stat err =       0.000412045166
             autocorr =       1.247558192956
   target nu stat err =       0.000412045166
   target dn stat err =       0.001870309969
      target stat err =       0.002541349188
              std dev =       0.521718651691
             le_variance =       0.272190351522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272233790263
                                         uncertainty =       0.001376613740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272233790263
                                         uncertainty =       0.001376613740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368904894
  error estimate for blocks of size 2^( 2) =       0.000383379448
  error estimate for blocks of size 2^( 3) =       0.000396621783
  error estimate for blocks of size 2^( 4) =       0.000406820710
  error estimate for blocks of size 2^( 5) =       0.000411794618
  error estimate for blocks of size 2^( 6) =       0.000415015589
  error estimate for blocks of size 2^( 7) =       0.000414549746

      target function =      -0.924672571826
              le_mean =     -17.210035576755
             les_mean =     296.466445529895
             stat err =       0.000412045166
             autocorr =       1.247558192956
   target nu stat err =       0.000412045166
   target dn stat err =       0.001870309969
      target stat err =       0.002541349188
              std dev =       0.521718651691
             le_variance =       0.272190351522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272233790263
                                         uncertainty =       0.001376613740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272233790263
                                         uncertainty =       0.001376613740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368904894
  error estimate for blocks of size 2^( 2) =       0.000383379448
  error estimate for blocks of size 2^( 3) =       0.000396621783
  error estimate for blocks of size 2^( 4) =       0.000406820710
  error estimate for blocks of size 2^( 5) =       0.000411794618
  error estimate for blocks of size 2^( 6) =       0.000415015589
  error estimate for blocks of size 2^( 7) =       0.000414549746

      target function =      -0.924672571826
              le_mean =     -17.210035576755
             les_mean =     296.466445529895
             stat err =       0.000412045166
             autocorr =       1.247558192956
   target nu stat err =       0.000412045166
   target dn stat err =       0.001870309969
      target stat err =       0.002541349188
              std dev =       0.521718651691
             le_variance =       0.272190351522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272233790263
                                         uncertainty =       0.001376613740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272233790263
                                         uncertainty =       0.001376613740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368904894
  error estimate for blocks of size 2^( 2) =       0.000383379448
  error estimate for blocks of size 2^( 3) =       0.000396621783
  error estimate for blocks of size 2^( 4) =       0.000406820710
  error estimate for blocks of size 2^( 5) =       0.000411794618
  error estimate for blocks of size 2^( 6) =       0.000415015589
  error estimate for blocks of size 2^( 7) =       0.000414549746

      target function =      -0.924672571826
              le_mean =     -17.210035576755
             les_mean =     296.466445529895
             stat err =       0.000412045166
             autocorr =       1.247558192956
   target nu stat err =       0.000412045166
   target dn stat err =       0.001870309969
      target stat err =       0.002541349188
              std dev =       0.521718651691
             le_variance =       0.272190351522


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924672571826        initial  <--
     5.9605e+36     5.9605e+37             0.0000e+00        -0.924672571826
     2.3842e+37     2.3842e+38             0.0000e+00        -0.924672571826
     9.5367e+37     9.5367e+38             0.0000e+00        -0.924672571826

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.7239
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4945e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2118
    reference variance = 0.177478
====================================================
  Execution time = 2.7105e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0497e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8475e-01
  Total weights = 1.966487561e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3479e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275446828863
                                         uncertainty =       0.001472406729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275446828863
                                         uncertainty =       0.001472406729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371085543
  error estimate for blocks of size 2^( 2) =       0.000385355715
  error estimate for blocks of size 2^( 3) =       0.000398158902
  error estimate for blocks of size 2^( 4) =       0.000407324960
  error estimate for blocks of size 2^( 5) =       0.000413169883
  error estimate for blocks of size 2^( 6) =       0.000418278650
  error estimate for blocks of size 2^( 7) =       0.000420810782

      target function =      -0.919814424825
              le_mean =     -17.209701008862
             les_mean =     296.458554021427
             stat err =       0.000414896069
             autocorr =       1.250059167118
   target nu stat err =       0.000414896069
   target dn stat err =       0.002124244820
      target stat err =       0.002838855788
              std dev =       0.524802604458
             le_variance =       0.275417773646


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720970100886e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+37, overlap shift 5.9605e+38 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919822393618       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919822393618       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919822393618       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919822393618       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+37 is 1.318697e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+38, overlap shift 2.3842e+39 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919822393618       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919822393618       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919815063477       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+38 is 2.936075e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+38, overlap shift 9.5367e+39 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919822393618       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919822393618       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919822393618       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919822393618       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919822393618       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -1.000000000000       residual = 1.06e+07           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+38 is 8.432238e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.608704 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5462e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2055
    reference variance = 0.373217
====================================================
  Execution time = 2.7456e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9001e-01
  Total weights = 1.9662e+06
  Execution time = 2.3739e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279357518171
                                         uncertainty =       0.002559671454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279357518171
                                         uncertainty =       0.002559671454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373709892
  error estimate for blocks of size 2^( 2) =       0.000387983999
  error estimate for blocks of size 2^( 3) =       0.000401192484
  error estimate for blocks of size 2^( 4) =       0.000410876364
  error estimate for blocks of size 2^( 5) =       0.000417632656
  error estimate for blocks of size 2^( 6) =       0.000421681361
  error estimate for blocks of size 2^( 7) =       0.000424325545

      target function =      -0.913010399221
              le_mean =     -17.209835557462
             les_mean =     296.468451332311
             stat err =       0.000418628982
             autocorr =       1.254843005518
   target nu stat err =       0.000418628982
   target dn stat err =       0.002739511910
      target stat err =       0.003578314548
              std dev =       0.528514054259
             le_variance =       0.279327105549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279357518171
                                         uncertainty =       0.002559671454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279357518171
                                         uncertainty =       0.002559671454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373709892
  error estimate for blocks of size 2^( 2) =       0.000387983999
  error estimate for blocks of size 2^( 3) =       0.000401192484
  error estimate for blocks of size 2^( 4) =       0.000410876364
  error estimate for blocks of size 2^( 5) =       0.000417632656
  error estimate for blocks of size 2^( 6) =       0.000421681361
  error estimate for blocks of size 2^( 7) =       0.000424325545

      target function =      -0.913010399221
              le_mean =     -17.209835557462
             les_mean =     296.468451332311
             stat err =       0.000418628982
             autocorr =       1.254843005515
   target nu stat err =       0.000418628982
   target dn stat err =       0.002739511910
      target stat err =       0.003578314548
              std dev =       0.528514054259
             le_variance =       0.279327105549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279357518171
                                         uncertainty =       0.002559671454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279357518171
                                         uncertainty =       0.002559671454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373709892
  error estimate for blocks of size 2^( 2) =       0.000387983999
  error estimate for blocks of size 2^( 3) =       0.000401192484
  error estimate for blocks of size 2^( 4) =       0.000410876364
  error estimate for blocks of size 2^( 5) =       0.000417632656
  error estimate for blocks of size 2^( 6) =       0.000421681361
  error estimate for blocks of size 2^( 7) =       0.000424325545

      target function =      -0.913010399221
              le_mean =     -17.209835557462
             les_mean =     296.468451332311
             stat err =       0.000418628982
             autocorr =       1.254843005515
   target nu stat err =       0.000418628982
   target dn stat err =       0.002739511910
      target stat err =       0.003578314548
              std dev =       0.528514054259
             le_variance =       0.279327105549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279357518171
                                         uncertainty =       0.002559671454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279357518171
                                         uncertainty =       0.002559671454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373709892
  error estimate for blocks of size 2^( 2) =       0.000387983999
  error estimate for blocks of size 2^( 3) =       0.000401192484
  error estimate for blocks of size 2^( 4) =       0.000410876364
  error estimate for blocks of size 2^( 5) =       0.000417632656
  error estimate for blocks of size 2^( 6) =       0.000421681361
  error estimate for blocks of size 2^( 7) =       0.000424325545

      target function =      -0.913010399221
              le_mean =     -17.209835557462
             les_mean =     296.468451332311
             stat err =       0.000418628982
             autocorr =       1.254843005515
   target nu stat err =       0.000418628982
   target dn stat err =       0.002739511910
      target stat err =       0.003578314548
              std dev =       0.528514054259
             le_variance =       0.279327105549


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913010399221        initial  <--
     5.9605e+37     5.9605e+38             1.3187e-42        -0.913010399221
     2.3842e+38     2.3842e+39             2.9361e-43        -0.913010399221
     9.5367e+38     9.5367e+39             8.4322e-44        -0.913010399221

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.4162
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4884e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.1218
    reference variance = 0.307051
====================================================
  Execution time = 2.7152e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0493e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8556e-01
  Total weights = 1.966314460e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2861e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276849581774
                                         uncertainty =       0.001626043983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276849581774
                                         uncertainty =       0.001626043983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372041846
  error estimate for blocks of size 2^( 2) =       0.000386497110
  error estimate for blocks of size 2^( 3) =       0.000399738427
  error estimate for blocks of size 2^( 4) =       0.000408534729
  error estimate for blocks of size 2^( 5) =       0.000413903130
  error estimate for blocks of size 2^( 6) =       0.000417474740
  error estimate for blocks of size 2^( 7) =       0.000417536938

      target function =      -0.918598534838
              le_mean =     -17.209122787881
             les_mean =     296.439463532614
             stat err =       0.000414362384
             autocorr =       1.240443722594
   target nu stat err =       0.000414362384
   target dn stat err =       0.002249942485
      target stat err =       0.002989197233
              std dev =       0.526155042495
             le_variance =       0.276839128743


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720912278788e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+38, overlap shift 5.9605e+39 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918607540735       residual = 6.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918607540735       residual = 6.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+39, overlap shift 2.3842e+40 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918607540735       residual = 6.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918607540735       residual = 6.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+39, overlap shift 9.5367e+40 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918607540735       residual = 6.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918607540735       residual = 6.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.609971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5447e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2844
    reference variance = 0.2502
====================================================
  Execution time = 2.7104e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8946e-01
  Total weights = 1.9666e+06
  Execution time = 2.3607e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279958840673
                                         uncertainty =       0.002076348319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279958840673
                                         uncertainty =       0.002076348319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374081876
  error estimate for blocks of size 2^( 2) =       0.000388179796
  error estimate for blocks of size 2^( 3) =       0.000401365194
  error estimate for blocks of size 2^( 4) =       0.000410677993
  error estimate for blocks of size 2^( 5) =       0.000416652255
  error estimate for blocks of size 2^( 6) =       0.000418478911
  error estimate for blocks of size 2^( 7) =       0.000419707369

      target function =      -0.913826348659
              le_mean =     -17.210234185646
             les_mean =     296.481621318256
             stat err =       0.000416379132
             autocorr =       1.238923741258
   target nu stat err =       0.000416379132
   target dn stat err =       0.002382888599
      target stat err =       0.003132922386
              std dev =       0.529040127560
             le_variance =       0.279883456568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279958840673
                                         uncertainty =       0.002076348319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279958840673
                                         uncertainty =       0.002076348319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374081876
  error estimate for blocks of size 2^( 2) =       0.000388179796
  error estimate for blocks of size 2^( 3) =       0.000401365194
  error estimate for blocks of size 2^( 4) =       0.000410677993
  error estimate for blocks of size 2^( 5) =       0.000416652255
  error estimate for blocks of size 2^( 6) =       0.000418478911
  error estimate for blocks of size 2^( 7) =       0.000419707369

      target function =      -0.913826348659
              le_mean =     -17.210234185646
             les_mean =     296.481621318256
             stat err =       0.000416379132
             autocorr =       1.238923741258
   target nu stat err =       0.000416379132
   target dn stat err =       0.002382888599
      target stat err =       0.003132922386
              std dev =       0.529040127560
             le_variance =       0.279883456568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279958840673
                                         uncertainty =       0.002076348319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279958840673
                                         uncertainty =       0.002076348319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374081876
  error estimate for blocks of size 2^( 2) =       0.000388179796
  error estimate for blocks of size 2^( 3) =       0.000401365194
  error estimate for blocks of size 2^( 4) =       0.000410677993
  error estimate for blocks of size 2^( 5) =       0.000416652255
  error estimate for blocks of size 2^( 6) =       0.000418478911
  error estimate for blocks of size 2^( 7) =       0.000419707369

      target function =      -0.913826348659
              le_mean =     -17.210234185646
             les_mean =     296.481621318256
             stat err =       0.000416379132
             autocorr =       1.238923741258
   target nu stat err =       0.000416379132
   target dn stat err =       0.002382888599
      target stat err =       0.003132922386
              std dev =       0.529040127560
             le_variance =       0.279883456568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279958840673
                                         uncertainty =       0.002076348319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279958840673
                                         uncertainty =       0.002076348319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374081876
  error estimate for blocks of size 2^( 2) =       0.000388179796
  error estimate for blocks of size 2^( 3) =       0.000401365194
  error estimate for blocks of size 2^( 4) =       0.000410677993
  error estimate for blocks of size 2^( 5) =       0.000416652255
  error estimate for blocks of size 2^( 6) =       0.000418478911
  error estimate for blocks of size 2^( 7) =       0.000419707369

      target function =      -0.913826348659
              le_mean =     -17.210234185646
             les_mean =     296.481621318256
             stat err =       0.000416379132
             autocorr =       1.238923741258
   target nu stat err =       0.000416379132
   target dn stat err =       0.002382888599
      target stat err =       0.003132922386
              std dev =       0.529040127560
             le_variance =       0.279883456568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913826348659        initial  <--
     5.9605e+38     5.9605e+39             0.0000e+00        -0.913826348659
     2.3842e+39     2.3842e+40             0.0000e+00        -0.913826348659
     9.5367e+39     9.5367e+40             0.0000e+00        -0.913826348659

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0224
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4476e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.207
    reference variance = 0.221111
====================================================
  Execution time = 2.7187e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0507e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9207e-01
  Total weights = 1.966458620e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4187e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282139592802
                                         uncertainty =       0.005258346090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282139592802
                                         uncertainty =       0.005258346090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375559985
  error estimate for blocks of size 2^( 2) =       0.000389922753
  error estimate for blocks of size 2^( 3) =       0.000402611556
  error estimate for blocks of size 2^( 4) =       0.000412687922
  error estimate for blocks of size 2^( 5) =       0.000419388646
  error estimate for blocks of size 2^( 6) =       0.000420322046
  error estimate for blocks of size 2^( 7) =       0.000423522023

      target function =      -0.910408229644
              le_mean =     -17.210227448999
             les_mean =     296.484002997437
             stat err =       0.000418980159
             autocorr =       1.244595676865
   target nu stat err =       0.000418980159
   target dn stat err =       0.005944643006
      target stat err =       0.007642535480
              std dev =       0.531130522773
             le_variance =       0.282099632221


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721022744900e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+39, overlap shift 5.9605e+40 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910472071697       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910472071697       residual = 4.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910472071697       residual = 9.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910476684570       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906250000000       residual = 3.97e+04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 4.62e+07           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+39 is 4.738146e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+40, overlap shift 2.3842e+41 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910472071697       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910472071697       residual = 4.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910472071697       residual = 9.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+40 is 1.184536e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+40, overlap shift 9.5367e+41 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910472071697       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910472071697       residual = 4.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910472071697       residual = 9.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910461425781       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910156250000       residual = 5.93e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 1.27e+07           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+40 is 2.961341e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.612333 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5615e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.1916
    reference variance = 0.249401
====================================================
  Execution time = 2.6980e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8371e-01
  Total weights = 1.9664e+06
  Execution time = 2.3800e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275829836975
                                         uncertainty =       0.001435153918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275829836975
                                         uncertainty =       0.001435153918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371340650
  error estimate for blocks of size 2^( 2) =       0.000385806925
  error estimate for blocks of size 2^( 3) =       0.000398565012
  error estimate for blocks of size 2^( 4) =       0.000408555804
  error estimate for blocks of size 2^( 5) =       0.000415031124
  error estimate for blocks of size 2^( 6) =       0.000419545903
  error estimate for blocks of size 2^( 7) =       0.000421604070

      target function =      -0.921344624205
              le_mean =     -17.210316465590
             les_mean =     296.478699301034
             stat err =       0.000416184225
             autocorr =       1.256105866792
   target nu stat err =       0.000416184225
   target dn stat err =       0.001843304849
      target stat err =       0.002491604239
              std dev =       0.525163385592
             le_variance =       0.275796581566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275829836975
                                         uncertainty =       0.001435153918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275829836975
                                         uncertainty =       0.001435153918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371340650
  error estimate for blocks of size 2^( 2) =       0.000385806925
  error estimate for blocks of size 2^( 3) =       0.000398565012
  error estimate for blocks of size 2^( 4) =       0.000408555804
  error estimate for blocks of size 2^( 5) =       0.000415031124
  error estimate for blocks of size 2^( 6) =       0.000419545903
  error estimate for blocks of size 2^( 7) =       0.000421604070

      target function =      -0.921344624205
              le_mean =     -17.210316465590
             les_mean =     296.478699301034
             stat err =       0.000416184225
             autocorr =       1.256105866792
   target nu stat err =       0.000416184225
   target dn stat err =       0.001843304849
      target stat err =       0.002491604239
              std dev =       0.525163385592
             le_variance =       0.275796581566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275829836975
                                         uncertainty =       0.001435153918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275829836975
                                         uncertainty =       0.001435153918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371340650
  error estimate for blocks of size 2^( 2) =       0.000385806925
  error estimate for blocks of size 2^( 3) =       0.000398565012
  error estimate for blocks of size 2^( 4) =       0.000408555804
  error estimate for blocks of size 2^( 5) =       0.000415031124
  error estimate for blocks of size 2^( 6) =       0.000419545903
  error estimate for blocks of size 2^( 7) =       0.000421604070

      target function =      -0.921344624205
              le_mean =     -17.210316465590
             les_mean =     296.478699301034
             stat err =       0.000416184225
             autocorr =       1.256105866792
   target nu stat err =       0.000416184225
   target dn stat err =       0.001843304849
      target stat err =       0.002491604239
              std dev =       0.525163385592
             le_variance =       0.275796581566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275829836975
                                         uncertainty =       0.001435153918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275829836975
                                         uncertainty =       0.001435153918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371340650
  error estimate for blocks of size 2^( 2) =       0.000385806925
  error estimate for blocks of size 2^( 3) =       0.000398565012
  error estimate for blocks of size 2^( 4) =       0.000408555804
  error estimate for blocks of size 2^( 5) =       0.000415031124
  error estimate for blocks of size 2^( 6) =       0.000419545903
  error estimate for blocks of size 2^( 7) =       0.000421604070

      target function =      -0.921344624205
              le_mean =     -17.210316465590
             les_mean =     296.478699301034
             stat err =       0.000416184225
             autocorr =       1.256105866792
   target nu stat err =       0.000416184225
   target dn stat err =       0.001843304849
      target stat err =       0.002491604239
              std dev =       0.525163385592
             le_variance =       0.275796581566


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921344624205        initial  <--
     5.9605e+39     5.9605e+40             4.7381e-44        -0.921344624205
     2.3842e+40     2.3842e+41             1.1845e-44        -0.921344624205
     9.5367e+40     9.5367e+41             2.9613e-45        -0.921344624205

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9598
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4581e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2263
    reference variance = 0.278464
====================================================
  Execution time = 2.7093e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0494e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8574e-01
  Total weights = 1.966465945e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8009e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275737124232
                                         uncertainty =       0.002194789084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275737124232
                                         uncertainty =       0.002194789084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371291055
  error estimate for blocks of size 2^( 2) =       0.000385401317
  error estimate for blocks of size 2^( 3) =       0.000398556111
  error estimate for blocks of size 2^( 4) =       0.000408411945
  error estimate for blocks of size 2^( 5) =       0.000413705131
  error estimate for blocks of size 2^( 6) =       0.000414990290
  error estimate for blocks of size 2^( 7) =       0.000415614710

      target function =      -0.918468848652
              le_mean =     -17.209580314935
             les_mean =     296.455399123206
             stat err =       0.000413180519
             autocorr =       1.238370792454
   target nu stat err =       0.000413180519
   target dn stat err =       0.003031100825
      target stat err =       0.003993422189
              std dev =       0.525093247261
             le_variance =       0.275722918319


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720958031493e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+40, overlap shift 5.9605e+41 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918485513494       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918485513494       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+41, overlap shift 2.3842e+42 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918485513494       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918485513494       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+41, overlap shift 9.5367e+42 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918485513494       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918485513494       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.613576 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6906e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2733
    reference variance = 1.29447
====================================================
  Execution time = 2.7311e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8657e-01
  Total weights = 1.9662e+06
  Execution time = 2.3817e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276794918976
                                         uncertainty =       0.001716751446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276794918976
                                         uncertainty =       0.001716751446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371989943
  error estimate for blocks of size 2^( 2) =       0.000386077126
  error estimate for blocks of size 2^( 3) =       0.000399431205
  error estimate for blocks of size 2^( 4) =       0.000408574340
  error estimate for blocks of size 2^( 5) =       0.000413515686
  error estimate for blocks of size 2^( 6) =       0.000418080106
  error estimate for blocks of size 2^( 7) =       0.000420860539

      target function =      -0.917567270170
              le_mean =     -17.210204987450
             les_mean =     296.477723458183
             stat err =       0.000415257668
             autocorr =       1.246157465332
   target nu stat err =       0.000415257668
   target dn stat err =       0.002644908785
      target stat err =       0.003493453905
              std dev =       0.526081639769
             le_variance =       0.276761891702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276794918976
                                         uncertainty =       0.001716751446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276794918976
                                         uncertainty =       0.001716751446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371989943
  error estimate for blocks of size 2^( 2) =       0.000386077126
  error estimate for blocks of size 2^( 3) =       0.000399431205
  error estimate for blocks of size 2^( 4) =       0.000408574340
  error estimate for blocks of size 2^( 5) =       0.000413515686
  error estimate for blocks of size 2^( 6) =       0.000418080106
  error estimate for blocks of size 2^( 7) =       0.000420860539

      target function =      -0.917567270170
              le_mean =     -17.210204987450
             les_mean =     296.477723458183
             stat err =       0.000415257668
             autocorr =       1.246157465331
   target nu stat err =       0.000415257668
   target dn stat err =       0.002644908785
      target stat err =       0.003493453905
              std dev =       0.526081639769
             le_variance =       0.276761891702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276794918976
                                         uncertainty =       0.001716751446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276794918976
                                         uncertainty =       0.001716751446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371989943
  error estimate for blocks of size 2^( 2) =       0.000386077126
  error estimate for blocks of size 2^( 3) =       0.000399431205
  error estimate for blocks of size 2^( 4) =       0.000408574340
  error estimate for blocks of size 2^( 5) =       0.000413515686
  error estimate for blocks of size 2^( 6) =       0.000418080106
  error estimate for blocks of size 2^( 7) =       0.000420860539

      target function =      -0.917567270170
              le_mean =     -17.210204987450
             les_mean =     296.477723458183
             stat err =       0.000415257668
             autocorr =       1.246157465331
   target nu stat err =       0.000415257668
   target dn stat err =       0.002644908785
      target stat err =       0.003493453905
              std dev =       0.526081639769
             le_variance =       0.276761891702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276794918976
                                         uncertainty =       0.001716751446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276794918976
                                         uncertainty =       0.001716751446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371989943
  error estimate for blocks of size 2^( 2) =       0.000386077126
  error estimate for blocks of size 2^( 3) =       0.000399431205
  error estimate for blocks of size 2^( 4) =       0.000408574340
  error estimate for blocks of size 2^( 5) =       0.000413515686
  error estimate for blocks of size 2^( 6) =       0.000418080106
  error estimate for blocks of size 2^( 7) =       0.000420860539

      target function =      -0.917567270170
              le_mean =     -17.210204987450
             les_mean =     296.477723458183
             stat err =       0.000415257668
             autocorr =       1.246157465331
   target nu stat err =       0.000415257668
   target dn stat err =       0.002644908785
      target stat err =       0.003493453905
              std dev =       0.526081639769
             le_variance =       0.276761891702


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917567270170        initial  <--
     5.9605e+40     5.9605e+41             0.0000e+00        -0.917567270170
     2.3842e+41     2.3842e+42             0.0000e+00        -0.917567270170
     9.5367e+41     9.5367e+42             0.0000e+00        -0.917567270170

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2789
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6191e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.1977
    reference variance = 0.204348
====================================================
  Execution time = 2.7114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0474e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8812e-01
  Total weights = 1.966202456e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1767e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276177639864
                                         uncertainty =       0.001868843187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276177639864
                                         uncertainty =       0.001868843187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371602350
  error estimate for blocks of size 2^( 2) =       0.000386242311
  error estimate for blocks of size 2^( 3) =       0.000399367671
  error estimate for blocks of size 2^( 4) =       0.000408553963
  error estimate for blocks of size 2^( 5) =       0.000414322618
  error estimate for blocks of size 2^( 6) =       0.000417432417
  error estimate for blocks of size 2^( 7) =       0.000418804764

      target function =      -0.915539894975
              le_mean =     -17.210231432832
             les_mean =     296.480188829442
             stat err =       0.000414778440
             autocorr =       1.245877794186
   target nu stat err =       0.000414778440
   target dn stat err =       0.003840232422
      target stat err =       0.005012334274
              std dev =       0.525533491431
             le_variance =       0.276185450616


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721023143283e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+41, overlap shift 5.9605e+42 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915566497859       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915566497859       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915566497859       residual = 6.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915566497859       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.000000000000       residual = 1.72e+04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915566375967       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+41 is 3.866154e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+42, overlap shift 2.3842e+43 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915566497859       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915566497859       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915566497859       residual = 6.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915566497859       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915566497857       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 1.94e+06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903470635414       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+42 is 9.687738e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+42, overlap shift 9.5367e+43 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915566497859       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915566497859       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915566497859       residual = 6.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915566497859       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 1.70e+04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915566471775       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.002347040540       residual = 2.87e+26           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+42 is 2.413850e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.616598 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5301e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2109
    reference variance = 0.184662
====================================================
  Execution time = 2.6876e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8592e-01
  Total weights = 1.9664e+06
  Execution time = 2.3739e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275334309403
                                         uncertainty =       0.001469694112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275334309403
                                         uncertainty =       0.001469694112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370995288
  error estimate for blocks of size 2^( 2) =       0.000385315638
  error estimate for blocks of size 2^( 3) =       0.000397954952
  error estimate for blocks of size 2^( 4) =       0.000407573600
  error estimate for blocks of size 2^( 5) =       0.000413498411
  error estimate for blocks of size 2^( 6) =       0.000417254519
  error estimate for blocks of size 2^( 7) =       0.000421380620

      target function =      -0.918241224062
              le_mean =     -17.209578445811
             les_mean =     296.455508258485
             stat err =       0.000414926787
             autocorr =       1.250852669483
   target nu stat err =       0.000414926787
   target dn stat err =       0.003177400804
      target stat err =       0.004180398211
              std dev =       0.524674962348
             le_variance =       0.275283816115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275334309403
                                         uncertainty =       0.001469694112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275334309403
                                         uncertainty =       0.001469694112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370995288
  error estimate for blocks of size 2^( 2) =       0.000385315638
  error estimate for blocks of size 2^( 3) =       0.000397954952
  error estimate for blocks of size 2^( 4) =       0.000407573600
  error estimate for blocks of size 2^( 5) =       0.000413498411
  error estimate for blocks of size 2^( 6) =       0.000417254519
  error estimate for blocks of size 2^( 7) =       0.000421380620

      target function =      -0.918241224062
              le_mean =     -17.209578445811
             les_mean =     296.455508258485
             stat err =       0.000414926787
             autocorr =       1.250852669483
   target nu stat err =       0.000414926787
   target dn stat err =       0.003177400804
      target stat err =       0.004180398211
              std dev =       0.524674962348
             le_variance =       0.275283816115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275334309403
                                         uncertainty =       0.001469694112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275334309403
                                         uncertainty =       0.001469694112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370995288
  error estimate for blocks of size 2^( 2) =       0.000385315638
  error estimate for blocks of size 2^( 3) =       0.000397954952
  error estimate for blocks of size 2^( 4) =       0.000407573600
  error estimate for blocks of size 2^( 5) =       0.000413498411
  error estimate for blocks of size 2^( 6) =       0.000417254519
  error estimate for blocks of size 2^( 7) =       0.000421380620

      target function =      -0.918241224062
              le_mean =     -17.209578445811
             les_mean =     296.455508258485
             stat err =       0.000414926787
             autocorr =       1.250852669483
   target nu stat err =       0.000414926787
   target dn stat err =       0.003177400804
      target stat err =       0.004180398211
              std dev =       0.524674962348
             le_variance =       0.275283816115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275334309403
                                         uncertainty =       0.001469694112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275334309403
                                         uncertainty =       0.001469694112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370995288
  error estimate for blocks of size 2^( 2) =       0.000385315638
  error estimate for blocks of size 2^( 3) =       0.000397954952
  error estimate for blocks of size 2^( 4) =       0.000407573600
  error estimate for blocks of size 2^( 5) =       0.000413498411
  error estimate for blocks of size 2^( 6) =       0.000417254519
  error estimate for blocks of size 2^( 7) =       0.000421380620

      target function =      -0.918241224062
              le_mean =     -17.209578445811
             les_mean =     296.455508258485
             stat err =       0.000414926787
             autocorr =       1.250852669483
   target nu stat err =       0.000414926787
   target dn stat err =       0.003177400804
      target stat err =       0.004180398211
              std dev =       0.524674962348
             le_variance =       0.275283816115


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918241224062        initial  <--
     5.9605e+41     5.9605e+42             3.8662e-46        -0.918241224062
     2.3842e+42     2.3842e+43             9.6877e-47        -0.918241224062
     9.5367e+42     9.5367e+43             2.4138e-47        -0.918241224062

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8489
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4157e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.1807
    reference variance = 0.320314
====================================================
  Execution time = 2.7062e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0483e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8189e-01
  Total weights = 1.966036755e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4088e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273824717730
                                         uncertainty =       0.001376633435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273824717730
                                         uncertainty =       0.001376633435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370050696
  error estimate for blocks of size 2^( 2) =       0.000384281460
  error estimate for blocks of size 2^( 3) =       0.000397652986
  error estimate for blocks of size 2^( 4) =       0.000406831965
  error estimate for blocks of size 2^( 5) =       0.000412439436
  error estimate for blocks of size 2^( 6) =       0.000415202449
  error estimate for blocks of size 2^( 7) =       0.000418376633

      target function =      -0.923666852906
              le_mean =     -17.210055243982
             les_mean =     296.467888672575
             stat err =       0.000413212621
             autocorr =       1.246880134186
   target nu stat err =       0.000413212621
   target dn stat err =       0.001799798968
      target stat err =       0.002446082002
              std dev =       0.523339085609
             le_variance =       0.273883798526


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721005524398e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+42, overlap shift 5.9605e+43 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923672579243       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923672579243       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+43, overlap shift 2.3842e+44 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923672579243       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923672579243       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+43, overlap shift 9.5367e+44 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923672579243       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923672579243       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.617847 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5480e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.1694
    reference variance = 0.286625
====================================================
  Execution time = 2.6917e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8623e-01
  Total weights = 1.9663e+06
  Execution time = 2.3724e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276677501041
                                         uncertainty =       0.001903071749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276677501041
                                         uncertainty =       0.001903071749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371918200
  error estimate for blocks of size 2^( 2) =       0.000386312104
  error estimate for blocks of size 2^( 3) =       0.000399512719
  error estimate for blocks of size 2^( 4) =       0.000409208390
  error estimate for blocks of size 2^( 5) =       0.000415294972
  error estimate for blocks of size 2^( 6) =       0.000418254336
  error estimate for blocks of size 2^( 7) =       0.000416390383

      target function =      -0.917940908986
              le_mean =     -17.209934991931
             les_mean =     296.468089648817
             stat err =       0.000414787020
             autocorr =       1.243814031776
   target nu stat err =       0.000414787020
   target dn stat err =       0.002420486939
      target stat err =       0.003206941898
              std dev =       0.525980178433
             le_variance =       0.276655148104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276677501041
                                         uncertainty =       0.001903071749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276677501041
                                         uncertainty =       0.001903071749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371918200
  error estimate for blocks of size 2^( 2) =       0.000386312104
  error estimate for blocks of size 2^( 3) =       0.000399512719
  error estimate for blocks of size 2^( 4) =       0.000409208390
  error estimate for blocks of size 2^( 5) =       0.000415294972
  error estimate for blocks of size 2^( 6) =       0.000418254336
  error estimate for blocks of size 2^( 7) =       0.000416390383

      target function =      -0.917940908986
              le_mean =     -17.209934991931
             les_mean =     296.468089648817
             stat err =       0.000414787020
             autocorr =       1.243814031775
   target nu stat err =       0.000414787020
   target dn stat err =       0.002420486939
      target stat err =       0.003206941898
              std dev =       0.525980178433
             le_variance =       0.276655148104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276677501041
                                         uncertainty =       0.001903071749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276677501041
                                         uncertainty =       0.001903071749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371918200
  error estimate for blocks of size 2^( 2) =       0.000386312104
  error estimate for blocks of size 2^( 3) =       0.000399512719
  error estimate for blocks of size 2^( 4) =       0.000409208390
  error estimate for blocks of size 2^( 5) =       0.000415294972
  error estimate for blocks of size 2^( 6) =       0.000418254336
  error estimate for blocks of size 2^( 7) =       0.000416390383

      target function =      -0.917940908986
              le_mean =     -17.209934991931
             les_mean =     296.468089648817
             stat err =       0.000414787020
             autocorr =       1.243814031775
   target nu stat err =       0.000414787020
   target dn stat err =       0.002420486939
      target stat err =       0.003206941898
              std dev =       0.525980178433
             le_variance =       0.276655148104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276677501041
                                         uncertainty =       0.001903071749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276677501041
                                         uncertainty =       0.001903071749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371918200
  error estimate for blocks of size 2^( 2) =       0.000386312104
  error estimate for blocks of size 2^( 3) =       0.000399512719
  error estimate for blocks of size 2^( 4) =       0.000409208390
  error estimate for blocks of size 2^( 5) =       0.000415294972
  error estimate for blocks of size 2^( 6) =       0.000418254336
  error estimate for blocks of size 2^( 7) =       0.000416390383

      target function =      -0.917940908986
              le_mean =     -17.209934991931
             les_mean =     296.468089648817
             stat err =       0.000414787020
             autocorr =       1.243814031775
   target nu stat err =       0.000414787020
   target dn stat err =       0.002420486939
      target stat err =       0.003206941898
              std dev =       0.525980178433
             le_variance =       0.276655148104


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917940908986        initial  <--
     5.9605e+42     5.9605e+43             0.0000e+00        -0.917940908986
     2.3842e+43     2.3842e+44             0.0000e+00        -0.917940908986
     9.5367e+43     9.5367e+44             0.0000e+00        -0.917940908986

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8862
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4377e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.1749
    reference variance = 0.207416
====================================================
  Execution time = 2.7097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0452e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8232e-01
  Total weights = 1.966398132e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4220e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273996189710
                                         uncertainty =       0.001435223310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273996189710
                                         uncertainty =       0.001435223310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370094708
  error estimate for blocks of size 2^( 2) =       0.000384634244
  error estimate for blocks of size 2^( 3) =       0.000398045096
  error estimate for blocks of size 2^( 4) =       0.000407845999
  error estimate for blocks of size 2^( 5) =       0.000413641410
  error estimate for blocks of size 2^( 6) =       0.000416361470
  error estimate for blocks of size 2^( 7) =       0.000419879581

      target function =      -0.923080300536
              le_mean =     -17.209996364333
             les_mean =     296.466293781933
             stat err =       0.000414432115
             autocorr =       1.253952411551
   target nu stat err =       0.000414432115
   target dn stat err =       0.001969861026
      target stat err =       0.002661158941
              std dev =       0.523401329317
             le_variance =       0.273948951530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720999636433e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+43, overlap shift 5.9605e+44 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923087146245       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923087146245       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923087146245       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923087146245       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923087097995       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923087121979       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914922311225       residual = 7.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+43 is 2.104577e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+44, overlap shift 2.3842e+45 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923087146245       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923087146245       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923087146245       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923087146245       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+44 is 4.250366e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+44, overlap shift 9.5367e+45 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923087146245       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923087146245       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923087146245       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923087146245       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 5.36e+04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 5.11e+12           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+44 is 1.062591e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.623159 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5534e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.1719
    reference variance = 0.212628
====================================================
  Execution time = 2.6952e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8925e-01
  Total weights = 1.9662e+06
  Execution time = 2.3808e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279159069153
                                         uncertainty =       0.002013758516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279159069153
                                         uncertainty =       0.002013758516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373553424
  error estimate for blocks of size 2^( 2) =       0.000387588534
  error estimate for blocks of size 2^( 3) =       0.000399906503
  error estimate for blocks of size 2^( 4) =       0.000409560561
  error estimate for blocks of size 2^( 5) =       0.000415302233
  error estimate for blocks of size 2^( 6) =       0.000418894413
  error estimate for blocks of size 2^( 7) =       0.000420609171

      target function =      -0.913740745606
              le_mean =     -17.208867558732
             les_mean =     296.434373242631
             stat err =       0.000416091594
             autocorr =       1.240716172198
   target nu stat err =       0.000416091594
   target dn stat err =       0.002765400567
      target stat err =       0.003610929737
              std dev =       0.528292770473
             le_variance =       0.279093251334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279159069153
                                         uncertainty =       0.002013758516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279159069153
                                         uncertainty =       0.002013758516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373553424
  error estimate for blocks of size 2^( 2) =       0.000387588534
  error estimate for blocks of size 2^( 3) =       0.000399906503
  error estimate for blocks of size 2^( 4) =       0.000409560561
  error estimate for blocks of size 2^( 5) =       0.000415302233
  error estimate for blocks of size 2^( 6) =       0.000418894413
  error estimate for blocks of size 2^( 7) =       0.000420609171

      target function =      -0.913740745606
              le_mean =     -17.208867558732
             les_mean =     296.434373242631
             stat err =       0.000416091594
             autocorr =       1.240716172198
   target nu stat err =       0.000416091594
   target dn stat err =       0.002765400567
      target stat err =       0.003610929737
              std dev =       0.528292770473
             le_variance =       0.279093251334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279159069153
                                         uncertainty =       0.002013758516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279159069153
                                         uncertainty =       0.002013758516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373553424
  error estimate for blocks of size 2^( 2) =       0.000387588534
  error estimate for blocks of size 2^( 3) =       0.000399906503
  error estimate for blocks of size 2^( 4) =       0.000409560561
  error estimate for blocks of size 2^( 5) =       0.000415302233
  error estimate for blocks of size 2^( 6) =       0.000418894413
  error estimate for blocks of size 2^( 7) =       0.000420609171

      target function =      -0.913740745606
              le_mean =     -17.208867558732
             les_mean =     296.434373242631
             stat err =       0.000416091594
             autocorr =       1.240716172198
   target nu stat err =       0.000416091594
   target dn stat err =       0.002765400567
      target stat err =       0.003610929737
              std dev =       0.528292770473
             le_variance =       0.279093251334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279159069153
                                         uncertainty =       0.002013758516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279159069153
                                         uncertainty =       0.002013758516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373553424
  error estimate for blocks of size 2^( 2) =       0.000387588534
  error estimate for blocks of size 2^( 3) =       0.000399906503
  error estimate for blocks of size 2^( 4) =       0.000409560561
  error estimate for blocks of size 2^( 5) =       0.000415302233
  error estimate for blocks of size 2^( 6) =       0.000418894413
  error estimate for blocks of size 2^( 7) =       0.000420609171

      target function =      -0.913740745606
              le_mean =     -17.208867558732
             les_mean =     296.434373242631
             stat err =       0.000416091594
             autocorr =       1.240716172198
   target nu stat err =       0.000416091594
   target dn stat err =       0.002765400567
      target stat err =       0.003610929737
              std dev =       0.528292770473
             le_variance =       0.279093251334


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913740745606        initial  <--
     5.9605e+43     5.9605e+44             2.1046e-48        -0.913740745606
     2.3842e+44     2.3842e+45             4.2504e-49        -0.913740745606
     9.5367e+44     9.5367e+45             1.0626e-49        -0.913740745606

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9185
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4468e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2138
    reference variance = 0.220671
====================================================
  Execution time = 2.7050e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0452e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8362e-01
  Total weights = 1.966481246e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5851e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275568926062
                                         uncertainty =       0.001754688187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275568926062
                                         uncertainty =       0.001754688187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371193049
  error estimate for blocks of size 2^( 2) =       0.000385221022
  error estimate for blocks of size 2^( 3) =       0.000398464913
  error estimate for blocks of size 2^( 4) =       0.000408095452
  error estimate for blocks of size 2^( 5) =       0.000414019857
  error estimate for blocks of size 2^( 6) =       0.000417163081
  error estimate for blocks of size 2^( 7) =       0.000419783863

      target function =      -0.921146715812
              le_mean =     -17.209208840217
             les_mean =     296.440493064168
             stat err =       0.000414765563
             autocorr =       1.248549350391
   target nu stat err =       0.000414765563
   target dn stat err =       0.002177834526
      target stat err =       0.002913423547
              std dev =       0.524954642748
             le_variance =       0.275577376942


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720920884022e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+44, overlap shift 5.9605e+45 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921155170278       residual = 6.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921155170278       residual = 6.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+45, overlap shift 2.3842e+46 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921155170278       residual = 6.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921155170278       residual = 6.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+45, overlap shift 9.5367e+46 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921155170278       residual = 6.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921155170278       residual = 6.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.626459 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7624e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2032
    reference variance = 0.248552
====================================================
  Execution time = 2.6908e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8465e-01
  Total weights = 1.9662e+06
  Execution time = 2.3822e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276096147100
                                         uncertainty =       0.001771791292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276096147100
                                         uncertainty =       0.001771791292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371478981
  error estimate for blocks of size 2^( 2) =       0.000385516506
  error estimate for blocks of size 2^( 3) =       0.000398297077
  error estimate for blocks of size 2^( 4) =       0.000408084133
  error estimate for blocks of size 2^( 5) =       0.000413632524
  error estimate for blocks of size 2^( 6) =       0.000417127989
  error estimate for blocks of size 2^( 7) =       0.000418872828

      target function =      -0.919746197367
              le_mean =     -17.208998277104
             les_mean =     296.434272489578
             stat err =       0.000414429368
             autocorr =       1.244607908440
   target nu stat err =       0.000414429368
   target dn stat err =       0.002208974863
      target stat err =       0.002943539180
              std dev =       0.525359018921
             le_variance =       0.276002098762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276096147100
                                         uncertainty =       0.001771791292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276096147100
                                         uncertainty =       0.001771791292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371478981
  error estimate for blocks of size 2^( 2) =       0.000385516506
  error estimate for blocks of size 2^( 3) =       0.000398297077
  error estimate for blocks of size 2^( 4) =       0.000408084133
  error estimate for blocks of size 2^( 5) =       0.000413632524
  error estimate for blocks of size 2^( 6) =       0.000417127989
  error estimate for blocks of size 2^( 7) =       0.000418872828

      target function =      -0.919746197367
              le_mean =     -17.208998277104
             les_mean =     296.434272489578
             stat err =       0.000414429368
             autocorr =       1.244607908440
   target nu stat err =       0.000414429368
   target dn stat err =       0.002208974863
      target stat err =       0.002943539180
              std dev =       0.525359018921
             le_variance =       0.276002098762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276096147100
                                         uncertainty =       0.001771791292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276096147100
                                         uncertainty =       0.001771791292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371478981
  error estimate for blocks of size 2^( 2) =       0.000385516506
  error estimate for blocks of size 2^( 3) =       0.000398297077
  error estimate for blocks of size 2^( 4) =       0.000408084133
  error estimate for blocks of size 2^( 5) =       0.000413632524
  error estimate for blocks of size 2^( 6) =       0.000417127989
  error estimate for blocks of size 2^( 7) =       0.000418872828

      target function =      -0.919746197367
              le_mean =     -17.208998277104
             les_mean =     296.434272489578
             stat err =       0.000414429368
             autocorr =       1.244607908440
   target nu stat err =       0.000414429368
   target dn stat err =       0.002208974863
      target stat err =       0.002943539180
              std dev =       0.525359018921
             le_variance =       0.276002098762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276096147100
                                         uncertainty =       0.001771791292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276096147100
                                         uncertainty =       0.001771791292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371478981
  error estimate for blocks of size 2^( 2) =       0.000385516506
  error estimate for blocks of size 2^( 3) =       0.000398297077
  error estimate for blocks of size 2^( 4) =       0.000408084133
  error estimate for blocks of size 2^( 5) =       0.000413632524
  error estimate for blocks of size 2^( 6) =       0.000417127989
  error estimate for blocks of size 2^( 7) =       0.000418872828

      target function =      -0.919746197367
              le_mean =     -17.208998277104
             les_mean =     296.434272489578
             stat err =       0.000414429368
             autocorr =       1.244607908440
   target nu stat err =       0.000414429368
   target dn stat err =       0.002208974863
      target stat err =       0.002943539180
              std dev =       0.525359018921
             le_variance =       0.276002098762


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919746197367        initial  <--
     5.9605e+44     5.9605e+45             0.0000e+00        -0.919746197367
     2.3842e+45     2.3842e+46             0.0000e+00        -0.919746197367
     9.5367e+45     9.5367e+46             0.0000e+00        -0.919746197367

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9114
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6555e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.128
    reference variance = 0.24521
====================================================
  Execution time = 2.7141e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0496e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8237e-01
  Total weights = 1.966257482e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1719e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273299504173
                                         uncertainty =       0.001457594496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273299504173
                                         uncertainty =       0.001457594496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369678114
  error estimate for blocks of size 2^( 2) =       0.000383721131
  error estimate for blocks of size 2^( 3) =       0.000397127231
  error estimate for blocks of size 2^( 4) =       0.000406452439
  error estimate for blocks of size 2^( 5) =       0.000412125535
  error estimate for blocks of size 2^( 6) =       0.000416386619
  error estimate for blocks of size 2^( 7) =       0.000418774243

      target function =      -0.923004545020
              le_mean =     -17.209944546855
             les_mean =     296.464556329300
             stat err =       0.000413434709
             autocorr =       1.250738123584
   target nu stat err =       0.000413434709
   target dn stat err =       0.002048345827
      target stat err =       0.002761080250
              std dev =       0.522812167919
             le_variance =       0.273332562924


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720994454686e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+45, overlap shift 5.9605e+46 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923012063399       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923012063399       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923012063399       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+45 is 2.808081e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+46, overlap shift 2.3842e+47 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923012063399       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923012063399       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923012063399       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+46 is 7.397188e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+46, overlap shift 9.5367e+47 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923012063399       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923012063399       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923012063399       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+46 is 1.849297e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.630236 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5326e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2525
    reference variance = 0.289477
====================================================
  Execution time = 2.6836e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8586e-01
  Total weights = 1.9666e+06
  Execution time = 2.3809e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276837146440
                                         uncertainty =       0.001638553712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276837146440
                                         uncertainty =       0.001638553712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372019868
  error estimate for blocks of size 2^( 2) =       0.000386359191
  error estimate for blocks of size 2^( 3) =       0.000399504440
  error estimate for blocks of size 2^( 4) =       0.000409333611
  error estimate for blocks of size 2^( 5) =       0.000414399616
  error estimate for blocks of size 2^( 6) =       0.000416641205
  error estimate for blocks of size 2^( 7) =       0.000418723247

      target function =      -0.918340978329
              le_mean =     -17.209643481986
             les_mean =     296.457691943705
             stat err =       0.000414774420
             autocorr =       1.243058762026
   target nu stat err =       0.000414774420
   target dn stat err =       0.001982346337
      target stat err =       0.002649107007
              std dev =       0.526123961069
             le_variance =       0.276806422411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276837146440
                                         uncertainty =       0.001638553712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276837146440
                                         uncertainty =       0.001638553712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372019868
  error estimate for blocks of size 2^( 2) =       0.000386359191
  error estimate for blocks of size 2^( 3) =       0.000399504440
  error estimate for blocks of size 2^( 4) =       0.000409333611
  error estimate for blocks of size 2^( 5) =       0.000414399616
  error estimate for blocks of size 2^( 6) =       0.000416641205
  error estimate for blocks of size 2^( 7) =       0.000418723247

      target function =      -0.918340978329
              le_mean =     -17.209643481986
             les_mean =     296.457691943705
             stat err =       0.000414774420
             autocorr =       1.243058762026
   target nu stat err =       0.000414774420
   target dn stat err =       0.001982346337
      target stat err =       0.002649107007
              std dev =       0.526123961069
             le_variance =       0.276806422411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276837146440
                                         uncertainty =       0.001638553712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276837146440
                                         uncertainty =       0.001638553712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372019868
  error estimate for blocks of size 2^( 2) =       0.000386359191
  error estimate for blocks of size 2^( 3) =       0.000399504440
  error estimate for blocks of size 2^( 4) =       0.000409333611
  error estimate for blocks of size 2^( 5) =       0.000414399616
  error estimate for blocks of size 2^( 6) =       0.000416641205
  error estimate for blocks of size 2^( 7) =       0.000418723247

      target function =      -0.918340978329
              le_mean =     -17.209643481986
             les_mean =     296.457691943705
             stat err =       0.000414774420
             autocorr =       1.243058762026
   target nu stat err =       0.000414774420
   target dn stat err =       0.001982346337
      target stat err =       0.002649107007
              std dev =       0.526123961069
             le_variance =       0.276806422411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276837146440
                                         uncertainty =       0.001638553712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276837146440
                                         uncertainty =       0.001638553712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372019868
  error estimate for blocks of size 2^( 2) =       0.000386359191
  error estimate for blocks of size 2^( 3) =       0.000399504440
  error estimate for blocks of size 2^( 4) =       0.000409333611
  error estimate for blocks of size 2^( 5) =       0.000414399616
  error estimate for blocks of size 2^( 6) =       0.000416641205
  error estimate for blocks of size 2^( 7) =       0.000418723247

      target function =      -0.918340978329
              le_mean =     -17.209643481986
             les_mean =     296.457691943705
             stat err =       0.000414774420
             autocorr =       1.243058762026
   target nu stat err =       0.000414774420
   target dn stat err =       0.001982346337
      target stat err =       0.002649107007
              std dev =       0.526123961069
             le_variance =       0.276806422411


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918340978329        initial  <--
     5.9605e+45     5.9605e+46             2.8081e-50        -0.918340978329
     2.3842e+46     2.3842e+47             7.3972e-51        -0.918340978329
     9.5367e+46     9.5367e+47             1.8493e-51        -0.918340978329

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8269
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4170e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2745
    reference variance = 0.17404
====================================================
  Execution time = 2.7177e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0471e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8524e-01
  Total weights = 1.966282125e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3453e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275646363833
                                         uncertainty =       0.001532846566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275646363833
                                         uncertainty =       0.001532846566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371231928
  error estimate for blocks of size 2^( 2) =       0.000385463973
  error estimate for blocks of size 2^( 3) =       0.000398727841
  error estimate for blocks of size 2^( 4) =       0.000408436960
  error estimate for blocks of size 2^( 5) =       0.000415124291
  error estimate for blocks of size 2^( 6) =       0.000418517099
  error estimate for blocks of size 2^( 7) =       0.000418893710

      target function =      -0.919155867099
              le_mean =     -17.209665172726
             les_mean =     296.457816103069
             stat err =       0.000415243015
             autocorr =       1.251163394043
   target nu stat err =       0.000415243015
   target dn stat err =       0.002316053286
      target stat err =       0.003080164824
              std dev =       0.525009627668
             le_variance =       0.275635109144


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720966517273e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+46, overlap shift 5.9605e+47 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919165384839       residual = 8.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919165384839       residual = 8.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+47, overlap shift 2.3842e+48 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919165384839       residual = 8.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919165384839       residual = 8.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+47, overlap shift 9.5367e+48 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919165384839       residual = 8.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919165384839       residual = 8.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.633543 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5535e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2204
    reference variance = 0.134065
====================================================
  Execution time = 2.7010e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8646e-01
  Total weights = 1.9662e+06
  Execution time = 2.4081e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275601045219
                                         uncertainty =       0.001779098621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275601045219
                                         uncertainty =       0.001779098621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371181187
  error estimate for blocks of size 2^( 2) =       0.000385813883
  error estimate for blocks of size 2^( 3) =       0.000398796753
  error estimate for blocks of size 2^( 4) =       0.000408552567
  error estimate for blocks of size 2^( 5) =       0.000414939566
  error estimate for blocks of size 2^( 6) =       0.000418436910
  error estimate for blocks of size 2^( 7) =       0.000420524076

      target function =      -0.917586690689
              le_mean =     -17.209732059127
             les_mean =     296.461335421615
             stat err =       0.000415613280
             autocorr =       1.253738374089
   target nu stat err =       0.000415613280
   target dn stat err =       0.002423858620
      target stat err =       0.003208031101
              std dev =       0.524937867781
             le_variance =       0.275559765031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275601045219
                                         uncertainty =       0.001779098621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275601045219
                                         uncertainty =       0.001779098621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371181187
  error estimate for blocks of size 2^( 2) =       0.000385813883
  error estimate for blocks of size 2^( 3) =       0.000398796753
  error estimate for blocks of size 2^( 4) =       0.000408552567
  error estimate for blocks of size 2^( 5) =       0.000414939566
  error estimate for blocks of size 2^( 6) =       0.000418436910
  error estimate for blocks of size 2^( 7) =       0.000420524076

      target function =      -0.917586690689
              le_mean =     -17.209732059127
             les_mean =     296.461335421615
             stat err =       0.000415613280
             autocorr =       1.253738374089
   target nu stat err =       0.000415613280
   target dn stat err =       0.002423858620
      target stat err =       0.003208031101
              std dev =       0.524937867781
             le_variance =       0.275559765031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275601045219
                                         uncertainty =       0.001779098621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275601045219
                                         uncertainty =       0.001779098621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371181187
  error estimate for blocks of size 2^( 2) =       0.000385813883
  error estimate for blocks of size 2^( 3) =       0.000398796753
  error estimate for blocks of size 2^( 4) =       0.000408552567
  error estimate for blocks of size 2^( 5) =       0.000414939566
  error estimate for blocks of size 2^( 6) =       0.000418436910
  error estimate for blocks of size 2^( 7) =       0.000420524076

      target function =      -0.917586690689
              le_mean =     -17.209732059127
             les_mean =     296.461335421615
             stat err =       0.000415613280
             autocorr =       1.253738374089
   target nu stat err =       0.000415613280
   target dn stat err =       0.002423858620
      target stat err =       0.003208031101
              std dev =       0.524937867781
             le_variance =       0.275559765031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275601045219
                                         uncertainty =       0.001779098621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275601045219
                                         uncertainty =       0.001779098621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371181187
  error estimate for blocks of size 2^( 2) =       0.000385813883
  error estimate for blocks of size 2^( 3) =       0.000398796753
  error estimate for blocks of size 2^( 4) =       0.000408552567
  error estimate for blocks of size 2^( 5) =       0.000414939566
  error estimate for blocks of size 2^( 6) =       0.000418436910
  error estimate for blocks of size 2^( 7) =       0.000420524076

      target function =      -0.917586690689
              le_mean =     -17.209732059127
             les_mean =     296.461335421615
             stat err =       0.000415613280
             autocorr =       1.253738374089
   target nu stat err =       0.000415613280
   target dn stat err =       0.002423858620
      target stat err =       0.003208031101
              std dev =       0.524937867781
             le_variance =       0.275559765031


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917586690689        initial  <--
     5.9605e+46     5.9605e+47             0.0000e+00        -0.917586690689
     2.3842e+47     2.3842e+48             0.0000e+00        -0.917586690689
     9.5367e+47     9.5367e+48             0.0000e+00        -0.917586690689

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0953
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4647e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.1862
    reference variance = 0.167845
====================================================
  Execution time = 2.7691e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0509e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8998e-01
  Total weights = 1.966245941e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3720e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278796835044
                                         uncertainty =       0.002230207856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278796835044
                                         uncertainty =       0.002230207856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373305211
  error estimate for blocks of size 2^( 2) =       0.000387260117
  error estimate for blocks of size 2^( 3) =       0.000400232378
  error estimate for blocks of size 2^( 4) =       0.000409817586
  error estimate for blocks of size 2^( 5) =       0.000414995250
  error estimate for blocks of size 2^( 6) =       0.000417156689
  error estimate for blocks of size 2^( 7) =       0.000418030847

      target function =      -0.913125696868
              le_mean =     -17.210155144115
             les_mean =     296.479423631618
             stat err =       0.000415000093
             autocorr =       1.235857178025
   target nu stat err =       0.000415000093
   target dn stat err =       0.002976161320
      target stat err =       0.003881445738
              std dev =       0.527941738565
             le_variance =       0.278722479320


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721015514411e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+47, overlap shift 5.9605e+48 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913141380980       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913141380980       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+48, overlap shift 2.3842e+49 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913141380980       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913141380980       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+48, overlap shift 9.5367e+49 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913141380980       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913141380980       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.636845 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6077e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2546
    reference variance = 0.24225
====================================================
  Execution time = 2.6979e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8394e-01
  Total weights = 1.9661e+06
  Execution time = 2.3837e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274310795849
                                         uncertainty =       0.001499958701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274310795849
                                         uncertainty =       0.001499958701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370341384
  error estimate for blocks of size 2^( 2) =       0.000384849682
  error estimate for blocks of size 2^( 3) =       0.000397860813
  error estimate for blocks of size 2^( 4) =       0.000407379655
  error estimate for blocks of size 2^( 5) =       0.000413524134
  error estimate for blocks of size 2^( 6) =       0.000415315344
  error estimate for blocks of size 2^( 7) =       0.000416755015

      target function =      -0.921069661501
              le_mean =     -17.210418805088
             les_mean =     296.482451333094
             stat err =       0.000413243537
             autocorr =       1.245109791879
   target nu stat err =       0.000413243537
   target dn stat err =       0.002065896919
      target stat err =       0.002774242556
              std dev =       0.523750188435
             le_variance =       0.274314259886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274310795849
                                         uncertainty =       0.001499958701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274310795849
                                         uncertainty =       0.001499958701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370341384
  error estimate for blocks of size 2^( 2) =       0.000384849682
  error estimate for blocks of size 2^( 3) =       0.000397860813
  error estimate for blocks of size 2^( 4) =       0.000407379655
  error estimate for blocks of size 2^( 5) =       0.000413524134
  error estimate for blocks of size 2^( 6) =       0.000415315344
  error estimate for blocks of size 2^( 7) =       0.000416755015

      target function =      -0.921069661501
              le_mean =     -17.210418805088
             les_mean =     296.482451333094
             stat err =       0.000413243537
             autocorr =       1.245109791883
   target nu stat err =       0.000413243537
   target dn stat err =       0.002065896919
      target stat err =       0.002774242556
              std dev =       0.523750188435
             le_variance =       0.274314259886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274310795849
                                         uncertainty =       0.001499958701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274310795849
                                         uncertainty =       0.001499958701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370341384
  error estimate for blocks of size 2^( 2) =       0.000384849682
  error estimate for blocks of size 2^( 3) =       0.000397860813
  error estimate for blocks of size 2^( 4) =       0.000407379655
  error estimate for blocks of size 2^( 5) =       0.000413524134
  error estimate for blocks of size 2^( 6) =       0.000415315344
  error estimate for blocks of size 2^( 7) =       0.000416755015

      target function =      -0.921069661501
              le_mean =     -17.210418805088
             les_mean =     296.482451333094
             stat err =       0.000413243537
             autocorr =       1.245109791883
   target nu stat err =       0.000413243537
   target dn stat err =       0.002065896919
      target stat err =       0.002774242556
              std dev =       0.523750188435
             le_variance =       0.274314259886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274310795849
                                         uncertainty =       0.001499958701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274310795849
                                         uncertainty =       0.001499958701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370341384
  error estimate for blocks of size 2^( 2) =       0.000384849682
  error estimate for blocks of size 2^( 3) =       0.000397860813
  error estimate for blocks of size 2^( 4) =       0.000407379655
  error estimate for blocks of size 2^( 5) =       0.000413524134
  error estimate for blocks of size 2^( 6) =       0.000415315344
  error estimate for blocks of size 2^( 7) =       0.000416755015

      target function =      -0.921069661501
              le_mean =     -17.210418805088
             les_mean =     296.482451333094
             stat err =       0.000413243537
             autocorr =       1.245109791883
   target nu stat err =       0.000413243537
   target dn stat err =       0.002065896919
      target stat err =       0.002774242556
              std dev =       0.523750188435
             le_variance =       0.274314259886


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921069661501        initial  <--
     5.9605e+47     5.9605e+48             0.0000e+00        -0.921069661501
     2.3842e+48     2.3842e+49             0.0000e+00        -0.921069661501
     9.5367e+48     9.5367e+49             0.0000e+00        -0.921069661501

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9880
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5080e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.1252
    reference variance = 0.219217
====================================================
  Execution time = 2.7632e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0485e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8811e-01
  Total weights = 1.966158343e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8779e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279030192117
                                         uncertainty =       0.002129531011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279030192117
                                         uncertainty =       0.002129531011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373522946
  error estimate for blocks of size 2^( 2) =       0.000387805868
  error estimate for blocks of size 2^( 3) =       0.000400800408
  error estimate for blocks of size 2^( 4) =       0.000410189163
  error estimate for blocks of size 2^( 5) =       0.000414676734
  error estimate for blocks of size 2^( 6) =       0.000417199593
  error estimate for blocks of size 2^( 7) =       0.000417968210

      target function =      -0.915477495107
              le_mean =     -17.209862072083
             les_mean =     296.467460832022
             stat err =       0.000415008425
             autocorr =       1.234466345851
   target nu stat err =       0.000415008425
   target dn stat err =       0.002537993241
      target stat err =       0.003339464444
              std dev =       0.528249667768
             le_variance =       0.279047711497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720986207208e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+48, overlap shift 5.9605e+49 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915488956439       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915488956439       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915527343750       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 5.85e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 1.17e+07           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+48 is 2.557672e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+49, overlap shift 2.3842e+50 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915488956439       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915488956439       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915527343750       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 5.85e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 1.17e+07           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+49 is 6.394179e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+49, overlap shift 9.5367e+50 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915488956439       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915488956439       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 9.15e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 9.17e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+49 is 1.598545e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.641555 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7324e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2254
    reference variance = 0.162987
====================================================
  Execution time = 2.6946e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8812e-01
  Total weights = 1.9665e+06
  Execution time = 2.3682e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276155765745
                                         uncertainty =       0.001690899420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276155765745
                                         uncertainty =       0.001690899420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371569999
  error estimate for blocks of size 2^( 2) =       0.000386272130
  error estimate for blocks of size 2^( 3) =       0.000398843219
  error estimate for blocks of size 2^( 4) =       0.000408217624
  error estimate for blocks of size 2^( 5) =       0.000413545343
  error estimate for blocks of size 2^( 6) =       0.000414035980
  error estimate for blocks of size 2^( 7) =       0.000415616150

      target function =      -0.915353707588
              le_mean =     -17.209472247779
             les_mean =     296.454057347105
             stat err =       0.000412853774
             autocorr =       1.234557252115
   target nu stat err =       0.000412853774
   target dn stat err =       0.002911527448
      target stat err =       0.003812939860
              std dev =       0.525487740259
             le_variance =       0.276137365163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276155765745
                                         uncertainty =       0.001690899420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276155765745
                                         uncertainty =       0.001690899420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371569999
  error estimate for blocks of size 2^( 2) =       0.000386272130
  error estimate for blocks of size 2^( 3) =       0.000398843219
  error estimate for blocks of size 2^( 4) =       0.000408217624
  error estimate for blocks of size 2^( 5) =       0.000413545343
  error estimate for blocks of size 2^( 6) =       0.000414035980
  error estimate for blocks of size 2^( 7) =       0.000415616150

      target function =      -0.915353707588
              le_mean =     -17.209472247779
             les_mean =     296.454057347105
             stat err =       0.000412853774
             autocorr =       1.234557252115
   target nu stat err =       0.000412853774
   target dn stat err =       0.002911527448
      target stat err =       0.003812939860
              std dev =       0.525487740259
             le_variance =       0.276137365163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276155765745
                                         uncertainty =       0.001690899420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276155765745
                                         uncertainty =       0.001690899420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371569999
  error estimate for blocks of size 2^( 2) =       0.000386272130
  error estimate for blocks of size 2^( 3) =       0.000398843219
  error estimate for blocks of size 2^( 4) =       0.000408217624
  error estimate for blocks of size 2^( 5) =       0.000413545343
  error estimate for blocks of size 2^( 6) =       0.000414035980
  error estimate for blocks of size 2^( 7) =       0.000415616150

      target function =      -0.915353707588
              le_mean =     -17.209472247779
             les_mean =     296.454057347105
             stat err =       0.000412853774
             autocorr =       1.234557252115
   target nu stat err =       0.000412853774
   target dn stat err =       0.002911527448
      target stat err =       0.003812939860
              std dev =       0.525487740259
             le_variance =       0.276137365163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276155765745
                                         uncertainty =       0.001690899420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276155765745
                                         uncertainty =       0.001690899420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371569999
  error estimate for blocks of size 2^( 2) =       0.000386272130
  error estimate for blocks of size 2^( 3) =       0.000398843219
  error estimate for blocks of size 2^( 4) =       0.000408217624
  error estimate for blocks of size 2^( 5) =       0.000413545343
  error estimate for blocks of size 2^( 6) =       0.000414035980
  error estimate for blocks of size 2^( 7) =       0.000415616150

      target function =      -0.915353707588
              le_mean =     -17.209472247779
             les_mean =     296.454057347105
             stat err =       0.000412853774
             autocorr =       1.234557252115
   target nu stat err =       0.000412853774
   target dn stat err =       0.002911527448
      target stat err =       0.003812939860
              std dev =       0.525487740259
             le_variance =       0.276137365163


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915353707588        initial  <--
     5.9605e+48     5.9605e+49             2.5577e-53        -0.915353707588
     2.3842e+49     2.3842e+50             6.3942e-54        -0.915353707588
     9.5367e+49     9.5367e+50             1.5985e-54        -0.915353707588

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8720
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6213e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2894
    reference variance = 0.241478
====================================================
  Execution time = 2.7169e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0487e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9016e-01
  Total weights = 1.966269587e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4298e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278510911865
                                         uncertainty =       0.001670776617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278510911865
                                         uncertainty =       0.001670776617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373150288
  error estimate for blocks of size 2^( 2) =       0.000387409990
  error estimate for blocks of size 2^( 3) =       0.000400355901
  error estimate for blocks of size 2^( 4) =       0.000410502824
  error estimate for blocks of size 2^( 5) =       0.000415604056
  error estimate for blocks of size 2^( 6) =       0.000417043649
  error estimate for blocks of size 2^( 7) =       0.000418783862

      target function =      -0.912836415307
              le_mean =     -17.209899894515
             les_mean =     296.470810547701
             stat err =       0.000415483598
             autocorr =       1.239767378199
   target nu stat err =       0.000415483598
   target dn stat err =       0.003105367153
      target stat err =       0.004042165492
              std dev =       0.527722641724
             le_variance =       0.278491186588


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720989989452e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+49, overlap shift 5.9605e+50 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912853664315       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912853664315       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+50, overlap shift 2.3842e+51 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912853664315       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912853664315       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+50, overlap shift 9.5367e+51 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912853664315       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912853664315       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.644840 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5612e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1539
    reference variance = 0.219923
====================================================
  Execution time = 2.6920e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9214e-01
  Total weights = 1.9662e+06
  Execution time = 2.3777e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279691363376
                                         uncertainty =       0.002066193406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279691363376
                                         uncertainty =       0.002066193406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373978368
  error estimate for blocks of size 2^( 2) =       0.000387996734
  error estimate for blocks of size 2^( 3) =       0.000400820078
  error estimate for blocks of size 2^( 4) =       0.000410051815
  error estimate for blocks of size 2^( 5) =       0.000417240743
  error estimate for blocks of size 2^( 6) =       0.000420716275
  error estimate for blocks of size 2^( 7) =       0.000421404412

      target function =      -0.910370530269
              le_mean =     -17.210210740946
             les_mean =     296.483489036636
             stat err =       0.000417353311
             autocorr =       1.245416924054
   target nu stat err =       0.000417353311
   target dn stat err =       0.003268725714
      target stat err =       0.004230132546
              std dev =       0.528893742124
             le_variance =       0.279728590458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279691363376
                                         uncertainty =       0.002066193406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279691363376
                                         uncertainty =       0.002066193406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373978368
  error estimate for blocks of size 2^( 2) =       0.000387996734
  error estimate for blocks of size 2^( 3) =       0.000400820078
  error estimate for blocks of size 2^( 4) =       0.000410051815
  error estimate for blocks of size 2^( 5) =       0.000417240743
  error estimate for blocks of size 2^( 6) =       0.000420716275
  error estimate for blocks of size 2^( 7) =       0.000421404412

      target function =      -0.910370530269
              le_mean =     -17.210210740946
             les_mean =     296.483489036636
             stat err =       0.000417353311
             autocorr =       1.245416924054
   target nu stat err =       0.000417353311
   target dn stat err =       0.003268725714
      target stat err =       0.004230132546
              std dev =       0.528893742124
             le_variance =       0.279728590458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279691363376
                                         uncertainty =       0.002066193406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279691363376
                                         uncertainty =       0.002066193406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373978368
  error estimate for blocks of size 2^( 2) =       0.000387996734
  error estimate for blocks of size 2^( 3) =       0.000400820078
  error estimate for blocks of size 2^( 4) =       0.000410051815
  error estimate for blocks of size 2^( 5) =       0.000417240743
  error estimate for blocks of size 2^( 6) =       0.000420716275
  error estimate for blocks of size 2^( 7) =       0.000421404412

      target function =      -0.910370530269
              le_mean =     -17.210210740946
             les_mean =     296.483489036636
             stat err =       0.000417353311
             autocorr =       1.245416924054
   target nu stat err =       0.000417353311
   target dn stat err =       0.003268725714
      target stat err =       0.004230132546
              std dev =       0.528893742124
             le_variance =       0.279728590458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279691363376
                                         uncertainty =       0.002066193406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279691363376
                                         uncertainty =       0.002066193406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373978368
  error estimate for blocks of size 2^( 2) =       0.000387996734
  error estimate for blocks of size 2^( 3) =       0.000400820078
  error estimate for blocks of size 2^( 4) =       0.000410051815
  error estimate for blocks of size 2^( 5) =       0.000417240743
  error estimate for blocks of size 2^( 6) =       0.000420716275
  error estimate for blocks of size 2^( 7) =       0.000421404412

      target function =      -0.910370530269
              le_mean =     -17.210210740946
             les_mean =     296.483489036636
             stat err =       0.000417353311
             autocorr =       1.245416924054
   target nu stat err =       0.000417353311
   target dn stat err =       0.003268725714
      target stat err =       0.004230132546
              std dev =       0.528893742124
             le_variance =       0.279728590458


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910370530269        initial  <--
     5.9605e+49     5.9605e+50             0.0000e+00        -0.910370530269
     2.3842e+50     2.3842e+51             0.0000e+00        -0.910370530269
     9.5367e+50     9.5367e+51             0.0000e+00        -0.910370530269

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8791
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4507e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2083
    reference variance = 0.224955
====================================================
  Execution time = 2.7187e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0470e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8925e-01
  Total weights = 1.966293270e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1669e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278507407631
                                         uncertainty =       0.001674433248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278507407631
                                         uncertainty =       0.001674433248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373174833
  error estimate for blocks of size 2^( 2) =       0.000387108907
  error estimate for blocks of size 2^( 3) =       0.000400396561
  error estimate for blocks of size 2^( 4) =       0.000409718285
  error estimate for blocks of size 2^( 5) =       0.000414987183
  error estimate for blocks of size 2^( 6) =       0.000418113542
  error estimate for blocks of size 2^( 7) =       0.000420037251

      target function =      -0.914002206065
              le_mean =     -17.209859817854
             les_mean =     296.468522892322
             stat err =       0.000415714065
             autocorr =       1.240979889870
   target nu stat err =       0.000415714065
   target dn stat err =       0.002650112588
      target stat err =       0.003471626579
              std dev =       0.527757353211
             le_variance =       0.278527823868


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720985981785e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+50, overlap shift 5.9605e+51 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914014553692       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914014553692       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+51, overlap shift 2.3842e+52 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914014553692       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914014553692       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+51, overlap shift 9.5367e+52 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914014553692       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914014553692       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.648164 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5367e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.1653
    reference variance = 0.163942
====================================================
  Execution time = 2.7051e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8726e-01
  Total weights = 1.9664e+06
  Execution time = 2.3669e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277163581702
                                         uncertainty =       0.001625961587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277163581702
                                         uncertainty =       0.001625961587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372208264
  error estimate for blocks of size 2^( 2) =       0.000386288086
  error estimate for blocks of size 2^( 3) =       0.000399661245
  error estimate for blocks of size 2^( 4) =       0.000409368577
  error estimate for blocks of size 2^( 5) =       0.000415080450
  error estimate for blocks of size 2^( 6) =       0.000417286994
  error estimate for blocks of size 2^( 7) =       0.000418384087

      target function =      -0.916454536124
              le_mean =     -17.209384843580
             les_mean =     296.450186094041
             stat err =       0.000415030027
             autocorr =       1.243331719493
   target nu stat err =       0.000415030027
   target dn stat err =       0.002315712973
      target stat err =       0.003060600442
              std dev =       0.526390397661
             le_variance =       0.277086850750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277163581702
                                         uncertainty =       0.001625961587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277163581702
                                         uncertainty =       0.001625961587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372208264
  error estimate for blocks of size 2^( 2) =       0.000386288086
  error estimate for blocks of size 2^( 3) =       0.000399661245
  error estimate for blocks of size 2^( 4) =       0.000409368577
  error estimate for blocks of size 2^( 5) =       0.000415080450
  error estimate for blocks of size 2^( 6) =       0.000417286994
  error estimate for blocks of size 2^( 7) =       0.000418384087

      target function =      -0.916454536124
              le_mean =     -17.209384843580
             les_mean =     296.450186094041
             stat err =       0.000415030027
             autocorr =       1.243331719494
   target nu stat err =       0.000415030027
   target dn stat err =       0.002315712973
      target stat err =       0.003060600442
              std dev =       0.526390397661
             le_variance =       0.277086850750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277163581702
                                         uncertainty =       0.001625961587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277163581702
                                         uncertainty =       0.001625961587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372208264
  error estimate for blocks of size 2^( 2) =       0.000386288086
  error estimate for blocks of size 2^( 3) =       0.000399661245
  error estimate for blocks of size 2^( 4) =       0.000409368577
  error estimate for blocks of size 2^( 5) =       0.000415080450
  error estimate for blocks of size 2^( 6) =       0.000417286994
  error estimate for blocks of size 2^( 7) =       0.000418384087

      target function =      -0.916454536124
              le_mean =     -17.209384843580
             les_mean =     296.450186094041
             stat err =       0.000415030027
             autocorr =       1.243331719494
   target nu stat err =       0.000415030027
   target dn stat err =       0.002315712973
      target stat err =       0.003060600442
              std dev =       0.526390397661
             le_variance =       0.277086850750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277163581702
                                         uncertainty =       0.001625961587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277163581702
                                         uncertainty =       0.001625961587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372208264
  error estimate for blocks of size 2^( 2) =       0.000386288086
  error estimate for blocks of size 2^( 3) =       0.000399661245
  error estimate for blocks of size 2^( 4) =       0.000409368577
  error estimate for blocks of size 2^( 5) =       0.000415080450
  error estimate for blocks of size 2^( 6) =       0.000417286994
  error estimate for blocks of size 2^( 7) =       0.000418384087

      target function =      -0.916454536124
              le_mean =     -17.209384843580
             les_mean =     296.450186094041
             stat err =       0.000415030027
             autocorr =       1.243331719494
   target nu stat err =       0.000415030027
   target dn stat err =       0.002315712973
      target stat err =       0.003060600442
              std dev =       0.526390397661
             le_variance =       0.277086850750


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916454536124        initial  <--
     5.9605e+50     5.9605e+51             0.0000e+00        -0.916454536124
     2.3842e+51     2.3842e+52             0.0000e+00        -0.916454536124
     9.5367e+51     9.5367e+52             0.0000e+00        -0.916454536124

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9621
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.3234
    reference variance = 0.562255
====================================================
  Execution time = 2.6936e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0471e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8703e-01
  Total weights = 1.966151216e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1885e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277903964102
                                         uncertainty =       0.001420884551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277903964102
                                         uncertainty =       0.001420884551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372744820
  error estimate for blocks of size 2^( 2) =       0.000386917971
  error estimate for blocks of size 2^( 3) =       0.000400048739
  error estimate for blocks of size 2^( 4) =       0.000410175937
  error estimate for blocks of size 2^( 5) =       0.000415963481
  error estimate for blocks of size 2^( 6) =       0.000419234904
  error estimate for blocks of size 2^( 7) =       0.000422010775

      target function =      -0.917056996129
              le_mean =     -17.210514667517
             les_mean =     296.488841631843
             stat err =       0.000416846274
             autocorr =       1.250629341470
   target nu stat err =       0.000416846274
   target dn stat err =       0.002070688310
      target stat err =       0.002758256296
              std dev =       0.527149214429
             le_variance =       0.277886294273


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721051466752e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+51, overlap shift 5.9605e+52 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917064498338       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917064498338       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917064498338       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917064498338       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 1.82e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       1.579373754948       residual = 6.78e+02           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+51 is 1.670731e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+52, overlap shift 2.3842e+53 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917064498338       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917064498338       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917064498338       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917064498338       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917064498338       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901022273058       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 1.92e+19           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =       0.000000000000       residual = 1.37e+16           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =       0.000000000000       residual = 1.05e+26           smallest_sin_value = 1.00e+00
davidson iteration    9 stopping due to too large eigenvalue change
davidson solver did not converge after          9 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+52 is 4.007409e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+52, overlap shift 9.5367e+53 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917064498338       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917064498338       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917064498338       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917064498338       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917064498338       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901022273058       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 1.92e+19           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =       0.000000000000       residual = 1.37e+16           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =       0.000000000000       residual = 1.05e+26           smallest_sin_value = 1.00e+00
davidson iteration    9 stopping due to too large eigenvalue change
davidson solver did not converge after          9 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+52 is 1.001852e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.655014 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5141e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.1174
    reference variance = 0.216015
====================================================
  Execution time = 2.6730e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8838e-01
  Total weights = 1.9663e+06
  Execution time = 2.3708e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275650947654
                                         uncertainty =       0.001649026457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275650947654
                                         uncertainty =       0.001649026457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371229870
  error estimate for blocks of size 2^( 2) =       0.000385187218
  error estimate for blocks of size 2^( 3) =       0.000398710455
  error estimate for blocks of size 2^( 4) =       0.000407627807
  error estimate for blocks of size 2^( 5) =       0.000412810735
  error estimate for blocks of size 2^( 6) =       0.000416328949
  error estimate for blocks of size 2^( 7) =       0.000416839857

      target function =      -0.914987256122
              le_mean =     -17.209341417074
             les_mean =     296.449809426752
             stat err =       0.000413401837
             autocorr =       1.240106480330
   target nu stat err =       0.000413401837
   target dn stat err =       0.003113407124
      target stat err =       0.004067395676
              std dev =       0.525006717441
             le_variance =       0.275632053358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275650947654
                                         uncertainty =       0.001649026457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275650947654
                                         uncertainty =       0.001649026457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371229870
  error estimate for blocks of size 2^( 2) =       0.000385187218
  error estimate for blocks of size 2^( 3) =       0.000398710455
  error estimate for blocks of size 2^( 4) =       0.000407627807
  error estimate for blocks of size 2^( 5) =       0.000412810735
  error estimate for blocks of size 2^( 6) =       0.000416328949
  error estimate for blocks of size 2^( 7) =       0.000416839857

      target function =      -0.914987256122
              le_mean =     -17.209341417074
             les_mean =     296.449809426752
             stat err =       0.000413401837
             autocorr =       1.240106480330
   target nu stat err =       0.000413401837
   target dn stat err =       0.003113407124
      target stat err =       0.004067395676
              std dev =       0.525006717441
             le_variance =       0.275632053358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275650947654
                                         uncertainty =       0.001649026457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275650947654
                                         uncertainty =       0.001649026457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371229870
  error estimate for blocks of size 2^( 2) =       0.000385187218
  error estimate for blocks of size 2^( 3) =       0.000398710455
  error estimate for blocks of size 2^( 4) =       0.000407627807
  error estimate for blocks of size 2^( 5) =       0.000412810735
  error estimate for blocks of size 2^( 6) =       0.000416328949
  error estimate for blocks of size 2^( 7) =       0.000416839857

      target function =      -0.914987256122
              le_mean =     -17.209341417074
             les_mean =     296.449809426752
             stat err =       0.000413401837
             autocorr =       1.240106480330
   target nu stat err =       0.000413401837
   target dn stat err =       0.003113407124
      target stat err =       0.004067395676
              std dev =       0.525006717441
             le_variance =       0.275632053358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275650947654
                                         uncertainty =       0.001649026457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275650947654
                                         uncertainty =       0.001649026457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371229870
  error estimate for blocks of size 2^( 2) =       0.000385187218
  error estimate for blocks of size 2^( 3) =       0.000398710455
  error estimate for blocks of size 2^( 4) =       0.000407627807
  error estimate for blocks of size 2^( 5) =       0.000412810735
  error estimate for blocks of size 2^( 6) =       0.000416328949
  error estimate for blocks of size 2^( 7) =       0.000416839857

      target function =      -0.914987256122
              le_mean =     -17.209341417074
             les_mean =     296.449809426752
             stat err =       0.000413401837
             autocorr =       1.240106480330
   target nu stat err =       0.000413401837
   target dn stat err =       0.003113407124
      target stat err =       0.004067395676
              std dev =       0.525006717441
             le_variance =       0.275632053358


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914987256122        initial  <--
     5.9605e+51     5.9605e+52             1.6707e-56        -0.914987256122
     2.3842e+52     2.3842e+53             4.0074e-57        -0.914987256122
     9.5367e+52     9.5367e+53             1.0019e-57        -0.914987256122

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.6373
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3795e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1158
    reference variance = 0.164437
====================================================
  Execution time = 2.6981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0499e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8724e-01
  Total weights = 1.966117336e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2844e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277127365844
                                         uncertainty =       0.001613389974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277127365844
                                         uncertainty =       0.001613389974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372281478
  error estimate for blocks of size 2^( 2) =       0.000386381390
  error estimate for blocks of size 2^( 3) =       0.000400073782
  error estimate for blocks of size 2^( 4) =       0.000410078682
  error estimate for blocks of size 2^( 5) =       0.000416817739
  error estimate for blocks of size 2^( 6) =       0.000419443860
  error estimate for blocks of size 2^( 7) =       0.000423490542

      target function =      -0.916590468765
              le_mean =     -17.209808656093
             les_mean =     296.464753387247
             stat err =       0.000417457706
             autocorr =       1.257425037551
   target nu stat err =       0.000417457706
   target dn stat err =       0.002520850954
      target stat err =       0.003325893320
              std dev =       0.526493939522
             le_variance =       0.277195868354


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720980865609e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+52, overlap shift 5.9605e+53 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916601721183       residual = 6.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916601721183       residual = 6.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+53, overlap shift 2.3842e+54 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916601721183       residual = 6.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916601721183       residual = 6.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+53, overlap shift 9.5367e+54 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916601721183       residual = 6.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916601721183       residual = 6.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.658284 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8410e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1426
    reference variance = 0.202042
====================================================
  Execution time = 2.6885e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8881e-01
  Total weights = 1.9663e+06
  Execution time = 2.3723e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277899069045
                                         uncertainty =       0.002145963180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277899069045
                                         uncertainty =       0.002145963180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372762475
  error estimate for blocks of size 2^( 2) =       0.000386943491
  error estimate for blocks of size 2^( 3) =       0.000399528060
  error estimate for blocks of size 2^( 4) =       0.000409623940
  error estimate for blocks of size 2^( 5) =       0.000416092488
  error estimate for blocks of size 2^( 6) =       0.000418635549
  error estimate for blocks of size 2^( 7) =       0.000420893883

      target function =      -0.914615369555
              le_mean =     -17.210072969737
             les_mean =     296.475417785428
             stat err =       0.000416311465
             autocorr =       1.247304156342
   target nu stat err =       0.000416311465
   target dn stat err =       0.003732418914
      target stat err =       0.004862870059
              std dev =       0.527174181862
             le_variance =       0.277912618022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277899069045
                                         uncertainty =       0.002145963180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277899069045
                                         uncertainty =       0.002145963180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372762475
  error estimate for blocks of size 2^( 2) =       0.000386943491
  error estimate for blocks of size 2^( 3) =       0.000399528060
  error estimate for blocks of size 2^( 4) =       0.000409623940
  error estimate for blocks of size 2^( 5) =       0.000416092488
  error estimate for blocks of size 2^( 6) =       0.000418635549
  error estimate for blocks of size 2^( 7) =       0.000420893883

      target function =      -0.914615369555
              le_mean =     -17.210072969737
             les_mean =     296.475417785428
             stat err =       0.000416311465
             autocorr =       1.247304156340
   target nu stat err =       0.000416311465
   target dn stat err =       0.003732418914
      target stat err =       0.004862870059
              std dev =       0.527174181862
             le_variance =       0.277912618022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277899069045
                                         uncertainty =       0.002145963180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277899069045
                                         uncertainty =       0.002145963180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372762475
  error estimate for blocks of size 2^( 2) =       0.000386943491
  error estimate for blocks of size 2^( 3) =       0.000399528060
  error estimate for blocks of size 2^( 4) =       0.000409623940
  error estimate for blocks of size 2^( 5) =       0.000416092488
  error estimate for blocks of size 2^( 6) =       0.000418635549
  error estimate for blocks of size 2^( 7) =       0.000420893883

      target function =      -0.914615369555
              le_mean =     -17.210072969737
             les_mean =     296.475417785428
             stat err =       0.000416311465
             autocorr =       1.247304156340
   target nu stat err =       0.000416311465
   target dn stat err =       0.003732418914
      target stat err =       0.004862870059
              std dev =       0.527174181862
             le_variance =       0.277912618022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277899069045
                                         uncertainty =       0.002145963180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277899069045
                                         uncertainty =       0.002145963180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372762475
  error estimate for blocks of size 2^( 2) =       0.000386943491
  error estimate for blocks of size 2^( 3) =       0.000399528060
  error estimate for blocks of size 2^( 4) =       0.000409623940
  error estimate for blocks of size 2^( 5) =       0.000416092488
  error estimate for blocks of size 2^( 6) =       0.000418635549
  error estimate for blocks of size 2^( 7) =       0.000420893883

      target function =      -0.914615369555
              le_mean =     -17.210072969737
             les_mean =     296.475417785428
             stat err =       0.000416311465
             autocorr =       1.247304156340
   target nu stat err =       0.000416311465
   target dn stat err =       0.003732418914
      target stat err =       0.004862870059
              std dev =       0.527174181862
             le_variance =       0.277912618022


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914615369555        initial  <--
     5.9605e+52     5.9605e+53             0.0000e+00        -0.914615369555
     2.3842e+53     2.3842e+54             0.0000e+00        -0.914615369555
     9.5367e+53     9.5367e+54             0.0000e+00        -0.914615369555

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8404
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.1094
    reference variance = 0.222345
====================================================
  Execution time = 2.7705e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0444e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8595e-01
  Total weights = 1.966265414e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4671e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276406779308
                                         uncertainty =       0.001600503146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276406779308
                                         uncertainty =       0.001600503146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371764573
  error estimate for blocks of size 2^( 2) =       0.000385999779
  error estimate for blocks of size 2^( 3) =       0.000399352581
  error estimate for blocks of size 2^( 4) =       0.000408962409
  error estimate for blocks of size 2^( 5) =       0.000415134888
  error estimate for blocks of size 2^( 6) =       0.000417915330
  error estimate for blocks of size 2^( 7) =       0.000418747201

      target function =      -0.918207363617
              le_mean =     -17.209583680259
             les_mean =     296.455720974483
             stat err =       0.000415189957
             autocorr =       1.247261959411
   target nu stat err =       0.000415189957
   target dn stat err =       0.002445744219
      target stat err =       0.003239479309
              std dev =       0.525762912639
             le_variance =       0.276426640307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720958368026e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+53, overlap shift 5.9605e+54 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918218001985       residual = 5.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918218001985       residual = 5.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+54, overlap shift 2.3842e+55 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918218001985       residual = 5.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918218001985       residual = 5.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+54, overlap shift 9.5367e+55 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918218001985       residual = 5.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918218001985       residual = 5.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.661500 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6185e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.1523
    reference variance = 0.389132
====================================================
  Execution time = 2.6969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8850e-01
  Total weights = 1.9662e+06
  Execution time = 2.3883e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278875157845
                                         uncertainty =       0.001937640007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278875157845
                                         uncertainty =       0.001937640007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373412992
  error estimate for blocks of size 2^( 2) =       0.000387334143
  error estimate for blocks of size 2^( 3) =       0.000400361139
  error estimate for blocks of size 2^( 4) =       0.000409853353
  error estimate for blocks of size 2^( 5) =       0.000415480352
  error estimate for blocks of size 2^( 6) =       0.000419127491
  error estimate for blocks of size 2^( 7) =       0.000419207703

      target function =      -0.914944115330
              le_mean =     -17.209767451661
             les_mean =     296.464594501005
             stat err =       0.000415917225
             autocorr =       1.240609106245
   target nu stat err =       0.000415917225
   target dn stat err =       0.002862840838
      target stat err =       0.003749755801
              std dev =       0.528094167424
             le_variance =       0.278883449668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278875157845
                                         uncertainty =       0.001937640007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278875157845
                                         uncertainty =       0.001937640007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373412992
  error estimate for blocks of size 2^( 2) =       0.000387334143
  error estimate for blocks of size 2^( 3) =       0.000400361139
  error estimate for blocks of size 2^( 4) =       0.000409853353
  error estimate for blocks of size 2^( 5) =       0.000415480352
  error estimate for blocks of size 2^( 6) =       0.000419127491
  error estimate for blocks of size 2^( 7) =       0.000419207703

      target function =      -0.914944115330
              le_mean =     -17.209767451661
             les_mean =     296.464594501005
             stat err =       0.000415917225
             autocorr =       1.240609106245
   target nu stat err =       0.000415917225
   target dn stat err =       0.002862840838
      target stat err =       0.003749755801
              std dev =       0.528094167424
             le_variance =       0.278883449668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278875157845
                                         uncertainty =       0.001937640007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278875157845
                                         uncertainty =       0.001937640007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373412992
  error estimate for blocks of size 2^( 2) =       0.000387334143
  error estimate for blocks of size 2^( 3) =       0.000400361139
  error estimate for blocks of size 2^( 4) =       0.000409853353
  error estimate for blocks of size 2^( 5) =       0.000415480352
  error estimate for blocks of size 2^( 6) =       0.000419127491
  error estimate for blocks of size 2^( 7) =       0.000419207703

      target function =      -0.914944115330
              le_mean =     -17.209767451661
             les_mean =     296.464594501005
             stat err =       0.000415917225
             autocorr =       1.240609106245
   target nu stat err =       0.000415917225
   target dn stat err =       0.002862840838
      target stat err =       0.003749755801
              std dev =       0.528094167424
             le_variance =       0.278883449668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278875157845
                                         uncertainty =       0.001937640007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278875157845
                                         uncertainty =       0.001937640007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373412992
  error estimate for blocks of size 2^( 2) =       0.000387334143
  error estimate for blocks of size 2^( 3) =       0.000400361139
  error estimate for blocks of size 2^( 4) =       0.000409853353
  error estimate for blocks of size 2^( 5) =       0.000415480352
  error estimate for blocks of size 2^( 6) =       0.000419127491
  error estimate for blocks of size 2^( 7) =       0.000419207703

      target function =      -0.914944115330
              le_mean =     -17.209767451661
             les_mean =     296.464594501005
             stat err =       0.000415917225
             autocorr =       1.240609106245
   target nu stat err =       0.000415917225
   target dn stat err =       0.002862840838
      target stat err =       0.003749755801
              std dev =       0.528094167424
             le_variance =       0.278883449668


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914944115330        initial  <--
     5.9605e+53     5.9605e+54             0.0000e+00        -0.914944115330
     2.3842e+54     2.3842e+55             0.0000e+00        -0.914944115330
     9.5367e+54     9.5367e+55             0.0000e+00        -0.914944115330

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0027
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5203e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2127
    reference variance = 0.154977
====================================================
  Execution time = 2.7044e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0502e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9132e-01
  Total weights = 1.966475631e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1801e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280290858314
                                         uncertainty =       0.002255940261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280290858314
                                         uncertainty =       0.002255940261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374343784
  error estimate for blocks of size 2^( 2) =       0.000388963344
  error estimate for blocks of size 2^( 3) =       0.000402405913
  error estimate for blocks of size 2^( 4) =       0.000411966407
  error estimate for blocks of size 2^( 5) =       0.000416886523
  error estimate for blocks of size 2^( 6) =       0.000420389420
  error estimate for blocks of size 2^( 7) =       0.000421520276

      target function =      -0.911408042463
              le_mean =     -17.210176010325
             les_mean =     296.481480284288
             stat err =       0.000417690657
             autocorr =       1.244996896670
   target nu stat err =       0.000417690657
   target dn stat err =       0.003014532720
      target stat err =       0.003916444163
              std dev =       0.529410526787
             le_variance =       0.280275505873


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721017601032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+54, overlap shift 5.9605e+55 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911424317350       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911424317350       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911424317350       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911424317350       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+54 is 2.388025e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+55, overlap shift 2.3842e+56 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911424317350       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911424317350       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+55 is 5.345287e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+55, overlap shift 9.5367e+56 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911424317350       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911424317350       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 9.10e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 9.10e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+55 is 1.336322e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.665483 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5238e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2819
    reference variance = 0.356783
====================================================
  Execution time = 2.6884e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8555e-01
  Total weights = 1.9663e+06
  Execution time = 2.3859e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275744449080
                                         uncertainty =       0.001515664600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275744449080
                                         uncertainty =       0.001515664600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371308508
  error estimate for blocks of size 2^( 2) =       0.000385175081
  error estimate for blocks of size 2^( 3) =       0.000398224030
  error estimate for blocks of size 2^( 4) =       0.000408036685
  error estimate for blocks of size 2^( 5) =       0.000413493878
  error estimate for blocks of size 2^( 6) =       0.000416557126
  error estimate for blocks of size 2^( 7) =       0.000420428434

      target function =      -0.918980074489
              le_mean =     -17.210502808716
             les_mean =     296.486954731216
             stat err =       0.000414629031
             autocorr =       1.246951641579
   target nu stat err =       0.000414629031
   target dn stat err =       0.002268363436
      target stat err =       0.003021696061
              std dev =       0.525117929841
             le_variance =       0.275748840241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275744449080
                                         uncertainty =       0.001515664600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275744449080
                                         uncertainty =       0.001515664600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371308508
  error estimate for blocks of size 2^( 2) =       0.000385175081
  error estimate for blocks of size 2^( 3) =       0.000398224030
  error estimate for blocks of size 2^( 4) =       0.000408036685
  error estimate for blocks of size 2^( 5) =       0.000413493878
  error estimate for blocks of size 2^( 6) =       0.000416557126
  error estimate for blocks of size 2^( 7) =       0.000420428434

      target function =      -0.918980074489
              le_mean =     -17.210502808716
             les_mean =     296.486954731216
             stat err =       0.000414629031
             autocorr =       1.246951641579
   target nu stat err =       0.000414629031
   target dn stat err =       0.002268363436
      target stat err =       0.003021696061
              std dev =       0.525117929841
             le_variance =       0.275748840241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275744449080
                                         uncertainty =       0.001515664600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275744449080
                                         uncertainty =       0.001515664600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371308508
  error estimate for blocks of size 2^( 2) =       0.000385175081
  error estimate for blocks of size 2^( 3) =       0.000398224030
  error estimate for blocks of size 2^( 4) =       0.000408036685
  error estimate for blocks of size 2^( 5) =       0.000413493878
  error estimate for blocks of size 2^( 6) =       0.000416557126
  error estimate for blocks of size 2^( 7) =       0.000420428434

      target function =      -0.918980074489
              le_mean =     -17.210502808716
             les_mean =     296.486954731216
             stat err =       0.000414629031
             autocorr =       1.246951641579
   target nu stat err =       0.000414629031
   target dn stat err =       0.002268363436
      target stat err =       0.003021696061
              std dev =       0.525117929841
             le_variance =       0.275748840241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275744449080
                                         uncertainty =       0.001515664600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275744449080
                                         uncertainty =       0.001515664600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371308508
  error estimate for blocks of size 2^( 2) =       0.000385175081
  error estimate for blocks of size 2^( 3) =       0.000398224030
  error estimate for blocks of size 2^( 4) =       0.000408036685
  error estimate for blocks of size 2^( 5) =       0.000413493878
  error estimate for blocks of size 2^( 6) =       0.000416557126
  error estimate for blocks of size 2^( 7) =       0.000420428434

      target function =      -0.918980074489
              le_mean =     -17.210502808716
             les_mean =     296.486954731216
             stat err =       0.000414629031
             autocorr =       1.246951641579
   target nu stat err =       0.000414629031
   target dn stat err =       0.002268363436
      target stat err =       0.003021696061
              std dev =       0.525117929841
             le_variance =       0.275748840241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918980074489        initial  <--
     5.9605e+54     5.9605e+55             2.3880e-59        -0.918980074489
     2.3842e+55     2.3842e+56             5.3453e-60        -0.918980074489
     9.5367e+55     9.5367e+56             1.3363e-60        -0.918980074489

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8984
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4152e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2222
    reference variance = 0.143009
====================================================
  Execution time = 2.7160e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0479e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.8450e-01
  Total weights = 1.966501880e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3104e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276669465038
                                         uncertainty =       0.001650994184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276669465038
                                         uncertainty =       0.001650994184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371894390
  error estimate for blocks of size 2^( 2) =       0.000386301433
  error estimate for blocks of size 2^( 3) =       0.000399959270
  error estimate for blocks of size 2^( 4) =       0.000408999075
  error estimate for blocks of size 2^( 5) =       0.000414611551
  error estimate for blocks of size 2^( 6) =       0.000418553225
  error estimate for blocks of size 2^( 7) =       0.000422294000

      target function =      -0.919761599841
              le_mean =     -17.208353231413
             les_mean =     296.411925193144
             stat err =       0.000416114463
             autocorr =       1.251948223191
   target nu stat err =       0.000416114463
   target dn stat err =       0.002187138642
      target stat err =       0.002913287471
              std dev =       0.525946504397
             le_variance =       0.276619725487


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720835323141e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+55, overlap shift 5.9605e+56 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919769975458       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919769975458       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 9.21e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 9.24e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+55 is 1.491288e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+56, overlap shift 2.3842e+57 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919769975458       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919769975458       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919769975458       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919769975458       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919769975455       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 2.09e+07           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+56 is 4.417946e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+56, overlap shift 9.5367e+57 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919769975458       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919769975458       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919769975458       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919769975458       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919769975455       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 2.09e+07           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+56 is 1.104486e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.670573 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5485e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.229
    reference variance = 0.281807
====================================================
  Execution time = 2.6845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8535e-01
  Total weights = 1.9666e+06
  Execution time = 2.3895e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275036756770
                                         uncertainty =       0.001609828820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275036756770
                                         uncertainty =       0.001609828820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370814310
  error estimate for blocks of size 2^( 2) =       0.000385019854
  error estimate for blocks of size 2^( 3) =       0.000398141408
  error estimate for blocks of size 2^( 4) =       0.000407105154
  error estimate for blocks of size 2^( 5) =       0.000412646718
  error estimate for blocks of size 2^( 6) =       0.000415290538
  error estimate for blocks of size 2^( 7) =       0.000417144630

      target function =      -0.918987523353
              le_mean =     -17.209578016262
             les_mean =     296.454925139822
             stat err =       0.000413046760
             autocorr =       1.240753383091
   target nu stat err =       0.000413046760
   target dn stat err =       0.002615346135
      target stat err =       0.003462182537
              std dev =       0.524419017101
             le_variance =       0.275015305497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275036756770
                                         uncertainty =       0.001609828820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275036756770
                                         uncertainty =       0.001609828820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370814310
  error estimate for blocks of size 2^( 2) =       0.000385019854
  error estimate for blocks of size 2^( 3) =       0.000398141408
  error estimate for blocks of size 2^( 4) =       0.000407105154
  error estimate for blocks of size 2^( 5) =       0.000412646718
  error estimate for blocks of size 2^( 6) =       0.000415290538
  error estimate for blocks of size 2^( 7) =       0.000417144630

      target function =      -0.918987523353
              le_mean =     -17.209578016262
             les_mean =     296.454925139822
             stat err =       0.000413046760
             autocorr =       1.240753383097
   target nu stat err =       0.000413046760
   target dn stat err =       0.002615346135
      target stat err =       0.003462182537
              std dev =       0.524419017101
             le_variance =       0.275015305497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275036756770
                                         uncertainty =       0.001609828820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275036756770
                                         uncertainty =       0.001609828820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370814310
  error estimate for blocks of size 2^( 2) =       0.000385019854
  error estimate for blocks of size 2^( 3) =       0.000398141408
  error estimate for blocks of size 2^( 4) =       0.000407105154
  error estimate for blocks of size 2^( 5) =       0.000412646718
  error estimate for blocks of size 2^( 6) =       0.000415290538
  error estimate for blocks of size 2^( 7) =       0.000417144630

      target function =      -0.918987523353
              le_mean =     -17.209578016262
             les_mean =     296.454925139822
             stat err =       0.000413046760
             autocorr =       1.240753383097
   target nu stat err =       0.000413046760
   target dn stat err =       0.002615346135
      target stat err =       0.003462182537
              std dev =       0.524419017101
             le_variance =       0.275015305497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275036756770
                                         uncertainty =       0.001609828820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275036756770
                                         uncertainty =       0.001609828820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370814310
  error estimate for blocks of size 2^( 2) =       0.000385019854
  error estimate for blocks of size 2^( 3) =       0.000398141408
  error estimate for blocks of size 2^( 4) =       0.000407105154
  error estimate for blocks of size 2^( 5) =       0.000412646718
  error estimate for blocks of size 2^( 6) =       0.000415290538
  error estimate for blocks of size 2^( 7) =       0.000417144630

      target function =      -0.918987523353
              le_mean =     -17.209578016262
             les_mean =     296.454925139822
             stat err =       0.000413046760
             autocorr =       1.240753383097
   target nu stat err =       0.000413046760
   target dn stat err =       0.002615346135
      target stat err =       0.003462182537
              std dev =       0.524419017101
             le_variance =       0.275015305497


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918987523353        initial  <--
     5.9605e+55     5.9605e+56             1.4913e-60        -0.918987523353
     2.3842e+56     2.3842e+57             4.4179e-61        -0.918987523353
     9.5367e+56     9.5367e+57             1.1045e-61        -0.918987523353

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8773
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4378e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2281
    reference variance = 0.196682
====================================================
  Execution time = 2.7071e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0496e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8488e-01
  Total weights = 1.966406148e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0128e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276193133486
                                         uncertainty =       0.001541794202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276193133486
                                         uncertainty =       0.001541794202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371619744
  error estimate for blocks of size 2^( 2) =       0.000385534174
  error estimate for blocks of size 2^( 3) =       0.000398882444
  error estimate for blocks of size 2^( 4) =       0.000408412328
  error estimate for blocks of size 2^( 5) =       0.000414388884
  error estimate for blocks of size 2^( 6) =       0.000417135961
  error estimate for blocks of size 2^( 7) =       0.000417318481

      target function =      -0.919790791286
              le_mean =     -17.210256994834
             les_mean =     296.477824264441
             stat err =       0.000414313914
             autocorr =       1.242972377070
   target nu stat err =       0.000414313914
   target dn stat err =       0.002076662382
      target stat err =       0.002780112054
              std dev =       0.525558090297
             le_variance =       0.276211306277


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721025699483e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+56, overlap shift 5.9605e+57 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919798433004       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919798433004       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+57, overlap shift 2.3842e+58 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919798433004       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919798433004       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+57, overlap shift 9.5367e+58 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919798433004       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919798433004       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.673884 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7103e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2401
    reference variance = 0.406958
====================================================
  Execution time = 2.6840e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8624e-01
  Total weights = 1.9663e+06
  Execution time = 2.3746e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278337792210
                                         uncertainty =       0.002225813400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278337792210
                                         uncertainty =       0.002225813400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373080208
  error estimate for blocks of size 2^( 2) =       0.000386731498
  error estimate for blocks of size 2^( 3) =       0.000399369946
  error estimate for blocks of size 2^( 4) =       0.000408929814
  error estimate for blocks of size 2^( 5) =       0.000413621588
  error estimate for blocks of size 2^( 6) =       0.000416560822
  error estimate for blocks of size 2^( 7) =       0.000419482230

      target function =      -0.917976583546
              le_mean =     -17.210159081927
             les_mean =     296.475819465661
             stat err =       0.000414648613
             autocorr =       1.235253276888
   target nu stat err =       0.000414648613
   target dn stat err =       0.002668089739
      target stat err =       0.003525911309
              std dev =       0.527623531746
             le_variance =       0.278386591252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278337792210
                                         uncertainty =       0.002225813400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278337792210
                                         uncertainty =       0.002225813400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373080208
  error estimate for blocks of size 2^( 2) =       0.000386731498
  error estimate for blocks of size 2^( 3) =       0.000399369946
  error estimate for blocks of size 2^( 4) =       0.000408929814
  error estimate for blocks of size 2^( 5) =       0.000413621588
  error estimate for blocks of size 2^( 6) =       0.000416560822
  error estimate for blocks of size 2^( 7) =       0.000419482230

      target function =      -0.917976583546
              le_mean =     -17.210159081927
             les_mean =     296.475819465661
             stat err =       0.000414648613
             autocorr =       1.235253276888
   target nu stat err =       0.000414648613
   target dn stat err =       0.002668089739
      target stat err =       0.003525911309
              std dev =       0.527623531746
             le_variance =       0.278386591252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278337792210
                                         uncertainty =       0.002225813400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278337792210
                                         uncertainty =       0.002225813400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373080208
  error estimate for blocks of size 2^( 2) =       0.000386731498
  error estimate for blocks of size 2^( 3) =       0.000399369946
  error estimate for blocks of size 2^( 4) =       0.000408929814
  error estimate for blocks of size 2^( 5) =       0.000413621588
  error estimate for blocks of size 2^( 6) =       0.000416560822
  error estimate for blocks of size 2^( 7) =       0.000419482230

      target function =      -0.917976583546
              le_mean =     -17.210159081927
             les_mean =     296.475819465661
             stat err =       0.000414648613
             autocorr =       1.235253276888
   target nu stat err =       0.000414648613
   target dn stat err =       0.002668089739
      target stat err =       0.003525911309
              std dev =       0.527623531746
             le_variance =       0.278386591252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278337792210
                                         uncertainty =       0.002225813400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278337792210
                                         uncertainty =       0.002225813400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373080208
  error estimate for blocks of size 2^( 2) =       0.000386731498
  error estimate for blocks of size 2^( 3) =       0.000399369946
  error estimate for blocks of size 2^( 4) =       0.000408929814
  error estimate for blocks of size 2^( 5) =       0.000413621588
  error estimate for blocks of size 2^( 6) =       0.000416560822
  error estimate for blocks of size 2^( 7) =       0.000419482230

      target function =      -0.917976583546
              le_mean =     -17.210159081927
             les_mean =     296.475819465661
             stat err =       0.000414648613
             autocorr =       1.235253276888
   target nu stat err =       0.000414648613
   target dn stat err =       0.002668089739
      target stat err =       0.003525911309
              std dev =       0.527623531746
             le_variance =       0.278386591252


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917976583546        initial  <--
     5.9605e+56     5.9605e+57             0.0000e+00        -0.917976583546
     2.3842e+57     2.3842e+58             0.0000e+00        -0.917976583546
     9.5367e+57     9.5367e+58             0.0000e+00        -0.917976583546

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8093
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.085226e-01 1 1  ON 0
  uu_1                 5.234236e-02 1 1  ON 1
  uu_2                -3.707546e-02 1 1  ON 2
  uu_3                -9.031758e-02 1 1  ON 3
  uu_4                -1.222790e-01 1 1  ON 4
  uu_5                -1.315724e-01 1 1  ON 5
  uu_6                -1.137333e-01 1 1  ON 6
  uu_7                -5.557761e-02 1 1  ON 7
  uu_8                 6.127295e-02 1 1  ON 8
  uu_9                 1.219792e-01 1 1  ON 9
  ud_0                 3.013137e-01 1 1  ON 10
  ud_1                 7.401120e-02 1 1  ON 11
  ud_2                -2.540207e-02 1 1  ON 12
  ud_3                -7.665085e-02 1 1  ON 13
  ud_4                -1.122475e-01 1 1  ON 14
  ud_5                -1.322663e-01 1 1  ON 15
  ud_6                -1.279198e-01 1 1  ON 16
  ud_7                -8.886151e-02 1 1  ON 17
  ud_8                -3.543190e-03 1 1  ON 18
  ud_9                 8.507211e-02 1 1  ON 19
  eO_0                -6.939931e-01 1 1  ON 20
  eO_1                -4.135577e-01 1 1  ON 21
  eO_2                -4.114945e-02 1 1  ON 22
  eO_3                 1.790346e-01 1 1  ON 23
  eO_4                 2.510250e-01 1 1  ON 24
  eO_5                 2.753322e-01 1 1  ON 25
  eO_6                 2.475324e-01 1 1  ON 26
  eO_7                 1.360299e-01 1 1  ON 27
  eO_8                 2.899396e-02 1 1  ON 28
  eO_9                 1.933890e-02 1 1  ON 29
 eH1_0                -2.044522e-01 1 1  ON 30
 eH1_1                -9.984160e-02 1 1  ON 31
 eH1_2                -4.893474e-02 1 1  ON 32
 eH1_3                -1.761908e-02 1 1  ON 33
 eH1_4                 1.758573e-02 1 1  ON 34
 eH1_5                 2.530478e-02 1 1  ON 35
 eH1_6                 7.729273e-02 1 1  ON 36
 eH1_7                 1.064271e-01 1 1  ON 37
 eH1_8                 1.024307e-01 1 1  ON 38
 eH1_9                 2.574338e-02 1 1  ON 39
 eH2_0                -2.011051e-01 1 1  ON 40
 eH2_1                -9.666840e-02 1 1  ON 41
 eH2_2                -4.626212e-02 1 1  ON 42
 eH2_3                -1.568804e-02 1 1  ON 43
 eH2_4                 1.794291e-02 1 1  ON 44
 eH2_5                 2.168908e-02 1 1  ON 45
 eH2_6                 6.870834e-02 1 1  ON 46
 eH2_7                 1.058400e-01 1 1  ON 47
 eH2_8                 1.043343e-01 1 1  ON 48
 eH2_9                 2.822488e-02 1 1  ON 49
ci_001                -4.271307e-02 3 1  ON 50
ci_002                -3.125995e-02 3 1  ON 51
ci_003                -2.592571e-02 3 1  ON 52
ci_004                 2.446782e-02 3 1  ON 53
ci_005                 2.454685e-02 3 1  ON 54
ci_006                -2.040318e-02 3 1  ON 55
ci_007                -2.055570e-02 3 1  ON 56
ci_008                -8.972855e-03 3 1  ON 57
ci_009                -1.503439e-02 3 1  ON 58
ci_010                -9.361103e-03 3 1  ON 59
ci_011                -1.056493e-02 3 1  ON 60
ci_012                -1.039172e-02 3 1  ON 61
ci_013                -1.948810e-02 3 1  ON 62
ci_014                 1.305510e-02 3 1  ON 63
ci_015                 1.351162e-02 3 1  ON 64
ci_016                 1.652840e-02 3 1  ON 65
ci_017                 1.623674e-02 3 1  ON 66
ci_018                 1.036374e-02 3 1  ON 67
ci_019                 1.021839e-02 3 1  ON 68
ci_020                 1.667190e-02 3 1  ON 69
ci_021                 1.651216e-02 3 1  ON 70
ci_022                 1.078735e-02 3 1  ON 71
ci_023                 1.010075e-02 3 1  ON 72
ci_024                 7.658203e-03 3 1  ON 73
ci_025                 7.008292e-03 3 1  ON 74
ci_026                 1.183911e-02 3 1  ON 75
ci_027                 1.160628e-02 3 1  ON 76
ci_028                -1.508897e-02 3 1  ON 77
ci_029                -1.542033e-02 3 1  ON 78
ci_030                -4.850839e-03 3 1  ON 79
ci_031                -4.845088e-03 3 1  ON 80
ci_032                -1.516514e-02 3 1  ON 81
ci_033                 6.838373e-03 3 1  ON 82
ci_034                 7.367477e-03 3 1  ON 83
ci_035                -4.689283e-03 3 1  ON 84
ci_036                -1.283780e-02 3 1  ON 85
ci_037                -1.270354e-02 3 1  ON 86
ci_038                 1.242716e-03 3 1  ON 87
ci_039                 1.512880e-03 3 1  ON 88
ci_040                -2.765068e-03 3 1  ON 89
ci_041                 8.543885e-03 3 1  ON 90
ci_042                 8.305212e-03 3 1  ON 91
ci_043                -3.617424e-03 3 1  ON 92
ci_044                -4.696354e-03 3 1  ON 93
ci_045                -2.845409e-03 3 1  ON 94
ci_046                 5.908393e-03 3 1  ON 95
ci_047                 5.850732e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5933e+01 secs
  Total Execution time = 7.5058e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
